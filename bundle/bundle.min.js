"use strict";(()=>{var $t=Object.defineProperty;var ss=Object.getOwnPropertyDescriptor;var os=Object.getOwnPropertyNames;var as=Object.prototype.hasOwnProperty;var ls=(d,s,e)=>s in d?$t(d,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[s]=e;var y=(d,s)=>()=>(d&&(s=d(d=0)),s);var ds=(d,s)=>()=>(s||d((s={exports:{}}).exports,s),s.exports),U=(d,s)=>{for(var e in s)$t(d,e,{get:s[e],enumerable:!0})},gs=(d,s,e,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of os(s))!as.call(d,r)&&r!==e&&$t(d,r,{get:()=>s[r],enumerable:!(t=ss(s,r))||t.enumerable});return d};var _=d=>gs($t({},"__esModule",{value:!0}),d);var T=(d,s,e)=>(ls(d,typeof s!="symbol"?s+"":s,e),e),vr=(d,s,e)=>{if(!s.has(d))throw TypeError("Cannot "+e)};var h=(d,s,e)=>(vr(d,s,"read from private field"),e?e.call(d):s.get(d)),A=(d,s,e)=>{if(s.has(d))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(d):s.set(d,e)},$=(d,s,e,t)=>(vr(d,s,"write to private field"),t?t.call(d,e):s.set(d,e),e);var Nt=(d,s,e,t)=>({set _(r){$(d,s,r,e)},get _(){return h(d,s,t)}}),E=(d,s,e)=>(vr(d,s,"access private method"),e);var mn,fn=y(()=>{"use strict";mn=["bold-header","format-leakage","fostered-content","h1","illegal-attr","insecure-style","invalid-gallery","invalid-imagemap","invalid-invoke","lonely-apos","lonely-bracket","lonely-http","nested-link","no-arg","no-duplicate","no-ignored","obsolete-attr","obsolete-tag","parsing-order","pipe-like","table-layout","tag-like","unbalanced-header","unclosed-comment","unclosed-quote","unclosed-table","unescaped","unknown-page","unmatched-tag","unterminated-url","url-encoding","var-anchor","void-ext"]});var Ae,Le,wr,xn,Re=y(()=>{"use strict";Ae={running:!1,run(d){let{running:s}=this;this.running=!0;try{let e=d();return this.running=s,e}catch(e){throw this.running=s,e}}},Le=d=>s=>s.type===d,wr=(d,s,e,t=[])=>{let r=[...d.childNodes],n=r.splice(s,e,...t);d.setAttribute("childNodes",r);for(let i of t)i.setAttribute("parentNode",d);return n},xn=(d,s)=>new Array(d).fill(void 0).map((e,t)=>s(t))});var Tn=ds((Vs,ps)=>{ps.exports={ext:[],html:[["b","bdi","del","i","ins","u","font","big","small","sub","sup","h1","h2","h3","h4","h5","h6","cite","code","em","s","strike","strong","tt","var","div","center","blockquote","ol","ul","dl","table","caption","pre","ruby","rb","rp","rt","rtc","p","span","abbr","dfn","kbd","samp","data","time","mark","tr","td","th","q","bdo"],["li","dt","dd"],["br","wbr","hr","meta","link"]],namespaces:{},nsid:{file:6,category:14},parserFunction:[{"#language":"language","#special":"special","#speciale":"speciale","#tag":"tag","#formatdate":"formatdate","#dateformat":"formatdate","#invoke":"invoke","#while":"while","#dowhile":"dowhile","#loop":"loop","#forargs":"forargs","#fornumargs":"fornumargs","#if":"if","#ifeq":"ifeq","#switch":"switch","#ifexist":"ifexist","#ifexpr":"ifexpr","#iferror":"iferror","#time":"time","#timel":"timel","#expr":"expr","#rel2abs":"rel2abs","#titleparts":"titleparts","#categorytree":"categorytree","#urldecode":"urldecode","#choose":"choose","#var":"var","#varexists":"varexists","#var_final":"var_final","#vardefine":"vardefine","#vardefineecho":"vardefineecho","#widget":"widget","#regex":"regex","#related":"related","#cscore":"cscore"},["!","="],["msg","raw"],["subst","safesubst"]],doubleUnderscore:[[],[]],protocol:"bitcoin:|ftp://|ftps://|geo:|git://|gopher://|http://|https://|irc://|ircs://|magnet:|mailto:|matrix:|mms://|news:|nntp://|redis://|sftp://|sip:|sips:|sms:|ssh://|svn://|tel:|telnet://|urn:|worldwind://|xmpp:",interwiki:[],img:{},variants:[]}});var bn,ue=y(()=>{"use strict";bn=Tn()});var kn,ve,we,Me,yn,re,An,ce,It,vn,us,Et,fe,H=y(()=>{"use strict";kn='[^[\\]<>"\0-\x7F\\p{Zs}\uFFFD]',ve=`(?:\\[[\\da-f:.]+\\]|${kn})`,we=`(?:${kn}|\0\\d+[c!~]\x7F)*`,Me=(d,s)=>e=>e.replace(d,s),yn=Me(/[\0\x7F]/gu,""),re=Me(/\0\d+c\x7F/gu,""),An=Me(/[\\{}()|.?*+^$[\]]/gu,"\\$&"),ce=(d,s="")=>d.map(e=>typeof e=="string"?e:e.text()).join(s),It=Me(/&#(\d+|x[\da-f]+);/giu,(d,s)=>String.fromCodePoint(+`${/^x/iu.test(s)?"0":""}${s}`)),vn=Me(/\n/gu,"\\n"),us={"&":"amp","<":"lt",">":"gt"},Et=Me(/[&<>]/gu,d=>`&${us[d]};`),fe=(d,s={})=>{let{pre:e="",post:t="",sep:r=""}=s;return`${e}${d.map(n=>n.print()).join(r)}${t}`}});var wn={};U(wn,{Title:()=>Sr});var pt,ut,Sr,Sn=y(()=>{"use strict";H();w();Sr=class{constructor(s,e=0,t=m.getConfig(),r=!1,n=!1){A(this,pt,void 0);A(this,ut,void 0);T(this,"ns");T(this,"fragment");T(this,"interwiki","");T(this,"valid");T(this,"encoded",!1);if(s=It(s),r&&s.includes("%"))try{let g=/%(?!21|3[ce]|5[bd]|7[b-d])[\da-f]{2}/iu.test(s);s=decodeURIComponent(s),this.encoded=g}catch(g){}s=s.replace(/_/gu," ").trim();let i=e;s.startsWith(":")&&(i=0,s=s.slice(1).trim());let a=s.split(":");if(a.length>1){let g=t.nsid[a[0].trim().toLowerCase()];g&&(i=g,s=a.slice(1).join(":").trim())}this.ns=i;let o=s.indexOf("#");if(o!==-1){let g=s.slice(o+1).trimEnd();if(g.includes("%"))try{g=decodeURIComponent(g)}catch(p){}this.fragment=g,s=s.slice(0,o).trim()}this.valid=!!(s||this.interwiki||n&&i===0&&this.fragment!==void 0)&&!/^:|\0\d+[eh!+-]\x7F|[<>[\]{}|]|%[\da-f]{2}|(?:^|\/)\.{1,2}(?:$|\/)/iu.test(s),this.main=s,Object.defineProperties(this,{encoded:{enumerable:!1,writable:!1}}),$(this,ut,t.namespaces)}get main(){return h(this,pt)}set main(s){s=s.replace(/_/gu," ").trim(),$(this,pt,s&&`${s[0].toUpperCase()}${s.slice(1)}`)}get prefix(){let s=h(this,ut)[this.ns];return`${s}${s&&":"}`}get title(){return`${`${this.interwiki}${this.interwiki&&":"}${this.prefix}`}${this.main}`.replace(/ /gu,"_")}get extension(){let{main:s}=this,e=s.lastIndexOf(".");return e===-1?void 0:s.slice(e+1).toLowerCase()}toString(){return`${this.title}${this.fragment===void 0?"":`#${this.fragment}`}`}};pt=new WeakMap,ut=new WeakMap});var Cn,C,N,j=y(()=>{"use strict";w();Cn=d=>(s,e,t,r,n="error")=>{let{start:i}=e,{top:a,left:o}="top"in e?e:s.getRootNode().posFromIndex(i),{offsetHeight:g,offsetWidth:p}=s,{startIndex:l,startLine:c,startCol:u}=d(s,i,a,o);return{rule:t,message:m.msg(r),severity:n,startIndex:l,endIndex:l+String(s).length,startLine:c,endLine:c+g-1,startCol:u,endCol:g===1?u+p:p}},C=Cn((d,s,e,t)=>{let r=d.getRelativeIndex(),{top:n,left:i}=d.parentNode.posFromIndex(r);return{startIndex:s+r,startLine:e+n,startCol:n?i:t+i}}),N=Cn((d,s,e,t)=>({startIndex:s,startLine:e,startCol:t}))});var ct,ht,Cr,We,$r=y(()=>{"use strict";We=class{constructor(){A(this,ht);T(this,"childNodes",[]);A(this,ct,void 0)}get firstChild(){return this.childNodes[0]}get lastChild(){return this.childNodes[this.childNodes.length-1]}get parentNode(){return h(this,ct)}get nextSibling(){var e;let s=(e=this.parentNode)==null?void 0:e.childNodes;return s&&s[s.indexOf(this)+1]}get previousSibling(){var e;let s=(e=this.parentNode)==null?void 0:e.childNodes;return s&&s[s.indexOf(this)-1]}get offsetHeight(){return E(this,ht,Cr).call(this).height}get offsetWidth(){return E(this,ht,Cr).call(this).width}getAttribute(s){return s==="padding"?0:this[s]}setAttribute(s,e){s==="parentNode"?$(this,ct,e):this[s]=e}getRootNode(){let{parentNode:s}=this;for(;s!=null&&s.parentNode;)({parentNode:s}=s);return s!=null?s:this}posFromIndex(s){let e=String(this);if(s>=-e.length&&s<=e.length){let t=e.slice(0,s).split(`
`),r=t.length-1;return{top:r,left:t[r].length}}}getGaps(s){return 0}getRelativeIndex(s){let e,t=(r,n)=>e.slice(0,r).reduce((i,a,o)=>i+String(a).length+n.getGaps(o),0)+n.getAttribute("padding");if(s===void 0){let{parentNode:r}=this;return r?({childNodes:e}=r,t(e.indexOf(this),r)):0}return{childNodes:e}=this,t(s,this)}getAbsoluteIndex(){let{parentNode:s}=this;return s?s.getAbsoluteIndex()+this.getRelativeIndex():0}seal(s,e){Object.defineProperty(this,s,{enumerable:!e&&!!this[s],configurable:!0})}};ct=new WeakMap,ht=new WeakSet,Cr=function(){let s=String(this).split(`
`),e=s.length;return{height:e,width:s[e-1].length}}});var mt,Nr,ft,Ir,Ft,$n=y(()=>{"use strict";H();Re();$r();Ft=class extends We{constructor(){super(...arguments);A(this,mt);A(this,ft)}get length(){return this.childNodes.length}text(e){return ce(this.childNodes,e)}normalize(){let e=[...this.childNodes];for(let t=e.length-1;t>=0;t--){let{type:r,data:n}=e[t];r!=="text"||this.getGaps(t-1)||n===""&&e.splice(t,1)}this.setAttribute("childNodes",e)}removeAt(e){return wr(this,e,1)[0]}insertAt(e,t=this.length){return wr(this,t,0,[e]),e}closest(e){let t=E(this,mt,Nr).call(this,e),{parentNode:r}=this;for(;r;){if(t(r))return r;({parentNode:r}=r)}}querySelectorAll(e){let t=E(this,mt,Nr).call(this,e);return E(this,ft,Ir).call(this,t)}append(...e){for(let t of e)this.insertAt(t)}replaceChildren(...e){for(let t=this.length-1;t>=0;t--)this.removeAt(t);this.append(...e)}setText(e,t=0){t+=t<0?this.length:0;let r=this.childNodes[t],{data:n}=r;return r.replaceData(e),n}toString(e=""){return this.childNodes.map(String).join(e)}lint(e=this.getAbsoluteIndex(),t){let r=[];for(let n=0,i=e+this.getAttribute("padding");n<this.length;n++){let a=this.childNodes[n];r.push(...a.lint(i,t)),i+=String(a).length+this.getGaps(n)}return r}print(e={}){var t;return String(this)?`<span class="wpb-${(t=e.class)!=null?t:this.type}">${fe(this.childNodes,e)}</span>`:""}json(e,t=this.getAbsoluteIndex()){let r={...this,range:[t,t+String(this).length],childNodes:[]};for(let n=0,i=t+this.getAttribute("padding");n<this.length;n++){let a=this.childNodes[n],{length:o}=String(a);a.type==="text"?r.childNodes.push({data:a.data,range:[i,i+o]}):r.childNodes.push(a.json(void 0,i)),i+=o+this.getGaps(n)}return r}};mt=new WeakSet,Nr=function(e){let t=new Set(e.split(",").map(r=>r.trim()));return({type:r})=>t.has(r)},ft=new WeakSet,Ir=function(e){var r;let t=[];for(let n of this.childNodes)n.type!=="text"&&(e(n)&&t.push(n),t.push(...E(r=n,ft,Ir).call(r,e)));return t}});var Nn,cs,hs,ms,fs,xs,Lt,In,xt,En=y(()=>{"use strict";H();w();$r();Nn="<\\s*(?:\\/\\s*)?([a-z]\\w*)|\\{+|\\}+|\\[{2,}|\\[(?![^[]*?\\])|((?:^|\\])[^[]*?)\\]+",cs=new RegExp(`${Nn}|https?[:/]\\/+`,"giu"),hs=new RegExp(Nn,"giu"),ms={"[":/[[\]]/u,"{":/[{}]/u,"]":/[[\]](?=[^[\]]*$)/u,"}":/[{}](?=[^{}]*$)/u},fs={"<":"tag-like","[":"lonely-bracket","{":"lonely-bracket","]":"lonely-bracket","}":"lonely-bracket",h:"lonely-http"},xs=["html","head","style","title","body","a","audio","img","video","embed","iframe","object","canvas","script","col","colgroup","tbody","tfoot","thead","button","input","label","option","select","textarea"],xt=class extends We{constructor(e){super();A(this,Lt);T(this,"type","text");T(this,"data","");Object.defineProperties(this,{childNodes:{enumerable:!1,configurable:!1},type:{enumerable:!1,writable:!1},data:{value:e}})}toString(){return this.data}text(){return this.data}lint(e=this.getAbsoluteIndex(),t){var R,q,J;let{data:r,parentNode:n,nextSibling:i,previousSibling:a}=this;if(!n)return[];let{type:o,name:g,parentNode:p}=n,l=!1;if(o==="attr-value"){let{type:M,name:ae,tag:ke}=p;if(M!=="ext-attr")l=!0;else if(ke==="choose"&&(ae==="before"||ae==="after"))return[]}if(t!=null||(t=o==="free-ext-link"||o==="ext-link-url"||o==="image-parameter"&&g==="link"||l?hs:cs),r.search(t)===-1)return[];t.lastIndex=0;let c=[],u=i==null?void 0:i.type,f=i==null?void 0:i.name,x=a==null?void 0:a.type,k=this.getRootNode(),{ext:L,html:S}=k.getAttribute("config"),{top:v,left:I}=k.posFromIndex(e),P=new Set(["onlyinclude","noinclude","includeonly",L,S,xs].flat(2));for(let M=t.exec(r);M;M=t.exec(r)){let[,ae,ke]=M,{0:te,index:W}=M;if(ke&&ke!=="]"){let{length:ee}=ke;W+=ee,te=te.slice(ee)}let{0:F,length:le}=te;if(F==="<"&&!P.has(ae.toLowerCase())||F==="["&&o==="ext-link-text"&&(/&(?:rbrack|#93|#x5[Dd];);/u.test(r.slice(W+1))||u==="ext"&&f==="nowiki"&&((R=i.innerText)!=null&&R.includes("]"))))continue;F==="]"&&(W||le>1)&&t.lastIndex--;let ge=e+W,ye=ge+le,K=String(k),pe=K[ye],ze=K[ge-1],kr=le>1&&!(F==="<"&&!/[\s/>]/u.test(pe!=null?pe:"")||l&&(F==="["||F==="]"))||F==="{"&&(pe===F||ze==="-")||F==="}"&&(ze===F||pe==="-")||F==="["&&(pe===F||o==="ext-link-text"||u==="free-ext-link"&&!r.slice(W+1).trim())||F==="]"&&(ze===F||x==="free-ext-link"&&!r.slice(0,W).includes("]"))?"error":"warning",yr=F==="{"||F==="[";if(kr==="warning"&&(yr||(F==="]"||F==="}"))){let ee=ms[F],Ar=yr?r.slice(W+1):r.slice(0,W);if(F==="{"&&((q=ee.exec(Ar))==null?void 0:q[0])==="}"||F==="}"&&((J=ee.exec(Ar))==null?void 0:J[0])==="{")continue;if(!Ar.includes(F)){let hn=yr?"nextSibling":"previousSibling",Fe=this[hn];for(;Fe&&(Fe.type!=="text"||!ee.test(Fe.data));)Fe=Fe[hn];if(Fe&&ee.exec(Fe.data)[0]!==F)continue}}let Ct=r.slice(0,W).split(`
`),pn=Ct.length+v-1,un=Ct[Ct.length-1],cn=Ct.length===1?I+un.length:un.length,gt={rule:fs[F],message:m.msg('lonely "$1"',F==="h"?te:F),severity:kr,startIndex:ge,endIndex:ye,startLine:pn,endLine:pn,startCol:cn,endCol:cn+le};if(F==="<")gt.suggestions=[{desc:"escape",range:[ge,ge+1],text:"&lt;"}];else if(F==="h"&&!(o==="ext-link-text"||o==="link-text")&&/[\p{L}\d_]/u.test(ze||""))gt.suggestions=[{desc:"whitespace",range:[ge,ge],text:" "}];else if(F==="["&&o==="ext-link-text"){let ee=n.getAbsoluteIndex()+String(n).length;gt.suggestions=[{desc:"escape",range:[ee,ee+1],text:"&#93;"}]}else if(F==="]"&&x==="free-ext-link"&&kr==="error"){let ee=e-String(a).length;gt.fix={range:[ee,ee],text:"["}}c.push(gt)}return c}replaceData(e){E(this,Lt,In).call(this,e)}print(){return Et(this.data)}};Lt=new WeakSet,In=function(e){this.setAttribute("data",e)}});var Rt,Fn=y(()=>{"use strict";G();Rt=class extends b{constructor(){super(...arguments);T(this,"type","onlyinclude")}toString(){return`<onlyinclude>${super.toString()}</onlyinclude>`}getAttribute(e){return e==="padding"?13:e==="plain"||super.getAttribute(e)}print(){return super.print({pre:'<span class="wpb-ext">&lt;onlyinclude&gt;</span>',post:'<span class="wpb-ext">&lt;/onlyinclude&gt;</span>'})}}});var he,Ue=y(()=>{"use strict";he=d=>{class s extends d{text(){return""}lint(){return[]}}return s}});var Q,Se=y(()=>{"use strict";w();G();Q=class extends b{get innerText(){return this.firstChild.data}constructor(s="",e=m.getConfig(),t=[]){super(s,e,t)}}});var V,Pe=y(()=>{"use strict";Ue();Se();V=class extends he(Q){constructor(){super(...arguments);T(this,"type","noinclude")}}});var Ce,He,Er=y(()=>{"use strict";w();G();He=class extends b{constructor(e,t,r,n,i=m.getConfig(),a=[]){super(void 0,i);A(this,Ce,void 0);T(this,"closed");T(this,"selfClosing");this.setAttribute("name",e.toLowerCase()),$(this,Ce,[e,n||e]),this.closed=n!=="",this.selfClosing=n===void 0,this.append(t,r);let o=typeof t=="string"?-1:a.indexOf(t);a.splice(o===-1?1/0:o,0,this)}get innerText(){return this.selfClosing?void 0:this.lastChild.text()}toString(){let{selfClosing:e,firstChild:t,lastChild:r}=this,[n,i]=h(this,Ce);return e?`<${n}${String(t)}/>`:`<${n}${String(t)}>${String(r)}${this.closed?`</${i}>`:""}`}text(){let[e,t]=h(this,Ce);return this.selfClosing?`<${e}${this.firstChild.text()}/>`:`<${e}${super.text(">")}${this.closed?`</${t}>`:""}`}getAttribute(e){return e==="padding"?h(this,Ce)[0].length+1:super.getAttribute(e)}getGaps(){return 1}print(){let[e,t]=h(this,Ce);return super.print(this.selfClosing?{pre:`&lt;${e}`,post:"/&gt;"}:{pre:`&lt;${e}`,sep:"&gt;",post:this.closed?`&lt;/${t}&gt;`:""})}};Ce=new WeakMap});var Pt,Ln=y(()=>{"use strict";j();Ue();w();Er();Pt=class extends he(He){constructor(e,t="",r,n,i=m.getConfig(),a=[]){super(e,t,r!=null?r:"",r===void 0||n!=null?n:"",i,a);T(this,"type","include")}lint(e=this.getAbsoluteIndex()){if(this.closed)return[];let t=N(this,{start:e},"unclosed-comment",m.msg("unclosed $1",`<${this.name}>`));return t.suggestions=[{desc:"close",range:[t.endIndex,t.endIndex],text:`</${this.name}>`}],[t]}}});var B,xe=y(()=>{"use strict";w();G();B=class extends b{constructor(s,e,t=m.getConfig(),r=[],n){super(s,t,r,n),this.type=e}}});var Ts,D,Rn,Pn,jt,Fr,Gn,Tt,qn,Bn,On,jn,Gt,bs,ks,ys,De,Z,ne,Ve,_n=y(()=>{"use strict";j();H();ue();w();G();xe();Ts=new Set(["id","class","style","lang","dir","title","tabindex","aria-describedby","aria-flowto","aria-hidden","aria-label","aria-labelledby","aria-level","aria-owns","role","about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),D=new Set(["align"]),Rn=new Set(["cite"]),Pn=new Set(["cite","datetime"]),jt=new Set(["width"]),Fr=new Set(["axis","align","bgcolor","height","width","valign"]),Gn=new Set([...Fr,"abbr","headers","scope","rowspan","colspan"]),Tt=new Set(["type"]),qn=new Set(["summary","align","bgcolor","cellpadding","cellspacing","frame","rules","width"]),Bn=new Set(["clear"]),On=new Set(["bgcolor","align","valign"]),jn={div:D,h1:D,h2:D,h3:D,h4:D,h5:D,h6:D,blockquote:Rn,q:Rn,p:D,br:Bn,pre:jt,ins:Pn,del:Pn,ul:Tt,ol:new Set(["type","start","reversed"]),li:new Set(["type","value"]),table:new Set([...qn,"border"]),caption:D,tr:On,td:Gn,th:Gn,img:new Set(["alt","src","width","height","srcset"]),font:new Set(["size","color","face"]),hr:jt,rt:new Set(["rbspan"]),data:new Set(["value"]),time:new Set(["datetime"]),meta:new Set(["itemprop","content"]),link:new Set(["itemprop","href","title"]),gallery:new Set(["mode","showfilename","caption","perrow","widths","heights","showthumbnails","type"]),poem:new Set(["compact","align"]),categorytree:new Set(["align","hideroot","onlyroot","depth","mode","hideprefix","namespaces","showcount","notranslations"]),combooption:new Set(["name","for","inline","align"])},Gt=new Set,bs={nowiki:Gt,indicator:new Set(["name"]),langconvert:new Set(["from","to"]),ref:new Set(["group","name","extends","follow","dir"]),references:new Set(["group","responsive"]),charinsert:new Set(["label"]),choose:new Set(["uncached","before","after"]),option:new Set(["weight"]),imagemap:Gt,inputbox:Gt,templatestyles:new Set(["src","wrapper"]),dynamicpagelist:Gt,poll:new Set(["id","show-results-before-voting"]),sm2:Tt,flashmp3:Tt,score:new Set(["line_width_inches","lang","override_midi","raw","note-language","override_audio","override_ogg","sound","vorbis"]),seo:new Set(["title","title_mode","title_separator","keywords","description","robots","google_bot","image","image_width","image_height","image_alt","type","site_name","locale","section","author","published_time","twitter_site"]),tab:new Set(["nested","name","index","class","block","inline","openname","closename","collapsed","dropdown","style","bgcolor","container","id","title"]),tabs:new Set(["plain","class","container","id","title","style"]),combobox:new Set(["placeholder","value","id","class","text","dropdown","style"])},ks=new RegExp("expression|(?:accelerator|-o-link(?:-source)?|-o-replace)\\s*:|(?:url|image(?:-set)?)\\s*\\(|attr\\s*\\([^)]+[\\s,]url","u"),ys={table:qn,td:new Set([...Fr,"scope"]),th:Fr,br:Bn,caption:D,div:D,hr:jt,h1:D,h2:D,h3:D,h4:D,h5:D,h6:D,li:Tt,p:D,pre:jt,tr:On,ul:Tt},Ve=class extends b{constructor(e,t,r,n="",i,a=[],o=m.getConfig(),g=[]){let p=new B(r,"attr-key",o,g,{}),l;if(r==="title"||t==="img"&&r==="alt")l=new b(i,o,g,{}),l.type="attr-value",l.setAttribute("stage",10);else if(t==="gallery"&&r==="caption"){let c={...o,excludes:[...o.excludes,"quote","extLink","magicLink","list"]};l=new b(i,c,g,{}),l.type="attr-value",l.setAttribute("stage",5)}else if(t==="choose"&&(r==="before"||r==="after")){let c={...o,excludes:[...o.excludes,"heading","html","table","hr","list"]};l=new b(i,c,g,{}),l.type="attr-value",l.setAttribute("stage",1)}else l=new B(i,"attr-value",o,g,{});super(void 0,o,g);A(this,De,void 0);A(this,Z,void 0);A(this,ne,void 0);this.type=e,this.append(p,l),$(this,Z,n),$(this,ne,[...a]),$(this,De,t),this.setAttribute("name",re(r).trim().toLowerCase())}get tag(){return h(this,De)}get balanced(){return!h(this,Z)||h(this,ne)[0]===h(this,ne)[1]}afterBuild(){h(this,Z).includes("\0")&&$(this,Z,this.buildFromStr(h(this,Z),0)),this.parentNode&&$(this,De,this.parentNode.name),this.setAttribute("name",this.firstChild.text().trim().toLowerCase())}toString(){let[e="",t=""]=h(this,ne);return h(this,Z)?`${super.toString(`${h(this,Z)}${e}`)}${t}`:String(this.firstChild)}text(){return h(this,Z)?`${super.text(`${h(this,Z).trim()}"`)}"`:this.firstChild.text()}getGaps(){var e,t;return h(this,Z)?h(this,Z).length+((t=(e=h(this,ne)[0])==null?void 0:e.length)!=null?t:0):0}lint(e=this.getAbsoluteIndex(),t){var f,x;let r=super.lint(e,t),{balanced:n,firstChild:i,lastChild:a,type:o,name:g,tag:p}=this,l=this.getValue(),c;if(!n){let k=this.getRootNode();c={start:e,...k.posFromIndex(e)};let L=C(a,c,"unclosed-quote",m.msg("unclosed $1","quotes"),"warning");L.startIndex--,L.startCol--;let S={range:[L.endIndex,L.endIndex],text:h(this,ne)[0]};a.childNodes.some(v=>v.type==="text"&&/\s/u.test(v.text()))?L.suggestions=[{desc:"close",...S}]:L.fix=S,r.push(L)}let u=bs[p];if(u&&!u.has(g)||(o==="ext-attr"?p in jn:!/\{\{[^{]+\}\}/u.test(g))&&!((f=jn[p])!=null&&f.has(g))&&!/^(?:xmlns:[\w:.-]+|data-[^:]*)$/u.test(g)&&(p==="meta"||p==="link"||!Ts.has(g)))c!=null||(c={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(i,c,"illegal-attr","illegal attribute name"));else if((x=ys[p])!=null&&x.has(g))c!=null||(c={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(i,c,"obsolete-attr","obsolete attribute","warning"));else if(g==="style"&&typeof l=="string"&&ks.test(l))c!=null||(c={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(a,c,"insecure-style","insecure style"));else if(g==="tabindex"&&typeof l=="string"&&l.trim()!=="0"){c!=null||(c={start:e,...this.getRootNode().posFromIndex(e)});let k=C(a,c,"illegal-attr","nonzero tabindex");k.suggestions=[{desc:"remove",range:[e,k.endIndex],text:""},{desc:"0 tabindex",range:[k.startIndex,k.endIndex],text:"0"}],r.push(k)}return r}getValue(){if(h(this,Z)){let e=this.lastChild.text();return h(this,ne)[1]?e:e[h(this,ne)[0]?"trimEnd":"trim"]()}return this.type==="ext-attr"||""}print(){let[e="",t=""]=h(this,ne);return h(this,Z)?super.print({sep:`${Et(h(this,Z))}${e}`,post:t}):super.print()}};De=new WeakMap,Z=new WeakMap,ne=new WeakMap});var zn,As,$e,qt=y(()=>{"use strict";j();H();w();G();xe();_n();zn=d=>d.slice(0,-1),As=d=>`${zn(d)}-dirty`,$e=class extends b{constructor(s,e,t,r=m.getConfig(),n=[]){if(super(void 0,r,n,{}),this.type=e,this.setAttribute("name",t),s){let i=new RegExp(`([^\\s/](?:(?!\0\\d+~\x7F)[^\\s/=])*)(?:((?:\\s|\0\\d+c\x7F)*(?:=|\0\\d+~\x7F)(?:\\s|\0\\d+c\x7F)*)(?:(["'])(.*?)(\\3|$)|(\\S*)))?`,"gsu"),a="",o=i.exec(s),g=0,p=()=>{a&&(super.insertAt(new B(a,As(e),r,n,{})),a="")};for(;o;){let{index:l,0:c,1:u,2:f,3:x,4:k,5:L,6:S}=o;if(a+=s.slice(g,l),/^(?:[\w:]|\0\d+[t!~{}+-]\x7F)(?:[\w:.-]|\0\d+[t!~{}+-]\x7F)*$/u.test(re(u).trim())){let v=k!=null?k:S,I=[x,L],P=new Ve(zn(e),t,u,f,v,I,r,n);p(),super.insertAt(P)}else a+=c;({lastIndex:g}=i),o=i.exec(s)}a+=s.slice(g),p()}}afterBuild(){if(this.type==="table-attrs"){let{parentNode:s}=this;this.setAttribute("name",(s==null?void 0:s.type)==="td"&&s.subtype==="caption"?"caption":s==null?void 0:s.type)}}getAttrTokens(s){return this.childNodes.filter(e=>e instanceof Ve&&(!s||e.name===s.toLowerCase().trim()))}getAttrToken(s){let e=this.getAttrTokens(s);return e[e.length-1]}getAttr(s){var e;return(e=this.getAttrToken(s))==null?void 0:e.getValue()}lint(s=this.getAbsoluteIndex(),e){let t=super.lint(s,e),{parentNode:r,length:n,childNodes:i}=this,a=new Map,o=new Set,g;if((r==null?void 0:r.type)==="html"&&r.closing&&this.text().trim()){g={start:s,...this.getRootNode().posFromIndex(s)};let p=N(this,g,"no-ignored","attributes of a closing tag");p.fix={range:[s,p.endIndex],text:""},t.push(p)}for(let p=0;p<n;p++){let l=i[p];if(l instanceof B&&l.text().trim()){g!=null||(g={start:s,...this.getRootNode().posFromIndex(s)});let c=C(l,g,"no-ignored","containing invalid attribute");c.suggestions=[{desc:"remove",range:[c.startIndex,c.endIndex],text:" "}],t.push(c)}else if(l instanceof Ve){let{name:c}=l;a.has(c)?(o.add(c),a.get(c).push(l)):c!=="class"&&a.set(c,[l])}}if(o.size>0){g!=null||(g={start:s,...this.getRootNode().posFromIndex(s)});for(let p of o)t.push(...a.get(p).map(l=>C(l,g,"no-duplicate",m.msg("duplicated $1 attribute",p))))}return t}print(){return String(this)?`<span class="wpb-${this.type}">${this.childNodes.map(s=>s.print(s instanceof B?{class:"attr-dirty"}:void 0)).join("")}</span>`:""}}});var Mn={};U(Mn,{PreToken:()=>Lr});var Lr,Wn=y(()=>{"use strict";ue();w();G();Pe();Lr=class extends b{constructor(e,t=m.getConfig(),r=[]){if(e){let n="<nowiki>",i="</nowiki>",{length:a}=n,o=e.indexOf(n),g=e.indexOf(i,o+a),p="";for(;o!==-1&&g!==-1;)new V(n,t,r),new V(i,t,r),p+=`${e.slice(0,o)}\0${r.length-1}c\x7F${e.slice(o+a,g)}\0${r.length}c\x7F`,e=e.slice(g+a+1),o=e.indexOf(n),g=e.indexOf(i,o+a);e=`${p}${e}`}super(e,t,r,{});T(this,"type","ext-inner");this.setAttribute("stage",10)}getAttribute(e){return e==="plain"||super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){return super.lint(e,/<\s*\/\s*(pre)\b/giu)}}});var Un={};U(Un,{ParamTagToken:()=>kt});var kt,Rr=y(()=>{"use strict";j();w();G();xe();kt=class extends b{constructor(e,t=m.getConfig(),r=[],n={}){super(void 0,t,r,{});T(this,"type","ext-inner");if(e){let i=B;this.append(...e.split(`
`).map(a=>new i(a,"param-line",t,r,{})))}}toString(){return super.toString(`
`)}text(){return super.text(`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let t;return this.childNodes.filter(r=>{let{childNodes:n}=r,i=n.findIndex(({type:o})=>o!=="text"),a=(i>=0?n.slice(0,i).map(String).join(""):String(r)).trim();return a&&!(i>=0?/^[a-z]+(?:\[\])?\s*(?:=|$)/iu:/^[a-z]+(?:\[\])?\s*=/iu).test(a)}).map(r=>{t!=null||(t={start:e,...this.getRootNode().posFromIndex(e)});let n=C(r,t,"no-ignored",m.msg("invalid parameter of <$1>",this.name));return n.suggestions=[{desc:"remove",range:[n.startIndex,n.endIndex],text:""}],n})}print(){return super.print({sep:`
`})}}});var me,yt=y(()=>{"use strict";w();G();me=class extends b{constructor(s,e,t="plain",r=m.getConfig(),n=[],i){super(s,r,n,i),this.type=t}lint(){return[]}}});var At,Ze,Bt,Qe,Pr=y(()=>{"use strict";j();w();G();yt();Qe=class extends b{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);A(this,Ze);T(this,"type","heading");A(this,At,void 0);$(this,At,e);let i=new b(t[0],r,n);i.type="heading-title",i.setAttribute("stage",2);let a=new me(t[1],/^[^\S\n]*$/u,"heading-trail",r,n,{});this.append(i,a)}get level(){return h(this,At)}toString(){let e=h(this,Ze,Bt);return`${e}${String(this.firstChild)}${e}${String(this.lastChild)}`}text(){let e=h(this,Ze,Bt);return`${e}${this.firstChild.text()}${e}`}getAttribute(e){return e==="padding"?this.level:super.getAttribute(e)}getGaps(){return this.level}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{firstChild:n,level:i}=this,a=String(n),o=n.childNodes.filter(c=>c.type==="quote"),g=o.filter(({bold:c})=>c),p=o.filter(({italic:c})=>c),l;return this.level===1&&(l={start:e,...this.getRootNode().posFromIndex(e)},r.push(C(n,l,"h1","<h1>"))),(a.startsWith("=")||a.endsWith("="))&&(l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(n,l,"unbalanced-header",m.msg("unbalanced $1 in a section header",'"="')))),this.closest("html-attrs, table-attrs")&&(l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)}),r.push(N(this,l,"parsing-order","section header in a HTML tag"))),g.length%2&&(l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(g[g.length-1],{...l,start:e+i,left:l.left+i},"format-leakage",m.msg("unbalanced $1 in a section header","bold apostrophes")))),p.length%2&&(l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(p[p.length-1],{start:e+i},"format-leakage",m.msg("unbalanced $1 in a section header","italic apostrophes")))),r}print(){let e=h(this,Ze,Bt);return super.print({pre:e,sep:e})}json(){let e=super.json();return e.level=this.level,e}};At=new WeakMap,Ze=new WeakSet,Bt=function(){return"=".repeat(this.level)}});var vs,Ot,Hn=y(()=>{"use strict";H();j();w();G();vs=d=>d.text().replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),Ot=class extends b{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);T(this,"type","parameter");let i=new b(typeof e=="number"?void 0:e,r,n,{}),a=new b(t,r,n);i.type="parameter-key",a.type="parameter-value",a.setAttribute("stage",2),this.append(i,a)}get anon(){return this.firstChild.length===0}afterBuild(){if(!this.anon){let{parentNode:e,firstChild:t}=this,r=vs(t);this.setAttribute("name",r),e&&e.getArgs(r,!1,!1).add(this)}}toString(){return this.anon?String(this.lastChild):super.toString("=")}text(){return this.anon?this.lastChild.text():super.text("=")}getGaps(){return this.anon?0:1}lint(e=this.getAbsoluteIndex(),t){var a;let r=super.lint(e,t),{firstChild:n}=this,i=(a=new RegExp(`https?://${ve}${we}$`,"iu").exec(n.text()))==null?void 0:a[0];if(i&&new URL(i).search){let o=C(n,{start:e},"unescaped","unescaped query string in an anonymous parameter");o.startIndex=o.endIndex,o.startLine=o.endLine,o.startCol=o.endCol,o.endIndex++,o.endCol++,o.fix={range:[o.startIndex,o.endIndex],text:"{{=}}"},r.push(o)}return r}print(){return super.print({sep:this.anon?"":"="})}json(){let e=super.json();return e.anon=this.anon,e}}});var ws,Ge,je,zt,Dn,Mt,Vn,_t,Zn=y(()=>{"use strict";H();j();Re();ue();w();G();Hn();xe();yt();ws=new Set(["pageid","articlepath","server","servername","scriptpath","stylepath"]),_t=class extends b{constructor(e,t,r=m.getConfig(),n=[]){var c,u;super(void 0,r,n,{});A(this,zt);A(this,Mt);T(this,"type","template");T(this,"modifier","");A(this,Ge,!1);A(this,je,new Map);let{parserFunction:[i,a]}=r,o=(c=/^(?:\s|\0\d+c\x7F)*\0\d+s\x7F/u.exec(e))==null?void 0:c[0];if(o)this.setAttribute("modifier",o),e=e.slice(o.length);else if(e.includes(":")){let[f,...x]=e.split(":"),[k]=/^(?:\s|\0\d+c\x7F)*/u.exec((u=x[0])!=null?u:"");this.setModifier(`${f}:${k}`)&&(e=x.join(":").slice(k.length))}let g=e.includes(":");if(g||t.length===0&&!h(this,Ge)){let[f,...x]=e.split(":"),k=re(f),L=k[x.length>0?"trimStart":"trim"](),S=L.toLowerCase(),v=i[S],I=a.includes(L);if(I||ws.has(v)||g&&v){this.setAttribute("name",v!=null?v:S),this.type="magic-word";let R=new RegExp(`^\\s*${L}\\s*$`,I?"u":"iu"),q=new me(f,R,"magic-word-name",r,n,{});if(super.insertAt(q),x.length>0&&t.unshift([x.join(":")]),this.name==="invoke")for(let J=0;J<2;J++){let M=t.shift();if(!M)break;let ae=new B(M.join("="),`invoke-${J?"function":"module"}`,r,n);super.insertAt(ae)}}}if(this.type==="template"){let f=re(It(e)).split("#")[0].trim();if(!f||/^:[\s_]*:|\0\d+[eh!+-]\x7F|[<>[\]{}\n]|%[\da-f]{2}/iu.test(f))throw n.pop(),new SyntaxError("\u975E\u6CD5\u7684\u6A21\u677F\u540D\u79F0");let x=new B(e,"template-name",r,n,{});super.insertAt(x)}let p=this.isTemplate(),l=1;for(let f=0;f<t.length;f++){let x=t[f];!p&&!(this.name==="switch"&&f>0)&&(x[0]=x.join("="),x.length=1),x.length===1&&(x.unshift(l),l++),this.insertAt(new Ot(...x,r,n))}this.seal("modifier")}setModifier(e){let{parserFunction:[,,t,r]}=this.getAttribute("config"),n=re(e).trim();if(e&&!n.endsWith(":"))return!1;let i=n.slice(0,-1).toLowerCase(),a=t.includes(i),o=r.includes(i);return h(this,Ge)&&a||!h(this,Ge)&&(o||e==="")||(Ae.running||this.length>1)&&(a||o||e==="")?(this.setAttribute("modifier",e),$(this,Ge,a),!!e):!1}isTemplate(){return this.type==="template"||this.name==="invoke"}afterBuild(){this.modifier.includes("\0")&&this.setAttribute("modifier",this.buildFromStr(this.modifier,0))}toString(){return`{{${this.modifier}${this.type==="magic-word"?`${String(this.firstChild)}${this.length===1?"":":"}${this.childNodes.slice(1).map(String).join("|")}`:super.toString("|")}}}`}text(){let{childNodes:e,length:t,firstChild:r,modifier:n,type:i,name:a}=this;return i==="magic-word"&&a==="vardefine"?"":`{{${n}${i==="magic-word"?`${r.text()}${t===1?"":":"}${ce(e.slice(1),"|")}`:super.text("|")}}}`}getAttribute(e){switch(e){case"padding":return this.modifier.length+2;default:return super.getAttribute(e)}}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{type:n,childNodes:i,length:a}=this,o;if(!this.isTemplate())return r;let g=E(this,zt,Dn).call(this);if(g.fragment!==void 0){o={start:e,...this.getRootNode().posFromIndex(e)};let l=i[n==="template"?0:1],c=C(l,o,"no-ignored","useless fragment"),u=l.childNodes.find(f=>f.type==="text"&&f.data.includes("#"));u&&(c.fix={range:[c.startIndex+u.getRelativeIndex()+u.data.indexOf("#"),c.endIndex],text:""}),r.push(c)}if(g.valid||(o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(i[1],o,"invalid-invoke","illegal module name"))),n==="magic-word"&&a===2)return o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),r.push(N(this,o,"invalid-invoke","missing module function")),r;let p=this.getDuplicatedArgs();return p.length>0&&(o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),r.push(...p.flatMap(([,l])=>l).map(l=>C(l,o,"no-duplicate","duplicated parameter")))),r}insertAt(e,t=this.length){return super.insertAt(e,t),e.anon?E(this,Mt,Vn).call(this,e):e.name&&this.getArgs(e.name,!1,!1).add(e),e}getAllArgs(){return this.childNodes.filter(Le("parameter"))}getAnonArgs(){return this.getAllArgs().filter(({anon:e})=>e)}getArgs(e,t=!1,r=!0){let n=String(e).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),i;return h(this,je).has(n)?i=h(this,je).get(n):(i=new Set(this.getAllArgs().filter(({name:a})=>n===a)),h(this,je).set(n,i)),i}getDuplicatedArgs(){return[...h(this,je)].filter(([,{size:e}])=>e>1).map(([e,t])=>[e,[...t]])}getPossibleValues(){let{type:e,name:t,childNodes:r,constructor:{name:n}}=this;if(e==="template")throw new Error(`${n}.getPossibleValues \u65B9\u6CD5\u4EC5\u4F9B\u7279\u5B9A\u9B54\u672F\u5B57\u4F7F\u7528\uFF01`);let i;switch(t){case"if":case"ifexist":case"ifexpr":case"iferror":i=2;break;case"ifeq":i=3;break;default:throw new Error(`${n}.getPossibleValues \u65B9\u6CD5\u4EC5\u4F9B\u7279\u5B9A\u9B54\u672F\u5B57\u4F7F\u7528\uFF01`)}let a=r.slice(i,i+2).map(({childNodes:[,o]})=>o);for(let o=0;o<a.length;){let{length:g,0:p}=a[o].childNodes.filter(l=>l.text().trim());if(g===0)a.splice(o,1);else if(g>1||p.type!=="magic-word")o++;else try{let l=p.getPossibleValues();a.splice(o,1,...l),o+=l.length}catch(l){o++}}return a}print(){let{childNodes:e,length:t,firstChild:r,modifier:n,type:i}=this;return`<span class="wpb-${i}">{{${n}${i==="magic-word"?`${r.print()}${t===1?"":":"}${fe(e.slice(1),{sep:"|"})}`:fe(e,{sep:"|"})}}}</span>`}};Ge=new WeakMap,je=new WeakMap,zt=new WeakSet,Dn=function(){let e=this.type==="template",t=this.childNodes[e?0:1];return this.normalizeTitle(t.text(),e?10:828)},Mt=new WeakSet,Vn=function(e){let t=this.getAnonArgs(),r=typeof e!="number";for(let n=r?t.indexOf(e):e-1;n<t.length;n++){let i=t[n],{name:a}=i,o=String(n+1);a!==o&&(i.setAttribute("name",o),this.getArgs(o,!1,!1).add(i))}}});var Wt,Qn=y(()=>{"use strict";Ue();G();Wt=class extends he(b){constructor(){super(...arguments);T(this,"type","hidden")}}});var Ut,Xn=y(()=>{"use strict";H();j();w();G();xe();Qn();Ut=class extends b{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});T(this,"type","arg");for(let n=0;n<e.length;n++)if(n===0){let i=new B(e[n],"arg-name",t,r,{});super.insertAt(i)}else if(n>1){let i=new Wt(e[n],t,r,{});super.insertAt(i)}else{let i=new b(e[n],t,r);i.type="arg-default",i.setAttribute("stage",2),super.insertAt(i)}}get default(){var e,t;return(t=(e=this.childNodes[1])==null?void 0:e.text())!=null?t:!1}toString(){return`{{{${super.toString("|")}}}}`}text(){return`{{{${ce(this.childNodes.slice(0,2),"|")}}}}`}getAttribute(e){return e==="padding"?3:super.getAttribute(e)}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let{childNodes:[r,n,...i]}=this;if(!this.getAttribute("include")){let o=N(this,{start:e},"no-arg","unexpected template argument");return n&&(o.fix={range:[e,o.endIndex],text:n.text()}),[o]}let a=r.lint(e+3,t);if(n&&a.push(...n.lint(e+4+String(r).length,t)),i.length>0){let o={start:e,...this.getRootNode().posFromIndex(e)};a.push(...i.map(g=>{let p=C(g,o,"no-ignored","invisible content inside triple braces");return p.startIndex--,p.startCol--,p.suggestions=[{desc:"remove",range:[p.startIndex,p.endIndex],text:""},{desc:"escape",range:[p.startIndex,p.startIndex+1],text:"{{!}}"}],p}))}return a}print(){return super.print({pre:"{{{",post:"}}}",sep:"|"})}json(){let e=super.json();return e.default=this.default,e}}});var Kn={};U(Kn,{parseBraces:()=>Gr});var Gr,jr=y(()=>{"use strict";H();w();Pr();Zn();Xn();Gr=(d,s=m.getConfig(),e=[])=>{var c,u,f,x,k,L;let t=`${(c=s.excludes)!=null&&c.includes("heading")?"":"^(\0\\d+c\x7F)*={1,6}|"}\\[\\[|\\{{2,}|-\\{(?!\\{)`,{parserFunction:[,,,r]}=s,n=[],i={"=":`
`,"{":"\\}{2,}|\\|","-":"\\}-","[":"\\]\\]"},a=new Map([["!","!"],["!!","+"],["(!","{"],["!)","}"],["!-","-"],["=","~"]]),o=new RegExp(t,"gmu"),g=o.exec(d),p=d.includes("}}"),l;for(;g||l!==void 0&&l<=d.length&&((f=(u=n[n.length-1])==null?void 0:u[0])!=null&&f.startsWith("="));){if(g!=null&&g[1]){let[,{length:W}]=g;g[0]=g[0].slice(W),g.index+=W}let{0:S,index:v}=g!=null?g:{0:`
`,index:d.length},I=(x=n.pop())!=null?x:{},{0:P,index:R,parts:q,findEqual:J,pos:M}=I,ae=S==="="&&J,ke=W=>{q[q.length-1].push(W.slice(M,v))};if(S==="]]"||S==="}-")l=v+2;else if(S===`
`){l=v+1;let{pos:W,findEqual:F}=(k=n[n.length-1])!=null?k:{};if(W===void 0||F||re(d.slice(W,R))!==""){let le=/^(={1,6})(.+)\1((?:\s|\0\d+c\x7F)*)$/u.exec(d.slice(R,v));le&&(d=`${d.slice(0,R)}\0${e.length}h\x7F${d.slice(v)}`,l=R+4+String(e.length).length,new Qe(le[1].length,le.slice(2),s,e))}}else if(S==="|"||ae)l=v+1,ke(d),S==="|"&&q.push([]),I.pos=l,I.findEqual=S==="|",n.push(I);else if(S.startsWith("}}")){let W=S.slice(0,Math.min(P.length,3)),F=P.length-W.length,{length:le}=e;l=v+W.length,ke(d);let ge=!1,ye="t";if(W.length===3){let K=q.map(ze=>ze.join("=")),pe=K.length>1&&re(K[1]).trim();new Ut(K,s,e),pe&&pe.endsWith(":")&&r.includes(pe.slice(0,-1).toLowerCase())&&(ye="s")}else try{new _t(q[0][0],q.slice(1),s,e);let K=re(q[0][0]).trim();a.has(K)?ye=a.get(K):/^(?:filepath|(?:full|canonical)urle?):.|^server$/iu.test(K)?ye="m":/^#vardefine:./iu.test(K)&&(ye="c")}catch(K){if(K instanceof SyntaxError&&K.message==="\u975E\u6CD5\u7684\u6A21\u677F\u540D\u79F0")ge=!0;else throw K}ge||(d=`${d.slice(0,R+F)}\0${le}${ye}\x7F${d.slice(l)}`,l=R+F+3+String(le).length,F>1?n.push({0:P.slice(0,F),index:R,pos:R+F,parts:[[]]}):F===1&&d[R-1]==="-"&&n.push({0:"-{",index:R-1,pos:R+1,parts:[[]]}))}else l=v+S.length,S.startsWith("{")&&(g.pos=l,g.parts=[[]]),n.push(..."0"in I?[I]:[],g);p&&(p=d.slice(l).includes("}}"));let te=n[n.length-1];!p&&((L=te==null?void 0:te[0])!=null&&L.startsWith("{"))&&(n.pop(),te=n[n.length-1]),o=new RegExp(t+(te?`|${i[te[0][0]]}${te.findEqual?"|=":""}`:""),"gmu"),o.lastIndex=l,g=o.exec(d)}return d}});var Jn={};U(Jn,{InputboxToken:()=>qr});var qr,Yn=y(()=>{"use strict";jr();w();Rr();qr=class extends kt{constructor(s,e=m.getConfig(),t=[]){let r=Symbol("InputboxToken");t.push(r),s&&(s=Gr(s,e,t)),t.splice(t.indexOf(r),1),super(s,e,t,{})}}});var Xe,Br=y(()=>{"use strict";j();Ue();w();Se();Xe=class extends he(Q){constructor(e,t=!0,r=m.getConfig(),n=[]){super(e,r,n);T(this,"type","comment");T(this,"closed");this.closed=t}getAttribute(e){return e==="padding"?4:super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){if(this.closed)return[];let t=N(this,{start:e},"unclosed-comment",m.msg("unclosed $1","HTML comment"));return t.fix={range:[t.endIndex,t.endIndex],text:"-->"},[t]}toString(){return`<!--${this.innerText}${this.closed?"-->":""}`}print(){return super.print({pre:"&lt;!--",post:this.closed?"--&gt;":""})}}});var Ht={};U(Ht,{NestedToken:()=>Or});var Or,Dt=y(()=>{"use strict";j();w();G();_r();Pe();Br();Or=class extends b{constructor(e,t,r,n=m.getConfig(),i=[]){e=e==null?void 0:e.replace(t,(a,o,g,p,l)=>{let c=`\0${i.length+1}${o?"e":"c"}\x7F`;if(o)new Ke(o,g,p,l,n,i);else{let u=a.endsWith("-->");new Xe(a.slice(4,u?-3:void 0),u,n,i)}return c}).replace(/(^|\0\d+[ce]\x7F)([^\0]+)(?=$|\0\d+[ce]\x7F)/gu,(a,o,g)=>(new V(g,n,i),`${o}\0${i.length}c\x7F`));super(e,n,i,{});T(this,"type","ext-inner")}lint(e=this.getAbsoluteIndex(),t){let r;return[...super.lint(e,t),...this.childNodes.filter(n=>{if(n.type==="ext"||n.type==="comment")return!1;let i=String(n).trim();return i&&!/^<!--.*-->$/su.test(i)}).map(n=>{r!=null||(r={start:e,...this.getRootNode().posFromIndex(e)});let i=C(n,r,"no-ignored",m.msg("invalid content in <$1>",this.name));return i.suggestions=[{desc:"remove",range:[i.startIndex,i.endIndex],text:""},{desc:"comment",range:[i.startIndex,i.startIndex],text:`<!--${String(n)}-->`}],i})]}}});var qe,de,Ne,Ie,Vt=y(()=>{"use strict";j();ue();w();G();xe();Ie=class extends b{constructor(e,t,r=m.getConfig(),n=[],i="|"){super(void 0,r,n,{});A(this,qe,!0);A(this,de,void 0);A(this,Ne,void 0);if(this.insertAt(new B(e,"link-target",r,n,{})),t!==void 0){let a=new b(t,r,n,{});a.type="link-text",a.setAttribute("stage",10),this.insertAt(a)}$(this,de,i)}afterBuild(){$(this,Ne,this.getTitle()),h(this,de).includes("\0")&&$(this,de,this.buildFromStr(h(this,de),0)),this.setAttribute("name",h(this,Ne).title)}setAttribute(e,t){e==="bracket"?$(this,qe,t):e==="title"?$(this,Ne,t):super.setAttribute(e,t)}toString(){let e=super.toString(h(this,de));return h(this,qe)?`[[${e}]]`:e}text(){let e=super.text("|");return h(this,qe)?`[[${e}]]`:e}getAttribute(e){return e==="title"?h(this,Ne):e==="padding"?2:super.getAttribute(e)}getGaps(e){return e===0?h(this,de).length:1}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{childNodes:[n,i],type:a}=this,{encoded:o,fragment:g}=h(this,Ne),p;if(n.childNodes.some(({type:l})=>l==="template")&&(p={start:e,...this.getRootNode().posFromIndex(e)},r.push(C(n,p,"unknown-page","template in an internal link target","warning"))),o&&(p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(n,p,"url-encoding","unnecessary URL encoding in an internal link"))),a==="link"||a==="category"){let l=i==null?void 0:i.childNodes.find(c=>c.type==="text"&&c.data.includes("|"));if(l){p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)});let c=C(i,p,"pipe-like",'additional "|" in the link text',"warning");c.suggestions=[{desc:"escape",range:[c.startIndex+l.getRelativeIndex(),c.startIndex+l.getRelativeIndex()+l.data.length],text:l.data.replace(/\|/gu,"&#124;")}],r.push(c)}}if(a!=="link"&&g!==void 0){p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)});let l=C(n,p,"no-ignored","useless fragment"),c=n.childNodes.find(u=>u.type==="text"&&u.data.includes("#"));c&&(l.fix={range:[l.startIndex+c.getRelativeIndex()+c.data.indexOf("#"),l.endIndex],text:""}),r.push(l)}return r}getTitle(e=!1){return this.normalizeTitle(this.firstChild.text(),0,e,!0,!0)}print(){return super.print(h(this,qe)?{pre:"[[",post:"]]",sep:h(this,de)}:{sep:h(this,de)})}};qe=new WeakMap,de=new WeakMap,Ne=new WeakMap});function ei(d,s,e,t=!1,r){s=s.trim();let n=s.replace(/\0\d+t\x7F/gu,"").trim();switch(d){case"width":return!n||/^(?:\d+x?|\d*x\d+)$/u.test(n);case"link":{if(!n||new RegExp(`^(?:(?:${e.protocol}|//)${ve}|\0\\d+m\x7F)${we}$`,"iu").test(n))return s;n.startsWith("[[")&&n.endsWith("]]")&&(n=n.slice(2,-2));let a=m.normalizeTitle(n,0,!1,e,t,!0,!0);return a.valid&&a}case"lang":return(r==="svg"||r==="svgz")&&!/[^a-z\d-]/u.test(n);case"alt":case"class":case"manualthumb":return!0;case"page":return(r==="djvu"||r==="djv"||r==="pdf")&&Number(n)>0;default:return!!n&&!isNaN(n)}}var Ss,Y,Qt,ti,Zt,ri=y(()=>{"use strict";H();j();w();G();Ss=new Set(["alt","link","lang","page","caption"]);Zt=class extends b{constructor(e,t,r=m.getConfig(),n=[]){var s=(...Cl)=>(super(...Cl),A(this,Qt),T(this,"type","image-parameter"),A(this,Y,""),this);var g;let i,a=Object.entries(r.img).map(([p,l])=>[p,l,new RegExp(`^(\\s*)${p.replace("$1","(.*)")}(\\s*)$`,"u")]),o=a.find(([,p,l])=>(i=l.exec(e),i&&(i.length!==4||ei(p,i[2],r,!0,t)!==!1)));if(o&&i){i.length===3?(s(void 0,r,n),$(this,Y,e)):(s(i[2],r,n,{}),$(this,Y,`${i[1]}${o[0]}${i[3]}`)),this.setAttribute("name",o[1]);return}s(e,{...r,excludes:[...(g=r.excludes)!=null?g:[],"list"]},n),this.setAttribute("name","caption"),this.setAttribute("stage",7)}get link(){return this.name==="link"?ei("link",super.text(),this.getAttribute("config")):void 0}afterBuild(){var e;((e=this.parentNode)==null?void 0:e.type)==="gallery-image"&&!Ss.has(this.name)&&this.setAttribute("name","invalid")}toString(){return h(this,Y)?h(this,Y).replace("$1",super.toString()):super.toString()}text(){return h(this,Y)?h(this,Y).replace("$1",super.text()).trim():super.text().trim()}getAttribute(e){return e==="plain"?this.name==="caption":e==="padding"?Math.max(0,h(this,Y).indexOf("$1")):super.getAttribute(e)}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{link:n,name:i}=this;if(i==="invalid"){let a=N(this,{start:e},"invalid-gallery","invalid gallery image parameter");a.fix={range:[e,e+a.endIndex],text:""},r.push(a)}else typeof n=="object"&&n.encoded&&r.push(N(this,{start:e},"url-encoding","unnecessary URL encoding in an internal link"));return r}getValue(){return this.name==="invalid"?this.text():E(this,Qt,ti).call(this)||super.text()}print(){return h(this,Y)?`<span class="wpb-image-parameter">${h(this,Y).replace("$1",`<span class="wpb-image-caption">${fe(this.childNodes)}</span>`)}</span>`:super.print({class:"image-caption"})}};Y=new WeakMap,Qt=new WeakSet,ti=function(){return h(this,Y)&&!h(this,Y).includes("$1")}});var zr,Mr,Wr,Cs,Je,Xt,Ye,Ur=y(()=>{"use strict";H();j();w();Vt();ri();zr=new Set(["manualthumb","frameless","framed","thumbnail"]),Mr=new Set(["left","right","center","none"]),Wr=new Set(["baseline","sub","super","top","text-top","middle","bottom","text-bottom"]),Cs=(d,s,e,t)=>{if(t===void 0)return[];let r=new RegExp(`${[d,s,e].map(An).join("|")}`,"gu"),n=[],i=r.exec(t),a=0,o=0;for(;i;){let{0:g,index:p}=i;g!==e?a+=g===d?1:-1:a===0&&(n.push(t.slice(o,p)),{lastIndex:o}=r),i=r.exec(t)}return n.push(t.slice(o)),n},Ye=class extends Ie{constructor(e,t,r=m.getConfig(),n=[],i="|"){super(e,void 0,r,n,i);A(this,Je);T(this,"type","file");let{extension:a}=this.getTitle(!0);this.append(...Cs("-{","}-","|",t).map(o=>new Zt(o,a,r,n)))}get extension(){return this.getTitle().extension}lint(e=this.getAbsoluteIndex(),t){var c;let r=super.lint(e,t),n=this.getAllArgs().filter(({childNodes:u})=>{let f=u.filter(x=>x.text().trim());return f.length!==1||f[0].type!=="arg"}),i=[...new Set(n.map(({name:u})=>u))].filter(u=>u!=="invalid"),a=i.filter(u=>zr.has(u)),o=i.filter(u=>Mr.has(u)),g=i.filter(u=>Wr.has(u));if(this.closest("ext-link-text")&&((c=this.getValue("link"))==null?void 0:c.trim())!==""&&r.push(N(this,{start:e},"nested-link","internal link in an external link")),n.length===i.length&&a.length<2&&o.length<2&&g.length<2)return r;let p={start:e,...this.getRootNode().posFromIndex(e)},l=(u,f)=>x=>C(x,p,"no-duplicate",m.msg(`${u} image $1 parameter`,f));for(let u of i){let f=n.filter(({name:x})=>x===u);u==="caption"&&(f=[...f.slice(0,-1).filter(x=>x.text()),...f.slice(-1)]),f.length>1&&r.push(...f.map(l("duplicated",u)))}return a.length>1&&r.push(...n.filter(({name:u})=>zr.has(u)).map(l("conflicting","frame"))),o.length>1&&r.push(...n.filter(({name:u})=>Mr.has(u)).map(l("conflicting","horizontal-alignment"))),g.length>1&&r.push(...n.filter(({name:u})=>Wr.has(u)).map(l("conflicting","vertical-alignment"))),r}getAllArgs(){return this.childNodes.slice(1)}getArgs(e){return this.getAllArgs().filter(({name:t})=>e===t)}getFrameArgs(){return E(this,Je,Xt).call(this,zr,"\u6846\u67B6")}getHorizAlignArgs(){return E(this,Je,Xt).call(this,Mr,"\u6C34\u5E73\u5BF9\u9F50")}getVertAlignArgs(){return E(this,Je,Xt).call(this,Wr,"\u5782\u76F4\u5BF9\u9F50")}getArg(e){let t=this.getArgs(e);return t[t.length-1]}getValue(e){var t;return(t=this.getArg(e))==null?void 0:t.getValue()}};Je=new WeakSet,Xt=function(e,t){return this.getAllArgs().filter(({name:n})=>e.has(n))}});var Kt,ni,et,Hr=y(()=>{"use strict";j();ue();w();G();Ur();et=class extends Ye{constructor(e,t,r,n=m.getConfig(),i=[]){let a;if(r!==void 0){a=new b(r,n,i),a.type="plain";for(let o=1;o<11;o++)a.parseOnce();i.splice(i.indexOf(a),1)}super(t,a==null?void 0:a.toString(),n,i);A(this,Kt);this.setAttribute("bracket",!1),this.type=`${e}-image`}getTitle(){let e=this.type==="imagemap-image";return this.normalizeTitle(String(this.firstChild),e?0:6,!0,!e)}getAttribute(e){return e==="padding"?0:super.getAttribute(e)}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{ns:n,interwiki:i}=this.getAttribute("title");return(i||n!==6)&&r.push(N(this,{start:e},"invalid-gallery","invalid gallery image")),r}afterBuild(){E(this,Kt,ni).call(this,this.getTitle())}};Kt=new WeakSet,ni=function(e){this.setAttribute("title",e)}});var si={};U(si,{GalleryToken:()=>Dr});var Jt,ii,Dr,oi=y(()=>{"use strict";w();G();Hr();Pe();Dr=class extends b{constructor(e,t=m.getConfig(),r=[]){var n;super(void 0,t,r,{});A(this,Jt);T(this,"type","ext-inner");for(let i of(n=e==null?void 0:e.split(`
`))!=null?n:[]){let a=/^([^|]+)(?:\|(.*))?/u.exec(i);if(!a){super.insertAt(i.trim()?new V(i,t):i);continue}let[,o,g]=a;E(this,Jt,ii).call(this,o)?super.insertAt(new et("gallery",o,g,t,r)):super.insertAt(new V(i,t))}}toString(){return super.toString(`
`)}text(){return super.text(`
`).replace(/\n\s*\n/gu,`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let{top:r,left:n}=this.getRootNode().posFromIndex(e),i=[];for(let a=0;a<this.length;a++){let o=this.childNodes[a],g=String(o),{length:p}=g,l=g.trim(),c=r+a,u=a?0:n;o.type==="noinclude"&&l&&!/^<!--.*-->$/u.test(l)?i.push({rule:"no-ignored",message:m.msg("invalid content in <$1>","gallery"),severity:l.startsWith("|")?"warning":"error",startIndex:e,endIndex:e+p,startLine:c,endLine:c,startCol:u,endCol:u+p,suggestions:[{desc:"remove",range:[e,e+p],text:""},{desc:"comment",range:[e,e+p],text:`<!--${g}-->`}]}):o.type!=="noinclude"&&o.type!=="text"&&i.push(...o.lint(e,t)),e+=p+1}return i}print(){return super.print({sep:`
`})}};Jt=new WeakSet,ii=function(e){return this.normalizeTitle(e,6,!0,!0).valid}});var tt,Vr=y(()=>{"use strict";j();Vt();tt=class extends Ie{constructor(){super(...arguments);T(this,"type","link")}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);return this.closest("ext-link-text")&&r.push(N(this,{start:e},"nested-link","internal link in an external link")),r}}});var rt,Zr=y(()=>{"use strict";j();w();G();rt=class extends b{constructor(s,e=!1,t=m.getConfig(),r=[]){super(s,t,r,{}),this.type=e?"ext-link-url":"free-ext-link"}lint(s=this.getAbsoluteIndex(),e){let t=super.lint(s,e),r=`[\uFF0C\uFF1B\u3002\uFF1A\uFF01\uFF1F\uFF08\uFF09]+${this.type==="ext-link-url"?"|\\|+":""}`,n=new RegExp(r,"u"),i=new RegExp(r,"gu"),a;for(let o of this.childNodes){let{type:g,data:p}=o;if(g!=="text"||!n.test(p))continue;a!=null||(a={start:s,...this.getRootNode().posFromIndex(s)});let l=C(o,a,"unterminated-url","","warning");i.lastIndex=0;for(let c=i.exec(p);c;c=i.exec(p)){let{index:u,0:f}=c,x=p.slice(0,u).split(`
`),k=x.length,L=x[k-1].length,S=l.startIndex+u,v=l.startLine+k-1,I=k===1?l.startCol+L:L,P=f.startsWith("|"),R={...l,message:m.msg("$1 in URL",P?'"|"':"full-width punctuation"),startIndex:S,endIndex:S+f.length,startLine:v,endLine:v,startCol:I,endCol:I+f.length};P?f.length===1&&(R.suggestions=[{desc:"whitespace",range:[S,S+1],text:" "}]):R.suggestions=[{desc:"whitespace",range:[S,S],text:" "},{desc:"escape",range:[S,R.endIndex],text:encodeURI(f)}],t.push(R)}}return t}}});var Te,nt,Qr=y(()=>{"use strict";ue();j();w();G();Zr();nt=class extends b{constructor(e,t="",r="",n=m.getConfig(),i=[]){super(void 0,n,i,{});T(this,"type","ext-link");A(this,Te,void 0);if(this.insertAt(new rt(e,!0,n,i)),$(this,Te,t),r){let a=new b(r,n,i,{});a.type="ext-link-text",a.setAttribute("stage",10),this.insertAt(a)}}toString(){return this.length===1?`[${super.toString()}${h(this,Te)}]`:`[${super.toString(h(this,Te))}]`}text(){return`[${super.text(" ")}]`}getAttribute(e){return e==="padding"?1:super.getAttribute(e)}getGaps(){return h(this,Te).length}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);return this.length===1&&this.closest("heading-title")&&r.push(N(this,{start:e},"var-anchor","variable anchor in a section header")),r}print(){return super.print(this.length===1?{pre:"[",post:`${h(this,Te)}]`}:{pre:"[",sep:h(this,Te),post:"]"})}};Te=new WeakMap});var vt,ai=y(()=>{"use strict";w();G();Pe();Vr();Qr();vt=class extends b{constructor(e,t,r,n=m.getConfig(),i=[]){super(void 0,n,i);T(this,"type","imagemap-link");this.append(e,t.length===2?new tt(...t,n,i):new nt(...t,n,i),new V(r,n,i))}}});var li={};U(li,{ImagemapToken:()=>Xr});var Xr,di=y(()=>{"use strict";j();Re();w();G();Pe();Hr();ai();Xr=class extends b{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});T(this,"type","ext-inner");if(!e)return;let n=e.split(`
`),i=new Set(t.protocol.split("|")),a=V,o=!0,g=!1;for(let p of n){let l=p.trim();if(!(g||!l||l.startsWith("#"))){if(o){let[c,...u]=p.split("|"),f=this.normalizeTitle(c,0,!0);if(f.valid&&!f.interwiki&&f.ns===6){let x=new et("imagemap",c,u.length>0?u.join("|"):void 0,t,r);super.insertAt(x),o=!1;continue}else g=!0}else if(p.trim().split(/[\t ]/u)[0]==="desc"){super.insertAt(p);continue}else if(p.includes("[")){let c=p.indexOf("["),u=p.slice(c),f=/^\[{2}([^|]+)(?:\|([^\]]+))?\]{2}[\w\s]*$/u.exec(u);if(f){if(this.normalizeTitle(f[1],0,!0,!1,!0).valid){super.insertAt(new vt(p.slice(0,c),f.slice(1),u.slice(u.indexOf("]]")+2),t,r));continue}}else if(i.has(u.slice(1,u.indexOf(":")+1))||i.has(u.slice(1,u.indexOf("//")+2))){let x=/^\[([^\]\s]+)(?:(\s+(?=\S))([^\]]*))?\][\w\s]*$/u.exec(u);if(x){super.insertAt(new vt(p.slice(0,c),x.slice(1),u.slice(u.indexOf("]")+1),t,r));continue}}}}super.insertAt(new a(p,t,r))}}get image(){return this.childNodes.find(Le("imagemap-image"))}toString(){return super.toString(`
`)}text(){return super.text(`
`).replace(/\n{2,}/gu,`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),n={start:e,...this.getRootNode().posFromIndex(e)};return this.image?r.push(...this.childNodes.filter(i=>{let a=String(i).trim();return i.type==="noinclude"&&a&&!a.startsWith("#")}).map(i=>C(i,n,"invalid-imagemap","invalid link in <imagemap>"))):r.push(N(this,n,"invalid-imagemap","<imagemap> without an image")),r}print(){return super.print({sep:`
`})}}});var gi={};U(gi,{NowikiToken:()=>Kr});var Kr,pi=y(()=>{"use strict";j();w();Se();Kr=class extends Q{constructor(){super(...arguments);T(this,"type","ext-inner")}lint(e=this.getAbsoluteIndex()){let{name:t,firstChild:{data:r}}=this;if((t==="templatestyles"||t==="section")&&r){let n=N(this,{start:e},"void-ext",m.msg("nothing should be in <$1>",t));return n.fix={range:[e-1,n.endIndex+t.length+3],text:"/>"},[n]}return super.lint(e,new RegExp(`<\\s*(?:\\/\\s*)${t==="nowiki"?"":"?"}(${t})\\b`,"giu"))}}});var ui,Ke,_r=y(()=>{"use strict";j();w();G();Er();qt();ui=(d,s)=>{let e=new Set(d);return e.delete(s),[...e]},Ke=class extends He{constructor(e,t,r,n,i=m.getConfig(),a=[]){var c;let o=e.toLowerCase(),g=new $e(!t||t.trimStart()!==t?t:` ${t}`,"ext-attrs",o,i,a),p={...i,ext:ui(i.ext,o),excludes:[...(c=i.excludes)!=null?c:[]]},l;switch(p.inExt=!0,o){case"tab":p.ext=ui(p.ext,"tabs");case"indicator":case"poem":case"ref":case"option":case"combooption":case"tabs":case"poll":case"seo":o==="poem"&&p.excludes.push("heading"),l=new b(r,p,a);break;case"pre":{let{PreToken:u}=(Wn(),_(Mn));l=new u(r,p,a);break}case"dynamicpagelist":{let{ParamTagToken:u}=(Rr(),_(Un));l=new u(r,p,a);break}case"inputbox":{p.excludes.push("heading");let{InputboxToken:u}=(Yn(),_(Jn));l=new u(r,p,a);break}case"references":{let{NestedToken:u}=(Dt(),_(Ht));l=new u(r,/<!--.*?(?:-->|$)|<(ref)(\s[^>]*)?>(.*?)<\/(ref\s*)>/gisu,["ref"],p,a);break}case"choose":{let{NestedToken:u}=(Dt(),_(Ht));l=new u(r,/<(option|choicetemplate)(\s[^>]*)?>(.*?)<\/(\1)>/gsu,["option","choicetemplate"],p,a);break}case"combobox":{let{NestedToken:u}=(Dt(),_(Ht));l=new u(r,/<(combooption)(\s[^>]*)?>(.*?)<\/(combooption\s*)>/gisu,["combooption"],p,a);break}case"gallery":{let{GalleryToken:u}=(oi(),_(si));l=new u(r,p,a);break}case"imagemap":{let{ImagemapToken:u}=(di(),_(li));l=new u(r,p,a);break}default:{let{NowikiToken:u}=(pi(),_(gi));l=new u(r,p)}}l.setAttribute("name",o),l.type="ext-inner";super(e,g,l,n,i,a);T(this,"type","ext");this.seal("closed",!0)}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),n;return this.name!=="nowiki"&&this.closest("html-attrs, table-attrs")&&(n={start:e,...this.getRootNode().posFromIndex(e)},r.push(N(this,n,"parsing-order","extension tag in HTML tag attributes"))),this.name==="ref"&&this.closest("heading-title")&&(n!=null||(n={start:e,...this.getRootNode().posFromIndex(e)}),r.push(N(this,n,"var-anchor","variable anchor in a section header"))),r}}});var ci={};U(ci,{parseCommentAndExt:()=>$s});var $s,hi=y(()=>{"use strict";w();Fn();Pe();Ln();_r();Br();$s=(d,s=m.getConfig(),e=[],t=!1)=>{let r="<onlyinclude>",n="</onlyinclude>",{length:i}=r,a=()=>{let c=d.indexOf(r);return{i:c,j:d.indexOf(n,c+i)}};if(t){let{i:c,j:u}=a();if(c!==-1&&u!==-1){let f="",x=k=>{new V(k,s,e),f+=`\0${e.length-1}c\x7F`};for(;c!==-1&&u!==-1;){let k=`\0${e.length}e\x7F`;new Rt(d.slice(c+i,u),s,e),c>0&&x(d.slice(0,c)),f+=k,d=d.slice(u+i+1),{i:c,j:u}=a()}return d&&x(d),f}}let o=s.ext.join("|"),g=t?"includeonly":"(?:no|only)include",p=t?"noinclude":"includeonly",l=new RegExp(`<!--.*?(?:-->|$)|<${g}(?:\\s[^>]*)?>|</${g}\\s*>|<(${o})(\\s[^>]*?)?(?:/>|>(.*?)</(\\1\\s*)>)|<(${p})(\\s[^>]*?)?(?:/>|>(.*?)(?:</(${p}\\s*)>|$))`,"gisu");return d.replace(l,(c,u,f,x,k,L,S,v,I)=>{let P=`\0${e.length}${u?"e":"c"}\x7F`;if(u)new Ke(u,f,x,k,s,e);else if(c.startsWith("<!--")){let R=c.endsWith("-->");new Xe(c.slice(4,R?-3:void 0),R,s,e)}else L?new Pt(L,S,v,I,s,e):new V(c,s,e);return P})}});var Ns,Is,Es,it,ie,Ee,Yt,mi=y(()=>{"use strict";j();H();w();G();Ns=new Set(["if","ifeq","ifexpr","ifexist","iferror","switch"]),Is=new Set(["b","big","center","cite","code","del","dfn","em","font","i","ins","kbd","mark","pre","q","s","samp","small","strike","strong","sub","sup","tt","u","var"]),Es=new Set(["strike","big","center","font","tt"]),Yt=class extends b{constructor(e,t,r,n,i=m.getConfig(),a=[]){super(void 0,i,a);T(this,"type","html");A(this,it,void 0);A(this,ie,void 0);A(this,Ee,void 0);this.insertAt(t),this.setAttribute("name",e.toLowerCase()),$(this,it,r),$(this,ie,n),$(this,Ee,e)}get selfClosing(){return h(this,ie)}get closing(){return h(this,it)}toString(){return`<${this.closing?"/":""}${h(this,Ee)}${super.toString()}${h(this,ie)?"/":""}>`}text(){let{closing:e}=this,t=`${h(this,Ee)}${e?"":super.text()}`;return`<${e?"/":""}${t}${h(this,ie)?"/":""}>`}getAttribute(e){return e==="padding"?h(this,Ee).length+(this.closing?2:1):super.getAttribute(e)}lint(e=this.getAbsoluteIndex(),t){var i;let r=super.lint(e,t),n;this.name==="h1"&&!this.closing&&(n=N(this,{start:e},"h1","<h1>"),r.push(n)),this.closest("table-attrs")&&(n!=null||(n=N(this,{start:e},"h1","")),r.push({...n,rule:"parsing-order",message:m.msg("HTML tag in table attributes")}));try{this.findMatchingTag()}catch(a){if(a instanceof SyntaxError){let{message:o}=a;n!=null||(n=N(this,{start:e},"h1",""));let[g]=o.split(":"),p={...n,rule:"unmatched-tag",message:m.msg(g)};if(g==="unclosed tag"&&!this.closest("heading-title"))if(Is.has(this.name)){let l=(i=this.parentNode)==null?void 0:i.childNodes,c=l==null?void 0:l.indexOf(this);l!=null&&l.slice(0,c).some(({type:u,name:f})=>u==="html"&&f===this.name)||(p.severity="warning")}else p.severity="warning";else if(g==="unmatched closing tag"){let l=this.closest("magic-word");l&&Ns.has(l.name)?p.severity="warning":p.suggestions=[{desc:"remove",range:[e,p.endIndex],text:""}]}else if(g==="tag that is both closing and self-closing"){let{html:[,,l]}=this.getAttribute("config");l.includes(this.name)&&(p.fix={range:[e+1,e+2],text:""})}r.push(p)}}return Es.has(this.name)&&(n!=null||(n=N(this,{start:e},"h1","")),r.push({...n,rule:"obsolete-tag",message:m.msg("obsolete HTML tag"),severity:"warning"})),(this.name==="b"||this.name==="strong")&&this.closest("heading-title")&&(n!=null||(n=N(this,{start:e},"h1","")),r.push({...n,rule:"bold-header",message:m.msg("bold in section header"),severity:"warning"})),r}findMatchingTag(){let{html:[e,t,r]}=this.getAttribute("config"),{name:n,parentNode:i,closing:a}=this,o=vn(String(this));if(a&&(h(this,ie)||r.includes(n)))throw new SyntaxError(`tag that is both closing and self-closing: ${o}`);if(r.includes(n)||h(this,ie)&&t.includes(n))return this;if(h(this,ie)&&e.includes(n))throw new SyntaxError(`invalid self-closing tag: ${o}`);if(!i)return;let{childNodes:g}=i,p=g.indexOf(this),l=(a?g.slice(0,p).reverse():g.slice(p+1)).filter(u=>u.type==="html"&&u.name===n),c=a?-1:1;for(let u of l)if(h(u,it)?c--:c++,c===0)return u;throw new SyntaxError(`${a?"unmatched closing":"unclosed"} tag: ${o}`)}print(){return super.print({pre:`&lt;${this.closing?"/":""}${h(this,Ee)}`,post:`${h(this,ie)?"/":""}&gt;`})}json(){let e=super.json();return Object.assign(e,{closing:this.closing,selfClosing:h(this,ie)}),e}};it=new WeakMap,ie=new WeakMap,Ee=new WeakMap});var fi={};U(fi,{parseHtml:()=>Fs});var Fs,xi=y(()=>{"use strict";w();qt();mi();Fs=(d,s=m.getConfig(),e=[])=>{let t=/^(\/?)([a-z][^\s/>]*)((?:\s|\/(?!>))[^>]*?)?(\/?>)([^<]*)$/iu,r=new Set(s.html.flat()),n=d.split("<"),i=n.shift();for(let a of n){let o=t.exec(a),g=o==null?void 0:o[2],p=g==null?void 0:g.toLowerCase();if(!o||!r.has(p)){i+=`<${a}`;continue}let[,l,,c="",u,f]=o,x=new $e(c,"html-attrs",p,s,e),k=x.getAttr("itemprop");if(p==="meta"&&(k===void 0||x.getAttr("content")===void 0)||p==="link"&&(k===void 0||x.getAttr("href")===void 0)){i+=`<${a}`,e.length=e.indexOf(x);continue}i+=`\0${e.length}x\x7F${f}`,new Yt(g,x,l==="/",u==="/>",s,e)}return i}});var Ti,ki=y(()=>{"use strict";Ti=(d=0)=>(s,e)=>{var r,bi;class t extends s{constructor(){super(...arguments);A(this,r)}getAttr(o){return h(this,r,bi).getAttr(o)}}return r=new WeakSet,bi=function(){return this.childNodes[d]},Object.defineProperty(t,"name",{value:s.name}),t}});var st,Jr=y(()=>{"use strict";ki();w();G();yt();qt();st=class extends Ti(1)(b){constructor(s,e,t,r=m.getConfig(),n=[],i={}){super(void 0,r,n,i),this.append(new me(e,s,"table-syntax",r,n,{}),new $e(t,"table-attrs",this.type,r,n))}}});var se,wt,Yr,Be,en=y(()=>{"use strict";j();ue();w();G();Jr();Be=class extends st{constructor(e,t,r=m.getConfig(),n=[]){var g;let i=/\||\0\d+!\x7F/u.exec(t!=null?t:""),a=i?t.slice(0,i.index):"";/\[\[|-\{/u.test(a)&&(i=null,a="");super(/^(?:\n[^\S\n]*(?:[|!]|\|\+|\{\{\s*!\s*\}\}\+?)|(?:\||\{\{\s*!\s*\}\}){2}|!!|\{\{\s*!!\s*\}\})$/u,e,a,r,n);A(this,wt);T(this,"type","td");A(this,se,"");i&&([Nt(this,se)._]=i);let o=new b(t==null?void 0:t.slice(((g=i==null?void 0:i.index)!=null?g:NaN)+h(this,se).length),r,n);o.type="td-inner",o.setAttribute("stage",4),this.insertAt(o)}get rowspan(){return this.getAttr("rowspan")}get colspan(){return this.getAttr("colspan")}get subtype(){return E(this,wt,Yr).call(this).subtype}afterBuild(){h(this,se).includes("\0")&&$(this,se,this.buildFromStr(h(this,se),0))}toString(){let{childNodes:[e,t,r]}=this;return`${String(e)}${String(t)}${h(this,se)}${String(r)}`}text(){let{childNodes:[e,t,r]}=this;return`${e.text()}${t.text()}${h(this,se)}${r.text()}`}getGaps(e){return e===1?h(this,se).length:0}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);e+=this.getRelativeIndex(this.length-1);for(let n of this.lastChild.childNodes)if(n.type==="text"){let{data:i}=n;if(i.includes("|")){let a=i.includes("||"),o=C(n,{start:e},"pipe-like",'additional "|" in a table cell',a?"error":"warning");if(a){let g={caption:"|+",td:"|",th:"!"}[this.subtype];o.fix={range:[o.startIndex,o.endIndex],text:i.replace(/\|\|/gu,`
${g}`)}}else o.suggestions=[{desc:"escape",range:[o.startIndex,o.endIndex],text:i.replace(/\|/gu,"&#124;")}];r.push(o)}}return r}isIndependent(){return this.firstChild.text().startsWith(`
`)}getAttr(e){let t=super.getAttr(e);return e==="rowspan"||e==="colspan"?parseInt(t)||1:t}print(){let{childNodes:[e,t,r]}=this;return`<span class="wpb-td">${e.print()}${t.print()}${h(this,se)}${r.print()}</span>`}json(){let e=super.json();return e.subtype=this.subtype,e}};se=new WeakMap,wt=new WeakSet,Yr=function(){var a;let e=this.firstChild.text(),t=e.slice(-1),r="td";if(t==="!"?r="th":t==="+"&&(r="caption"),this.isIndependent())return{subtype:r};let{previousSibling:n}=this;return E(a=n,wt,Yr).call(a)}});var ot,tn=y(()=>{"use strict";j();Re();Jr();en();ot=class extends st{lint(s=this.getAbsoluteIndex(),e){let t=super.lint(s,e),r=this.childNodes.find(({type:p})=>p==="table-inter");if(!r)return t;let n=r.childNodes.find(p=>p.text().trim()),i=/^\s*(?:!|\{\{\s*![!-]?\s*\}\})/u,a=Le("arg"),o=Le("magic-word");if(!n||i.test(String(n))||a(n)&&i.test(n.default||""))return t;if(o(n))try{if(n.getPossibleValues().every(p=>i.test(p.text())))return t}catch(p){}let g=C(r,{start:s},"fostered-content","content to be moved out from the table");return g.severity=n.type==="template"?"warning":"error",g.startIndex++,g.startLine++,g.startCol=0,t.push(g),t}getRowCount(){return Number(this.childNodes.some(s=>s instanceof Be&&s.isIndependent()&&!s.firstChild.text().endsWith("+")))}getNthCol(s,e=!1){let t=0;for(let r of this.childNodes.slice(2))if(r instanceof Be&&(r.isIndependent()&&(t=+(r.subtype!=="caption")),s-=t,s<0))return r}}});var Ls,Rs,rn,er,yi=y(()=>{"use strict";j();Re();w();tn();yt();Ls=/^\n[^\S\n]*(?:\|\}|\{\{\s*!\s*\}\}\}|\{\{\s*!\)\s*\}\})$/u,Rs=({type:d})=>d==="tr"||d==="table-syntax",rn=class extends Array{},er=class extends ot{constructor(e,t,r=m.getConfig(),n=[]){super(/^(?:\{\||\{\{\{\s*!\s*\}\}|\{\{\s*\(!\s*\}\})$/u,e,t,r,n,{});T(this,"type","table")}get closed(){return this.lastChild.type==="table-syntax"}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);this.closed||r.push(C(this.firstChild,{start:e},"unclosed-table",m.msg("unclosed $1","table")));let n=this.getLayout(),{length:i}=n;if(i>1){let a=1,o=1/0,g=0;for(;g<i;g++){let p=n[g],l=p.length;if(l<a)break;l<o&&(o=l);let{colspan:c}=this.getNthCell(p[p.length-1]),u=l-c+1;if(u>o)break;u>a&&(a=u)}if(g<i){let p=C(this.getNthRow(g),{start:e},"table-layout","inconsistent table layout","warning");p.startIndex++,p.startLine++,p.startCol=0,r.push(p)}}return r}close(e=`
|}`,t=!1){let r=this.getAttribute("config"),n=this.getAttribute("accum"),i=t?[e]:m.parse(e,this.getAttribute("include"),2,r).childNodes,a=Ae.run(()=>super.insertAt(new me(void 0,Ls,"table-syntax",r,n,{})));t||a.afterBuild(),this.lastChild.replaceChildren(...i)}getLayout(e){let t=this.getAllRows(),{length:r}=t,n=new rn(...xn(r,()=>[]));for(let i=0;i<r;i++){let a=n[i],o=0,g=0,p;for(let l of t[i].childNodes.slice(2))if(l.type==="td"){if(l.isIndependent()&&(p=l.subtype!=="caption"),p){let c={row:i,column:o},{rowspan:u,colspan:f}=l;for(o++;a[g];)g++;for(let x=i;x<Math.min(i+u,r);x++)for(let k=g;k<g+f;k++)n[x][k]=c;g+=f}}else if(Rs(l))break}return n}getAllRows(){return[...super.getRowCount()?[this]:[],...this.childNodes.slice(1).filter(e=>e.type==="tr"&&e.getRowCount()>0)]}getNthCell(e){var r;let t=e.row===void 0?void 0:e;return t&&((r=this.getNthRow(t.row,!1,!1))==null?void 0:r.getNthCol(t.column))}getNthRow(e,t=!1,r=!1){let n=super.getRowCount();if(e===0&&n)return this;n&&e--;for(let i of this.childNodes.slice(2))if(i.type==="tr"&&i.getRowCount()&&(e--,e<0))return i}json(){let e=super.json();return e.closed=this.closed,e}}});var tr,Ai=y(()=>{"use strict";w();tn();tr=class extends ot{constructor(e,t,r=m.getConfig(),n=[]){super(/^\n[^\S\n]*(?:\|-+|\{\{\s*!\s*\}\}-+|\{\{\s*!-\s*\}\}-*)$/u,e,t,r,n,{});T(this,"type","tr")}}});var at,nn=y(()=>{"use strict";Se();at=class extends Q{}});var lt,sn=y(()=>{"use strict";nn();lt=class extends at{constructor(){super(...arguments);T(this,"type","dd")}}});var vi={};U(vi,{parseTable:()=>Gs});var Ps,Gs,wi=y(()=>{"use strict";w();G();yi();Ai();en();sn();Ps=d=>d.lastChild.constructor!==b,Gs=({firstChild:{data:d},type:s,name:e},t=m.getConfig(),r=[])=>{let n=[],i=d.split(`
`),a=s==="root"||s==="parameter-value"||s==="ext-inner"&&e==="poem"?"":`
${i.shift()}`,o,g=(l,c)=>{if(!c){a+=l;return}let{lastChild:u}=c;if(Ps(c)){let f=new b(l,t,r);f.type="table-inter",f.setAttribute("stage",3),c.insertAt(f)}else u.setText(String(u)+l)},p=()=>o.type==="td"?n.pop():o;for(let l of i){o=n.pop();let[c]=/^(?:\s|\0\d+c\x7F)*/u.exec(l),u=l.slice(c.length),f=/^(:*)((?:\s|\0\d+c\x7F)*)(\{\||\{(?:\0\d+c\x7F)*\0\d+!\x7F|\0\d+\{\x7F)(.*)$/u.exec(u);if(f){for(;o&&o.type!=="td";)o=n.pop();let[,I,P,R,q]=f;I&&new lt(I,t,r),g(`
${c}${I&&`\0${r.length-1}d\x7F`}${P}\0${r.length}b\x7F`,o),n.push(...o?[o]:[],new er(R,q,t,r));continue}else if(!o){a+=`
${l}`;continue}let x=/^(?:(\|\}|\0\d+!\x7F\}|\0\d+\}\x7F)|(\|-+|\0\d+!\x7F-+|\0\d+-\x7F-*)(?!-)|(!|(?:\||\0\d+!\x7F)\+?))(.*)$/u.exec(u);if(!x){g(`
${l}`,o),n.push(o);continue}let[,k,L,S,v]=x;if(k){for(;o.type!=="table";)o=n.pop();o.close(`
${c}${k}`,!0),g(v,n[n.length-1])}else if(L){o=p(),o.type==="tr"&&(o=n.pop());let I=new tr(`
${c}${L}`,v,t,r);n.push(o,I),o.insertAt(I)}else{o=p();let I=S==="!"?/!!|(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu:/(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu,P=I.exec(v),R=0,q=`
${c}${S}`,J=M=>{let ae=new Be(q,v.slice(R,P==null?void 0:P.index),t,r);return M.insertAt(ae),ae};for(;P;)J(o),{lastIndex:R}=I,[q]=P,P=I.exec(v);n.push(o,J(o))}}return a.slice(1)}});var rr,Si=y(()=>{"use strict";Se();rr=class extends Q{constructor(){super(...arguments);T(this,"type","hr")}}});var nr,Ci=y(()=>{"use strict";Ue();w();Se();nr=class extends he(Q){constructor(e,t,r=m.getConfig(),n=[]){super(e,r,n);T(this,"type","double-underscore")}getAttribute(e){return e==="padding"?2:super.getAttribute(e)}toString(){return`__${this.innerText}__`}print(){return super.print({pre:"__",post:"__"})}}});var $i={};U($i,{parseHrAndDoubleUnderscore:()=>js});var js,Ni=y(()=>{"use strict";w();Si();Ci();Pr();js=({firstChild:{data:d},type:s,name:e},t=m.getConfig(),r=[])=>{let{doubleUnderscore:n}=t,i=new Set(n[0]),a=new Set(n[1]);return s!=="root"&&(s!=="ext-inner"||e!=="poem")&&(d=`\0${d}`),d=d.replace(/^((?:\0\d+c\x7F)*)(-{4,})/gmu,(o,g,p)=>(new rr(p,t,r),`${g}\0${r.length-1}r\x7F`)).replace(new RegExp(`__(${n.flat().join("|")})__`,"giu"),(o,g)=>{let p=a.has(g);return p||i.has(g.toLowerCase())?(new nr(g,p,t,r),`\0${r.length-1}u\x7F`):o}).replace(/^((?:\0\d+c\x7F)*)(={1,6})(.+)\2((?:[^\S\n]|\0\d+c\x7F)*)$/gmu,(o,g,p,l,c)=>{let u=`${g}\0${r.length}h\x7F`;return new Qe(p.length,[l,c],t,r),u}),s==="root"||s==="ext-inner"&&e==="poem"?d:d.slice(1)}});var ir,Ii=y(()=>{"use strict";Vt();ir=class extends Ie{constructor(){super(...arguments);T(this,"type","category")}}});var sr,Ei=y(()=>{"use strict";j();w();Se();sr=class extends Q{constructor(){super(...arguments);T(this,"type","quote")}get bold(){return this.innerText.length!==2}get italic(){return this.innerText.length!==3}lint(e=this.getAbsoluteIndex()){let{previousSibling:t,nextSibling:r,bold:n}=this,i=m.msg('lonely "$1"',"'"),a=[],o;if((t==null?void 0:t.type)==="text"&&t.data.endsWith("'")){o=N(this,{start:e},"lonely-apos",i);let{startIndex:g,startLine:p,startCol:l}=o,[,{length:c}]=/(?:^|[^'])('+)$/u.exec(t.data),u=e-c;a.push({...o,startIndex:u,endIndex:g,startCol:l-c,endLine:p,endCol:l,suggestions:[{desc:"escape",range:[u,g],text:"&apos;".repeat(c)}]})}if((r==null?void 0:r.type)==="text"&&r.data.startsWith("'")){o!=null||(o=N(this,{start:e},"lonely-apos",i));let{endIndex:g,endLine:p,endCol:l}=o,[{length:c}]=/^'+/u.exec(r.data),u=g+c;a.push({...o,startIndex:g,endIndex:u,startLine:p,startCol:l,endCol:l+c,suggestions:[{desc:"escape",range:[g,u],text:"&apos;".repeat(c)}]})}return n&&this.closest("heading-title")&&(o!=null||(o=N(this,{start:e},"lonely-apos",i)),a.push({...o,rule:"bold-header",message:m.msg("bold in section header"),severity:"warning"})),a}json(){let e=super.json();return Object.assign(e,{bold:this.bold,italic:this.italic}),e}}});var on={};U(on,{parseQuotes:()=>qs});var qs,an=y(()=>{"use strict";w();Ei();qs=(d,s=m.getConfig(),e=[])=>{var p;let t=d.split(/('{2,})/u),{length:r}=t;if(r===1)return d;let n=0,i=0,a,o,g;for(let l=1;l<r;l+=2){let c=t[l].length;switch(c){case 2:i++;break;case 4:t[l-1]+="'",t[l]="'''";case 3:if(n++,a!==void 0)break;t[l-1].endsWith(" ")?o===void 0&&g===void 0&&(g=l):t[l-1].slice(-2,-1)===" "?a=l:o!=null||(o=l);break;default:t[l-1]+="'".repeat(c-5),t[l]="'''''",i++,n++}}if(i%2===1&&n%2===1){let l=(p=a!=null?a:o)!=null?p:g;l!==void 0&&(t[l]="''",t[l-1]+="'")}for(let l=1;l<r;l+=2)new sr(t[l],s,e),t[l]=`\0${e.length-1}q\x7F`;return t.join("")}});var Li={};U(Li,{parseLinks:()=>Fi});var Fi,Ri=y(()=>{"use strict";w();Vr();Ur();Ii();Fi=(d,s=m.getConfig(),e=[])=>{let{parseQuotes:t}=(an(),_(on)),r=s.inExt?/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)(.*?[^\]]))?\]\](.*)$/su:/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)(.*?[^\]])?)?\]\](.*)$/su,n=/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(\||\0\d+!\x7F)(.*)$/su,i=new RegExp(`^\\s*(?:${s.protocol}|//)`,"iu"),a=d.split("[["),o=a.shift();for(let g=0;g<a.length;g++){let p=!1,l,c,u,f,x=a[g],k=r.exec(x);if(k)[,l,c,u,f]=k,f.startsWith("]")&&(u!=null&&u.includes("["))&&(u+="]",f=f.slice(1));else{let q=n.exec(x);q&&(p=!0,[,l,c,u]=q)}if(l===void 0||i.test(l)||/\0\d+[exhbru]\x7F/u.test(l)){o+=`[[${x}`;continue}let L=l.trim().startsWith(":");if(L&&p){o+=`[[${x}`;continue}let S=m.normalizeTitle(l,0,!1,s,!0,!0,!0),{ns:v,valid:I,interwiki:P}=S;if(I){if(p){if(P||v!==6){o+=`[[${x}`;continue}let q=!1;for(g++;g<a.length;g++){let J=a[g],M=J.split("]]");if(M.length>2){q=!0,u+=`[[${M[0]}]]${M[1]}`,f=M.slice(2).join("]]");break}else if(M.length===2)u+=`[[${M[0]}]]${M[1]}`;else{u+=`[[${J}`;break}}if(u=Fi(u,s,e),!q){o+=`[[${l}${c}${u}`;continue}}}else{o+=`[[${x}`;continue}u&&(u=t(u,s,e)),o+=`\0${e.length}l\x7F${f}`;let R=tt;L||(!P&&v===6?R=Ye:!P&&v===14&&(R=ir)),u===void 0&&c&&(u=""),new R(l,u,s,e,c)}return o}});var Pi={};U(Pi,{parseExternalLinks:()=>Bs});var Bs,Gi=y(()=>{"use strict";H();w();Qr();Bs=(d,s=m.getConfig(),e=[])=>{let t=new RegExp(`\\[((?:(?:${s.protocol}|//)${ve}|\0\\d+m\x7F)${we}(?=[[\\]<>"\\t\\p{Zs}]|\0\\d))(\\p{Zs}*(?=\\P{Zs}))([^\\]-\b
-\uFFFD]*)\\]`,"giu");return d.replace(t,(r,n,i,a)=>{let{length:o}=e,g=/&[lg]t;/u.exec(n);return g&&(n=n.slice(0,g.index),i="",a=`${n.slice(g.index)}${i}${a}`),new nt(n,i,a,s,e),`\0${o}w\x7F`})}});var ji={};U(ji,{parseMagicLinks:()=>Os});var Os,qi=y(()=>{"use strict";H();w();Zr();Os=(d,s=m.getConfig(),e=[])=>{let t=new RegExp(`(^|[^\\p{L}\\d_])(?:${s.protocol})(${ve}${we})`,"giu");return d.replace(t,(r,n,i)=>{let a="",o=n?r.slice(1):r,g=/&(?:lt|gt|nbsp|#x0*(?:3[ce]|a0)|#0*(?:6[02]|160));/iu.exec(o);g&&(a=o.slice(g.index),o=o.slice(0,g.index));let p=new RegExp(`[,;.:!?${o.includes("(")?"":")"}]+$`,"u"),l=p.exec(o);if(l){let c=0;l[0].startsWith(";")&&/&(?:[a-z]+|#x[\da-f]+|#\d+)$/iu.test(o.slice(0,l.index))&&(c=1),a=`${o.slice(l.index+c)}${a}`,o=o.slice(0,l.index+c)}return a.length>=i.length?r:(new rt(o,!1,s,e),`${n}\0${e.length-1}w\x7F${a}`)})}});var or,Bi=y(()=>{"use strict";nn();or=class extends at{constructor(){super(...arguments);T(this,"type","list")}}});var Oi={};U(Oi,{parseList:()=>_s});var _s,_i=y(()=>{"use strict";w();Bi();sn();_s=(d,s=m.getConfig(),e=[])=>{let t=/^((?:\0\d+c\x7F)*)([;:*#]+)/u.exec(d);if(!t)return d;let[r,n,i]=t,a=`${n}\0${e.length}d\x7F${d.slice(r.length)}`,o=i.split(";").length-1;if(new or(i,s,e),!o)return a;let{html:[g]}=s,p=/:+|-\{|\0\d+[xq]\x7F/gu,l=p,c=l.exec(a),u=0,f=!1,x=!1,k=0,L=(v,I)=>(new lt(v,s,e),`${a.slice(0,I)}\0${e.length-1}d\x7F${a.slice(I+v.length)}`),S=v=>{v?u&&u--:u++};for(;c&&o;){let{0:v,index:I}=c;if(v==="-{"){if(!k){let{lastIndex:P}=l;l=/-\{|\}-/gu,l.lastIndex=P}k++}else if(v==="}-"){if(k--,!k){let{lastIndex:P}=l;l=p,l.lastIndex=P}}else if(v.endsWith("x\x7F")){let{name:P,closing:R,selfClosing:q}=e[Number(v.slice(1,-2))];(!q||g.includes(P))&&S(R)}else if(v.endsWith("q\x7F")){let{bold:P,italic:R}=e[Number(v.slice(1,-2))];P&&(S(f),f=!f),R&&(S(x),x=!x)}else if(u===0){if(v.length>=o)return L(v.slice(0,o),I);o-=v.length,l.lastIndex=I+4+String(e.length).length,a=L(v,I)}c=l.exec(a)}return a}});var zi,be,ar,Mi=y(()=>{"use strict";j();w();G();xe();zi=new Set(["A","T","R","D","-","H","N"]),ar=class extends b{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});T(this,"type","converter-flags");A(this,be,void 0);this.append(...e.map(n=>new B(n,"converter-flag",t,r)))}afterBuild(){$(this,be,this.childNodes.map(e=>e.text().trim()))}toString(){return super.toString(";")}text(){return super.text(";")}getGaps(){return 1}getUnknownFlags(){return new Set(h(this,be).filter(e=>/\{{3}[^{}]+\}{3}/u.test(e)))}getVariantFlags(){let e=new Set(this.getAttribute("config").variants);return new Set(h(this,be).filter(t=>e.has(t)))}lint(e=this.getAbsoluteIndex(),t){let r=this.getVariantFlags(),n=this.getUnknownFlags(),i=new Set(h(this,be).filter(u=>zi.has(u))),a=h(this,be).filter(u=>!u).length,o=h(this,be).length-n.size-a,g=super.lint(e,t);if(r.size===o||i.size===o)return g;let p={start:e,...this.getRootNode().posFromIndex(e)},{childNodes:l,length:c}=this;for(let u=0;u<c;u++){let f=l[u],x=f.text().trim();if(x&&!r.has(x)&&!n.has(x)&&(r.size>0||!i.has(x))){let k=C(f,p,"no-ignored","invalid conversion flag");r.size===0&&zi.has(x.toUpperCase())?k.fix={range:[k.startIndex,k.endIndex],text:x.toUpperCase()}:k.suggestions=[{desc:"remove",range:[k.startIndex,k.endIndex],text:""}],g.push(k)}}return g}print(){return super.print({sep:";"})}};be=new WeakMap});var dt,Wi=y(()=>{"use strict";w();G();xe();dt=class extends b{constructor(e,t=!0,r=m.getConfig(),n=[]){super(void 0,r,n);T(this,"type","converter-rule");let i=e.indexOf(":"),a=e.slice(0,i).indexOf("=>"),o=a===-1?e.slice(0,i):e.slice(a+2,i);t&&r.variants.includes(o.trim())?(super.insertAt(new B(o,"converter-rule-variant",r,n)),super.insertAt(new B(e.slice(i+1),"converter-rule-to",r,n)),a!==-1&&super.insertAt(new B(e.slice(0,a),"converter-rule-from",r,n),0)):super.insertAt(new B(e,"converter-rule-to",r,n))}toString(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`${String(t)}=>${String(r)}:${String(n)}`}return super.toString(":")}text(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`${t.text()}=>${r.text()}:${n.text()}`}return super.text(":")}getGaps(e){return e===0&&this.length===3?2:1}print(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`<span class="wpb-converter-rule">${t.print()}=>${r.print()}:${n.print()}</span>`}return super.print({sep:":"})}}});var lr,Ui=y(()=>{"use strict";H();w();G();Mi();Wi();lr=class extends b{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);T(this,"type","converter");this.append(new ar(e,r,n));let[i]=t,a=i.includes(":"),o=new dt(i,a,r,n);a&&o.length===1?this.insertAt(new dt(t.join(";"),!1,r,n)):this.append(o,...t.slice(1).map(g=>new dt(g,!0,r,n)))}toString(){let{childNodes:[e,...t]}=this;return`-{${String(e)}${e.length>0?"|":""}${t.map(String).join(";")}}-`}text(){let{childNodes:[e,...t]}=this;return`-{${e.text()}|${ce(t,";")}}-`}getAttribute(e){return e==="padding"?2:super.getAttribute(e)}getGaps(e){return e||this.firstChild.length>0?1:0}print(){let{childNodes:[e,...t]}=this;return`<span class="wpb-converter">-{${e.print()}${e.length>0?"|":""}${fe(t,{sep:";"})}}-</span>`}}});var Hi={};U(Hi,{parseConverter:()=>zs});var zs,Di=y(()=>{"use strict";w();Ui();zs=(d,s=m.getConfig(),e=[])=>{let t=/-\{/gu,r=/-\{|\}-/gu,n=[],i=t,a=i.exec(d);for(;a;){let{0:o,index:g}=a;if(o==="}-"){let p=n.pop(),{length:l}=e,c=d.slice(p.index+2,g),u=c.indexOf("|"),[f,x]=u===-1?[[],c]:[c.slice(0,u).split(";"),c.slice(u+1)],k=x.replace(/(&[#a-z\d]+);/giu,"$1"),L=`(?:${s.variants.join("|")})`,S=k.split(new RegExp(`;(?=(?:[^;]*?=>)?\\s*${L}\\s*:|(?:\\s|\0\\d+c\x7F)*$)`,"u")).map(v=>v.replace(/\x01/gu,";"));new lr(f,S,s,e),d=`${d.slice(0,p.index)}\0${l}v\x7F${d.slice(g+2)}`,n.length===0&&(i=t),i.lastIndex=p.index+3+String(l).length}else n.push(a),i=r,i.lastIndex=g+2;a=i.exec(d)}return d}});var dn={};U(dn,{Token:()=>b});var oe,O,z,Oe,St,ln,dr,Vi,gr,Zi,pr,Qi,ur,Xi,cr,Ki,hr,Ji,mr,Yi,fr,es,xr,ts,Tr,rs,br,ns,gn,b,G=y(()=>{"use strict";H();ue();j();w();$n();En();gn=class gn extends Ft{constructor(e,t=m.getConfig(),r=[],n){super();A(this,St);A(this,dr);A(this,gr);A(this,pr);A(this,ur);A(this,cr);A(this,hr);A(this,mr);A(this,fr);A(this,xr);A(this,Tr);A(this,br);T(this,"type","root");A(this,oe,0);A(this,O,void 0);A(this,z,void 0);A(this,Oe,void 0);typeof e=="string"&&this.insertAt(e),$(this,O,t),$(this,z,r),r.push(this)}parseOnce(e=h(this,oe),t=!1){if(e<h(this,oe)||!this.getAttribute("plain")||this.length===0)return this;if(h(this,oe)>=11)return this;switch(e){case 0:this.type==="root"&&h(this,z).shift(),$(this,Oe,t),E(this,dr,Vi).call(this,t);break;case 1:E(this,gr,Zi).call(this);break;case 2:E(this,pr,Qi).call(this);break;case 3:E(this,ur,Xi).call(this);break;case 4:E(this,cr,Ki).call(this);break;case 5:E(this,hr,Ji).call(this);break;case 6:E(this,mr,Yi).call(this);break;case 7:E(this,fr,es).call(this);break;case 8:E(this,xr,ts).call(this);break;case 9:E(this,Tr,rs).call(this);break;case 10:E(this,br,ns).call(this)}if(this.type==="root")for(let r of h(this,z))r.parseOnce(e,t);return Nt(this,oe)._++,this}buildFromStr(e,t){let r=e.split(/[\0\x7F]/u).map((n,i)=>{if(i%2===0)return new xt(n);if(isNaN(n.slice(-1)))return h(this,z)[Number(n.slice(0,-1))];throw new Error(`\u89E3\u6790\u9519\u8BEF\uFF01\u672A\u6B63\u786E\u6807\u8BB0\u7684 Token\uFF1A${n}`)});return t===0?r.map(String).join(""):t===1?ce(r):r}afterBuild(){if(this.type==="root")for(let e of h(this,z))e.afterBuild()}parse(e=11,t=!1){for(e=Math.min(e,11);h(this,oe)<e;)this.parseOnce(h(this,oe),t);return e&&(E(this,St,ln).call(this),this.afterBuild()),this}getAttribute(e){switch(e){case"plain":return this.constructor===gn;case"config":return JSON.parse(JSON.stringify(h(this,O)));case"include":{if(h(this,Oe)!==void 0)return h(this,Oe);let t=this.getRootNode();return t!==this&&t.getAttribute("include")}case"accum":return h(this,z);default:return super.getAttribute(e)}}setAttribute(e,t){switch(e){case"stage":h(this,oe)===0&&this.type==="root"&&h(this,z).shift(),$(this,oe,t);break;default:super.setAttribute(e,t)}}insertAt(e,t=this.length){let r=typeof e=="string"?new xt(e):e;return super.insertAt(r,t),r.type==="root"&&(r.type="plain"),r}normalizeTitle(e,t=0,r=!1,n=!1,i=!1){return m.normalizeTitle(e,t,h(this,Oe),h(this,O),r,n,i)}lint(e=this.getAbsoluteIndex(),t){var n;let r=super.lint(e,t);if(this.type==="root"){let i={};for(let u of this.querySelectorAll("category")){let f=i[u.name];f?f.add(u):i[u.name]=new Set([u])}for(let u of Object.values(i))u.size>1&&r.push(...[...u].map(f=>{let x=N(f,{start:f.getAbsoluteIndex()},"no-duplicate","duplicated category");return x.suggestions=[{desc:"remove",range:[x.startIndex,x.endIndex],text:""}],x}));let a=/<!--\s*lint-(disable(?:(?:-next)?-line)?|enable)(\s[\sa-z,-]*)?-->/gu,o=String(this),g=[],p=a.exec(o),l=0,c=0;for(;p;){let{1:u,index:f}=p,x=(n=p[2])==null?void 0:n.trim();c+=o.slice(l,f).split(`
`).length-1,l=f,g.push({line:c+(u==="disable-line"?0:1),from:u==="disable"?a.lastIndex:void 0,to:u==="enable"?a.lastIndex:void 0,rules:x?new Set(x.split(",").map(k=>k.trim())):void 0}),p=a.exec(o)}return r.filter(({rule:u,startLine:f,startIndex:x})=>{let k={pos:0};for(let{line:L,from:S,to:v,rules:I}of g){if(L>f+1)break;if(I&&!I.has(u))continue;if(L===f&&S===void 0&&v===void 0)return!1;S<=x&&S>k.pos?(k.pos=S,k.type="from"):v<=x&&v>k.pos&&(k.pos=v,k.type="to")}return k.type!=="from"})}return r}};oe=new WeakMap,O=new WeakMap,z=new WeakMap,Oe=new WeakMap,St=new WeakSet,ln=function(){var n;$(this,oe,11);let{length:e,firstChild:t}=this,r=String(t);if(e===1&&t.type==="text"&&r.includes("\0")&&(this.replaceChildren(...this.buildFromStr(r)),this.normalize(),this.type==="root"))for(let i of h(this,z))E(n=i,St,ln).call(n)},dr=new WeakSet,Vi=function(e){let{parseCommentAndExt:t}=(hi(),_(ci));this.setText(t(String(this.firstChild),h(this,O),h(this,z),e))},gr=new WeakSet,Zi=function(){let{parseBraces:e}=(jr(),_(Kn)),t=this.type==="root"?String(this.firstChild):`\0${String(this.firstChild)}`,r=e(t,h(this,O),h(this,z));this.setText(this.type==="root"?r:r.slice(1))},pr=new WeakSet,Qi=function(){var t;if((t=h(this,O).excludes)!=null&&t.includes("html"))return;let{parseHtml:e}=(xi(),_(fi));this.setText(e(String(this.firstChild),h(this,O),h(this,z)))},ur=new WeakSet,Xi=function(){var t;if((t=h(this,O).excludes)!=null&&t.includes("table"))return;let{parseTable:e}=(wi(),_(vi));this.setText(e(this,h(this,O),h(this,z)))},cr=new WeakSet,Ki=function(){var t;if((t=h(this,O).excludes)!=null&&t.includes("hr"))return;let{parseHrAndDoubleUnderscore:e}=(Ni(),_($i));this.setText(e(this,h(this,O),h(this,z)))},hr=new WeakSet,Ji=function(){let{parseLinks:e}=(Ri(),_(Li));this.setText(e(String(this.firstChild),h(this,O),h(this,z)))},mr=new WeakSet,Yi=function(){var r;if((r=h(this,O).excludes)!=null&&r.includes("quote"))return;let{parseQuotes:e}=(an(),_(on)),t=String(this.firstChild).split(`
`);for(let n=0;n<t.length;n++)t[n]=e(t[n],h(this,O),h(this,z));this.setText(t.join(`
`))},fr=new WeakSet,es=function(){var t;if((t=h(this,O).excludes)!=null&&t.includes("extLink"))return;let{parseExternalLinks:e}=(Gi(),_(Pi));this.setText(e(String(this.firstChild),h(this,O),h(this,z)))},xr=new WeakSet,ts=function(){var t;if((t=h(this,O).excludes)!=null&&t.includes("magicLink"))return;let{parseMagicLinks:e}=(qi(),_(ji));this.setText(e(String(this.firstChild),h(this,O),h(this,z)))},Tr=new WeakSet,rs=function(){var n;if((n=h(this,O).excludes)!=null&&n.includes("list"))return;let{parseList:e}=(_i(),_(Oi)),t=String(this.firstChild).split(`
`),r=this.type==="root"||this.type==="ext-inner"&&this.name==="poem"?0:1;for(;r<t.length;r++)t[r]=e(t[r],h(this,O),h(this,z));this.setText(t.join(`
`))},br=new WeakSet,ns=function(){if(h(this,O).variants.length>0){let{parseConverter:e}=(Di(),_(Hi));this.setText(e(String(this.firstChild),h(this,O),h(this,z)))}};b=gn});var _e,is,Ms,m,w=y(()=>{fn();Re();ue();H();_e={i18n:void 0,rules:mn,getConfig(){return{...bn,...this.config,excludes:[]}},msg(d,s=""){var e,t;return d&&((t=(e=this.i18n)==null?void 0:e[d])!=null?t:d).replace("$1",this.msg(s))},normalizeTitle(d,s=0,e=!1,t=_e.getConfig(),r=!1,n=!1,i=!1){let{Title:a}=(Sn(),_(wn));if(r)return new a(d,s,t,n,i);let{Token:o}=(G(),_(dn)),g=Ae.run(()=>new o(d,t).parseOnce(0,e).parseOnce()),p=new a(String(g),s,t,n,i);return Ae.run(()=>{for(let l of["main","fragment"]){let c=p[l];c!=null&&c.includes("\0")&&(p[l]=g.buildFromStr(c,1))}}),p},parse(d,s,e=11,t=_e.getConfig()){d=yn(d);let{Token:r}=(G(),_(dn));return Ae.run(()=>new r(d,t).parse(e,s))}},is={},Ms=new Set(["normalizeTitle","parse"]);for(let d in _e)Ms.has(d)||(is[d]={enumerable:!1});Object.defineProperties(_e,is);typeof self=="object"?Object.assign(self,{Parser:_e}):typeof globalThis=="object"&&Object.assign(globalThis,{Parser:_e});m=_e});w();})();
