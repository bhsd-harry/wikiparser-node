"use strict";(()=>{var At=Object.defineProperty;var es=Object.getOwnPropertyDescriptor;var ts=Object.getOwnPropertyNames;var rs=Object.prototype.hasOwnProperty;var ns=(g,i,e)=>i in g?At(g,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[i]=e;var k=(g,i)=>()=>(g&&(i=g(g=0)),i);var is=(g,i)=>()=>(i||g((i={exports:{}}).exports,i),i.exports),M=(g,i)=>{for(var e in i)At(g,e,{get:i[e],enumerable:!0})},ss=(g,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let r of ts(i))!rs.call(g,r)&&r!==e&&At(g,r,{get:()=>i[r],enumerable:!(t=es(i,r))||t.enumerable});return g};var j=g=>ss(At({},"__esModule",{value:!0}),g);var f=(g,i,e)=>(ns(g,typeof i!="symbol"?i+"":i,e),e),vr=(g,i,e)=>{if(!i.has(g))throw TypeError("Cannot "+e)};var u=(g,i,e)=>(vr(g,i,"read from private field"),e?e.call(g):i.get(g)),y=(g,i,e)=>{if(i.has(g))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(g):i.set(g,e)},C=(g,i,e,t)=>(vr(g,i,"write to private field"),t?t.call(g,e):i.set(g,e),e);var St=(g,i,e,t)=>({set _(r){C(g,i,r,e)},get _(){return u(g,i,t)}}),L=(g,i,e)=>(vr(g,i,"access private method"),e);var cn,hn=k(()=>{"use strict";cn=["bold-header","format-leakage","fostered-content","h1","illegal-attr","insecure-style","invalid-gallery","invalid-imagemap","invalid-invoke","lonely-apos","lonely-bracket","lonely-http","nested-link","no-arg","no-duplicate","no-ignored","obsolete-attr","obsolete-tag","parsing-order","pipe-like","table-layout","tag-like","unbalanced-header","unclosed-comment","unclosed-quote","unclosed-table","unescaped","unknown-page","unmatched-tag","unterminated-url","url-encoding","var-anchor","void-ext"]});var Ie,Ee,Ar,Le=k(()=>{"use strict";Ie={running:!1,run(g){return g()}},Ee=g=>i=>i.type===g,Ar=(g,i,e,t=[])=>{let r=[...g.childNodes],n=r.splice(i,e,...t);g.setAttribute("childNodes",r);for(let s of t)s.setAttribute("parentNode",g);return n}});var mn=is((_s,os)=>{os.exports={ext:[],html:[["b","bdi","del","i","ins","u","font","big","small","sub","sup","h1","h2","h3","h4","h5","h6","cite","code","em","s","strike","strong","tt","var","div","center","blockquote","ol","ul","dl","table","caption","pre","ruby","rb","rp","rt","rtc","p","span","abbr","dfn","kbd","samp","data","time","mark","tr","td","th","q","bdo"],["li","dt","dd"],["br","wbr","hr","meta","link"]],namespaces:{},nsid:{file:6,category:14},parserFunction:[{"#language":"language","#special":"special","#speciale":"speciale","#tag":"tag","#formatdate":"formatdate","#dateformat":"formatdate","#invoke":"invoke","#while":"while","#dowhile":"dowhile","#loop":"loop","#forargs":"forargs","#fornumargs":"fornumargs","#if":"if","#ifeq":"ifeq","#switch":"switch","#ifexist":"ifexist","#ifexpr":"ifexpr","#iferror":"iferror","#time":"time","#timel":"timel","#expr":"expr","#rel2abs":"rel2abs","#titleparts":"titleparts","#categorytree":"categorytree","#urldecode":"urldecode","#choose":"choose","#var":"var","#varexists":"varexists","#var_final":"var_final","#vardefine":"vardefine","#vardefineecho":"vardefineecho","#widget":"widget","#regex":"regex","#related":"related","#cscore":"cscore"},["!","="],["msg","raw"],["subst","safesubst"]],doubleUnderscore:[[],[]],protocol:"bitcoin:|ftp://|ftps://|geo:|git://|gopher://|http://|https://|irc://|ircs://|magnet:|mailto:|matrix:|mms://|news:|nntp://|redis://|sftp://|sip:|sips:|sms:|ssh://|svn://|tel:|telnet://|urn:|worldwind://|xmpp:",interwiki:[],img:{},variants:[]}});var fn,ge=k(()=>{"use strict";fn=mn()});var xn,ye,ve,gt,Tn,ne,bn,pe,wt,kn,fe,D=k(()=>{"use strict";xn='[^[\\]<>"\0-\x7F\\p{Zs}\uFFFD]',ye=`(?:\\[[\\da-f:.]+\\]|${xn})`,ve=`(?:${xn}|\0\\d+[c!~]\x7F)*`,gt=(g,i)=>e=>e.replace(g,i),Tn=gt(/[\0\x7F]/gu,""),ne=gt(/\0\d+c\x7F/gu,""),bn=gt(/[\\{}()|.?*+^$[\]]/gu,"\\$&"),pe=(g,i="")=>g.map(e=>typeof e=="string"?e:e.text()).join(i),wt=gt(/&#(\d+|x[\da-f]+);/giu,(g,i)=>String.fromCodePoint(+`${i.toLowerCase().startsWith("x")?"0":""}${i}`)),kn=gt(/\n/gu,"\\n"),fe=(g,i={})=>{let{pre:e="",post:t="",sep:r=""}=i;return`${e}${g.map(n=>n.print()).join(r)}${t}`}});var yn={};M(yn,{Title:()=>Sr});var pt,Sr,vn=k(()=>{"use strict";D();A();Sr=class{constructor(i,e=0,t=m.getConfig(),r=!1,n=!1){f(this,"valid");f(this,"ns");f(this,"fragment");f(this,"encoded",!1);y(this,pt,void 0);if(i=wt(i),r&&i.includes("%"))try{let l=/%(?!21|3[ce]|5[bd]|7[b-d])[\da-f]{2}/iu.test(i);i=decodeURIComponent(i),this.encoded=l}catch(l){}i=i.replace(/_/gu," ").trim();let s=e;i.startsWith(":")&&(s=0,i=i.slice(1).trim());let o=i.split(":");if(o.length>1){let l=t.nsid[o[0].trim().toLowerCase()];l&&(s=l,i=o.slice(1).join(":").trim())}this.ns=s;let a=i.indexOf("#");if(a!==-1){let l=i.slice(a+1).trimEnd();if(l.includes("%"))try{l=decodeURIComponent(l)}catch(p){}else if(l.includes("."))try{l=decodeURIComponent(l.replace(/\./gu,"%"))}catch(p){}this.fragment=l,i=i.slice(0,a).trim()}this.valid=!!(i||this.interwiki||n&&this.fragment!==void 0)&&!/^:|\0\d+[eh!+-]\x7F|[<>[\]{}|]|%[\da-f]{2}/iu.test(i),this.main=i}get main(){return u(this,pt)}set main(i){i=i.replace(/_/gu," ").trim(),C(this,pt,i&&`${i[0].toUpperCase()}${i.slice(1)}`)}get extension(){let{main:i}=this,e=i.lastIndexOf(".");return e===-1?void 0:i.slice(e+1).toLowerCase()}};pt=new WeakMap});var ut,ct,wr,ze,$r=k(()=>{"use strict";ze=class{constructor(){y(this,ct);f(this,"childNodes",[]);y(this,ut,void 0)}get firstChild(){return this.childNodes[0]}get lastChild(){return this.childNodes[this.childNodes.length-1]}get parentNode(){return u(this,ut)}get nextSibling(){var e;let i=(e=this.parentNode)==null?void 0:e.childNodes;return i&&i[i.indexOf(this)+1]}get previousSibling(){var e;let i=(e=this.parentNode)==null?void 0:e.childNodes;return i&&i[i.indexOf(this)-1]}get offsetHeight(){return L(this,ct,wr).call(this).height}get offsetWidth(){return L(this,ct,wr).call(this).width}getAttribute(i){return i==="padding"?0:i in this?String(this[i]):void 0}setAttribute(i,e){i==="parentNode"?C(this,ut,e):this[i]=e}getRootNode(){let{parentNode:i}=this;for(;i!=null&&i.parentNode;)({parentNode:i}=i);return i!=null?i:this}posFromIndex(i){let e=String(this);if(i>=-e.length&&i<=e.length){let t=e.slice(0,i).split(`
`),r=t.length-1;return{top:r,left:t[r].length}}}getGaps(i){return 0}getRelativeIndex(i){let e,t=(r,n)=>e.slice(0,r).reduce((s,o,a)=>s+String(o).length+n.getGaps(a),0)+n.getAttribute("padding");if(i===void 0){let{parentNode:r}=this;return r?({childNodes:e}=r,t(e.indexOf(this),r)):0}return{childNodes:e}=this,t(i,this)}getAbsoluteIndex(){let{parentNode:i}=this;return i?i.getAbsoluteIndex()+this.getRelativeIndex():0}seal(i,e){Object.defineProperty(this,i,{enumerable:!e&&!!this[i],configurable:!0})}};ut=new WeakMap,ct=new WeakSet,wr=function(){let i=String(this).split(`
`),e=i.length;return{height:e,width:i[e-1].length}}});var Ct,An,$t,Sn=k(()=>{"use strict";D();Le();$r();$t=class extends ze{constructor(){super(...arguments);y(this,Ct)}get length(){return this.childNodes.length}text(e){return pe(this.childNodes,e)}normalize(){let e=[...this.childNodes];for(let t=e.length-1;t>=0;t--){let{type:r,data:n}=e[t];r!=="text"||this.getGaps(t-1)||n===""&&e.splice(t,1)}this.setAttribute("childNodes",e)}removeAt(e){return Ar(this,e,1)[0]}insertAt(e,t=this.length){return Ar(this,t,0,[e]),e}closest(e){let t=L(this,Ct,An).call(this,e),{parentNode:r}=this;for(;r;){if(t(r))return r;({parentNode:r}=r)}}append(...e){for(let t of e)this.insertAt(t)}replaceChildren(...e){for(let t=this.length-1;t>=0;t--)this.removeAt(t);this.append(...e)}setText(e,t=0){t+=t<0?this.length:0;let r=this.childNodes[t],{data:n}=r;return r.replaceData(e),n}toString(e=""){return this.childNodes.map(String).join(e)}lint(e=this.getAbsoluteIndex()){let t=[];for(let r=0,n=e+this.getAttribute("padding");r<this.length;r++){let s=this.childNodes[r];t.push(...s.lint(n)),n+=String(s).length+this.getGaps(r)}return t}print(e={}){var t;return String(this)?`<span class="wpb-${(t=e.class)!=null?t:this.type}">${fe(this.childNodes,e)}</span>`:""}json(e,t=this.getAbsoluteIndex()){let r={...this,range:[t,t+String(this).length],childNodes:[]};for(let n=0,s=t+this.getAttribute("padding");n<this.length;n++){let o=this.childNodes[n],{length:a}=String(o);o.type==="text"?r.childNodes.push({data:o.data,range:[s,s+a]}):r.childNodes.push(o.json(void 0,s)),s+=a+this.getGaps(n)}return r}};Ct=new WeakSet,An=function(e){let t=new Set(e.split(",").map(r=>r.trim()));return({type:r})=>t.has(r)}});var wn,w,N,q=k(()=>{"use strict";A();wn=g=>(i,e,t,r,n="error")=>{let{start:s}=e,{top:o,left:a}="top"in e?e:i.getRootNode().posFromIndex(s),{offsetHeight:l,offsetWidth:p}=i,{startIndex:d,startLine:c,startCol:h}=g(i,s,o,a);return{rule:t,message:m.msg(r),severity:n,startIndex:d,endIndex:d+String(i).length,startLine:c,endLine:c+l-1,startCol:h,endCol:l===1?h+p:p}},w=wn((g,i,e,t)=>{let r=g.getRelativeIndex(),{top:n,left:s}=g.parentNode.posFromIndex(r);return{startIndex:i+r,startLine:e+n,startCol:n?s:t+s}}),N=wn((g,i,e,t)=>({startIndex:i,startLine:e,startCol:t}))});var Q,Ae=k(()=>{"use strict";A();P();Q=class extends T{get innerText(){return this.firstChild.data}constructor(i="",e=m.getConfig(),t=[]){super(i,e,t)}}});var Nr={};M(Nr,{NowikiToken:()=>Cr});var Cr,Fr=k(()=>{"use strict";q();A();Ae();Cr=class extends Q{constructor(){super(...arguments);f(this,"type","ext-inner")}lint(e=this.getAbsoluteIndex()){let{name:t,firstChild:{data:r}}=this;if((t==="templatestyles"||t==="section")&&r){let n=N(this,{start:e},"void-ext",m.msg("nothing should be in <$1>",t));return n.fix={range:[e-1,n.endIndex+t.length+3],text:"/>"},[n]}return super.lint(e)}}});var $n,as,ls,ds,gs,ps,Nt,Cn,ht,Nn=k(()=>{"use strict";A();$r();$n="<\\s*(?:\\/\\s*)?([a-z]\\w*)|\\{+|\\}+|\\[{2,}|\\[(?![^[]*?\\])|((?:^|\\])[^[]*?)\\]+",as=new RegExp(`${$n}|https?[:/]\\/+`,"giu"),ls=new RegExp($n,"giu"),ds={"[":/[[\]]/u,"{":/[{}]/u,"]":/[[\]](?=[^[\]]*$)/u,"}":/[{}](?=[^{}]*$)/u},gs={"<":"tag-like","[":"lonely-bracket","{":"lonely-bracket","]":"lonely-bracket","}":"lonely-bracket",h:"lonely-http"},ps=["html","head","style","title","body","a","audio","img","video","embed","iframe","object","canvas","script","col","colgroup","tbody","tfoot","thead","button","input","label","option","select","textarea"],ht=class extends ze{constructor(e){super();y(this,Nt);f(this,"type","text");f(this,"data","");Object.defineProperties(this,{childNodes:{enumerable:!1,configurable:!1},type:{enumerable:!1,writable:!1},data:{value:e}})}toString(){return this.data}text(){return this.data}lint(e=this.getAbsoluteIndex()){var H,he,lt,de;let{data:t,parentNode:r,nextSibling:n,previousSibling:s}=this;if(!r)return[];let{type:o,name:a,parentNode:l}=r,p=!1;if(o==="attr-value"){let{type:W,name:ee,tag:re}=l;if(W!=="ext-attr")p=!0;else if(re==="choose"&&(ee==="before"||ee==="after"))return[]}let{NowikiToken:d}=(Fr(),j(Nr)),c=((H=r.closest("ext"))==null?void 0:H.name)==="pre",h=c||a==="nowiki",x;if(c||o==="ext-inner"&&r instanceof d?x=new RegExp(`<\\s*(?:\\/\\s*)${h?"":"?"}(${a})\\b`,"giu"):o==="free-ext-link"||o==="ext-link-url"||o==="image-parameter"&&a==="link"||p?x=ls:x=as,t.search(x)===-1)return[];x.lastIndex=0;let b=[],S=n==null?void 0:n.type,R=n==null?void 0:n.name,F=s==null?void 0:s.type,v=this.getRootNode(),{ext:I,html:E}=v.getAttribute("config"),{top:G,left:_}=v.posFromIndex(e),Y=new Set(["onlyinclude","noinclude","includeonly",I,E,ps].flat(2));for(let W=x.exec(t);W;W=x.exec(t)){let[,ee,re]=W,{0:Ne,index:K}=W;if(re&&re!=="]"){let{length:te}=re;K+=te,Ne=Ne.slice(te)}let{0:$,length:ke}=Ne;if($==="<"&&!Y.has(ee.toLowerCase())||$==="["&&o==="ext-link-text"&&(/&(?:rbrack|#93|#x5[Dd];);/u.test(t.slice(K+1))||S==="ext"&&R==="nowiki"&&((he=n.innerText)!=null&&he.includes("]"))))continue;$==="]"&&(K||ke>1)&&x.lastIndex--;let me=e+K,an=me+ke,ln=String(v),_e=ln[an],yt=ln[me-1],br=ke>1&&!($==="<"&&(h||!/[\s/>]/u.test(_e!=null?_e:""))||p&&($==="["||$==="]"))||$==="{"&&(_e===$||yt==="-")||$==="}"&&(yt===$||_e==="-")||$==="["&&(_e===$||o==="ext-link-text"||S==="free-ext-link"&&!t.slice(K+1).trim())||$==="]"&&(yt===$||F==="free-ext-link"&&!t.slice(0,K).includes("]"))?"error":"warning",kr=$==="{"||$==="[";if(br==="warning"&&(kr||($==="]"||$==="}"))){let te=ds[$],yr=kr?t.slice(K+1):t.slice(0,K);if($==="{"&&((lt=te.exec(yr))==null?void 0:lt[0])==="}"||$==="}"&&((de=te.exec(yr))==null?void 0:de[0])==="{")continue;if(!yr.includes($)){let un=kr?"nextSibling":"previousSibling",Fe=this[un];for(;Fe&&(Fe.type!=="text"||!te.test(Fe.data));)Fe=Fe[un];if(Fe&&te.exec(Fe.data)[0]!==$)continue}}let vt=t.slice(0,K).split(`
`),dn=vt.length+G-1,gn=vt[vt.length-1],pn=vt.length===1?_+gn.length:gn.length,dt={rule:gs[$],message:m.msg('lonely "$1"',$==="h"?Ne:$),severity:br,startIndex:me,endIndex:an,startLine:dn,endLine:dn,startCol:pn,endCol:pn+ke};if($==="<")dt.suggestions=[{desc:"escape",range:[me,me+1],text:"&lt;"}];else if($==="h"&&!(o==="ext-link-text"||o==="link-text")&&/[\p{L}\d_]/u.test(yt||""))dt.suggestions=[{desc:"whitespace",range:[me,me],text:" "}];else if($==="["&&o==="ext-link-text"){let te=r.getAbsoluteIndex()+String(r).length;dt.suggestions=[{desc:"escape",range:[te,te+1],text:"&#93;"}]}else if($==="]"&&F==="free-ext-link"&&br==="error"){let te=e-String(s).length;dt.fix={range:[te,te],text:"["}}b.push(dt)}return b}replaceData(e){L(this,Nt,Cn).call(this,e)}print(){let e={"&":"amp","<":"lt",">":"gt"};return this.data.replace(/[&<>]/gu,t=>`&${e[t]};`)}};Nt=new WeakSet,Cn=function(e){this.setAttribute("data",e)}});var Ft,Fn=k(()=>{"use strict";P();Ft=class extends T{constructor(){super(...arguments);f(this,"type","onlyinclude")}toString(){return`<onlyinclude>${super.toString()}</onlyinclude>`}getAttribute(e){return e==="padding"?13:e==="plain"||super.getAttribute(e)}print(){return super.print({pre:'<span class="wpb-ext">&lt;onlyinclude&gt;</span>',post:'<span class="wpb-ext">&lt;/onlyinclude&gt;</span>'})}}});var ue,Me=k(()=>{"use strict";ue=g=>{class i extends g{text(){return""}lint(){return[]}}return i}});var V,Re=k(()=>{"use strict";Me();Ae();V=class extends ue(Q){constructor(){super(...arguments);f(this,"type","noinclude")}}});var Se,We,Ir=k(()=>{"use strict";A();P();We=class extends T{constructor(e,t,r,n,s=m.getConfig(),o=[]){super(void 0,s);y(this,Se,void 0);f(this,"closed");f(this,"selfClosing");this.setAttribute("name",e.toLowerCase()),C(this,Se,[e,n||e]),this.closed=n!=="",this.selfClosing=n===void 0,this.append(t,r);let a=typeof t=="string"?-1:o.indexOf(t);o.splice(a===-1?1/0:a,0,this)}get innerText(){return this.selfClosing?void 0:this.lastChild.text()}toString(){let{selfClosing:e,firstChild:t,lastChild:r}=this,[n,s]=u(this,Se);return e?`<${n}${String(t)}/>`:`<${n}${String(t)}>${String(r)}${this.closed?`</${s}>`:""}`}text(){let[e,t]=u(this,Se);return this.selfClosing?`<${e}${this.firstChild.text()}/>`:`<${e}${super.text(">")}${this.closed?`</${t}>`:""}`}getAttribute(e){return e==="padding"?u(this,Se)[0].length+1:super.getAttribute(e)}getGaps(){return 1}print(){let[e,t]=u(this,Se);return super.print(this.selfClosing?{pre:`&lt;${e}`,post:"/&gt;"}:{pre:`&lt;${e}`,sep:"&gt;",post:this.closed?`&lt;/${t}&gt;`:""})}};Se=new WeakMap});var It,In=k(()=>{"use strict";q();Me();A();Ir();It=class extends ue(We){constructor(e,t="",r,n,s=m.getConfig(),o=[]){super(e,t,r!=null?r:"",r===void 0||n!=null?n:"",s,o);f(this,"type","include")}lint(e=this.getAbsoluteIndex()){if(this.closed)return[];let t=N(this,{start:e},"unclosed-comment",m.msg("unclosed $1",`<${this.name}>`));return t.suggestions=[{desc:"close",range:[t.endIndex,t.endIndex],text:`</${this.name}>`}],[t]}}});var B,xe=k(()=>{"use strict";A();P();B=class extends T{constructor(i,e,t=m.getConfig(),r=[],n){super(i,t,r,n),this.type=e}}});var us,U,En,Ln,Lt,Er,Rn,mt,Gn,qn,jn,Pn,Et,cs,hs,ms,Ue,Z,ie,He,Bn=k(()=>{"use strict";q();D();ge();A();P();xe();us=new Set(["id","class","style","lang","dir","title","tabindex","aria-describedby","aria-flowto","aria-hidden","aria-label","aria-labelledby","aria-level","aria-owns","role","about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),U=new Set(["align"]),En=new Set(["cite"]),Ln=new Set(["cite","datetime"]),Lt=new Set(["width"]),Er=new Set(["axis","align","bgcolor","height","width","valign"]),Rn=new Set([...Er,"abbr","headers","scope","rowspan","colspan"]),mt=new Set(["type"]),Gn=new Set(["summary","align","bgcolor","cellpadding","cellspacing","frame","rules","width"]),qn=new Set(["clear"]),jn=new Set(["bgcolor","align","valign"]),Pn={div:U,h1:U,h2:U,h3:U,h4:U,h5:U,h6:U,blockquote:En,q:En,p:U,br:qn,pre:Lt,ins:Ln,del:Ln,ul:mt,ol:new Set(["type","start","reversed"]),li:new Set(["type","value"]),table:new Set([...Gn,"border"]),caption:U,tr:jn,td:Rn,th:Rn,img:new Set(["alt","src","width","height","srcset"]),font:new Set(["size","color","face"]),hr:Lt,rt:new Set(["rbspan"]),data:new Set(["value"]),time:new Set(["datetime"]),meta:new Set(["itemprop","content"]),link:new Set(["itemprop","href","title"]),gallery:new Set(["mode","showfilename","caption","perrow","widths","heights","showthumbnails","type"]),poem:new Set(["compact","align"]),categorytree:new Set(["align","hideroot","onlyroot","depth","mode","hideprefix","namespaces","showcount","notranslations"]),combooption:new Set(["name","for","inline","align"])},Et=new Set,cs={nowiki:Et,indicator:new Set(["name"]),langconvert:new Set(["from","to"]),ref:new Set(["group","name","extends","follow","dir"]),references:new Set(["group","responsive"]),charinsert:new Set(["label"]),choose:new Set(["uncached","before","after"]),option:new Set(["weight"]),imagemap:Et,inputbox:Et,templatestyles:new Set(["src","wrapper"]),dynamicpagelist:Et,poll:new Set(["id","show-results-before-voting"]),sm2:mt,flashmp3:mt,score:new Set(["line_width_inches","lang","override_midi","raw","note-language","override_audio","override_ogg","sound","vorbis"]),seo:new Set(["title","title_mode","title_separator","keywords","description","robots","google_bot","image","image_width","image_height","image_alt","type","site_name","locale","section","author","published_time","twitter_site"]),tab:new Set(["nested","name","index","class","block","inline","openname","closename","collapsed","dropdown","style","bgcolor","container","id","title"]),tabs:new Set(["plain","class","container","id","title","style"]),combobox:new Set(["placeholder","value","id","class","text","dropdown","style"])},hs=new RegExp("expression|(?:accelerator|-o-link(?:-source)?|-o-replace)\\s*:|(?:url|image(?:-set)?)\\s*\\(|attr\\s*\\([^)]+[\\s,]url","u"),ms={table:Gn,td:new Set([...Er,"scope"]),th:Er,br:qn,caption:U,div:U,hr:Lt,h1:U,h2:U,h3:U,h4:U,h5:U,h6:U,li:mt,p:U,pre:Lt,tr:jn,ul:mt},He=class extends T{constructor(e,t,r,n="",s,o=[],a=m.getConfig(),l=[]){let p=new B(r,"attr-key",a,l,{}),d;if(r==="title"||t==="img"&&r==="alt")d=new T(s,a,l,{}),d.type="attr-value",d.setAttribute("stage",10);else if(t==="gallery"&&r==="caption"){let c={...a,excludes:[...a.excludes,"quote","extLink","magicLink","list"]};d=new T(s,c,l,{}),d.type="attr-value",d.setAttribute("stage",5)}else if(t==="choose"&&(r==="before"||r==="after")){let c={...a,excludes:[...a.excludes,"heading","html","table","hr","list"]};d=new T(s,c,l,{}),d.type="attr-value",d.setAttribute("stage",1)}else d=new B(s,"attr-value",a,l,{});super(void 0,a,l);y(this,Ue,void 0);y(this,Z,void 0);y(this,ie,void 0);this.type=e,this.append(p,d),C(this,Z,n),C(this,ie,[...o]),C(this,Ue,t),this.setAttribute("name",ne(r).trim().toLowerCase())}get tag(){return u(this,Ue)}get balanced(){return!u(this,Z)||u(this,ie)[0]===u(this,ie)[1]}afterBuild(){u(this,Z).includes("\0")&&C(this,Z,this.buildFromStr(u(this,Z),0)),this.parentNode&&C(this,Ue,this.parentNode.name),this.setAttribute("name",this.firstChild.text().trim().toLowerCase())}toString(){let[e="",t=""]=u(this,ie);return u(this,Z)?`${super.toString(`${u(this,Z)}${e}`)}${t}`:String(this.firstChild)}text(){return u(this,Z)?`${super.text(`${u(this,Z).trim()}"`)}"`:this.firstChild.text()}getGaps(){var e,t;return u(this,Z)?u(this,Z).length+((t=(e=u(this,ie)[0])==null?void 0:e.length)!=null?t:0):0}lint(e=this.getAbsoluteIndex()){var h,x;let t=super.lint(e),{balanced:r,firstChild:n,lastChild:s,type:o,name:a,tag:l}=this,p=this.getValue(),d;if(!r){let b=this.getRootNode();d={start:e,...b.posFromIndex(e)};let S=w(s,d,"unclosed-quote",m.msg("unclosed $1","quotes"),"warning");S.startIndex--,S.startCol--;let R={range:[S.endIndex,S.endIndex],text:u(this,ie)[0]};s.childNodes.some(F=>F.type==="text"&&/\s/u.test(F.text()))?S.suggestions=[{desc:"close",...R}]:S.fix=R,t.push(S)}let c=cs[l];if(c&&!c.has(a)||(o==="ext-attr"?l in Pn:!/\{\{[^{]+\}\}/u.test(a))&&!((h=Pn[l])!=null&&h.has(a))&&!/^(?:xmlns:[\w:.-]+|data-[^:]*)$/u.test(a)&&(l==="meta"||l==="link"||!us.has(a)))d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(n,d,"illegal-attr","illegal attribute name"));else if((x=ms[l])!=null&&x.has(a))d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(n,d,"obsolete-attr","obsolete attribute","warning"));else if(a==="style"&&typeof p=="string"&&hs.test(p))d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(s,d,"insecure-style","insecure style"));else if(a==="tabindex"&&typeof p=="string"&&p.trim()!=="0"){d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)});let b=w(s,d,"illegal-attr","nonzero tabindex");b.suggestions=[{desc:"remove",range:[e,b.endIndex],text:""},{desc:"0 tabindex",range:[b.startIndex,b.endIndex],text:"0"}],t.push(b)}return t}getValue(){if(u(this,Z)){let e=this.lastChild.text();return u(this,ie)[1]?e:e[u(this,ie)[0]?"trimEnd":"trim"]()}return this.type==="ext-attr"||""}print(){let[e="",t=""]=u(this,ie);return u(this,Z)?super.print({sep:`${u(this,Z)}${e}`,post:t}):super.print()}};Ue=new WeakMap,Z=new WeakMap,ie=new WeakMap});var On,fs,we,Pt=k(()=>{"use strict";q();D();A();P();xe();Bn();On=g=>g.slice(0,-1),fs=g=>`${On(g)}-dirty`,we=class extends T{constructor(i,e,t,r=m.getConfig(),n=[]){if(super(void 0,r,n,{}),this.type=e,this.setAttribute("name",t),i){let s=new RegExp(`([^\\s/](?:(?!\0\\d+~\x7F)[^\\s/=])*)(?:((?:\\s|\0\\d+c\x7F)*(?:=|\0\\d+~\x7F)(?:\\s|\0\\d+c\x7F)*)(?:(["'])(.*?)(\\3|$)|(\\S*)))?`,"gsu"),o="",a=s.exec(i),l=0,p=()=>{o&&(super.insertAt(new B(o,fs(e),r,n,{})),o="")};for(;a;){let{index:d,0:c,1:h,2:x,3:b,4:S,5:R,6:F}=a;if(o+=i.slice(l,d),/^(?:[\w:]|\0\d+[t!~{}+-]\x7F)(?:[\w:.-]|\0\d+[t!~{}+-]\x7F)*$/u.test(ne(h).trim())){let v=S!=null?S:F,I=[b,R],E=new He(On(e),t,h,x,v,I,r,n);p(),super.insertAt(E)}else o+=c;({lastIndex:l}=s),a=s.exec(i)}o+=i.slice(l),p()}}afterBuild(){if(this.type==="table-attrs"){let{parentNode:i}=this;this.setAttribute("name",(i==null?void 0:i.type)==="td"&&i.subtype==="caption"?"caption":i==null?void 0:i.type)}}getAttrTokens(i){return this.childNodes.filter(e=>e instanceof He&&(!i||e.name===i.toLowerCase().trim()))}getAttrToken(i){let e=this.getAttrTokens(i);return e[e.length-1]}getAttr(i){var e;return(e=this.getAttrToken(i))==null?void 0:e.getValue()}lint(i=this.getAbsoluteIndex()){let e=super.lint(i),{parentNode:t,length:r,childNodes:n}=this,s=new Map,o=new Set,a;if((t==null?void 0:t.type)==="html"&&t.closing&&this.text().trim()){a={start:i,...this.getRootNode().posFromIndex(i)};let l=N(this,a,"no-ignored","attributes of a closing tag");l.fix={range:[i,l.endIndex],text:""},e.push(l)}for(let l=0;l<r;l++){let p=n[l];if(p instanceof B&&p.text().trim()){a!=null||(a={start:i,...this.getRootNode().posFromIndex(i)});let d=w(p,a,"no-ignored","containing invalid attribute");d.suggestions=[{desc:"remove",range:[d.startIndex,d.endIndex],text:" "}],e.push(d)}else if(p instanceof He){let{name:d}=p;s.has(d)?(o.add(d),s.get(d).push(p)):d!=="class"&&s.set(d,[p])}}if(o.size>0){a!=null||(a={start:i,...this.getRootNode().posFromIndex(i)});for(let l of o)e.push(...s.get(l).map(p=>w(p,a,"no-duplicate",m.msg("duplicated $1 attribute",l))))}return e}print(){return String(this)?`<span class="wpb-${this.type}">${this.childNodes.map(i=>i.print(i instanceof B?{class:"attr-dirty"}:void 0)).join("")}</span>`:""}}});var _n={};M(_n,{PreToken:()=>Lr});var Lr,zn=k(()=>{"use strict";ge();A();P();Re();Lr=class extends T{constructor(e,t=m.getConfig(),r=[]){if(e){let n="<nowiki>",s="</nowiki>",{length:o}=n,a=e.indexOf(n),l=e.indexOf(s,a+o),p="";for(;a!==-1&&l!==-1;)new V(n,t,r),new V(s,t,r),p+=`${e.slice(0,a)}\0${r.length-1}c\x7F${e.slice(a+o,l)}\0${r.length}c\x7F`,e=e.slice(l+o+1),a=e.indexOf(n),l=e.indexOf(s,a+o);e=`${p}${e}`}super(e,t,r,{});f(this,"type","ext-inner");this.setAttribute("stage",10)}getAttribute(e){return e==="plain"||super.getAttribute(e)}}});var Mn={};M(Mn,{ParamTagToken:()=>ft});var ft,Rr=k(()=>{"use strict";q();A();P();xe();ft=class extends T{constructor(e,t=m.getConfig(),r=[],n={}){super(void 0,t,r,{});f(this,"type","ext-inner");if(e){let s=B;this.append(...e.split(`
`).map(o=>new s(o,"param-line",t,r,{})))}}toString(){return super.toString(`
`)}text(){return super.text(`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let t;return this.childNodes.filter(r=>{let{childNodes:n}=r,s=n.findIndex(({type:a})=>a!=="text"),o=(s>=0?n.slice(0,s).map(String).join(""):String(r)).trim();return o&&!(s>=0?/^[a-z]+(?:\[\])?\s*(?:=|$)/iu:/^[a-z]+(?:\[\])?\s*=/iu).test(o)}).map(r=>{t!=null||(t={start:e,...this.getRootNode().posFromIndex(e)});let n=w(r,t,"no-ignored",m.msg("invalid parameter of <$1>",this.name));return n.suggestions=[{desc:"remove",range:[n.startIndex,n.endIndex],text:""}],n})}print(){return super.print({sep:`
`})}}});var ce,xt=k(()=>{"use strict";A();P();ce=class extends T{constructor(i,e,t="plain",r=m.getConfig(),n=[],s){super(i,r,n,s),this.type=t}lint(){return[]}}});var Tt,De,Gt,Ve,Pr=k(()=>{"use strict";q();A();P();xt();Ve=class extends T{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);y(this,De);f(this,"type","heading");y(this,Tt,void 0);C(this,Tt,e);let s=new T(t[0],r,n);s.type="heading-title",s.setAttribute("stage",2);let o=new ce(t[1],/^[^\S\n]*$/u,"heading-trail",r,n,{});this.append(s,o)}get level(){return u(this,Tt)}toString(){let e=u(this,De,Gt);return`${e}${String(this.firstChild)}${e}${String(this.lastChild)}`}text(){let e=u(this,De,Gt);return`${e}${this.firstChild.text()}${e}`}getAttribute(e){return e==="padding"?this.level:super.getAttribute(e)}getGaps(){return this.level}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),{firstChild:r,level:n}=this,s=String(r),o=r.childNodes.filter(d=>d.type==="quote"),a=o.filter(({bold:d})=>d),l=o.filter(({italic:d})=>d),p;return this.level===1&&(p={start:e,...this.getRootNode().posFromIndex(e)},t.push(w(r,p,"h1","<h1>"))),(s.startsWith("=")||s.endsWith("="))&&(p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(r,p,"unbalanced-header",m.msg("unbalanced $1 in a section header",'"="')))),this.closest("html-attrs, table-attrs")&&(p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)}),t.push(N(this,p,"parsing-order","section header in a HTML tag"))),a.length%2&&(p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(a[a.length-1],{...p,start:e+n,left:p.left+n},"format-leakage",m.msg("unbalanced $1 in a section header","bold apostrophes")))),l.length%2&&(p!=null||(p={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(l[l.length-1],{start:e+n},"format-leakage",m.msg("unbalanced $1 in a section header","italic apostrophes")))),t}print(){let e=u(this,De,Gt);return super.print({pre:e,sep:e})}json(){let e=super.json();return e.level=this.level,e}};Tt=new WeakMap,De=new WeakSet,Gt=function(){return"=".repeat(this.level)}});var xs,qt,Wn=k(()=>{"use strict";D();q();A();P();xs=g=>g.text().replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),qt=class extends T{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);f(this,"type","parameter");let s=new T(typeof e=="number"?void 0:e,r,n,{}),o=new T(t,r,n);s.type="parameter-key",o.type="parameter-value",o.setAttribute("stage",2),this.append(s,o)}get anon(){return this.firstChild.length===0}afterBuild(){if(!this.anon){let{parentNode:e,firstChild:t}=this,r=xs(t);this.setAttribute("name",r),e&&e.getArgs(r,!1,!1).add(this)}}toString(){return this.anon?String(this.lastChild):super.toString("=")}text(){return this.anon?this.lastChild.text():super.text("=")}getGaps(){return this.anon?0:1}lint(e=this.getAbsoluteIndex()){var s;let t=super.lint(e),{firstChild:r}=this,n=(s=new RegExp(`https?://${ye}${ve}$`,"iu").exec(r.text()))==null?void 0:s[0];if(n&&new URL(n).search){let o=w(r,{start:e},"unescaped","unescaped query string in an anonymous parameter");o.startIndex=o.endIndex,o.startLine=o.endLine,o.startCol=o.endCol,o.endIndex++,o.endCol++,o.fix={range:[o.startIndex,o.endIndex],text:"{{=}}"},t.push(o)}return t}print(){return super.print({sep:this.anon?"":"="})}json(){let e=super.json();return e.anon=this.anon,e}}});var Ts,Pe,Ge,Bt,Un,Ot,Hn,jt,Dn=k(()=>{"use strict";D();q();Le();ge();A();P();Wn();xe();xt();Ts=new Set(["pageid","articlepath","server","servername","scriptpath","stylepath"]),jt=class extends T{constructor(e,t,r=m.getConfig(),n=[]){var c,h;super(void 0,r,n,{});y(this,Bt);y(this,Ot);f(this,"type","template");f(this,"modifier","");y(this,Pe,!1);y(this,Ge,new Map);let{parserFunction:[s,o]}=r,a=(c=/^(?:\s|\0\d+c\x7F)*\0\d+s\x7F/u.exec(e))==null?void 0:c[0];if(a)this.setAttribute("modifier",a),e=e.slice(a.length);else if(e.includes(":")){let[x,...b]=e.split(":"),[S]=/^(?:\s|\0\d+c\x7F)*/u.exec((h=b[0])!=null?h:"");this.setModifier(`${x}:${S}`)&&(e=b.join(":").slice(S.length))}let l=e.includes(":");if(l||t.length===0&&!u(this,Pe)){let[x,...b]=e.split(":"),S=ne(x),R=S[b.length>0?"trimStart":"trim"](),F=R.toLowerCase(),v=s[F],I=o.includes(R);if(I||Ts.has(v)||l&&v){this.setAttribute("name",v!=null?v:F),this.type="magic-word";let G=new RegExp(`^\\s*${R}\\s*$`,I?"u":"iu"),_=new ce(x,G,"magic-word-name",r,n,{});if(super.insertAt(_),b.length>0&&t.unshift([b.join(":")]),this.name==="invoke")for(let Y=0;Y<2;Y++){let H=t.shift();if(!H)break;let he=new B(H.join("="),`invoke-${Y?"function":"module"}`,r,n);super.insertAt(he)}}}if(this.type==="template"){let x=ne(wt(e)).split("#")[0].trim();if(!x||/^:[\s_]*:|\0\d+[eh!+-]\x7F|[<>[\]{}\n]|%[\da-f]{2}/iu.test(x))throw n.pop(),new SyntaxError("\u975E\u6CD5\u7684\u6A21\u677F\u540D\u79F0");let b=new B(e,"template-name",r,n,{});super.insertAt(b)}let p=this.isTemplate(),d=1;for(let x=0;x<t.length;x++){let b=t[x];!p&&!(this.name==="switch"&&x>0)&&(b[0]=b.join("="),b.length=1),b.length===1&&(b.unshift(d),d++),this.insertAt(new qt(...b,r,n))}this.seal("modifier")}setModifier(e){let{parserFunction:[,,t,r]}=this.getAttribute("config"),n=ne(e).trim();if(e&&!n.endsWith(":"))return!1;let s=n.slice(0,-1).toLowerCase(),o=t.includes(s),a=r.includes(s);return u(this,Pe)&&o||!u(this,Pe)&&(a||e==="")||(Ie.running||this.length>1)&&(o||a||e==="")?(this.setAttribute("modifier",e),C(this,Pe,o),!!e):!1}isTemplate(){return this.type==="template"||this.name==="invoke"}afterBuild(){this.modifier.includes("\0")&&this.setAttribute("modifier",this.buildFromStr(this.modifier,0))}toString(){return`{{${this.modifier}${this.type==="magic-word"?`${String(this.firstChild)}${this.length===1?"":":"}${this.childNodes.slice(1).map(String).join("|")}`:super.toString("|")}}}`}text(){let{childNodes:e,length:t,firstChild:r,modifier:n,type:s,name:o}=this;return s==="magic-word"&&o==="vardefine"?"":`{{${n}${s==="magic-word"?`${r.text()}${t===1?"":":"}${pe(e.slice(1),"|")}`:super.text("|")}}}`}getAttribute(e){switch(e){case"padding":return this.modifier.length+2;default:return super.getAttribute(e)}}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),{type:r,childNodes:n,length:s}=this,o;if(!this.isTemplate())return t;let a=L(this,Bt,Un).call(this);if(a.fragment!==void 0){o={start:e,...this.getRootNode().posFromIndex(e)};let p=n[r==="template"?0:1],d=w(p,o,"no-ignored","useless fragment"),c=p.childNodes.find(h=>h.type==="text"&&h.data.includes("#"));c&&(d.fix={range:[d.startIndex+c.getRelativeIndex()+c.data.indexOf("#"),d.endIndex],text:""}),t.push(d)}if(a.valid||(o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(n[1],o,"invalid-invoke","illegal module name"))),r==="magic-word"&&s===2)return o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),t.push(N(this,o,"invalid-invoke","missing module function")),t;let l=this.getDuplicatedArgs();return l.length>0&&(o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),t.push(...l.flatMap(([,p])=>p).map(p=>w(p,o,"no-duplicate","duplicated parameter")))),t}insertAt(e,t=this.length){return super.insertAt(e,t),e.anon?L(this,Ot,Hn).call(this,e):e.name&&this.getArgs(e.name,!1,!1).add(e),e}getAllArgs(){return this.childNodes.filter(Ee("parameter"))}getAnonArgs(){return this.getAllArgs().filter(({anon:e})=>e)}getArgs(e,t=!1,r=!0){let n=String(e).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),s;return u(this,Ge).has(n)?s=u(this,Ge).get(n):(s=new Set(this.getAllArgs().filter(({name:o})=>n===o)),u(this,Ge).set(n,s)),s}getDuplicatedArgs(){return[...u(this,Ge)].filter(([,{size:e}])=>e>1).map(([e,t])=>[e,[...t]])}getPossibleValues(){let{type:e,name:t,childNodes:r,constructor:{name:n}}=this;if(e==="template")throw new Error(`${n}.getPossibleValues \u65B9\u6CD5\u4EC5\u4F9B\u7279\u5B9A\u9B54\u672F\u5B57\u4F7F\u7528\uFF01`);let s;switch(t){case"if":case"ifexist":case"ifexpr":case"iferror":s=2;break;case"ifeq":s=3;break;default:throw new Error(`${n}.getPossibleValues \u65B9\u6CD5\u4EC5\u4F9B\u7279\u5B9A\u9B54\u672F\u5B57\u4F7F\u7528\uFF01`)}let o=r.slice(s,s+2).map(({childNodes:[,a]})=>a);for(let a=0;a<o.length;){let{length:l,0:p}=o[a].childNodes.filter(d=>d.text().trim());if(l===0)o.splice(a,1);else if(l>1||p.type!=="magic-word")a++;else try{let d=p.getPossibleValues();o.splice(a,1,...d),a+=d.length}catch(d){a++}}return o}print(){let{childNodes:e,length:t,firstChild:r,modifier:n,type:s}=this;return`<span class="wpb-${s}">{{${n}${s==="magic-word"?`${r.print()}${t===1?"":":"}${fe(e.slice(1),{sep:"|"})}`:fe(e,{sep:"|"})}}}</span>`}};Pe=new WeakMap,Ge=new WeakMap,Bt=new WeakSet,Un=function(){let e=this.type==="template",t=this.childNodes[e?0:1];return this.normalizeTitle(t.text(),e?10:828)},Ot=new WeakSet,Hn=function(e){let t=this.getAnonArgs(),r=typeof e!="number";for(let n=r?t.indexOf(e):e-1;n<t.length;n++){let s=t[n],{name:o}=s,a=String(n+1);o!==a&&(s.setAttribute("name",a),this.getArgs(a,!1,!1).add(s))}}});var _t,Vn=k(()=>{"use strict";Me();P();_t=class extends ue(T){constructor(){super(...arguments);f(this,"type","hidden")}}});var zt,Zn=k(()=>{"use strict";D();q();A();P();xe();Vn();zt=class extends T{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});f(this,"type","arg");for(let n=0;n<e.length;n++)if(n===0){let s=new B(e[n],"arg-name",t,r,{});super.insertAt(s)}else if(n>1){let s=new _t(e[n],t,r,{});super.insertAt(s)}else{let s=new T(e[n],t,r);s.type="arg-default",s.setAttribute("stage",2),super.insertAt(s)}}get default(){var e,t;return(t=(e=this.childNodes[1])==null?void 0:e.text())!=null?t:!1}toString(){return`{{{${super.toString("|")}}}}`}text(){return`{{{${pe(this.childNodes.slice(0,2),"|")}}}}`}getAttribute(e){return e==="padding"?3:super.getAttribute(e)}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let{childNodes:[t,r,...n]}=this;if(!this.getAttribute("include")){let o=N(this,{start:e},"no-arg","unexpected template argument");return r&&(o.fix={range:[e,o.endIndex],text:r.text()}),[o]}let s=t.lint(e+3);if(r&&s.push(...r.lint(e+4+String(t).length)),n.length>0){let o={start:e,...this.getRootNode().posFromIndex(e)};s.push(...n.map(a=>{let l=w(a,o,"no-ignored","invisible content inside triple braces");return l.startIndex--,l.startCol--,l.suggestions=[{desc:"remove",range:[l.startIndex,l.endIndex],text:""},{desc:"escape",range:[l.startIndex,l.startIndex+1],text:"{{!}}"}],l}))}return s}print(){return super.print({pre:"{{{",post:"}}}",sep:"|"})}json(){let e=super.json();return e.default=this.default,e}}});var Qn={};M(Qn,{parseBraces:()=>Gr});var Gr,qr=k(()=>{"use strict";D();A();Pr();Dn();Zn();Gr=(g,i=m.getConfig(),e=[])=>{var c,h,x,b,S,R;let t=`${(c=i.excludes)!=null&&c.includes("heading")?"":"^(\0\\d+c\x7F)*={1,6}|"}\\[\\[|\\{{2,}|-\\{(?!\\{)`,{parserFunction:[,,,r]}=i,n=[],s={"=":`
`,"{":"\\}{2,}|\\|","-":"\\}-","[":"\\]\\]"},o=new Map([["!","!"],["!!","+"],["(!","{"],["!)","}"],["!-","-"],["=","~"]]),a=new RegExp(t,"gmu"),l=a.exec(g),p=g.includes("}}"),d;for(;l||d!==void 0&&d<=g.length&&((x=(h=n[n.length-1])==null?void 0:h[0])!=null&&x.startsWith("="));){if(l!=null&&l[1]){let[,{length:W}]=l;l[0]=l[0].slice(W),l.index+=W}let{0:F,index:v}=l!=null?l:{0:`
`,index:g.length},I=(b=n.pop())!=null?b:{},{0:E,index:G,parts:_,findEqual:Y,pos:H}=I,he=F==="="&&Y,lt=W=>{_[_.length-1].push(W.slice(H,v))};if(F==="]]"||F==="}-")d=v+2;else if(F===`
`){d=v+1;let{pos:W,findEqual:ee}=(S=n[n.length-1])!=null?S:{};if(W===void 0||ee||ne(g.slice(W,G))!==""){let re=/^(={1,6})(.+)\1((?:\s|\0\d+c\x7F)*)$/u.exec(g.slice(G,v));re&&(g=`${g.slice(0,G)}\0${e.length}h\x7F${g.slice(v)}`,d=G+4+String(e.length).length,new Ve(re[1].length,re.slice(2),i,e))}}else if(F==="|"||he)d=v+1,lt(g),F==="|"&&_.push([]),I.pos=d,I.findEqual=F==="|",n.push(I);else if(F.startsWith("}}")){let W=F.slice(0,Math.min(E.length,3)),ee=E.length-W.length,{length:re}=e;d=v+W.length,lt(g);let Ne=!1,K="t";if(W.length===3){let $=_.map(me=>me.join("=")),ke=$.length>1&&ne($[1]).trim();new zt($,i,e),ke&&ke.endsWith(":")&&r.includes(ke.slice(0,-1).toLowerCase())&&(K="s")}else try{new jt(_[0][0],_.slice(1),i,e);let $=ne(_[0][0]).trim();o.has($)?K=o.get($):/^(?:filepath|(?:full|canonical)urle?):.|^server$/iu.test($)?K="m":/^#vardefine:./iu.test($)&&(K="c")}catch($){if($ instanceof SyntaxError&&$.message==="\u975E\u6CD5\u7684\u6A21\u677F\u540D\u79F0")Ne=!0;else throw $}Ne||(g=`${g.slice(0,G+ee)}\0${re}${K}\x7F${g.slice(d)}`,d=G+ee+3+String(re).length,ee>1?n.push({0:E.slice(0,ee),index:G,pos:G+ee,parts:[[]]}):ee===1&&g[G-1]==="-"&&n.push({0:"-{",index:G-1,pos:G+1,parts:[[]]}))}else d=v+F.length,F.startsWith("{")&&(l.pos=d,l.parts=[[]]),n.push(..."0"in I?[I]:[],l);p&&(p=g.slice(d).includes("}}"));let de=n[n.length-1];!p&&((R=de==null?void 0:de[0])!=null&&R.startsWith("{"))&&(n.pop(),de=n[n.length-1]),a=new RegExp(t+(de?`|${s[de[0][0]]}${de.findEqual?"|=":""}`:""),"gmu"),a.lastIndex=d,l=a.exec(g)}return g}});var Xn={};M(Xn,{InputboxToken:()=>jr});var jr,Kn=k(()=>{"use strict";qr();A();Rr();jr=class extends ft{constructor(i,e=m.getConfig(),t=[]){let r=Symbol("InputboxToken");t.push(r),i&&(i=Gr(i,e,t)),t.splice(t.indexOf(r),1),super(i,e,t,{})}}});var Ze,Br=k(()=>{"use strict";q();Me();A();Ae();Ze=class extends ue(Q){constructor(e,t=!0,r=m.getConfig(),n=[]){super(e,r,n);f(this,"type","comment");f(this,"closed");this.closed=t}getAttribute(e){return e==="padding"?4:super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){if(this.closed)return[];let t=N(this,{start:e},"unclosed-comment",m.msg("unclosed $1","HTML comment"));return t.fix={range:[t.endIndex,t.endIndex],text:"-->"},[t]}toString(){return`<!--${this.innerText}${this.closed?"-->":""}`}print(){return super.print({pre:"&lt;!--",post:this.closed?"--&gt;":""})}}});var Mt={};M(Mt,{NestedToken:()=>Or});var Or,Wt=k(()=>{"use strict";q();A();P();_r();Re();Br();Or=class extends T{constructor(e,t,r,n=m.getConfig(),s=[]){e=e==null?void 0:e.replace(t,(o,a,l,p,d)=>{let c=`\0${s.length+1}${a?"e":"c"}\x7F`;if(a)new Qe(a,l,p,d,n,s);else{let h=o.endsWith("-->");new Ze(o.slice(4,h?-3:void 0),h,n,s)}return c}).replace(/(^|\0\d+[ce]\x7F)([^\0]+)(?=$|\0\d+[ce]\x7F)/gu,(o,a,l)=>(new V(l,n,s),`${a}\0${s.length}c\x7F`));super(e,n,s,{});f(this,"type","ext-inner")}lint(e=this.getAbsoluteIndex()){let t;return[...super.lint(e),...this.childNodes.filter(r=>{if(r.type==="ext"||r.type==="comment")return!1;let n=String(r).trim();return n&&!/^<!--.*-->$/su.test(n)}).map(r=>{t!=null||(t={start:e,...this.getRootNode().posFromIndex(e)});let n=w(r,t,"no-ignored",m.msg("invalid content in <$1>",this.name));return n.suggestions=[{desc:"remove",range:[n.startIndex,n.endIndex],text:""},{desc:"comment",range:[n.startIndex,n.startIndex],text:`<!--${String(r)}-->`}],n})]}}});var qe,le,je,$e,Ut=k(()=>{"use strict";q();ge();A();P();xe();$e=class extends T{constructor(e,t,r=m.getConfig(),n=[],s="|"){super(void 0,r,n,{});y(this,qe,!0);y(this,le,void 0);y(this,je,void 0);if(this.insertAt(new B(e,"link-target",r,n,{})),t!==void 0){let o=new T(t,r,n,{});o.type="link-text",o.setAttribute("stage",10),this.insertAt(o)}C(this,le,s)}afterBuild(){C(this,je,this.getTitle()),u(this,le).includes("\0")&&C(this,le,this.buildFromStr(u(this,le),0))}setAttribute(e,t){e==="bracket"?C(this,qe,!!t):e==="title"?C(this,je,t):super.setAttribute(e,t)}toString(){let e=super.toString(u(this,le));return u(this,qe)?`[[${e}]]`:e}text(){let e=super.text("|");return u(this,qe)?`[[${e}]]`:e}getAttribute(e){return e==="title"?u(this,je):e==="padding"?2:super.getAttribute(e)}getGaps(e){return e===0?u(this,le).length:1}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),{childNodes:[r,n],type:s}=this,{encoded:o,fragment:a}=u(this,je),l;if(r.childNodes.some(({type:p})=>p==="template")&&(l={start:e,...this.getRootNode().posFromIndex(e)},t.push(w(r,l,"unknown-page","template in an internal link target","warning"))),o&&(l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)}),t.push(w(r,l,"url-encoding","unnecessary URL encoding in an internal link"))),s==="link"||s==="category"){let p=n==null?void 0:n.childNodes.find(d=>d.type==="text"&&d.data.includes("|"));if(p){l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)});let d=w(n,l,"pipe-like",'additional "|" in the link text',"warning");d.suggestions=[{desc:"escape",range:[d.startIndex+p.getRelativeIndex(),d.startIndex+p.getRelativeIndex()+p.data.length],text:p.data.replace(/\|/gu,"&#124;")}],t.push(d)}}if(s!=="link"&&a!==void 0){l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)});let p=w(r,l,"no-ignored","useless fragment"),d=r.childNodes.find(c=>c.type==="text"&&c.data.includes("#"));d&&(p.fix={range:[p.startIndex+d.getRelativeIndex()+d.data.indexOf("#"),p.endIndex],text:""}),t.push(p)}return t}getTitle(e=!1){return this.normalizeTitle(this.firstChild.text(),0,e,!0,!0)}print(){return super.print(u(this,qe)?{pre:"[[",post:"]]",sep:u(this,le)}:{sep:u(this,le)})}};qe=new WeakMap,le=new WeakMap,je=new WeakMap});function Jn(g,i,e,t=!1,r){i=i.trim();let n=i.replace(/\0\d+t\x7F/gu,"").trim();switch(g){case"width":return!n||/^(?:\d+x?|\d*x\d+)$/u.test(n);case"link":{if(!n||new RegExp(`^(?:(?:${e.protocol}|//)${ye}|\0\\d+m\x7F)${ve}$`,"iu").test(n))return i;n.startsWith("[[")&&n.endsWith("]]")&&(n=n.slice(2,-2));let o=m.normalizeTitle(n,0,!1,e,t,!0,!0);return o.valid&&o}case"lang":return(r==="svg"||r==="svgz")&&!/[^a-z\d-]/u.test(n);case"alt":case"class":case"manualthumb":return!0;case"page":return(r==="djvu"||r==="djv")&&Number(n)>0;default:return!Number.isNaN(Number(n))}}var bs,J,Dt,Yn,Ht,ei=k(()=>{"use strict";D();q();A();P();bs=new Set(["alt","link","lang","page","caption"]);Ht=class extends T{constructor(e,t,r=m.getConfig(),n=[]){var i=(...vl)=>(super(...vl),y(this,Dt),f(this,"type","image-parameter"),y(this,J,""),this);var l;let s,o=Object.entries(r.img).map(([p,d])=>[p,d,new RegExp(`^(\\s*)${p.replace("$1","(.*)")}(\\s*)$`,"u")]),a=o.find(([,p,d])=>(s=d.exec(e),s&&(s.length!==4||Jn(p,s[2],r,!0,t)!==!1)));if(a&&s){s.length===3?(i(void 0,r,n),C(this,J,e)):(i(s[2],r,n,{}),C(this,J,`${s[1]}${a[0]}${s[3]}`)),this.setAttribute("name",a[1]);return}i(e,{...r,excludes:[...(l=r.excludes)!=null?l:[],"list"]},n),this.setAttribute("name","caption"),this.setAttribute("stage",7)}get link(){return this.name==="link"?Jn("link",super.text(),this.getAttribute("config")):void 0}afterBuild(){var e;((e=this.parentNode)==null?void 0:e.type)==="gallery-image"&&!bs.has(this.name)&&this.setAttribute("name","invalid")}toString(){return u(this,J)?u(this,J).replace("$1",super.toString()):super.toString()}text(){return u(this,J)?u(this,J).replace("$1",super.text()).trim():super.text().trim()}getAttribute(e){return e==="plain"?this.name==="caption":e==="padding"?Math.max(0,u(this,J).indexOf("$1")):super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),{link:r,name:n}=this;if(n==="invalid"){let s=N(this,{start:e},"invalid-gallery","invalid gallery image parameter");s.fix={range:[e,e+s.endIndex],text:""},t.push(s)}else typeof r=="object"&&r.encoded&&t.push(N(this,{start:e},"url-encoding","unnecessary URL encoding in an internal link"));return t}getValue(){return this.name==="invalid"?this.text():L(this,Dt,Yn).call(this)||super.text()}print(){return u(this,J)?`<span class="wpb-image-parameter">${u(this,J).replace("$1",`<span class="wpb-image-caption">${fe(this.childNodes)}</span>`)}</span>`:super.print({class:"image-caption"})}};J=new WeakMap,Dt=new WeakSet,Yn=function(){return u(this,J)&&!u(this,J).includes("$1")}});var zr,Mr,Wr,ks,Xe,Vt,Ke,Ur=k(()=>{"use strict";D();q();A();Ut();ei();zr=new Set(["manualthumb","frameless","framed","thumbnail"]),Mr=new Set(["left","right","center","none"]),Wr=new Set(["baseline","sub","super","top","text-top","middle","bottom","text-bottom"]),ks=(g,i,e,t)=>{if(t===void 0)return[];let r=new RegExp(`${[g,i,e].map(bn).join("|")}`,"gu"),n=[],s=r.exec(t),o=0,a=0;for(;s;){let{0:l,index:p}=s;l!==e?o+=l===g?1:-1:o===0&&(n.push(t.slice(a,p)),{lastIndex:a}=r),s=r.exec(t)}return n.push(t.slice(a)),n},Ke=class extends $e{constructor(e,t,r=m.getConfig(),n=[],s="|"){super(e,void 0,r,n,s);y(this,Xe);f(this,"type","file");let{extension:o}=this.getTitle(!0);this.append(...ks("-{","}-","|",t).map(a=>new Ht(a,o,r,n)))}get extension(){return this.getTitle().extension}lint(e=this.getAbsoluteIndex()){var d;let t=super.lint(e),r=this.getAllArgs().filter(({childNodes:c})=>{let h=c.filter(x=>x.text().trim());return h.length!==1||h[0].type!=="arg"}),n=[...new Set(r.map(({name:c})=>c))].filter(c=>c!=="invalid"),s=n.filter(c=>zr.has(c)),o=n.filter(c=>Mr.has(c)),a=n.filter(c=>Wr.has(c));if(this.closest("ext-link-text")&&((d=this.getValue("link"))==null?void 0:d.trim())!==""&&t.push(N(this,{start:e},"nested-link","internal link in an external link")),r.length===n.length&&s.length<2&&o.length<2&&a.length<2)return t;let l={start:e,...this.getRootNode().posFromIndex(e)},p=(c,h)=>x=>w(x,l,"no-duplicate",m.msg(`${c} image $1 parameter`,h));for(let c of n){let h=r.filter(({name:x})=>x===c);c==="caption"&&(h=[...h.slice(0,-1).filter(x=>x.text()),...h.slice(-1)]),h.length>1&&t.push(...h.map(p("duplicated",c)))}return s.length>1&&t.push(...r.filter(({name:c})=>zr.has(c)).map(p("conflicting","frame"))),o.length>1&&t.push(...r.filter(({name:c})=>Mr.has(c)).map(p("conflicting","horizontal-alignment"))),a.length>1&&t.push(...r.filter(({name:c})=>Wr.has(c)).map(p("conflicting","vertical-alignment"))),t}getAllArgs(){return this.childNodes.slice(1)}getArgs(e){return this.getAllArgs().filter(({name:t})=>e===t)}getFrameArgs(){return L(this,Xe,Vt).call(this,zr,"\u6846\u67B6")}getHorizAlignArgs(){return L(this,Xe,Vt).call(this,Mr,"\u6C34\u5E73\u5BF9\u9F50")}getVertAlignArgs(){return L(this,Xe,Vt).call(this,Wr,"\u5782\u76F4\u5BF9\u9F50")}getArg(e){let t=this.getArgs(e);return t[t.length-1]}getValue(e){var t;return(t=this.getArg(e))==null?void 0:t.getValue()}};Xe=new WeakSet,Vt=function(e,t){return this.getAllArgs().filter(({name:n})=>e.has(n))}});var Zt,ti,Je,Hr=k(()=>{"use strict";q();ge();A();P();Ur();Je=class extends Ke{constructor(e,t,r,n=m.getConfig(),s=[]){let o;if(r!==void 0){o=new T(r,n,s),o.type="plain";for(let a=1;a<11;a++)o.parseOnce();s.splice(s.indexOf(o),1)}super(t,o==null?void 0:o.toString(),n,s);y(this,Zt);this.setAttribute("bracket",!1),this.type=`${e}-image`}getTitle(){let e=this.type==="imagemap-image";return this.normalizeTitle(String(this.firstChild),e?0:6,!0,!e)}getAttribute(e){return e==="padding"?0:super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),{ns:r,interwiki:n}=this.getAttribute("title");return(n||r!==6)&&t.push(N(this,{start:e},"invalid-gallery","invalid gallery image")),t}afterBuild(){L(this,Zt,ti).call(this,this.getTitle())}};Zt=new WeakSet,ti=function(e){this.setAttribute("title",e)}});var ni={};M(ni,{GalleryToken:()=>Dr});var Qt,ri,Dr,ii=k(()=>{"use strict";A();P();Hr();Re();Dr=class extends T{constructor(e,t=m.getConfig(),r=[]){var n;super(void 0,t,r,{});y(this,Qt);f(this,"type","ext-inner");for(let s of(n=e==null?void 0:e.split(`
`))!=null?n:[]){let o=/^([^|]+)(?:\|(.*))?/u.exec(s);if(!o){super.insertAt(s.trim()?new V(s,t):s);continue}let[,a,l]=o;L(this,Qt,ri).call(this,a)?super.insertAt(new Je("gallery",a,l,t,r)):super.insertAt(new V(s,t))}}toString(){return super.toString(`
`)}text(){return super.text(`
`).replace(/\n\s*\n/gu,`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let{top:t,left:r}=this.getRootNode().posFromIndex(e),n=[];for(let s=0;s<this.length;s++){let o=this.childNodes[s],a=String(o),{length:l}=a,p=a.trim(),d=t+s,c=s?0:r;o.type==="noinclude"&&p&&!/^<!--.*-->$/u.test(p)?n.push({rule:"no-ignored",message:m.msg("invalid content in <$1>","gallery"),severity:"error",startIndex:e,endIndex:e+l,startLine:d,endLine:d,startCol:c,endCol:c+l,suggestions:[{desc:"remove",range:[e,e+l],text:""},{desc:"comment",range:[e,e+l],text:`<!--${a}-->`}]}):o.type!=="noinclude"&&o.type!=="text"&&n.push(...o.lint(e)),e+=l+1}return n}print(){return super.print({sep:`
`})}};Qt=new WeakSet,ri=function(e){return this.normalizeTitle(e,6,!0,!0).valid}});var Ye,Vr=k(()=>{"use strict";q();Ut();Ye=class extends $e{constructor(){super(...arguments);f(this,"type","link")}lint(e=this.getAbsoluteIndex()){let t=super.lint(e);return this.closest("ext-link-text")&&t.push(N(this,{start:e},"nested-link","internal link in an external link")),t}}});var et,Zr=k(()=>{"use strict";q();A();P();et=class extends T{constructor(i,e=!1,t=m.getConfig(),r=[]){super(i,t,r,{}),this.type=e?"ext-link-url":"free-ext-link"}lint(i=this.getAbsoluteIndex()){let e=super.lint(i),t=`[\uFF0C\uFF1B\u3002\uFF1A\uFF01\uFF1F\uFF08\uFF09]+${this.type==="ext-link-url"?"|\\|+":""}`,r=new RegExp(t,"u"),n=new RegExp(t,"gu"),s;for(let o of this.childNodes){let{type:a,data:l}=o;if(a!=="text"||!r.test(l))continue;s!=null||(s={start:i,...this.getRootNode().posFromIndex(i)});let p=w(o,s,"unterminated-url","","warning");n.lastIndex=0;for(let d=n.exec(l);d;d=n.exec(l)){let{index:c,0:h}=d,x=l.slice(0,c).split(`
`),b=x.length,S=x[b-1].length,R=p.startIndex+c,F=p.startLine+b-1,v=b===1?p.startCol+S:S,I=h.startsWith("|"),E={...p,message:m.msg("$1 in URL",I?'"|"':"full-width punctuation"),startIndex:R,endIndex:R+h.length,startLine:F,endLine:F,startCol:v,endCol:v+h.length};I?h.length===1&&(E.suggestions=[{desc:"whitespace",range:[R,R+1],text:" "}]):E.suggestions=[{desc:"whitespace",range:[R,R],text:" "},{desc:"escape",range:[R,E.endIndex],text:encodeURI(h)}],e.push(E)}}return e}}});var Te,tt,Qr=k(()=>{"use strict";ge();q();A();P();Zr();tt=class extends T{constructor(e,t="",r="",n=m.getConfig(),s=[]){super(void 0,n,s,{});f(this,"type","ext-link");y(this,Te,void 0);if(this.insertAt(new et(e,!0,n,s)),C(this,Te,t),r){let o=new T(r,n,s,{});o.type="ext-link-text",o.setAttribute("stage",10),this.insertAt(o)}}toString(){return this.length===1?`[${super.toString()}${u(this,Te)}]`:`[${super.toString(u(this,Te))}]`}text(){return`[${super.text(" ")}]`}getAttribute(e){return e==="padding"?1:super.getAttribute(e)}getGaps(){return u(this,Te).length}lint(e=this.getAbsoluteIndex()){let t=super.lint(e);return this.length===1&&this.closest("heading-title")&&t.push(N(this,{start:e},"var-anchor","variable anchor in a section header")),t}print(){return super.print(this.length===1?{pre:"[",post:`${u(this,Te)}]`}:{pre:"[",sep:u(this,Te),post:"]"})}};Te=new WeakMap});var bt,si=k(()=>{"use strict";A();P();Re();Vr();Qr();bt=class extends T{constructor(e,t,r,n=m.getConfig(),s=[]){super(void 0,n,s);f(this,"type","imagemap-link");this.append(e,t.length===2?new Ye(...t,n,s):new tt(...t,n,s),new V(r,n,s))}}});var oi={};M(oi,{ImagemapToken:()=>Xr});var Xr,ai=k(()=>{"use strict";q();Le();A();P();Re();Hr();si();Xr=class extends T{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});f(this,"type","ext-inner");if(!e)return;let n=e.split(`
`),s=new Set(t.protocol.split("|")),o=V,a=!0,l=!1;for(let p of n){let d=p.trim();if(!(l||!d||d.startsWith("#"))){if(a){let[c,...h]=p.split("|"),x=this.normalizeTitle(c,0,!0);if(x.valid&&!x.interwiki&&x.ns===6){let b=new Je("imagemap",c,h.length>0?h.join("|"):void 0,t,r);super.insertAt(b),a=!1;continue}else l=!0}else if(p.trim().split(/[\t ]/u)[0]==="desc"){super.insertAt(p);continue}else if(p.includes("[")){let c=p.indexOf("["),h=p.slice(c),x=/^\[{2}([^|]+)(?:\|([^\]]+))?\]{2}[\w\s]*$/u.exec(h);if(x){if(this.normalizeTitle(x[1],0,!0,!1,!0).valid){super.insertAt(new bt(p.slice(0,c),x.slice(1),h.slice(h.indexOf("]]")+2),t,r));continue}}else if(s.has(h.slice(1,h.indexOf(":")+1))||s.has(h.slice(1,h.indexOf("//")+2))){let b=/^\[([^\]\s]+)(?:(\s+(?=\S))([^\]]*))?\][\w\s]*$/u.exec(h);if(b){super.insertAt(new bt(p.slice(0,c),b.slice(1),h.slice(h.indexOf("]")+1),t,r));continue}}}}super.insertAt(new o(p,t,r))}}get image(){return this.childNodes.find(Ee("imagemap-image"))}toString(){return super.toString(`
`)}text(){return super.text(`
`).replace(/\n{2,}/gu,`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),r={start:e,...this.getRootNode().posFromIndex(e)};return this.image?t.push(...this.childNodes.filter(n=>{let s=String(n).trim();return n.type==="noinclude"&&s&&!s.startsWith("#")}).map(n=>w(n,r,"invalid-imagemap","invalid link in <imagemap>"))):t.push(N(this,r,"invalid-imagemap","<imagemap> without an image")),t}print(){return super.print({sep:`
`})}}});var li,Qe,_r=k(()=>{"use strict";q();A();P();Ir();Pt();li=(g,i)=>{let e=new Set(g);return e.delete(i),[...e]},Qe=class extends We{constructor(e,t,r,n,s=m.getConfig(),o=[]){var c;let a=e.toLowerCase(),l=new we(!t||t.trimStart()!==t?t:` ${t}`,"ext-attrs",a,s,o),p={...s,ext:li(s.ext,a),excludes:[...(c=s.excludes)!=null?c:[]]},d;switch(p.inExt=!0,a){case"tab":p.ext=li(p.ext,"tabs");case"indicator":case"poem":case"ref":case"option":case"combooption":case"tabs":case"poll":case"seo":a==="poem"&&p.excludes.push("heading"),d=new T(r,p,o);break;case"pre":{let{PreToken:h}=(zn(),j(_n));d=new h(r,p,o);break}case"dynamicpagelist":{let{ParamTagToken:h}=(Rr(),j(Mn));d=new h(r,p,o);break}case"inputbox":{p.excludes.push("heading");let{InputboxToken:h}=(Kn(),j(Xn));d=new h(r,p,o);break}case"references":{let{NestedToken:h}=(Wt(),j(Mt));d=new h(r,/<!--.*?(?:-->|$)|<(ref)(\s[^>]*)?>(.*?)<\/(ref\s*)>/gisu,["ref"],p,o);break}case"choose":{let{NestedToken:h}=(Wt(),j(Mt));d=new h(r,/<(option|choicetemplate)(\s[^>]*)?>(.*?)<\/(\1)>/gsu,["option","choicetemplate"],p,o);break}case"combobox":{let{NestedToken:h}=(Wt(),j(Mt));d=new h(r,/<(combooption)(\s[^>]*)?>(.*?)<\/(combooption\s*)>/gisu,["combooption"],p,o);break}case"gallery":{let{GalleryToken:h}=(ii(),j(ni));d=new h(r,p,o);break}case"imagemap":{let{ImagemapToken:h}=(ai(),j(oi));d=new h(r,p,o);break}default:{let{NowikiToken:h}=(Fr(),j(Nr));d=new h(r,p)}}d.setAttribute("name",a),d.type="ext-inner";super(e,l,d,n,s,o);f(this,"type","ext");this.seal("closed",!0)}lint(e=this.getAbsoluteIndex()){let t=super.lint(e),r;return this.name!=="nowiki"&&this.closest("html-attrs, table-attrs")&&(r={start:e,...this.getRootNode().posFromIndex(e)},t.push(N(this,r,"parsing-order","extension tag in HTML tag attributes"))),this.name==="ref"&&this.closest("heading-title")&&(r!=null||(r={start:e,...this.getRootNode().posFromIndex(e)}),t.push(N(this,r,"var-anchor","variable anchor in a section header"))),t}}});var di={};M(di,{parseCommentAndExt:()=>ys});var ys,gi=k(()=>{"use strict";A();Fn();Re();In();_r();Br();ys=(g,i=m.getConfig(),e=[],t=!1)=>{let r="<onlyinclude>",n="</onlyinclude>",{length:s}=r,o=()=>{let c=g.indexOf(r);return{i:c,j:g.indexOf(n,c+s)}};if(t){let{i:c,j:h}=o();if(c!==-1&&h!==-1){let x="",b=S=>{new V(S,i,e),x+=`\0${e.length-1}c\x7F`};for(;c!==-1&&h!==-1;){let S=`\0${e.length}e\x7F`;new Ft(g.slice(c+s,h),i,e),c>0&&b(g.slice(0,c)),x+=S,g=g.slice(h+s+1),{i:c,j:h}=o()}return g&&b(g),x}}let a=i.ext.join("|"),l=t?"includeonly":"(?:no|only)include",p=t?"noinclude":"includeonly",d=new RegExp(`<!--.*?(?:-->|$)|<${l}(?:\\s[^>]*)?>|</${l}\\s*>|<(${a})(\\s[^>]*?)?(?:/>|>(.*?)</(\\1\\s*)>)|<(${p})(\\s[^>]*?)?(?:/>|>(.*?)(?:</(${p}\\s*)>|$))`,"gisu");return g.replace(d,(c,h,x,b,S,R,F,v,I)=>{let E=`\0${e.length}${h?"e":"c"}\x7F`;if(h)new Qe(h,x,b,S,i,e);else if(c.startsWith("<!--")){let G=c.endsWith("-->");new Ze(c.slice(4,G?-3:void 0),G,i,e)}else R?new It(R,F,v,I,i,e):new V(c,i,e);return E})}});var vs,As,Ss,rt,se,Ce,Xt,pi=k(()=>{"use strict";q();D();A();P();vs=new Set(["if","ifeq","ifexpr","ifexist","iferror","switch"]),As=new Set(["b","big","center","cite","code","del","dfn","em","font","i","ins","kbd","mark","pre","q","s","samp","small","strike","strong","sub","sup","tt","u","var"]),Ss=new Set(["strike","big","center","font","tt"]),Xt=class extends T{constructor(e,t,r,n,s=m.getConfig(),o=[]){super(void 0,s,o);f(this,"type","html");y(this,rt,void 0);y(this,se,void 0);y(this,Ce,void 0);this.insertAt(t),this.setAttribute("name",e.toLowerCase()),C(this,rt,r),C(this,se,n),C(this,Ce,e)}get selfClosing(){return u(this,se)}get closing(){return u(this,rt)}toString(){return`<${this.closing?"/":""}${u(this,Ce)}${super.toString()}${u(this,se)?"/":""}>`}text(){let{closing:e}=this,t=`${u(this,Ce)}${e?"":super.text()}`;return`<${e?"/":""}${t}${u(this,se)?"/":""}>`}getAttribute(e){return e==="padding"?u(this,Ce).length+(this.closing?2:1):super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){var n;let t=super.lint(e),r;this.name==="h1"&&!this.closing&&(r=N(this,{start:e},"h1","<h1>"),t.push(r)),this.closest("table-attrs")&&(r!=null||(r=N(this,{start:e},"h1","")),t.push({...r,rule:"parsing-order",message:m.msg("HTML tag in table attributes")}));try{this.findMatchingTag()}catch(s){if(s instanceof SyntaxError){let{message:o}=s;r!=null||(r=N(this,{start:e},"h1",""));let[a]=o.split(":"),l={...r,rule:"unmatched-tag",message:m.msg(a)};if(a==="unclosed tag"&&!this.closest("heading-title"))if(As.has(this.name)){let p=(n=this.parentNode)==null?void 0:n.childNodes,d=p==null?void 0:p.indexOf(this);p!=null&&p.slice(0,d).some(({type:c,name:h})=>c==="html"&&h===this.name)||(l.severity="warning")}else l.severity="warning";else if(a==="unmatched closing tag"){let p=this.closest("magic-word");p&&vs.has(p.name)?l.severity="warning":l.suggestions=[{desc:"remove",range:[e,l.endIndex],text:""}]}else if(a==="tag that is both closing and self-closing"){let{html:[,,p]}=this.getAttribute("config");p.includes(this.name)&&(l.fix={range:[e+1,e+2],text:""})}t.push(l)}}return Ss.has(this.name)&&(r!=null||(r=N(this,{start:e},"h1","")),t.push({...r,rule:"obsolete-tag",message:m.msg("obsolete HTML tag"),severity:"warning"})),(this.name==="b"||this.name==="strong")&&this.closest("heading-title")&&(r!=null||(r=N(this,{start:e},"h1","")),t.push({...r,rule:"bold-header",message:m.msg("bold in section header"),severity:"warning"})),t}findMatchingTag(){let{html:[e,t,r]}=this.getAttribute("config"),{name:n,parentNode:s,closing:o}=this,a=kn(String(this));if(o&&(u(this,se)||r.includes(n)))throw new SyntaxError(`tag that is both closing and self-closing: ${a}`);if(r.includes(n)||u(this,se)&&t.includes(n))return this;if(u(this,se)&&e.includes(n))throw new SyntaxError(`invalid self-closing tag: ${a}`);if(!s)return;let{childNodes:l}=s,p=l.indexOf(this),d=(o?l.slice(0,p).reverse():l.slice(p+1)).filter(h=>h.type==="html"&&h.name===n),c=o?-1:1;for(let h of d)if(u(h,rt)?c--:c++,c===0)return h;throw new SyntaxError(`${o?"unmatched closing":"unclosed"} tag: ${a}`)}print(){return super.print({pre:`&lt;${this.closing?"/":""}${u(this,Ce)}`,post:`${u(this,se)?"/":""}&gt;`})}json(){let e=super.json();return Object.assign(e,{closing:this.closing,selfClosing:u(this,se)}),e}};rt=new WeakMap,se=new WeakMap,Ce=new WeakMap});var ui={};M(ui,{parseHtml:()=>ws});var ws,ci=k(()=>{"use strict";A();Pt();pi();ws=(g,i=m.getConfig(),e=[])=>{let t=/^(\/?)([a-z][^\s/>]*)((?:\s|\/(?!>))[^>]*?)?(\/?>)([^<]*)$/iu,r=new Set(i.html.flat()),n=g.split("<"),s=n.shift();for(let o of n){let a=t.exec(o),l=a==null?void 0:a[2],p=l==null?void 0:l.toLowerCase();if(!a||!r.has(p)){s+=`<${o}`;continue}let[,d,,c="",h,x]=a,b=new we(c,"html-attrs",p,i,e),S=b.getAttr("itemprop");if(p==="meta"&&(S===void 0||b.getAttr("content")===void 0)||p==="link"&&(S===void 0||b.getAttr("href")===void 0)){s+=`<${o}`,e.pop();continue}s+=`\0${e.length}x\x7F${x}`,new Xt(l,b,d==="/",h==="/>",i,e)}return s}});var nt,Kr=k(()=>{"use strict";A();P();xt();Pt();nt=class extends T{constructor(i,e,t,r=m.getConfig(),n=[],s={}){super(void 0,r,n,s),this.append(new ce(e,i,"table-syntax",r,n,{}),new we(t,"table-attrs",this.type,r,n))}}});var it,Jr=k(()=>{"use strict";q();Le();Kr();it=class extends nt{lint(i=this.getAbsoluteIndex()){let e=super.lint(i),t=this.childNodes.find(({type:l})=>l==="table-inter");if(!t)return e;let r=t.childNodes.find(l=>l.text().trim()),n=/^\s*(?:!|\{\{\s*![!-]?\s*\}\})/u,s=Ee("arg"),o=Ee("magic-word");if(!r||n.test(String(r))||s(r)&&n.test(r.default||""))return e;if(o(r))try{if(r.getPossibleValues().every(l=>n.test(l.text())))return e}catch(l){}let a=w(t,{start:i},"fostered-content","content to be moved out from the table");return a.severity=r.type==="template"?"warning":"error",a.startIndex++,a.startLine++,a.startCol=0,e.push(a),e}}});var $s,Kt,hi=k(()=>{"use strict";q();Le();A();Jr();xt();$s=/^\n[^\S\n]*(?:\|\}|\{\{\s*!\s*\}\}\}|\{\{\s*!\)\s*\}\})$/u,Kt=class extends it{constructor(e,t,r=m.getConfig(),n=[]){super(/^(?:\{\||\{\{\{\s*!\s*\}\}|\{\{\s*\(!\s*\}\})$/u,e,t,r,n,{});f(this,"type","table")}get closed(){return this.lastChild.type==="table-syntax"}lint(e=this.getAbsoluteIndex()){let t=super.lint(e);return this.closed||t.push(w(this.firstChild,{start:e},"unclosed-table",m.msg("unclosed $1","table"))),t}close(e=`
|}`,t=!1){let r=this.getAttribute("config"),n=this.getAttribute("accum"),s=t?[e]:m.parse(e,this.getAttribute("include"),2,r).childNodes,o=Ie.run(()=>super.insertAt(new ce(void 0,$s,"table-syntax",r,n,{})));t||o.afterBuild(),this.lastChild.replaceChildren(...s)}json(){let e=super.json();return e.closed=this.closed,e}}});var Jt,mi=k(()=>{"use strict";A();Jr();Jt=class extends it{constructor(e,t,r=m.getConfig(),n=[]){super(/^\n[^\S\n]*(?:\|-+|\{\{\s*!\s*\}\}-+|\{\{\s*!-\s*\}\}-*)$/u,e,t,r,n,{});f(this,"type","tr")}}});var oe,er,fi,Yt,xi=k(()=>{"use strict";q();ge();A();P();Kr();Yt=class extends nt{constructor(e,t,r=m.getConfig(),n=[]){var l;let s=/\||\0\d+!\x7F/u.exec(t!=null?t:""),o=s?t.slice(0,s.index):"";/\[\[|-\{/u.test(o)&&(s=null,o="");super(/^(?:\n[^\S\n]*(?:[|!]|\|\+|\{\{\s*!\s*\}\}\+?)|(?:\||\{\{\s*!\s*\}\}){2}|!!|\{\{\s*!!\s*\}\})$/u,e,o,r,n);y(this,er);f(this,"type","td");y(this,oe,"");s&&([St(this,oe)._]=s);let a=new T(t==null?void 0:t.slice(((l=s==null?void 0:s.index)!=null?l:NaN)+u(this,oe).length),r,n);a.type="td-inner",a.setAttribute("stage",4),this.insertAt(a)}get subtype(){return L(this,er,fi).call(this).subtype}afterBuild(){u(this,oe).includes("\0")&&C(this,oe,this.buildFromStr(u(this,oe),0))}toString(){let{childNodes:[e,t,r]}=this;return`${String(e)}${String(t)}${u(this,oe)}${String(r)}`}text(){let{childNodes:[e,t,r]}=this;return`${e.text()}${t.text()}${u(this,oe)}${r.text()}`}getGaps(e){return e===1?u(this,oe).length:0}lint(e=this.getAbsoluteIndex()){let t=super.lint(e);e+=this.getRelativeIndex(this.length-1);for(let r of this.lastChild.childNodes)if(r.type==="text"){let{data:n}=r;if(n.includes("|")){let s=n.includes("||"),o=w(r,{start:e},"pipe-like",'additional "|" in a table cell',s?"error":"warning");if(s){let a={caption:"|+",td:"|",th:"!"}[this.subtype];o.fix={range:[o.startIndex,o.endIndex],text:n.replace(/\|\|/gu,`
${a}`)}}else o.suggestions=[{desc:"escape",range:[o.startIndex,o.endIndex],text:n.replace(/\|/gu,"&#124;")}];t.push(o)}}return t}print(){let{childNodes:[e,t,r]}=this;return`<span class="wpb-td">${e.print()}${t.print()}${u(this,oe)}${r.print()}</span>`}json(){let e=super.json();return e.subtype=this.subtype,e}};oe=new WeakMap,er=new WeakSet,fi=function(){let e=this.firstChild.text(),t=e.slice(-1),r="td";return t==="!"?r="th":t==="+"&&(r="caption"),{subtype:r}}});var st,Yr=k(()=>{"use strict";Ae();st=class extends Q{}});var ot,en=k(()=>{"use strict";Yr();ot=class extends st{constructor(){super(...arguments);f(this,"type","dd")}}});var Ti={};M(Ti,{parseTable:()=>Ns});var Cs,Ns,bi=k(()=>{"use strict";A();P();hi();mi();xi();en();Cs=g=>g.lastChild.constructor!==T,Ns=({firstChild:{data:g},type:i,name:e},t=m.getConfig(),r=[])=>{let n=[],s=g.split(`
`),o=i==="root"||i==="parameter-value"||i==="ext-inner"&&e==="poem"?"":`
${s.shift()}`,a,l=(d,c)=>{if(!c){o+=d;return}let{lastChild:h}=c;if(Cs(c)){let x=new T(d,t,r);x.type="table-inter",x.setAttribute("stage",3),c.insertAt(x)}else h.setText(String(h)+d)},p=()=>a.type==="td"?n.pop():a;for(let d of s){a=n.pop();let[c]=/^(?:\s|\0\d+c\x7F)*/u.exec(d),h=d.slice(c.length),x=/^(:*)((?:\s|\0\d+c\x7F)*)(\{\||\{(?:\0\d+c\x7F)*\0\d+!\x7F|\0\d+\{\x7F)(.*)$/u.exec(h);if(x){for(;a&&a.type!=="td";)a=n.pop();let[,I,E,G,_]=x;I&&new ot(I,t,r),l(`
${c}${I&&`\0${r.length-1}d\x7F`}${E}\0${r.length}b\x7F`,a),n.push(...a?[a]:[],new Kt(G,_,t,r));continue}else if(!a){o+=`
${d}`;continue}let b=/^(?:(\|\}|\0\d+!\x7F\}|\0\d+\}\x7F)|(\|-+|\0\d+!\x7F-+|\0\d+-\x7F-*)(?!-)|(!|(?:\||\0\d+!\x7F)\+?))(.*)$/u.exec(h);if(!b){l(`
${d}`,a),n.push(a);continue}let[,S,R,F,v]=b;if(S){for(;a.type!=="table";)a=n.pop();a.close(`
${c}${S}`,!0),l(v,n[n.length-1])}else if(R){a=p(),a.type==="tr"&&(a=n.pop());let I=new Jt(`
${c}${R}`,v,t,r);n.push(a,I),a.insertAt(I)}else{a=p();let I=F==="!"?/!!|(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu:/(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu,E=I.exec(v),G=0,_=`
${c}${F}`,Y=H=>{let he=new Yt(_,v.slice(G,E==null?void 0:E.index),t,r);return H.insertAt(he),he};for(;E;)Y(a),{lastIndex:G}=I,[_]=E,E=I.exec(v);n.push(a,Y(a))}}return o.slice(1)}});var tr,ki=k(()=>{"use strict";Ae();tr=class extends Q{constructor(){super(...arguments);f(this,"type","hr")}}});var rr,yi=k(()=>{"use strict";Me();A();Ae();rr=class extends ue(Q){constructor(e,t,r=m.getConfig(),n=[]){super(e,r,n);f(this,"type","double-underscore")}getAttribute(e){return e==="padding"?2:super.getAttribute(e)}toString(){return`__${this.innerText}__`}print(){return super.print({pre:"__",post:"__"})}}});var vi={};M(vi,{parseHrAndDoubleUnderscore:()=>Fs});var Fs,Ai=k(()=>{"use strict";A();ki();yi();Pr();Fs=({firstChild:{data:g},type:i,name:e},t=m.getConfig(),r=[])=>{let{doubleUnderscore:n}=t,s=new Set(n[0]),o=new Set(n[1]);return i!=="root"&&(i!=="ext-inner"||e!=="poem")&&(g=`\0${g}`),g=g.replace(/^((?:\0\d+c\x7F)*)(-{4,})/gmu,(a,l,p)=>(new tr(p,t,r),`${l}\0${r.length-1}r\x7F`)).replace(new RegExp(`__(${n.flat().join("|")})__`,"giu"),(a,l)=>{let p=o.has(l);return p||s.has(l.toLowerCase())?(new rr(l,p,t,r),`\0${r.length-1}u\x7F`):a}).replace(/^((?:\0\d+c\x7F)*)(={1,6})(.+)\2((?:[^\S\n]|\0\d+c\x7F)*)$/gmu,(a,l,p,d,c)=>{let h=`${l}\0${r.length}h\x7F`;return new Ve(p.length,[d,c],t,r),h}),i==="root"||i==="ext-inner"&&e==="poem"?g:g.slice(1)}});var nr,Si=k(()=>{"use strict";Ut();nr=class extends $e{constructor(){super(...arguments);f(this,"type","category")}}});var ir,wi=k(()=>{"use strict";q();A();Ae();ir=class extends Q{constructor(){super(...arguments);f(this,"type","quote")}get bold(){return this.innerText.length!==2}get italic(){return this.innerText.length!==3}lint(e=this.getAbsoluteIndex()){let{previousSibling:t,nextSibling:r,bold:n}=this,s=m.msg('lonely "$1"',"'"),o=[],a;if((t==null?void 0:t.type)==="text"&&t.data.endsWith("'")){a=N(this,{start:e},"lonely-apos",s);let{startIndex:l,startLine:p,startCol:d}=a,[,{length:c}]=/(?:^|[^'])('+)$/u.exec(t.data),h=e-c;o.push({...a,startIndex:h,endIndex:l,startCol:d-c,endLine:p,endCol:d,suggestions:[{desc:"escape",range:[h,l],text:"&apos;".repeat(c)}]})}if((r==null?void 0:r.type)==="text"&&r.data.startsWith("'")){a!=null||(a=N(this,{start:e},"lonely-apos",s));let{endIndex:l,endLine:p,endCol:d}=a,[{length:c}]=/^'+/u.exec(r.data),h=l+c;o.push({...a,startIndex:l,endIndex:h,startLine:p,startCol:d,endCol:d+c,suggestions:[{desc:"escape",range:[l,h],text:"&apos;".repeat(c)}]})}return n&&this.closest("heading-title")&&(a!=null||(a=N(this,{start:e},"lonely-apos",s)),o.push({...a,rule:"bold-header",message:m.msg("bold in section header"),severity:"warning"})),o}json(){let e=super.json();return Object.assign(e,{bold:this.bold,italic:this.italic}),e}}});var tn={};M(tn,{parseQuotes:()=>Is});var Is,rn=k(()=>{"use strict";A();wi();Is=(g,i=m.getConfig(),e=[])=>{var p;let t=g.split(/('{2,})/u),{length:r}=t;if(r===1)return g;let n=0,s=0,o,a,l;for(let d=1;d<r;d+=2){let c=t[d].length;switch(c){case 2:s++;break;case 4:t[d-1]+="'",t[d]="'''";case 3:if(n++,o!==void 0)break;t[d-1].endsWith(" ")?a===void 0&&l===void 0&&(l=d):t[d-1].slice(-2,-1)===" "?o=d:a!=null||(a=d);break;default:t[d-1]+="'".repeat(c-5),t[d]="'''''",s++,n++}}if(s%2===1&&n%2===1){let d=(p=o!=null?o:a)!=null?p:l;d!==void 0&&(t[d]="''",t[d-1]+="'")}for(let d=1;d<r;d+=2)new ir(t[d],i,e),t[d]=`\0${e.length-1}q\x7F`;return t.join("")}});var Ci={};M(Ci,{parseLinks:()=>$i});var $i,Ni=k(()=>{"use strict";A();Vr();Ur();Si();$i=(g,i=m.getConfig(),e=[])=>{let{parseQuotes:t}=(rn(),j(tn)),r=i.inExt?/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)(.*?[^\]]))?\]\](.*)$/su:/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)(.*?[^\]])?)?\]\](.*)$/su,n=/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(\||\0\d+!\x7F)(.*)$/su,s=new RegExp(`^\\s*(?:${i.protocol}|//)`,"iu"),o=g.split("[["),a=o.shift();for(let l=0;l<o.length;l++){let p=!1,d,c,h,x,b=o[l],S=r.exec(b);if(S)[,d,c,h,x]=S,x.startsWith("]")&&(h!=null&&h.includes("["))&&(h+="]",x=x.slice(1));else{let _=n.exec(b);_&&(p=!0,[,d,c,h]=_)}if(d===void 0||s.test(d)||/\0\d+[exhbru]\x7F/u.test(d)){a+=`[[${b}`;continue}let R=d.trim().startsWith(":");if(R&&p){a+=`[[${b}`;continue}let F=m.normalizeTitle(d,0,!1,i,!0,!0,!0),{ns:v,valid:I,interwiki:E}=F;if(I){if(p){if(E||v!==6){a+=`[[${b}`;continue}let _=!1;for(l++;l<o.length;l++){let Y=o[l],H=Y.split("]]");if(H.length>2){_=!0,h+=`[[${H[0]}]]${H[1]}`,x=H.slice(2).join("]]");break}else if(H.length===2)h+=`[[${H[0]}]]${H[1]}`;else{h+=`[[${Y}`;break}}if(h=$i(h,i,e),!_){a+=`[[${d}${c}${h}`;continue}}}else{a+=`[[${b}`;continue}h&&(h=t(h,i,e)),a+=`\0${e.length}l\x7F${x}`;let G=Ye;R||(!E&&v===6?G=Ke:!E&&v===14&&(G=nr)),h===void 0&&c&&(h=""),new G(d,h,i,e,c)}return a}});var Fi={};M(Fi,{parseExternalLinks:()=>Es});var Es,Ii=k(()=>{"use strict";D();A();Qr();Es=(g,i=m.getConfig(),e=[])=>{let t=new RegExp(`\\[((?:(?:${i.protocol}|//)${ye}|\0\\d+m\x7F)${ve}(?=[[\\]<>"\\t\\p{Zs}]|\0\\d))(\\p{Zs}*(?=\\P{Zs}))([^\\]-\b
-\uFFFD]*)\\]`,"giu");return g.replace(t,(r,n,s,o)=>{let{length:a}=e,l=/&[lg]t;/u.exec(n);return l&&(n=n.slice(0,l.index),s="",o=`${n.slice(l.index)}${s}${o}`),new tt(n,s,o,i,e),`\0${a}w\x7F`})}});var Ei={};M(Ei,{parseMagicLinks:()=>Ls});var Ls,Li=k(()=>{"use strict";D();A();Zr();Ls=(g,i=m.getConfig(),e=[])=>{let t=new RegExp(`(^|[^\\p{L}\\d_])(?:${i.protocol})(${ye}${ve})`,"giu");return g.replace(t,(r,n,s)=>{let o="",a=n?r.slice(1):r,l=/&(?:lt|gt|nbsp|#x0*(?:3[ce]|a0)|#0*(?:6[02]|160));/iu.exec(a);l&&(o=a.slice(l.index),a=a.slice(0,l.index));let p=new RegExp(`[,;.:!?${a.includes("(")?"":")"}]+$`,"u"),d=p.exec(a);if(d){let c=0;d[0].startsWith(";")&&/&(?:[a-z]+|#x[\da-f]+|#\d+)$/iu.test(a.slice(0,d.index))&&(c=1),o=`${a.slice(d.index+c)}${o}`,a=a.slice(0,d.index+c)}return o.length>=s.length?r:(new et(a,!1,i,e),`${n}\0${e.length-1}w\x7F${o}`)})}});var sr,Ri=k(()=>{"use strict";Yr();sr=class extends st{constructor(){super(...arguments);f(this,"type","list")}}});var Pi={};M(Pi,{parseList:()=>Rs});var Rs,Gi=k(()=>{"use strict";A();Ri();en();Rs=(g,i=m.getConfig(),e=[])=>{let t=/^((?:\0\d+c\x7F)*)([;:*#]+)/u.exec(g);if(!t)return g;let[r,n,s]=t,o=`${n}\0${e.length}d\x7F${g.slice(r.length)}`,a=s.split(";").length-1;if(new sr(s,i,e),!a)return o;let{html:[l]}=i,p=/:+|-\{|\0\d+[xq]\x7F/gu,d=p,c=d.exec(o),h=0,x=!1,b=!1,S=0,R=(v,I)=>(new ot(v,i,e),`${o.slice(0,I)}\0${e.length-1}d\x7F${o.slice(I+v.length)}`),F=v=>{v?h&&h--:h++};for(;c&&a;){let{0:v,index:I}=c;if(v==="-{"){if(!S){let{lastIndex:E}=d;d=/-\{|\}-/gu,d.lastIndex=E}S++}else if(v==="}-"){if(S--,!S){let{lastIndex:E}=d;d=p,d.lastIndex=E}}else if(v.endsWith("x\x7F")){let{name:E,closing:G,selfClosing:_}=e[Number(v.slice(1,-2))];(!_||l.includes(E))&&F(G)}else if(v.endsWith("q\x7F")){let{bold:E,italic:G}=e[Number(v.slice(1,-2))];E&&(F(x),x=!x),G&&(F(b),b=!b)}else if(h===0){if(v.length>=a)return R(v.slice(0,a),I);a-=v.length,d.lastIndex=I+4+String(e.length).length,o=R(v,I)}c=d.exec(o)}return o}});var qi,be,or,ji=k(()=>{"use strict";q();A();P();xe();qi=new Set(["A","T","R","D","-","H","N"]),or=class extends T{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});f(this,"type","converter-flags");y(this,be,void 0);this.append(...e.map(n=>new B(n,"converter-flag",t,r)))}afterBuild(){C(this,be,this.childNodes.map(e=>e.text().trim()))}toString(){return super.toString(";")}text(){return super.text(";")}getGaps(){return 1}getUnknownFlags(){return new Set(u(this,be).filter(e=>/\{{3}[^{}]+\}{3}/u.test(e)))}getVariantFlags(){let e=new Set(this.getAttribute("config").variants);return new Set(u(this,be).filter(t=>e.has(t)))}lint(e=this.getAbsoluteIndex()){let t=this.getVariantFlags(),r=this.getUnknownFlags(),n=new Set(u(this,be).filter(c=>qi.has(c))),s=u(this,be).filter(c=>!c).length,o=u(this,be).length-r.size-s,a=super.lint(e);if(t.size===o||n.size===o)return a;let l={start:e,...this.getRootNode().posFromIndex(e)},{childNodes:p,length:d}=this;for(let c=0;c<d;c++){let h=p[c],x=h.text().trim();if(x&&!t.has(x)&&!r.has(x)&&(t.size>0||!n.has(x))){let b=w(h,l,"no-ignored","invalid conversion flag");t.size===0&&qi.has(x.toUpperCase())?b.fix={range:[b.startIndex,b.endIndex],text:x.toUpperCase()}:b.suggestions=[{desc:"remove",range:[b.startIndex,b.endIndex],text:""}],a.push(b)}}return a}print(){return super.print({sep:";"})}};be=new WeakMap});var at,Bi=k(()=>{"use strict";A();P();xe();at=class extends T{constructor(e,t=!0,r=m.getConfig(),n=[]){super(void 0,r,n);f(this,"type","converter-rule");let s=e.indexOf(":"),o=e.slice(0,s).indexOf("=>"),a=o===-1?e.slice(0,s):e.slice(o+2,s);t&&r.variants.includes(a.trim())?(super.insertAt(new B(a,"converter-rule-variant",r,n)),super.insertAt(new B(e.slice(s+1),"converter-rule-to",r,n)),o!==-1&&super.insertAt(new B(e.slice(0,o),"converter-rule-from",r,n),0)):super.insertAt(new B(e,"converter-rule-to",r,n))}toString(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`${String(t)}=>${String(r)}:${String(n)}`}return super.toString(":")}text(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`${t.text()}=>${r.text()}:${n.text()}`}return super.text(":")}getGaps(e){return e===0&&this.length===3?2:1}print(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`<span class="wpb-converter-rule">${t.print()}=>${r.print()}:${n.print()}</span>`}return super.print({sep:":"})}}});var ar,Oi=k(()=>{"use strict";D();A();P();ji();Bi();ar=class extends T{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);f(this,"type","converter");this.append(new or(e,r,n));let[s]=t,o=s.includes(":"),a=new at(s,o,r,n);o&&a.length===1?this.insertAt(new at(t.join(";"),!1,r,n)):this.append(a,...t.slice(1).map(l=>new at(l,!0,r,n)))}toString(){let{childNodes:[e,...t]}=this;return`-{${String(e)}${e.length>0?"|":""}${t.map(String).join(";")}}-`}text(){let{childNodes:[e,...t]}=this;return`-{${e.text()}|${pe(t,";")}}-`}getAttribute(e){return e==="padding"?2:super.getAttribute(e)}getGaps(e){return e||this.firstChild.length>0?1:0}print(){let{childNodes:[e,...t]}=this;return`<span class="wpb-converter">-{${e.print()}${e.length>0?"|":""}${fe(t,{sep:";"})}}-</span>`}}});var _i={};M(_i,{parseConverter:()=>Ps});var Ps,zi=k(()=>{"use strict";A();Oi();Ps=(g,i=m.getConfig(),e=[])=>{let t=/-\{/gu,r=/-\{|\}-/gu,n=[],s=t,o=s.exec(g);for(;o;){let{0:a,index:l}=o;if(a==="}-"){let p=n.pop(),{length:d}=e,c=g.slice(p.index+2,l),h=c.indexOf("|"),[x,b]=h===-1?[[],c]:[c.slice(0,h).split(";"),c.slice(h+1)],S=b.replace(/(&[#a-z\d]+);/giu,"$1"),R=`(?:${i.variants.join("|")})`,F=S.split(new RegExp(`;(?=(?:[^;]*?=>)?\\s*${R}\\s*:|(?:\\s|\0\\d+c\x7F)*$)`,"u")).map(v=>v.replace(/\x01/gu,";"));new ar(x,F,i,e),g=`${g.slice(0,p.index)}\0${d}v\x7F${g.slice(l+2)}`,n.length===0&&(s=t),s.lastIndex=p.index+3+String(d).length}else n.push(o),s=r,s.lastIndex=l+2;o=s.exec(g)}return g}});var sn={};M(sn,{Token:()=>T});var ae,O,z,Be,kt,nn,lr,Mi,dr,Wi,gr,Ui,pr,Hi,ur,Di,cr,Vi,hr,Zi,mr,Qi,fr,Xi,xr,Ki,Tr,Ji,on,T,P=k(()=>{"use strict";D();ge();A();Sn();Nn();on=class on extends $t{constructor(e,t=m.getConfig(),r=[],n){super();y(this,kt);y(this,lr);y(this,dr);y(this,gr);y(this,pr);y(this,ur);y(this,cr);y(this,hr);y(this,mr);y(this,fr);y(this,xr);y(this,Tr);f(this,"type","root");y(this,ae,0);y(this,O,void 0);y(this,z,void 0);y(this,Be,void 0);typeof e=="string"&&this.insertAt(e),C(this,O,t),C(this,z,r),r.push(this)}parseOnce(e=u(this,ae),t=!1){if(e<u(this,ae)||!this.getAttribute("plain")||this.length===0)return this;if(u(this,ae)>=11)return this;switch(e){case 0:this.type==="root"&&u(this,z).shift(),C(this,Be,t),L(this,lr,Mi).call(this,t);break;case 1:L(this,dr,Wi).call(this);break;case 2:L(this,gr,Ui).call(this);break;case 3:L(this,pr,Hi).call(this);break;case 4:L(this,ur,Di).call(this);break;case 5:L(this,cr,Vi).call(this);break;case 6:L(this,hr,Zi).call(this);break;case 7:L(this,mr,Qi).call(this);break;case 8:L(this,fr,Xi).call(this);break;case 9:L(this,xr,Ki).call(this);break;case 10:L(this,Tr,Ji).call(this)}if(this.type==="root")for(let r of u(this,z))r.parseOnce(e,t);return St(this,ae)._++,this}buildFromStr(e,t){let r=e.split(/[\0\x7F]/u).map((n,s)=>{if(s%2===0)return new ht(n);if(Number.isNaN(Number(n.slice(-1))))return u(this,z)[Number(n.slice(0,-1))];throw new Error(`\u89E3\u6790\u9519\u8BEF\uFF01\u672A\u6B63\u786E\u6807\u8BB0\u7684 Token\uFF1A${n}`)});return t===0?r.map(String).join(""):t===1?pe(r):r}afterBuild(){if(this.type==="root")for(let e of u(this,z))e.afterBuild()}parse(e=11,t=!1){for(e=Math.min(e,11);u(this,ae)<e;)this.parseOnce(u(this,ae),t);return e&&(L(this,kt,nn).call(this),this.afterBuild()),this}getAttribute(e){switch(e){case"plain":return this.constructor===on;case"config":return JSON.parse(JSON.stringify(u(this,O)));case"include":{if(u(this,Be)!==void 0)return u(this,Be);let t=this.getRootNode();return t!==this&&t.getAttribute("include")}case"accum":return u(this,z);default:return super.getAttribute(e)}}setAttribute(e,t){switch(e){case"stage":u(this,ae)===0&&this.type==="root"&&u(this,z).shift(),C(this,ae,t);break;default:super.setAttribute(e,t)}}insertAt(e,t=this.length){let r=typeof e=="string"?new ht(e):e;return super.insertAt(r,t),r.type==="root"&&(r.type="plain"),r}normalizeTitle(e,t=0,r=!1,n=!1,s=!1){return m.normalizeTitle(e,t,u(this,Be),u(this,O),r,n,s)}};ae=new WeakMap,O=new WeakMap,z=new WeakMap,Be=new WeakMap,kt=new WeakSet,nn=function(){var n;C(this,ae,11);let{length:e,firstChild:t}=this,r=String(t);if(e===1&&t.type==="text"&&r.includes("\0")&&(this.replaceChildren(...this.buildFromStr(r)),this.normalize(),this.type==="root"))for(let s of u(this,z))L(n=s,kt,nn).call(n)},lr=new WeakSet,Mi=function(e){let{parseCommentAndExt:t}=(gi(),j(di));this.setText(t(String(this.firstChild),u(this,O),u(this,z),e))},dr=new WeakSet,Wi=function(){let{parseBraces:e}=(qr(),j(Qn)),t=this.type==="root"?String(this.firstChild):`\0${String(this.firstChild)}`,r=e(t,u(this,O),u(this,z));this.setText(this.type==="root"?r:r.slice(1))},gr=new WeakSet,Ui=function(){var t;if((t=u(this,O).excludes)!=null&&t.includes("html"))return;let{parseHtml:e}=(ci(),j(ui));this.setText(e(String(this.firstChild),u(this,O),u(this,z)))},pr=new WeakSet,Hi=function(){var t;if((t=u(this,O).excludes)!=null&&t.includes("table"))return;let{parseTable:e}=(bi(),j(Ti));this.setText(e(this,u(this,O),u(this,z)))},ur=new WeakSet,Di=function(){var t;if((t=u(this,O).excludes)!=null&&t.includes("hr"))return;let{parseHrAndDoubleUnderscore:e}=(Ai(),j(vi));this.setText(e(this,u(this,O),u(this,z)))},cr=new WeakSet,Vi=function(){let{parseLinks:e}=(Ni(),j(Ci));this.setText(e(String(this.firstChild),u(this,O),u(this,z)))},hr=new WeakSet,Zi=function(){var r;if((r=u(this,O).excludes)!=null&&r.includes("quote"))return;let{parseQuotes:e}=(rn(),j(tn)),t=String(this.firstChild).split(`
`);for(let n=0;n<t.length;n++)t[n]=e(t[n],u(this,O),u(this,z));this.setText(t.join(`
`))},mr=new WeakSet,Qi=function(){var t;if((t=u(this,O).excludes)!=null&&t.includes("extLink"))return;let{parseExternalLinks:e}=(Ii(),j(Fi));this.setText(e(String(this.firstChild),u(this,O),u(this,z)))},fr=new WeakSet,Xi=function(){var t;if((t=u(this,O).excludes)!=null&&t.includes("magicLink"))return;let{parseMagicLinks:e}=(Li(),j(Ei));this.setText(e(String(this.firstChild),u(this,O),u(this,z)))},xr=new WeakSet,Ki=function(){var n;if((n=u(this,O).excludes)!=null&&n.includes("list"))return;let{parseList:e}=(Gi(),j(Pi)),t=String(this.firstChild).split(`
`),r=this.type==="root"||this.type==="ext-inner"&&this.name==="poem"?0:1;for(;r<t.length;r++)t[r]=e(t[r],u(this,O),u(this,z));this.setText(t.join(`
`))},Tr=new WeakSet,Ji=function(){if(u(this,O).variants.length>0){let{parseConverter:e}=(zi(),j(_i));this.setText(e(String(this.firstChild),u(this,O),u(this,z)))}};T=on});var Oe,Yi,Gs,m,A=k(()=>{hn();Le();ge();D();Oe={i18n:void 0,rules:cn,getConfig(){return{...fn,...this.config,excludes:[]}},msg(g,i=""){var e,t;return g&&((t=(e=this.i18n)==null?void 0:e[g])!=null?t:g).replace("$1",this.msg(i))},normalizeTitle(g,i=0,e=!1,t=Oe.getConfig(),r=!1,n=!1,s=!1){let{Title:o}=(vn(),j(yn));if(r)return new o(g,i,t,n,s);let{Token:a}=(P(),j(sn)),l=Ie.run(()=>new a(g,t).parseOnce(0,e).parseOnce());return new o(String(l),i,t,n,s)},parse(g,i,e=11,t=Oe.getConfig()){g=Tn(g);let{Token:r}=(P(),j(sn));return Ie.run(()=>new r(g,t).parse(e,i))}},Yi={},Gs=new Set(["normalizeTitle","parse"]);for(let g in Oe)Gs.has(g)||(Yi[g]={enumerable:!1});Object.defineProperties(Oe,Yi);typeof self=="object"?Object.assign(self,{Parser:Oe}):typeof globalThis=="object"&&Object.assign(globalThis,{Parser:Oe});m=Oe});A();})();
