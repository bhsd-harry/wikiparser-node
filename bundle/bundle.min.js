"use strict";(()=>{var jt=Object.defineProperty;var ws=Object.getOwnPropertyDescriptor;var Ss=Object.getOwnPropertyNames;var Cs=Object.prototype.hasOwnProperty;var Ns=(g,i,e)=>i in g?jt(g,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[i]=e;var y=(g,i)=>()=>(g&&(i=g(g=0)),i);var $s=(g,i)=>()=>(i||g((i={exports:{}}).exports,i),i.exports),W=(g,i)=>{for(var e in i)jt(g,e,{get:i[e],enumerable:!0})},Is=(g,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let r of Ss(i))!Cs.call(g,r)&&r!==e&&jt(g,r,{get:()=>i[r],enumerable:!(t=ws(i,r))||t.enumerable});return g};var M=g=>Is(jt({},"__esModule",{value:!0}),g);var x=(g,i,e)=>(Ns(g,typeof i!="symbol"?i+"":i,e),e),Rr=(g,i,e)=>{if(!i.has(g))throw TypeError("Cannot "+e)};var h=(g,i,e)=>(Rr(g,i,"read from private field"),e?e.call(g):i.get(g)),k=(g,i,e)=>{if(i.has(g))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(g):i.set(g,e)},S=(g,i,e,t)=>(Rr(g,i,"write to private field"),t?t.call(g,e):i.set(g,e),e);var Bt=(g,i,e,t)=>({set _(r){S(g,i,r,e)},get _(){return h(g,i,t)}}),$=(g,i,e)=>(Rr(g,i,"access private method"),e);var Cn,Nn=y(()=>{"use strict";Cn=["bold-header","format-leakage","fostered-content","h1","illegal-attr","insecure-style","invalid-gallery","invalid-imagemap","invalid-invoke","invalid-isbn","lonely-apos","lonely-bracket","lonely-http","nested-link","no-arg","no-duplicate","no-ignored","obsolete-attr","obsolete-tag","parsing-order","pipe-like","table-layout","tag-like","unbalanced-header","unclosed-comment","unclosed-quote","unclosed-table","unescaped","unknown-page","unmatched-tag","unterminated-url","url-encoding","var-anchor","void-ext"]});var we,Ge,Pr,$n,je=y(()=>{"use strict";we={running:!1,run(g){let{running:i}=this;this.running=!0;try{let e=g();return this.running=i,e}catch(e){throw this.running=i,e}}},Ge=g=>i=>i.type===g,Pr=(g,i,e,t=[])=>{let r=[...g.childNodes],n=r.splice(i,e,...t);g.setAttribute("childNodes",r);for(let s of t)s.setAttribute("parentNode",g);return n},$n=(g,i)=>new Array(g).fill(void 0).map((e,t)=>i(t))});var In=$s((mo,Es)=>{Es.exports={ext:[],html:[["b","bdi","del","i","ins","u","font","big","small","sub","sup","h1","h2","h3","h4","h5","h6","cite","code","em","s","strike","strong","tt","var","div","center","blockquote","ol","ul","dl","table","caption","pre","ruby","rb","rp","rt","rtc","p","span","abbr","dfn","kbd","samp","data","time","mark","tr","td","th","q","bdo"],["li","dt","dd"],["br","wbr","hr","meta","link"]],namespaces:{},nsid:{file:6,category:14},parserFunction:[{"#language":"language","#special":"special","#speciale":"speciale","#tag":"tag","#formatdate":"formatdate","#dateformat":"formatdate","#invoke":"invoke","#while":"while","#dowhile":"dowhile","#loop":"loop","#forargs":"forargs","#fornumargs":"fornumargs","#if":"if","#ifeq":"ifeq","#switch":"switch","#ifexist":"ifexist","#ifexpr":"ifexpr","#iferror":"iferror","#time":"time","#timel":"timel","#expr":"expr","#rel2abs":"rel2abs","#titleparts":"titleparts","#categorytree":"categorytree","#urldecode":"urldecode","#choose":"choose","#var":"var","#varexists":"varexists","#var_final":"var_final","#vardefine":"vardefine","#vardefineecho":"vardefineecho","#widget":"widget","#regex":"regex","#related":"related","#cscore":"cscore"},["!","="],["msg","raw"],["subst","safesubst"]],doubleUnderscore:[[],[]],protocol:"bitcoin:|ftp://|ftps://|geo:|git://|gopher://|http://|https://|irc://|ircs://|magnet:|mailto:|matrix:|mms://|news:|nntp://|redis://|sftp://|sip:|sips:|sms:|ssh://|svn://|tel:|telnet://|urn:|worldwind://|xmpp:",interwiki:[],img:{},redirection:["#redirect"],variants:[]}});var En,ce=y(()=>{"use strict";En=In()});var Fn,he,me,Ue,Ln,ne,qt,ie,Fs,Rn,Pn,Ls,De,xe,D=y(()=>{"use strict";Fn='[^[\\]<>"\0-\x7F\\p{Zs}\uFFFD]',he=`(?:\\[[\\da-f:.]+\\]|${Fn})`,me=`(?:${Fn}|\0\\d+[c!~]\x7F)*`,Ue=(g,i)=>e=>e.replace(g,i),Ln=Ue(/[\0\x7F]|\r$/gmu,""),ne=Ue(/\0\d+c\x7F/gu,""),qt=Ue(/[\\{}()|.?*+^$[\]]/gu,"\\$&"),ie=(g,i="")=>g.map(e=>typeof e=="string"?e:e.text()).join(i),Fs={lt:"<",gt:">",lbrack:"[",rbrack:"]",lbrace:"{",rbrace:"}"},Rn=Ue(/&(?:#(\d+|x[\da-fA-F]+)|([lLgG][tT]|[lr]brac[ke]));/gu,(g,i,e)=>i?String.fromCodePoint(+((/^x/iu.test(i)?"0":"")+i)):Fs[e.toLowerCase()]),Pn=Ue(/\n/gu,"\\n"),Ls={"&":"amp","<":"lt",">":"gt"},De=Ue(/[&<>]/gu,g=>`&${Ls[g]};`),xe=(g,i={})=>{let{pre:e="",post:t="",sep:r=""}=i;return e+g.map(n=>n.print()).join(r)+t}});var jn={};W(jn,{Title:()=>Gr});var Gn,xt,Tt,Gr,Bn=y(()=>{"use strict";D();Gn=g=>decodeURIComponent(g.replace(/%(?![\da-f]{2})/giu,"%25")),Gr=class{constructor(i,e,t,r,n){k(this,xt,void 0);k(this,Tt,void 0);x(this,"ns");x(this,"fragment");x(this,"interwiki","");x(this,"valid");x(this,"encoded",!1);let s=i.trim().startsWith("../");if(i=Rn(i),r&&i.includes("%"))try{let o=/%(?!21|3[ce]|5[bd]|7[b-d])[\da-f]{2}/iu.test(i);i=Gn(i),this.encoded=o}catch(o){}if(i=i.replace(/_/gu," ").trim(),s)this.ns=0;else{let o=e;i.startsWith(":")&&(o=0,i=i.slice(1).trim());let p=i.split(":");if(p.length>1){let l=t.nsid[p[0].trim().toLowerCase()];l&&(o=l,i=p.slice(1).join(":").trim())}this.ns=o}let a=i.indexOf("#");if(a!==-1){let o=i.slice(a+1).trimEnd();if(o.includes("%"))try{o=Gn(o)}catch(p){}this.fragment=o,i=i.slice(0,a).trim()}this.valid=!!(i||this.interwiki||n&&this.ns===0&&this.fragment!==void 0)&&!/^:|\0\d+[eh!+-]\x7F|[<>[\]{}|\n]|%[\da-f]{2}|(?:^|\/)\.{1,2}(?:$|\/)/iu.test(s?/^(?:\.\.\/)+(.*)/u.exec(i)[1]:i),this.main=i,Object.defineProperties(this,{encoded:{enumerable:!1,writable:!1}}),S(this,Tt,t.namespaces)}get main(){return h(this,xt)}set main(i){i=i.replace(/_/gu," ").trim(),S(this,xt,i&&i[0].toUpperCase()+i.slice(1))}get prefix(){let i=h(this,Tt)[this.ns];return i+(i&&":")}get title(){return(this.interwiki+(this.interwiki&&":")+this.prefix+this.main).replace(/ /gu,"_")}get extension(){let{main:i}=this,e=i.lastIndexOf(".");return e===-1?void 0:i.slice(e+1).toLowerCase()}toString(){return`${this.title}${this.fragment===void 0?"":`#${this.fragment}`}`}};xt=new WeakMap,Tt=new WeakMap});var qn,C,I,j=y(()=>{"use strict";N();qn=g=>(i,e,t,r,n="error")=>{let{start:s}=e,{top:a,left:o}="top"in e?e:i.getRootNode().posFromIndex(s),{offsetHeight:p,offsetWidth:l}=i,{startIndex:d,startLine:u,startCol:c}=g(i,s,a,o);return{rule:t,message:m.msg(r),severity:n,startIndex:d,endIndex:d+String(i).length,startLine:u,endLine:u+p-1,startCol:c,endCol:p===1?c+l:l}},C=qn((g,i,e,t)=>{let r=g.getRelativeIndex(),{top:n,left:s}=g.parentNode.posFromIndex(r);return{startIndex:i+r,startLine:e+n,startCol:n?s:t+s}}),I=qn((g,i,e,t)=>({startIndex:i,startLine:e,startCol:t}))});var On,_n,bt,kt,jr,He,Br=y(()=>{"use strict";On=g=>{let i=g.split(`
`),e=i.length;return{height:e,width:i[e-1].length}},_n=(g,i)=>i.childNodes.slice(0,g).reduce((e,t,r)=>e+String(t).length+i.getGaps(r),0)+i.getAttribute("padding"),He=class{constructor(){k(this,kt);x(this,"childNodes",[]);k(this,bt,void 0)}get firstChild(){return this.childNodes[0]}get lastChild(){return this.childNodes[this.childNodes.length-1]}get parentNode(){return h(this,bt)}get nextSibling(){var e;let i=(e=this.parentNode)==null?void 0:e.childNodes;return i&&i[i.indexOf(this)+1]}get previousSibling(){var e;let i=(e=this.parentNode)==null?void 0:e.childNodes;return i&&i[i.indexOf(this)-1]}get offsetHeight(){return $(this,kt,jr).call(this).height}get offsetWidth(){return $(this,kt,jr).call(this).width}getAttribute(i){return i==="padding"?0:this[i]}setAttribute(i,e){i==="parentNode"?S(this,bt,e):this[i]=e}getRootNode(){let{parentNode:i}=this;for(;i!=null&&i.parentNode;)({parentNode:i}=i);return i!=null?i:this}posFromIndex(i){let e=String(this);if(i>=-e.length&&i<=e.length){let{height:t,width:r}=On(e.slice(0,i));return{top:t-1,left:r}}}getGaps(i){return 0}getRelativeIndex(i){if(i===void 0){let{parentNode:e}=this;return e?_n(e.childNodes.indexOf(this),e):0}return _n(i,this)}getAbsoluteIndex(){let{parentNode:i}=this;return i?i.getAbsoluteIndex()+this.getRelativeIndex():0}seal(i,e){Object.defineProperty(this,i,{enumerable:!e&&!!this[i],configurable:!0})}};bt=new WeakMap,kt=new WeakSet,jr=function(){return On(String(this))}});var Ve,Ot,yt,qr,At,Or,_t,Mn=y(()=>{"use strict";D();je();Br();_t=class extends He{constructor(){super(...arguments);k(this,Ve);k(this,yt);k(this,At)}get length(){return this.childNodes.length}text(e){return ie(this.childNodes,e)}normalize(){let e=[...this.childNodes],t=r=>{e.splice(r,1)};for(let r=e.length-1;r>=0;r--){let{type:n,data:s}=e[r];n!=="text"||this.getGaps(r-1)||s===""&&t(r)}this.setAttribute("childNodes",e)}removeAt(e){return Pr(this,e,1)[0]}insertAt(e,t=this.length){return Pr(this,t,0,[e]),e}closest(e){let t=$(this,Ve,Ot).call(this,e),{parentNode:r}=this;for(;r;){if(t(r))return r;({parentNode:r}=r)}}querySelector(e){let t=$(this,Ve,Ot).call(this,e);return $(this,yt,qr).call(this,t)}querySelectorAll(e){let t=$(this,Ve,Ot).call(this,e);return $(this,At,Or).call(this,t)}append(...e){for(let t of e)this.insertAt(t)}replaceChildren(...e){for(let t=this.length-1;t>=0;t--)this.removeAt(t);this.append(...e)}setText(e,t=0){t+=t<0?this.length:0;let r=this.childNodes[t],{data:n}=r;return r.replaceData(e),n}toString(e=""){return this.childNodes.map(String).join(e)}lint(e=this.getAbsoluteIndex(),t){let r=[];for(let n=0,s=e+this.getAttribute("padding");n<this.length;n++){let a=this.childNodes[n];r.push(...a.lint(s,t)),s+=String(a).length+this.getGaps(n)}return r}print(e={}){var t;return String(this)?`<span class="wpb-${(t=e.class)!=null?t:this.type}">${xe(this.childNodes,e)}</span>`:""}json(e,t=this.getAbsoluteIndex()){let r={...this,range:[t,t+String(this).length],childNodes:[]};for(let n=0,s=t+this.getAttribute("padding");n<this.length;n++){let a=this.childNodes[n],{length:o}=String(a);a.type==="text"?r.childNodes.push({data:a.data,range:[s,s+o]}):r.childNodes.push(a.json(void 0,s)),s+=o+this.getGaps(n)}return r}};Ve=new WeakSet,Ot=function(e){let t=new Set(e.split(",").map(r=>r.trim()));return({type:r})=>t.has(r)},yt=new WeakSet,qr=function(e){var t;for(let r of this.childNodes){if(r.type==="text")continue;if(e(r))return r;let n=$(t=r,yt,qr).call(t,e);if(n)return n}},At=new WeakSet,Or=function(e){var r;let t=[];for(let n of this.childNodes)n.type!=="text"&&(e(n)&&t.push(n),t.push(...$(r=n,At,Or).call(r,e)));return t}});var zn,Rs,Ps,Gs,js,Bs,qs,Mt,Wn,vt,Un=y(()=>{"use strict";D();N();Br();zn="<\\s*(?:\\/\\s*)?([a-z]\\w*)|\\{+|\\}+|\\[{2,}|\\[(?![^[]*?\\])|((?:^|\\])[^[]*?)\\]+",Rs=new RegExp(`${zn}|https?[:/]\\/+`,"giu"),Ps=new RegExp(zn,"giu"),Gs=new RegExp(`^https?:\\/\\/${he}${me}\\.(?:gif|png|jpg|jpeg)$`,"iu"),js={"[":/[[\]]/u,"{":/[{}]/u,"]":/[[\]](?=[^[\]]*$)/u,"}":/[{}](?=[^{}]*$)/u},Bs={"<":"tag-like","[":"lonely-bracket","{":"lonely-bracket","]":"lonely-bracket","}":"lonely-bracket",h:"lonely-http"},qs=["html","head","style","title","body","a","audio","img","video","embed","iframe","object","canvas","script","col","colgroup","tbody","tfoot","thead","button","input","label","option","select","textarea"],vt=class extends He{constructor(e){super();k(this,Mt);x(this,"type","text");x(this,"data","");Object.defineProperties(this,{childNodes:{enumerable:!1,configurable:!1},type:{enumerable:!1,writable:!1},data:{value:e}})}toString(){return this.data}text(){return this.data}lint(e=this.getAbsoluteIndex(),t){var G,B,O;let{data:r,parentNode:n,nextSibling:s,previousSibling:a}=this;if(!n)throw new Error("\u65E0\u6CD5\u5BF9\u5B64\u7ACB\u6587\u672C\u8282\u70B9\u8FDB\u884C\u8BED\u6CD5\u5206\u6790\uFF01");let{type:o,name:p,parentNode:l}=n,d=!1;if(o==="attr-value"){let{type:ee,name:pe,tag:Le}=l;if(ee!=="ext-attr")d=!0;else if(Le==="choose"&&(pe==="before"||pe==="after"))return[]}if(t!=null||(t=o==="free-ext-link"||o==="ext-link-url"||o==="image-parameter"&&p==="link"||d?Ps:Rs),r.search(t)===-1)return[];t.lastIndex=0;let u=[],c=s==null?void 0:s.type,f=s==null?void 0:s.name,T=a==null?void 0:a.type,A=this.getRootNode(),{ext:F,html:L}=A.getAttribute("config"),{top:v,left:w}=A.posFromIndex(e),R=new Set(["onlyinclude","noinclude","includeonly",F,L,qs].flat(2));for(let ee=t.exec(r);ee;ee=t.exec(r)){let[,pe,Le]=ee,{0:Re,index:V}=ee;if(Le&&Le!=="]"){let{length:re}=Le;V+=re,Re=Re.slice(re)}let{0:E,length:te}=Re;if(E==="<"&&!R.has(pe.toLowerCase())||E==="["&&o==="ext-link-text"&&(/&(?:rbrack|#93|#x5[Dd];);/u.test(r.slice(V+1))||c==="ext"&&f==="nowiki"&&((G=s.innerText)!=null&&G.includes("]"))))continue;if(E==="]"&&(V||te>1))t.lastIndex--;else if(E==="h"&&V===0&&o==="ext-link-text"&&Gs.test(r))continue;let J=e+V,ht=J+te,Ae=String(A),U=Ae[ht],ve=Ae[J-1],mt=te>1&&!(E==="<"&&!/[\s/>]/u.test(U!=null?U:"")||d&&(E==="["||E==="]"))||E==="{"&&(U===E||ve==="-")||E==="}"&&(ve===E||U==="-")||E==="["&&(U===E||o==="ext-link-text"||c==="free-ext-link"&&!r.slice(V+1).trim())||E==="]"&&(ve===E||T==="free-ext-link"&&!r.slice(0,V).includes("]"))?"error":"warning",Fr=E==="{"||E==="[";if(mt==="warning"&&(Fr||(E==="]"||E==="}"))){let re=js[E],Lr=Fr?r.slice(V+1):r.slice(0,V);if(E==="{"&&((B=re.exec(Lr))==null?void 0:B[0])==="}"||E==="}"&&((O=re.exec(Lr))==null?void 0:O[0])==="{")continue;if(!Lr.includes(E)){let Sn=Fr?"nextSibling":"previousSibling",Pe=this[Sn];for(;Pe&&(Pe.type!=="text"||!re.test(Pe.data));)Pe=Pe[Sn];if(Pe&&re.exec(Pe.data)[0]!==E)continue}}let Gt=r.slice(0,V).split(`
`),An=Gt.length+v-1,vn=Gt[Gt.length-1],wn=Gt.length===1?w+vn.length:vn.length,ft={rule:Bs[E],message:m.msg('lonely "$1"',E==="h"?Re:E),severity:mt,startIndex:J,endIndex:ht,startLine:An,endLine:An,startCol:wn,endCol:wn+te};if(E==="<")ft.suggestions=[{desc:"escape",range:[J,J+1],text:"&lt;"}];else if(E==="h"&&!(o==="ext-link-text"||o==="link-text")&&/[\p{L}\d_]/u.test(ve||""))ft.suggestions=[{desc:"whitespace",range:[J,J],text:" "}];else if(E==="["&&o==="ext-link-text"){let re=n.getAbsoluteIndex()+String(n).length;ft.suggestions=[{desc:"escape",range:[re,re+1],text:"&#93;"}]}else if(E==="]"&&T==="free-ext-link"&&mt==="error"){let re=e-String(a).length;ft.fix={range:[re,re],text:"["}}u.push(ft)}return u}replaceData(e){$(this,Mt,Wn).call(this,e)}print(){return De(this.data)}};Mt=new WeakSet,Wn=function(e){this.setAttribute("data",e)}});var se,Be=y(()=>{"use strict";se=g=>{class i extends g{text(){return""}lint(){return[]}}return i}});var oe,Xe=y(()=>{"use strict";N();P();oe=class extends b{constructor(i,e,t="plain",r=m.getConfig(),n=[],s){super(i,r,n,s),this.type=t}lint(){return[]}}});var _,Te=y(()=>{"use strict";N();P();_=class extends b{constructor(i,e,t=m.getConfig(),r=[],n){super(i,t,r,n),this.type=e}}});var qe,ue,Se,fe,St=y(()=>{"use strict";j();ce();N();P();Te();fe=class extends b{constructor(e,t,r=m.getConfig(),n=[],s="|"){super(void 0,r,n,{});k(this,qe,!0);k(this,ue,void 0);k(this,Se,void 0);if(this.insertAt(new _(e,"link-target",r,n,{})),t!==void 0){let a=new b(t,r,n,{});a.type="link-text",a.setAttribute("stage",10),this.insertAt(a)}S(this,ue,s)}afterBuild(){S(this,Se,this.getTitle()),h(this,ue).includes("\0")&&S(this,ue,this.buildFromStr(h(this,ue),0)),this.setAttribute("name",h(this,Se).title)}setAttribute(e,t){e==="bracket"?S(this,qe,t):e==="title"?S(this,Se,t):super.setAttribute(e,t)}toString(){let e=super.toString(h(this,ue));return h(this,qe)?`[[${e}]]`:e}text(){let e=super.text("|");return h(this,qe)?`[[${e}]]`:e}getAttribute(e){return e==="title"?h(this,Se):e==="padding"?2:super.getAttribute(e)}getGaps(e){return e===0?h(this,ue).length:1}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{childNodes:[n,s],type:a}=this,{encoded:o,fragment:p}=h(this,Se),l;if(n.childNodes.some(({type:d})=>d==="template")&&(l={start:e,...this.getRootNode().posFromIndex(e)},r.push(C(n,l,"unknown-page","template in an internal link target","warning"))),o&&(l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(n,l,"url-encoding","unnecessary URL encoding in an internal link"))),a==="link"||a==="category"){let d=s==null?void 0:s.childNodes.find(u=>u.type==="text"&&u.data.includes("|"));if(d){l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)});let u=C(s,l,"pipe-like",'additional "|" in the link text',"warning");u.suggestions=[{desc:"escape",range:[u.startIndex+d.getRelativeIndex(),u.startIndex+d.getRelativeIndex()+d.data.length],text:d.data.replace(/\|/gu,"&#124;")}],r.push(u)}}if(a!=="link"&&a!=="redirect-target"&&p!==void 0){l!=null||(l={start:e,...this.getRootNode().posFromIndex(e)});let d=C(n,l,"no-ignored","useless fragment"),u=n.childNodes.find(c=>c.type==="text"&&c.data.includes("#"));u&&(d.fix={range:[d.startIndex+u.getRelativeIndex()+u.data.indexOf("#"),d.endIndex],text:""}),r.push(d)}return r}getTitle(e){return this.normalizeTitle(this.firstChild.text(),0,e,!0,!0)}print(){return super.print(h(this,qe)?{pre:"[[",post:"]]",sep:h(this,ue)}:{sep:h(this,ue)})}};qe=new WeakMap,ue=new WeakMap,Se=new WeakMap});var K,Ce=y(()=>{"use strict";N();P();K=class extends b{get innerText(){return this.firstChild.data}constructor(i="",e=m.getConfig(),t=[]){super(i,e,t)}}});var H,Ne=y(()=>{"use strict";Be();Ce();H=class extends se(K){constructor(){super(...arguments);x(this,"type","noinclude")}}});var zt,Dn=y(()=>{"use strict";j();N();St();Ne();zt=class extends fe{constructor(e,t,r=m.getConfig(),n=[]){super(e,void 0,r,n);x(this,"type","redirect-target");t!==void 0&&this.insertAt(new H(t,r,n))}getTitle(){return this.normalizeTitle(String(this.firstChild),0,!0,!0)}text(){return`[[${String(this.firstChild)}]]`}lint(e=this.getAbsoluteIndex()){let t=super.lint(e,/\]\]/u);if(this.length===2){let r=C(this.lastChild,{start:e},"no-ignored","useless link text");r.startIndex--,r.startCol--,r.fix={range:[r.startIndex,r.endIndex],text:""},t.push(r)}return t}}});var $e,Qe,Wt,Hn=y(()=>{"use strict";Be();N();P();Xe();Dn();Wt=class extends se(b){constructor(e,t,r,n,s,a=m.getConfig(),o=[]){super(void 0,a,o);x(this,"type","redirect");k(this,$e,void 0);k(this,Qe,void 0);S(this,$e,e),S(this,Qe,s);let p=new RegExp(`^(?:${a.redirection.join("|")})\\s*(?::\\s*)?$`,"iu");this.append(new oe(t,p,"redirect-syntax",a,o,{}),new zt(r,n==null?void 0:n.slice(1),a,o))}getAttribute(e){return e==="padding"?h(this,$e).length:super.getAttribute(e)}toString(){return h(this,$e)+super.toString()+h(this,Qe)}lint(e=this.getAbsoluteIndex()){return this.lastChild.lint(e+h(this,$e).length+String(this.firstChild).length)}print(){return super.print({pre:h(this,$e),post:h(this,Qe)})}};$e=new WeakMap,Qe=new WeakMap});var Vn={};W(Vn,{parseRedirect:()=>Os});var Os,Xn=y(()=>{"use strict";N();Hn();Os=(g,i,e)=>{let t=new RegExp(`^(\\s*)((?:${i.redirection.join("|")})\\s*(?::\\s*)?)\\[\\[([^\\n|\\]]+)(\\|.*?)?\\]\\](\\s*)`,"iu"),r=t.exec(g);return r&&m.normalizeTitle(r[3],0,!1,i,!0,!0).valid?(g=`\0${e.length}c\x7F${g.slice(r[0].length)}`,new Wt(...r.slice(1),i,e),g):!1}});var Ut,Qn=y(()=>{"use strict";P();Ut=class extends b{constructor(){super(...arguments);x(this,"type","onlyinclude")}toString(){return`<onlyinclude>${super.toString()}</onlyinclude>`}getAttribute(e){return e==="padding"?13:e==="plain"||super.getAttribute(e)}print(){return super.print({pre:'<span class="wpb-ext">&lt;onlyinclude&gt;</span>',post:'<span class="wpb-ext">&lt;/onlyinclude&gt;</span>'})}}});var Ie,Ze,_r=y(()=>{"use strict";N();P();Ze=class extends b{constructor(e,t,r,n,s=m.getConfig(),a=[]){super(void 0,s);k(this,Ie,void 0);x(this,"closed");x(this,"selfClosing");this.setAttribute("name",e.toLowerCase()),S(this,Ie,[e,n||e]),this.closed=n!=="",this.selfClosing=n===void 0,this.append(t,r);let o=typeof t=="string"?-1:a.indexOf(t);a.splice(o===-1?1/0:o,0,this)}get innerText(){return this.selfClosing?void 0:this.lastChild.text()}toString(){let{selfClosing:e,firstChild:t,lastChild:r}=this,[n,s]=h(this,Ie);return e?`<${n}${String(t)}/>`:`<${n}${String(t)}>${String(r)}${this.closed?`</${s}>`:""}`}text(){let[e,t]=h(this,Ie);return this.selfClosing?`<${e}${this.firstChild.text()}/>`:`<${e}${super.text(">")}${this.closed?`</${t}>`:""}`}getAttribute(e){return e==="padding"?h(this,Ie)[0].length+1:super.getAttribute(e)}getGaps(){return 1}print(){let[e,t]=h(this,Ie);return super.print(this.selfClosing?{pre:`&lt;${e}`,post:"/&gt;"}:{pre:`&lt;${e}`,sep:"&gt;",post:this.closed?`&lt;/${t}&gt;`:""})}};Ie=new WeakMap});var Dt,Zn=y(()=>{"use strict";j();Be();N();_r();Dt=class extends se(Ze){constructor(e,t="",r,n,s=m.getConfig(),a=[]){super(e,t,r!=null?r:"",r===void 0||n!=null?n:"",s,a);x(this,"type","include")}lint(e=this.getAbsoluteIndex()){if(this.closed)return[];let t=I(this,{start:e},"unclosed-comment",m.msg("unclosed $1",`<${this.name}>`));return t.suggestions=[{desc:"close",range:[t.endIndex,t.endIndex],text:`</${this.name}>`}],[t]}}});var _s,X,Kn,Jn,Vt,Mr,Yn,Ct,ti,ri,ni,ei,Ht,Ms,zs,Ws,Ke,Q,ae,Je,ii=y(()=>{"use strict";j();D();ce();N();P();Te();_s=new Set(["id","class","style","lang","dir","title","tabindex","aria-describedby","aria-flowto","aria-hidden","aria-label","aria-labelledby","aria-level","aria-owns","role","about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),X=new Set(["align"]),Kn=new Set(["cite"]),Jn=new Set(["cite","datetime"]),Vt=new Set(["width"]),Mr=new Set(["axis","align","bgcolor","height","width","valign"]),Yn=new Set([...Mr,"abbr","headers","scope","rowspan","colspan"]),Ct=new Set(["type"]),ti=new Set(["summary","align","bgcolor","cellpadding","cellspacing","frame","rules","width"]),ri=new Set(["clear"]),ni=new Set(["bgcolor","align","valign"]),ei={div:X,h1:X,h2:X,h3:X,h4:X,h5:X,h6:X,blockquote:Kn,q:Kn,p:X,br:ri,pre:Vt,ins:Jn,del:Jn,ul:Ct,ol:new Set(["type","start","reversed"]),li:new Set(["type","value"]),table:new Set([...ti,"border"]),caption:X,tr:ni,td:Yn,th:Yn,img:new Set(["alt","src","width","height","srcset"]),font:new Set(["size","color","face"]),hr:Vt,rt:new Set(["rbspan"]),data:new Set(["value"]),time:new Set(["datetime"]),meta:new Set(["itemprop","content"]),link:new Set(["itemprop","href","title"]),gallery:new Set(["mode","showfilename","caption","perrow","widths","heights","showthumbnails","type"]),poem:new Set(["compact","align"]),categorytree:new Set(["align","hideroot","onlyroot","depth","mode","hideprefix","namespaces","showcount","notranslations"]),combooption:new Set(["name","for","inline","align"])},Ht=new Set,Ms={nowiki:Ht,indicator:new Set(["name"]),langconvert:new Set(["from","to"]),ref:new Set(["group","name","extends","follow","dir"]),references:new Set(["group","responsive"]),charinsert:new Set(["label"]),choose:new Set(["uncached","before","after"]),option:new Set(["weight"]),imagemap:Ht,inputbox:Ht,templatestyles:new Set(["src","wrapper"]),dynamicpagelist:Ht,poll:new Set(["id","show-results-before-voting"]),sm2:Ct,flashmp3:Ct,score:new Set(["line_width_inches","lang","override_midi","raw","note-language","override_audio","override_ogg","sound","vorbis"]),seo:new Set(["title","title_mode","title_separator","keywords","description","robots","google_bot","image","image_width","image_height","image_alt","type","site_name","locale","section","author","published_time","twitter_site"]),tab:new Set(["nested","name","index","class","block","inline","openname","closename","collapsed","dropdown","style","bgcolor","container","id","title"]),tabs:new Set(["plain","class","container","id","title","style"]),combobox:new Set(["placeholder","value","id","class","text","dropdown","style"])},zs=new RegExp("expression|(?:accelerator|-o-link(?:-source)?|-o-replace)\\s*:|(?:url|image(?:-set)?)\\s*\\(|attr\\s*\\([^)]+[\\s,]url","u"),Ws={table:ti,td:new Set([...Mr,"scope"]),th:Mr,br:ri,caption:X,div:X,hr:Vt,h1:X,h2:X,h3:X,h4:X,h5:X,h6:X,li:Ct,p:X,pre:Vt,tr:ni,ul:Ct},Je=class extends b{constructor(e,t,r,n="",s,a=[],o=m.getConfig(),p=[]){let l=new _(r,"attr-key",o,p,{}),d;if(r==="title"||t==="img"&&r==="alt")d=new b(s,o,p,{}),d.type="attr-value",d.setAttribute("stage",10);else if(t==="gallery"&&r==="caption"){let u={...o,excludes:[...o.excludes,"quote","extLink","magicLink","list"]};d=new b(s,u,p,{}),d.type="attr-value",d.setAttribute("stage",5)}else if(t==="choose"&&(r==="before"||r==="after")){let u={...o,excludes:[...o.excludes,"heading","html","table","hr","list"]};d=new b(s,u,p,{}),d.type="attr-value",d.setAttribute("stage",1)}else d=new _(s,"attr-value",o,p,{});super(void 0,o,p);k(this,Ke,void 0);k(this,Q,void 0);k(this,ae,void 0);this.type=e,this.append(l,d),S(this,Q,n),S(this,ae,[...a]),S(this,Ke,t),this.setAttribute("name",ne(r).trim().toLowerCase())}get tag(){return h(this,Ke)}get balanced(){return!h(this,Q)||h(this,ae)[0]===h(this,ae)[1]}afterBuild(){h(this,Q).includes("\0")&&S(this,Q,this.buildFromStr(h(this,Q),0)),this.parentNode&&S(this,Ke,this.parentNode.name),this.setAttribute("name",this.firstChild.text().trim().toLowerCase())}toString(){let[e="",t=""]=h(this,ae);return h(this,Q)?super.toString(h(this,Q)+e)+t:String(this.firstChild)}text(){return h(this,Q)?`${super.text(`${h(this,Q).trim()}"`)}"`:this.firstChild.text()}getGaps(){var e,t;return h(this,Q)?h(this,Q).length+((t=(e=h(this,ae)[0])==null?void 0:e.length)!=null?t:0):0}lint(e=this.getAbsoluteIndex(),t){var f,T;let r=super.lint(e,t),{balanced:n,firstChild:s,lastChild:a,type:o,name:p,tag:l}=this,d=this.getValue(),u;if(!n){let A=this.getRootNode();u={start:e,...A.posFromIndex(e)};let F=C(a,u,"unclosed-quote",m.msg("unclosed $1","quotes"),"warning");F.startIndex--,F.startCol--;let L={range:[F.endIndex,F.endIndex],text:h(this,ae)[0]};a.childNodes.some(({type:v,data:w})=>v==="text"&&/\s/u.test(w))?F.suggestions=[{desc:"close",...L}]:F.fix=L,r.push(F)}let c=Ms[l];if(c&&!c.has(p)||(o==="ext-attr"?l in ei:!/\{\{[^{]+\}\}/u.test(p))&&!((f=ei[l])!=null&&f.has(p))&&!/^(?:xmlns:[\w:.-]+|data-[^:]*)$/u.test(p)&&(l==="meta"||l==="link"||!_s.has(p)))u!=null||(u={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(s,u,"illegal-attr","illegal attribute name"));else if((T=Ws[l])!=null&&T.has(p))u!=null||(u={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(s,u,"obsolete-attr","obsolete attribute","warning"));else if(p==="style"&&typeof d=="string"&&zs.test(d))u!=null||(u={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(a,u,"insecure-style","insecure style"));else if(p==="tabindex"&&typeof d=="string"&&d.trim()!=="0"){u!=null||(u={start:e,...this.getRootNode().posFromIndex(e)});let A=C(a,u,"illegal-attr","nonzero tabindex");A.suggestions=[{desc:"remove",range:[e,A.endIndex],text:""},{desc:"0 tabindex",range:[A.startIndex,A.endIndex],text:"0"}],r.push(A)}return r}getValue(){if(h(this,Q)){let e=this.lastChild.text();return h(this,ae)[1]?e:e[h(this,ae)[0]?"trimEnd":"trim"]()}return this.type==="ext-attr"||""}print(){let[e="",t=""]=h(this,ae);return h(this,Q)?super.print({sep:De(h(this,Q))+e,post:t}):super.print()}};Ke=new WeakMap,Q=new WeakMap,ae=new WeakMap});var si,Us,Ee,Xt=y(()=>{"use strict";j();D();N();P();Te();ii();si=g=>g.slice(0,-1),Us=g=>`${si(g)}-dirty`,Ee=class extends b{constructor(i,e,t,r=m.getConfig(),n=[]){if(super(void 0,r,n,{}),this.type=e,this.setAttribute("name",t),i){let s=new RegExp(`([^\\s/](?:(?!\0\\d+~\x7F)[^\\s/=])*)(?:((?:\\s|\0\\d+c\x7F)*(?:=|\0\\d+~\x7F)(?:\\s|\0\\d+c\x7F)*)(?:(["'])(.*?)(\\3|$)|(\\S*)))?`,"gsu"),a="",o=s.exec(i),p=0,l=()=>{a&&(super.insertAt(new _(a,Us(e),r,n,{})),a="")};for(;o;){let{index:d,0:u,1:c,2:f,3:T,4:A,5:F,6:L}=o;if(a+=i.slice(p,d),/^(?:[\w:]|\0\d+[t!~{}+-]\x7F)(?:[\w:.-]|\0\d+[t!~{}+-]\x7F)*$/u.test(ne(c).trim())){let v=A!=null?A:L,w=[T,F],R=new Je(si(e),t,c,f,v,w,r,n);l(),super.insertAt(R)}else a+=u;({lastIndex:p}=s),o=s.exec(i)}a+=i.slice(p),l()}}afterBuild(){if(this.type==="table-attrs"){let{parentNode:i}=this;this.setAttribute("name",(i==null?void 0:i.type)==="td"&&i.subtype==="caption"?"caption":i==null?void 0:i.type)}}getAttrTokens(i){return this.childNodes.filter(e=>e instanceof Je&&(!i||e.name===i.toLowerCase().trim()))}getAttrToken(i){let e=this.getAttrTokens(i);return e[e.length-1]}getAttr(i){var e;return(e=this.getAttrToken(i))==null?void 0:e.getValue()}lint(i=this.getAbsoluteIndex(),e){let t=super.lint(i,e),{parentNode:r,length:n,childNodes:s}=this,a=new Map,o=new Set,p;if((r==null?void 0:r.type)==="html"&&r.closing&&this.text().trim()){p={start:i,...this.getRootNode().posFromIndex(i)};let l=I(this,p,"no-ignored","attributes of a closing tag");l.fix={range:[i,l.endIndex],text:""},t.push(l)}for(let l=0;l<n;l++){let d=s[l];if(d instanceof _&&d.text().trim()){p!=null||(p={start:i,...this.getRootNode().posFromIndex(i)});let u=C(d,p,"no-ignored","containing invalid attribute");u.suggestions=[{desc:"remove",range:[u.startIndex,u.endIndex],text:" "}],t.push(u)}else if(d instanceof Je){let{name:u}=d;a.has(u)?(o.add(u),a.get(u).push(d)):u!=="class"&&a.set(u,[d])}}if(o.size>0){p!=null||(p={start:i,...this.getRootNode().posFromIndex(i)});for(let l of o)t.push(...a.get(l).map(d=>C(d,p,"no-duplicate",m.msg("duplicated $1 attribute",l))))}return t}print(){return String(this)?`<span class="wpb-${this.type}">${this.childNodes.map(i=>i.print(i instanceof _?{class:"attr-dirty"}:void 0)).join("")}</span>`:""}}});var oi={};W(oi,{PreToken:()=>zr});var zr,ai=y(()=>{"use strict";ce();N();P();Ne();zr=class extends b{constructor(e,t=m.getConfig(),r=[]){if(e){let n="<nowiki>",s="</nowiki>",{length:a}=n,o=e.indexOf(n),p=e.indexOf(s,o+a),l="";for(;o!==-1&&p!==-1;)new H(n,t,r),new H(s,t,r),l+=`${e.slice(0,o)}\0${r.length-1}c\x7F${e.slice(o+a,p)}\0${r.length}c\x7F`,e=e.slice(p+a+1),o=e.indexOf(n),p=e.indexOf(s,o+a);e=l+e}super(e,t,r,{});x(this,"type","ext-inner");this.setAttribute("stage",10)}getAttribute(e){return e==="plain"||super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){return super.lint(e,/<\s*\/\s*(pre)\b/giu)}}});var li={};W(li,{ParamTagToken:()=>Nt});var Nt,Wr=y(()=>{"use strict";j();N();P();Te();Nt=class extends b{constructor(e,t=m.getConfig(),r=[],n={}){super(void 0,t,r,{});x(this,"type","ext-inner");if(e){let s=_;this.append(...e.split(`
`).map(a=>new s(a,"param-line",t,r,{})))}}toString(){return super.toString(`
`)}text(){return super.text(`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex()){let t;return this.childNodes.filter(r=>{let{childNodes:n}=r,s=n.findIndex(({type:o})=>o!=="text"),a=(s>=0?n.slice(0,s).map(String).join(""):String(r)).trim();return a&&!(s>=0?/^[a-z]+(?:\[\])?\s*(?:=|$)/iu:/^[a-z]+(?:\[\])?\s*=/iu).test(a)}).map(r=>{t!=null||(t={start:e,...this.getRootNode().posFromIndex(e)});let n=C(r,t,"no-ignored",m.msg("invalid parameter of <$1>",this.name));return n.suggestions=[{desc:"remove",range:[n.startIndex,n.endIndex],text:""}],n})}print(){return super.print({sep:`
`})}}});var $t,Ye,Qt,et,Ur=y(()=>{"use strict";j();N();P();Xe();et=class extends b{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);k(this,Ye);x(this,"type","heading");k(this,$t,void 0);S(this,$t,e);let s=new b(t[0],r,n);s.type="heading-title",s.setAttribute("stage",2);let a=new oe(t[1],/^[^\S\n]*$/u,"heading-trail",r,n,{});this.append(s,a)}get level(){return h(this,$t)}toString(){let e=h(this,Ye,Qt);return e+String(this.firstChild)+e+String(this.lastChild)}text(){let e=h(this,Ye,Qt);return e+this.firstChild.text()+e}getAttribute(e){return e==="padding"?this.level:super.getAttribute(e)}getGaps(){return this.level}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{firstChild:n,level:s}=this,a=String(n),o=n.childNodes.filter(u=>u.type==="quote"),p=o.filter(({bold:u})=>u),l=o.filter(({italic:u})=>u),d;return this.level===1&&(d={start:e,...this.getRootNode().posFromIndex(e)},r.push(C(n,d,"h1","<h1>"))),(a.startsWith("=")||a.endsWith("="))&&(d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(n,d,"unbalanced-header",m.msg("unbalanced $1 in a section header",'"="')))),this.closest("html-attrs, table-attrs")&&(d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),r.push(I(this,d,"parsing-order","section header in a HTML tag"))),p.length%2&&(d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(p[p.length-1],{...d,start:e+s,left:d.left+s},"format-leakage",m.msg("unbalanced $1 in a section header","bold apostrophes")))),l.length%2&&(d!=null||(d={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(l[l.length-1],{start:e+s},"format-leakage",m.msg("unbalanced $1 in a section header","italic apostrophes")))),r}print(){let e=h(this,Ye,Qt);return super.print({pre:e,sep:e})}json(){let e=super.json();return e.level=this.level,e}};$t=new WeakMap,Ye=new WeakSet,Qt=function(){return"=".repeat(this.level)}});var Ds,Zt,di=y(()=>{"use strict";D();j();N();P();Ds=g=>g.text().replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),Zt=class extends b{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);x(this,"type","parameter");let s=new b(typeof e=="number"?void 0:e,r,n,{}),a=new b(t,r,n);s.type="parameter-key",a.type="parameter-value",a.setAttribute("stage",2),this.append(s,a)}get anon(){return this.firstChild.length===0}afterBuild(){if(!this.anon){let{parentNode:e,firstChild:t}=this,r=Ds(t);this.setAttribute("name",r),e&&e.getArgs(r,!1,!1).add(this)}}toString(){return this.anon?String(this.lastChild):super.toString("=")}text(){return this.anon?this.lastChild.text():super.text("=")}getGaps(){return this.anon?0:1}lint(e=this.getAbsoluteIndex(),t){var a;let r=super.lint(e,t),{firstChild:n}=this,s=(a=new RegExp(`https?://${he}${me}$`,"iu").exec(n.text()))==null?void 0:a[0];if(s&&new URL(s).search){let o=C(n,{start:e},"unescaped","unescaped query string in an anonymous parameter");o.startIndex=o.endIndex,o.startLine=o.endLine,o.startCol=o.endCol,o.endIndex++,o.endCol++,o.fix={range:[o.startIndex,o.endIndex],text:"{{=}}"},r.push(o)}return r}print(){return super.print({sep:this.anon?"":"="})}json(){let e=super.json();return e.anon=this.anon,e}}});var Hs,Oe,_e,Kt,gi,Jt,pi,It,ui=y(()=>{"use strict";D();j();je();ce();N();P();di();Te();Xe();Hs=new Set(["pageid","articlepath","server","servername","scriptpath","stylepath"]),It=class extends b{constructor(e,t,r=m.getConfig(),n=[]){var u,c;super(void 0,r,n,{});k(this,Kt);k(this,Jt);x(this,"type","template");x(this,"modifier","");k(this,Oe,!1);k(this,_e,new Map);let{parserFunction:[s,a]}=r,o=(u=/^(?:\s|\0\d+c\x7F)*\0\d+s\x7F/u.exec(e))==null?void 0:u[0];if(o)this.setAttribute("modifier",o),e=e.slice(o.length);else if(e.includes(":")){let[f,...T]=e.split(":"),[A]=/^(?:\s|\0\d+c\x7F)*/u.exec((c=T[0])!=null?c:"");this.setModifier(`${f}:${A}`)&&(e=T.join(":").slice(A.length))}let p=e.includes(":");if(p||t.length===0&&!h(this,Oe)){let[f,...T]=e.split(":"),A=ne(f),F=A[T.length>0?"trimStart":"trim"](),L=F.toLowerCase(),v=s[L],w=a.includes(F);if(w||Hs.has(v)||p&&v){this.setAttribute("name",v!=null?v:L),this.type="magic-word";let G=new RegExp(`^\\s*${F}\\s*$`,w?"u":"iu"),B=new oe(f,G,"magic-word-name",r,n,{});if(super.insertAt(B),T.length>0&&t.unshift([T.join(":")]),this.name==="invoke")for(let O=0;O<2;O++){let ee=t.shift();if(!ee)break;let pe=new _(ee.join("="),`invoke-${O?"function":"module"}`,r,n);super.insertAt(pe)}}}if(this.type==="template"){let f=ne(e).trim();if(!this.normalizeTitle(f,10,!0).valid)throw n.pop(),new SyntaxError("\u975E\u6CD5\u7684\u6A21\u677F\u540D\u79F0");let T=new _(e,"template-name",r,n,{});super.insertAt(T)}let l=this.isTemplate(),d=1;for(let f=0;f<t.length;f++){let T=t[f];!l&&!(this.name==="switch"&&f>0)&&(T[0]=T.join("="),T.length=1),T.length===1&&(T.unshift(d),d++),this.insertAt(new Zt(...T,r,n))}this.seal("modifier")}setModifier(e){let{parserFunction:[,,t,r]}=this.getAttribute("config"),n=ne(e).trim();if(e&&!n.endsWith(":"))return!1;let s=n.slice(0,-1).toLowerCase(),a=t.includes(s),o=r.includes(s);return h(this,Oe)&&a||!h(this,Oe)&&(o||e==="")||(we.running||this.length>1)&&(a||o||e==="")?(this.setAttribute("modifier",e),S(this,Oe,a),!!e):!1}isTemplate(){return this.type==="template"||this.name==="invoke"}afterBuild(){this.modifier.includes("\0")&&this.setAttribute("modifier",this.buildFromStr(this.modifier,0))}toString(){return`{{${this.modifier}${this.type==="magic-word"?`${String(this.firstChild)}${this.length===1?"":":"}${this.childNodes.slice(1).map(String).join("|")}`:super.toString("|")}}}`}text(){let{childNodes:e,length:t,firstChild:r,modifier:n,type:s,name:a}=this;return s==="magic-word"&&a==="vardefine"?"":`{{${n}${s==="magic-word"?r.text()+(t===1?"":":")+ie(e.slice(1),"|"):super.text("|")}}}`}getAttribute(e){switch(e){case"padding":return this.modifier.length+2;default:return super.getAttribute(e)}}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{type:n,childNodes:s,length:a}=this,o;if(!this.isTemplate())return r;let p=$(this,Kt,gi).call(this);if(p.fragment!==void 0){o={start:e,...this.getRootNode().posFromIndex(e)};let d=s[n==="template"?0:1],u=C(d,o,"no-ignored","useless fragment"),c=d.childNodes.find(f=>f.type==="text"&&f.data.includes("#"));c&&(u.fix={range:[u.startIndex+c.getRelativeIndex()+c.data.indexOf("#"),u.endIndex],text:""}),r.push(u)}if(p.valid||(o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),r.push(C(s[1],o,"invalid-invoke","illegal module name"))),n==="magic-word"&&a===2)return o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),r.push(I(this,o,"invalid-invoke","missing module function")),r;let l=this.getDuplicatedArgs().filter(([,d])=>!d[0].querySelector("ext"));return l.length>0&&(o!=null||(o={start:e,...this.getRootNode().posFromIndex(e)}),r.push(...l.flatMap(([,d])=>d).map(d=>C(d,o,"no-duplicate","duplicated parameter")))),r}insertAt(e,t=this.length){return super.insertAt(e,t),e.anon?$(this,Jt,pi).call(this,e):e.name&&this.getArgs(e.name,!1,!1).add(e),e}getAllArgs(){return this.childNodes.filter(Ge("parameter"))}getAnonArgs(){return this.getAllArgs().filter(({anon:e})=>e)}getArgs(e,t,r=!0){let n=String(e).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),s;return h(this,_e).has(n)?s=h(this,_e).get(n):(s=new Set(this.getAllArgs().filter(({name:a})=>n===a)),h(this,_e).set(n,s)),s}getDuplicatedArgs(){return[...h(this,_e)].filter(([,{size:e}])=>e>1).map(([e,t])=>[e,[...t]])}getPossibleValues(){let{type:e,name:t,childNodes:r,constructor:{name:n}}=this;if(e==="template")throw new Error(`${n}.getPossibleValues \u65B9\u6CD5\u4EC5\u4F9B\u7279\u5B9A\u9B54\u672F\u5B57\u4F7F\u7528\uFF01`);let s;switch(t){case"if":case"ifexist":case"ifexpr":case"iferror":s=2;break;case"ifeq":s=3;break;default:throw new Error(`${n}.getPossibleValues \u65B9\u6CD5\u4EC5\u4F9B\u7279\u5B9A\u9B54\u672F\u5B57\u4F7F\u7528\uFF01`)}let a=r.slice(s,s+2).map(({childNodes:[,o]})=>o);for(let o=0;o<a.length;){let{length:p,0:l}=a[o].childNodes.filter(d=>d.text().trim());if(p===0)a.splice(o,1);else if(p>1||l.type!=="magic-word")o++;else try{let d=l.getPossibleValues();a.splice(o,1,...d),o+=d.length}catch(d){o++}}return a}print(){let{childNodes:e,length:t,firstChild:r,modifier:n,type:s}=this;return`<span class="wpb-${s}">{{${De(n)}${s==="magic-word"?r.print()+(t===1?"":":")+xe(e.slice(1),{sep:"|"}):xe(e,{sep:"|"})}}}</span>`}};Oe=new WeakMap,_e=new WeakMap,Kt=new WeakSet,gi=function(){let e=this.type==="template",t=this.childNodes[e?0:1];return this.normalizeTitle(t.text(),e?10:828)},Jt=new WeakSet,pi=function(e){let t=this.getAnonArgs(),r=typeof e!="number";for(let n=r?t.indexOf(e):e-1;n<t.length;n++){let s=t[n],{name:a}=s,o=String(n+1);a!==o&&(s.setAttribute("name",o),this.getArgs(o,!1,!1).add(s))}}});var Yt,ci=y(()=>{"use strict";Be();P();Yt=class extends se(b){constructor(){super(...arguments);x(this,"type","hidden")}}});var er,hi=y(()=>{"use strict";D();j();N();P();Te();ci();er=class extends b{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});x(this,"type","arg");for(let n=0;n<e.length;n++)if(n===0){let s=new _(e[n],"arg-name",t,r,{});super.insertAt(s)}else if(n>1){let s=new Yt(e[n],t,r,{});super.insertAt(s)}else{let s=new b(e[n],t,r);s.type="arg-default",s.setAttribute("stage",2),super.insertAt(s)}}get default(){var e,t;return(t=(e=this.childNodes[1])==null?void 0:e.text())!=null?t:!1}toString(){return`{{{${super.toString("|")}}}}`}text(){return`{{{${ie(this.childNodes.slice(0,2),"|")}}}}`}getAttribute(e){return e==="padding"?3:super.getAttribute(e)}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let{childNodes:[r,n,...s]}=this;if(!this.getAttribute("include")){let o=I(this,{start:e},"no-arg","unexpected template argument");return n&&(o.fix={range:[e,o.endIndex],text:n.text()}),[o]}let a=r.lint(e+3,t);if(n&&a.push(...n.lint(e+4+String(r).length,t)),s.length>0){let o={start:e,...this.getRootNode().posFromIndex(e)};a.push(...s.map(p=>{let l=C(p,o,"no-ignored","invisible content inside triple braces");return l.startIndex--,l.startCol--,l.suggestions=[{desc:"remove",range:[l.startIndex,l.endIndex],text:""},{desc:"escape",range:[l.startIndex,l.startIndex+1],text:"{{!}}"}],l}))}return a}print(){return super.print({pre:"{{{",post:"}}}",sep:"|"})}json(){let e=super.json();return e.default=this.default,e}}});var mi={};W(mi,{parseBraces:()=>Dr});var Dr,Hr=y(()=>{"use strict";D();Ur();ui();hi();Dr=(g,i,e)=>{var c,f,T,A,F,L;let t=`${(c=i.excludes)!=null&&c.includes("heading")?"":"^(\0\\d+c\x7F)*={1,6}|"}\\[\\[|\\{{2,}|-\\{(?!\\{)`,{parserFunction:[,,,r]}=i,n=[],s={"=":`
`,"{":"\\}{2,}|\\|","-":"\\}-","[":"\\]\\]"},a=new Map([["!","!"],["!!","+"],["(!","{"],["!)","}"],["!-","-"],["=","~"]]),o=new RegExp(`\\{\\{\\s*(${[...a.keys()].map(qt).join("|")})\\s*\\}\\}(?!\\})`,"gu");g=g.replace(o,(v,w)=>(new It(v.slice(2,-2),[],i,e),`\0${e.length-2}${a.get(w)}\x7F`));let p=new RegExp(t,"gmu"),l=p.exec(g),d=g.includes("}}"),u;for(;l||u!==void 0&&u<=g.length&&((T=(f=n[n.length-1])==null?void 0:f[0])!=null&&T.startsWith("="));){if(l!=null&&l[1]){let[,{length:E}]=l;l[0]=l[0].slice(E),l.index+=E}let{0:v,index:w}=l!=null?l:{0:`
`,index:g.length},R=(A=n.pop())!=null?A:{},{0:G,index:B,parts:O,findEqual:ee,pos:pe}=R,Le=v==="="&&ee,Re=E=>{O[O.length-1].push(E.slice(pe,w))};if(v==="]]"||v==="}-")u=w+2;else if(v===`
`){u=w+1;let{pos:E,findEqual:te}=(F=n[n.length-1])!=null?F:{};if(E===void 0||te||ne(g.slice(E,B))!==""){let J=/^(={1,6})(.+)\1((?:\s|\0\d+c\x7F)*)$/u.exec(g.slice(B,w));J&&(g=`${g.slice(0,B)}\0${e.length}h\x7F${g.slice(w)}`,u=B+4+String(e.length).length,new et(J[1].length,J.slice(2),i,e))}}else if(v==="|"||Le)u=w+1,Re(g),v==="|"&&O.push([]),R.pos=u,R.findEqual=v==="|",n.push(R);else if(v.startsWith("}}")){let E=v.slice(0,Math.min(G.length,3)),te=G.length-E.length,{length:J}=e;u=w+E.length,Re(g);let ht=!1,Ae="t";if(E.length===3){let U=O.map(mt=>mt.join("=")),ve=U.length>1&&ne(U[1]).trim();new er(U,i,e),ve&&ve.endsWith(":")&&r.includes(ve.slice(0,-1).toLowerCase())&&(Ae="s")}else try{new It(O[0][0],O.slice(1),i,e);let U=ne(O[0][0]).trim();a.has(U)?Ae=a.get(U):/^(?:filepath|(?:full|canonical)urle?):.|^server$/iu.test(U)?Ae="m":/^#vardefine:./iu.test(U)&&(Ae="c")}catch(U){if(U instanceof SyntaxError&&U.message==="\u975E\u6CD5\u7684\u6A21\u677F\u540D\u79F0")ht=!0;else throw U}ht||(g=`${g.slice(0,B+te)}\0${J}${Ae}\x7F${g.slice(u)}`,u=B+te+3+String(J).length,te>1?n.push({0:G.slice(0,te),index:B,pos:B+te,parts:[[]]}):te===1&&g[B-1]==="-"&&n.push({0:"-{",index:B-1,pos:B+1,parts:[[]]}))}else u=w+v.length,v.startsWith("{")&&(l.pos=u,l.parts=[[]]),n.push(..."0"in R?[R]:[],l);d&&(d=g.slice(u).includes("}}"));let V=n[n.length-1];!d&&((L=V==null?void 0:V[0])!=null&&L.startsWith("{"))&&(n.pop(),V=n[n.length-1]),p=new RegExp(t+(V?`|${s[V[0][0]]}${V.findEqual?"|=":""}`:""),"gmu"),p.lastIndex=u,l=p.exec(g)}return g}});var fi={};W(fi,{InputboxToken:()=>Vr});var Vr,xi=y(()=>{"use strict";Hr();N();Wr();Vr=class extends Nt{constructor(i,e=m.getConfig(),t=[]){let r=Symbol("InputboxToken"),{length:n}=t;t.push(r),i&&(i=Dr(i,e,t)),t.splice(n,1),super(i,e,t,{})}}});var tt,Xr=y(()=>{"use strict";j();Be();N();Ce();tt=class extends se(K){constructor(e,t=!0,r=m.getConfig(),n=[]){super(e,r,n);x(this,"type","comment");x(this,"closed");this.closed=t}getAttribute(e){return e==="padding"?4:super.getAttribute(e)}lint(e=this.getAbsoluteIndex()){if(this.closed)return[];let t=I(this,{start:e},"unclosed-comment",m.msg("unclosed $1","HTML comment"));return t.fix={range:[t.endIndex,t.endIndex],text:"-->"},[t]}toString(){return`<!--${this.innerText}${this.closed?"-->":""}`}print(){return super.print({pre:"&lt;!--",post:this.closed?"--&gt;":""})}}});var tr={};W(tr,{NestedToken:()=>Qr});var Qr,rr=y(()=>{"use strict";j();N();P();Zr();Ne();Xr();Qr=class extends b{constructor(e,t,r,n=m.getConfig(),s=[]){e=e==null?void 0:e.replace(t,(a,o,p,l,d)=>{let u=`\0${s.length+1}${o?"e":"c"}\x7F`;if(o)new rt(o,p,l,d,n,s);else{let c=a.endsWith("-->");new tt(a.slice(4,c?-3:void 0),c,n,s)}return u}).replace(/(^|\0\d+[ce]\x7F)([^\0]+)(?=$|\0\d+[ce]\x7F)/gu,(a,o,p)=>(new H(p,n,s),`${o}\0${s.length}c\x7F`));super(e,n,s,{});x(this,"type","ext-inner")}lint(e=this.getAbsoluteIndex(),t){let r;return[...super.lint(e,t),...this.childNodes.filter(n=>{if(n.type==="ext"||n.type==="comment")return!1;let s=String(n).trim();return s&&!/^<!--.*-->$/su.test(s)}).map(n=>{r!=null||(r={start:e,...this.getRootNode().posFromIndex(e)});let s=C(n,r,"no-ignored",m.msg("invalid content in <$1>",this.name));return s.suggestions=[{desc:"remove",range:[s.startIndex,s.endIndex],text:""},{desc:"comment",range:[s.startIndex,s.startIndex],text:`<!--${String(n)}-->`}],s})]}}});function Ti(g,i,e,t,r){i=i.trim();let n=i.replace(/\0\d+t\x7F/gu,"").trim();switch(g){case"width":return!n||/^(?:\d+x?|\d*x\d+)(?:\s*px)?$/u.test(n);case"link":{if(!n||new RegExp(`^(?:(?:${e.protocol}|//)${he}|\0\\d+m\x7F)${me}$`,"iu").test(n))return i;n.startsWith("[[")&&n.endsWith("]]")&&(n=n.slice(2,-2));let a=m.normalizeTitle(n,0,!1,e,t,!0,!0);return a.valid&&a}case"lang":return(r==="svg"||r==="svgz")&&!/[^a-z\d-]/u.test(n);case"alt":case"class":case"manualthumb":return!0;case"page":return(r==="djvu"||r==="djv"||r==="pdf")&&Number(n)>0;default:return!!n&&!isNaN(n)}}var Vs,Y,ir,bi,nr,ki=y(()=>{"use strict";D();j();N();P();Vs=new Set(["alt","link","lang","page","caption"]);nr=class extends b{constructor(e,t,r=m.getConfig(),n=[]){var i=(...od)=>(super(...od),k(this,ir),x(this,"type","image-parameter"),k(this,Y,""),this);var p;let s,a=Object.entries(r.img).map(([l,d])=>[l,d,new RegExp(`^(\\s*)${l.replace("$1","(.*)")}(\\s*)$`,"u")]),o=a.find(([,l,d])=>(s=d.exec(e),s&&(s.length!==4||Ti(l,s[2],r,!0,t)!==!1)));if(o&&s){s.length===3?(i(void 0,r,n),S(this,Y,e)):(i(s[2],r,n,{}),S(this,Y,s[1]+o[0]+s[3])),this.setAttribute("name",o[1]);return}i(e,{...r,excludes:[...(p=r.excludes)!=null?p:[],"list"]},n),this.setAttribute("name","caption"),this.setAttribute("stage",7)}get link(){return this.name==="link"?Ti("link",super.text(),this.getAttribute("config")):void 0}afterBuild(){var e;((e=this.parentNode)==null?void 0:e.type)==="gallery-image"&&!Vs.has(this.name)&&this.setAttribute("name","invalid")}toString(){return h(this,Y)?h(this,Y).replace("$1",super.toString()):super.toString()}text(){return h(this,Y)?h(this,Y).replace("$1",super.text()).trim():super.text().trim()}getAttribute(e){return e==="plain"?this.name==="caption":e==="padding"?Math.max(0,h(this,Y).indexOf("$1")):super.getAttribute(e)}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{link:n,name:s}=this;if(s==="invalid"){let a=I(this,{start:e},"invalid-gallery","invalid gallery image parameter");a.fix={range:[e,e+a.endIndex],text:""},r.push(a)}else typeof n=="object"&&n.encoded&&r.push(I(this,{start:e},"url-encoding","unnecessary URL encoding in an internal link"));return r}getValue(){return this.name==="invalid"?this.text():$(this,ir,bi).call(this)||super.text()}print(){return h(this,Y)?`<span class="wpb-image-parameter">${h(this,Y).replace("$1",`<span class="wpb-image-caption">${xe(this.childNodes)}</span>`)}</span>`:super.print({class:"image-caption"})}};Y=new WeakMap,ir=new WeakSet,bi=function(){return h(this,Y)&&!h(this,Y).includes("$1")}});var Kr,Jr,Yr,Xs,nt,sr,it,en=y(()=>{"use strict";D();j();N();St();ki();Kr=new Set(["manualthumb","frameless","framed","thumbnail"]),Jr=new Set(["left","right","center","none"]),Yr=new Set(["baseline","sub","super","top","text-top","middle","bottom","text-bottom"]),Xs=(g,i,e,t)=>{if(t===void 0)return[];let r=new RegExp(`${[g,i,e].map(qt).join("|")}`,"gu"),n=[],s=r.exec(t),a=0,o=0;for(;s;){let{0:p,index:l}=s;p!==e?a+=p===g?1:-1:a===0&&(n.push(t.slice(o,l)),{lastIndex:o}=r),s=r.exec(t)}return n.push(t.slice(o)),n},it=class extends fe{constructor(e,t,r=m.getConfig(),n=[],s="|"){super(e,void 0,r,n,s);k(this,nt);x(this,"type","file");let{extension:a}=this.getTitle(!0);this.append(...Xs("-{","}-","|",t).map(o=>new nr(o,a,r,n)))}get extension(){return this.getTitle().extension}lint(e=this.getAbsoluteIndex(),t){var u;let r=super.lint(e,t),n=this.getAllArgs().filter(({childNodes:c})=>{let f=c.filter(T=>T.text().trim());return f.length!==1||f[0].type!=="arg"}),s=[...new Set(n.map(({name:c})=>c))].filter(c=>c!=="invalid"),a=s.filter(c=>Kr.has(c)),o=s.filter(c=>Jr.has(c)),p=s.filter(c=>Yr.has(c));if(this.closest("ext-link-text")&&((u=this.getValue("link"))==null?void 0:u.trim())!==""&&r.push(I(this,{start:e},"nested-link","internal link in an external link")),n.length===s.length&&a.length<2&&o.length<2&&p.length<2)return r;let l={start:e,...this.getRootNode().posFromIndex(e)},d=(c,f)=>T=>C(T,l,"no-duplicate",m.msg(`${c} image $1 parameter`,f));for(let c of s){let f=n.filter(({name:T})=>T===c);c==="caption"&&(f=[...f.slice(0,-1).filter(T=>T.text()),...f.slice(-1)]),f.length>1&&r.push(...f.map(d("duplicated",c)))}return a.length>1&&r.push(...n.filter(({name:c})=>Kr.has(c)).map(d("conflicting","frame"))),o.length>1&&r.push(...n.filter(({name:c})=>Jr.has(c)).map(d("conflicting","horizontal-alignment"))),p.length>1&&r.push(...n.filter(({name:c})=>Yr.has(c)).map(d("conflicting","vertical-alignment"))),r}getAllArgs(){return this.childNodes.slice(1)}getArgs(e){return this.getAllArgs().filter(({name:t})=>e===t)}getFrameArgs(){return $(this,nt,sr).call(this,Kr,"\u6846\u67B6")}getHorizAlignArgs(){return $(this,nt,sr).call(this,Jr,"\u6C34\u5E73\u5BF9\u9F50")}getVertAlignArgs(){return $(this,nt,sr).call(this,Yr,"\u5782\u76F4\u5BF9\u9F50")}getArg(e){let t=this.getArgs(e);return t[t.length-1]}getValue(e){var t;return(t=this.getArg(e))==null?void 0:t.getValue()}};nt=new WeakSet,sr=function(e,t){return this.getAllArgs().filter(({name:n})=>e.has(n))}});var or,yi,st,tn=y(()=>{"use strict";j();ce();N();P();en();st=class extends it{constructor(e,t,r,n=m.getConfig(),s=[]){let a;if(r!==void 0){let{length:o}=s;a=new b(r,n,s);for(let p=1;p<11;p++)a.parseOnce();s.splice(o,1)}super(t,a==null?void 0:a.toString(),n,s);k(this,or);this.setAttribute("bracket",!1),this.type=`${e}-image`}getTitle(){let e=this.type==="imagemap-image";return this.normalizeTitle(String(this.firstChild),e?0:6,!0,!e)}getAttribute(e){return e==="padding"?0:super.getAttribute(e)}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),{ns:n,interwiki:s}=this.getAttribute("title");return(s||n!==6)&&r.push(I(this,{start:e},"invalid-gallery","invalid gallery image")),r}afterBuild(){$(this,or,yi).call(this,this.getTitle())}};or=new WeakSet,yi=function(e){this.setAttribute("title",e)}});var vi={};W(vi,{GalleryToken:()=>rn});var ar,Ai,rn,wi=y(()=>{"use strict";N();P();tn();Ne();rn=class extends b{constructor(e,t=m.getConfig(),r=[]){var n;super(void 0,t,r,{});k(this,ar);x(this,"type","ext-inner");for(let s of(n=e==null?void 0:e.split(`
`))!=null?n:[]){let a=/^([^|]+)(?:\|(.*))?/u.exec(s);if(!a){super.insertAt(s.trim()?new H(s,t):s);continue}let[,o,p]=a;$(this,ar,Ai).call(this,o)?super.insertAt(new st("gallery",o,p,t,r)):super.insertAt(new H(s,t))}}toString(){return super.toString(`
`)}text(){return super.text(`
`).replace(/\n\s*\n/gu,`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let{top:r,left:n}=this.getRootNode().posFromIndex(e),s=[];for(let a=0;a<this.length;a++){let o=this.childNodes[a],p=String(o),{length:l}=p,d=p.trim(),u=r+a,c=a?0:n;o.type==="noinclude"&&d&&!/^<!--.*-->$/u.test(d)?s.push({rule:"no-ignored",message:m.msg("invalid content in <$1>","gallery"),severity:d.startsWith("|")?"warning":"error",startIndex:e,endIndex:e+l,startLine:u,endLine:u,startCol:c,endCol:c+l,suggestions:[{desc:"remove",range:[e,e+l],text:""},{desc:"comment",range:[e,e+l],text:`<!--${p}-->`}]}):o.type!=="noinclude"&&o.type!=="text"&&s.push(...o.lint(e,t)),e+=l+1}return s}print(){return super.print({sep:`
`})}};ar=new WeakSet,Ai=function(e){return this.normalizeTitle(e,6,!0,!0).valid}});var ot,nn=y(()=>{"use strict";j();St();ot=class extends fe{constructor(){super(...arguments);x(this,"type","link")}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);return this.closest("ext-link-text")&&r.push(I(this,{start:e},"nested-link","internal link in an external link")),r}}});var Qs,be,lr=y(()=>{"use strict";j();D();N();P();Qs="(?:[\\p{Zs}\\t]|&nbsp;|&#0*160;|&#[xX]0*[aA]0;)",be=class extends b{get link(){let i={"!":"|","=":"="},e=ie(this.childNodes.map(t=>{let{type:r,name:n}=t;return r==="magic-word"&&String(n)in i?i[n]:t}));return this.type==="magic-link"&&(e=e.replace(new RegExp(`${Qs}+`,"gu")," "),e.startsWith("ISBN")&&(e=`ISBN ${e.slice(5).replace(/[- ]/gu,"").replace(/x$/u,"X")}`)),e}constructor(i,e="free-ext-link",t=m.getConfig(),r=[]){super(i,t,r,{}),this.type=e}lint(i=this.getAbsoluteIndex(),e){let t=super.lint(i,e),r;if(this.type==="magic-link"){let{link:o}=this;if(o.startsWith("ISBN")){let p=[...o.slice(5)].map(l=>l==="X"?10:Number(l));(p.length===10&&p.reduce((l,d,u)=>l+d*(10-u),0)%11||p.length===13&&(p[12]===10||p.reduce((l,d,u)=>l+d*(u%2?3:1),0)%10))&&(r={start:i,...this.getRootNode().posFromIndex(i)},t.push(I(this,r,"invalid-isbn","invalid ISBN")))}return t}let n=`[\uFF0C\uFF1B\u3002\uFF1A\uFF01\uFF1F\uFF08\uFF09]+${this.type==="ext-link-url"?"|\\|+":""}`,s=new RegExp(n,"u"),a=new RegExp(n,"gu");for(let o of this.childNodes){let{type:p,data:l}=o;if(p!=="text"||!s.test(l))continue;r!=null||(r={start:i,...this.getRootNode().posFromIndex(i)});let d=C(o,r,"unterminated-url","","warning");a.lastIndex=0;for(let u=a.exec(l);u;u=a.exec(l)){let{index:c,0:f}=u,T=l.slice(0,c).split(`
`),A=T.length,F=T[A-1].length,L=d.startIndex+c,v=d.startLine+A-1,w=A===1?d.startCol+F:F,R=f.startsWith("|"),G={...d,message:m.msg("$1 in URL",R?'"|"':"full-width punctuation"),startIndex:L,endIndex:L+f.length,startLine:v,endLine:v,startCol:w,endCol:w+f.length};R?f.length===1&&(G.suggestions=[{desc:"whitespace",range:[L,L+1],text:" "}]):G.suggestions=[{desc:"whitespace",range:[L,L],text:" "},{desc:"escape",range:[L,G.endIndex],text:encodeURI(f)}],t.push(G)}}return t}}});var ke,at,sn=y(()=>{"use strict";ce();j();N();P();lr();at=class extends b{constructor(e,t="",r="",n=m.getConfig(),s=[]){super(void 0,n,s,{});x(this,"type","ext-link");k(this,ke,void 0);let a=e&&/\0\d+f\x7F/u.test(e)?s[Number(e.slice(1,-2))]:new be(e,"ext-link-url",n,s);if(this.insertAt(a),S(this,ke,t),r){let o=new b(r,n,s,{});o.type="ext-link-text",o.setAttribute("stage",10),this.insertAt(o)}}toString(){return this.length===1?`[${super.toString()}${h(this,ke)}]`:`[${super.toString(h(this,ke))}]`}text(){return`[${super.text(" ")}]`}getAttribute(e){return e==="padding"?1:super.getAttribute(e)}getGaps(){return h(this,ke).length}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);return this.length===1&&this.closest("heading-title")&&r.push(I(this,{start:e},"var-anchor","variable anchor in a section header")),r}print(){return super.print(this.length===1?{pre:"[",post:`${h(this,ke)}]`}:{pre:"[",sep:h(this,ke),post:"]"})}};ke=new WeakMap});var Et,Si=y(()=>{"use strict";N();P();Ne();nn();sn();Et=class extends b{constructor(e,t,r,n=m.getConfig(),s=[]){super(void 0,n,s);x(this,"type","imagemap-link");this.append(e,t.length===2?new ot(...t,n,s):new at(...t,n,s),new H(r,n,s))}}});var Ci={};W(Ci,{ImagemapToken:()=>on});var on,Ni=y(()=>{"use strict";j();je();N();P();Ne();tn();Si();on=class extends b{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});x(this,"type","ext-inner");if(!e)return;let n=e.split(`
`),s=new Set(t.protocol.split("|")),a=H,o=!0,p=!1;for(let l of n){let d=l.trim();if(!(p||!d||d.startsWith("#"))){if(o){let[u,...c]=l.split("|"),f=this.normalizeTitle(u,0,!0);if(f.valid&&!f.interwiki&&f.ns===6){let T=new st("imagemap",u,c.length>0?c.join("|"):void 0,t,r);super.insertAt(T),o=!1;continue}else p=!0}else if(l.trim().split(/[\t ]/u)[0]==="desc"){super.insertAt(l);continue}else if(l.includes("[")){let u=l.indexOf("["),c=l.slice(u),f=/^\[\[([^|]+)(?:\|([^\]]+))?\]\][\w\s]*$/u.exec(c);if(f){if(this.normalizeTitle(f[1],0,!0,!1,!0).valid){super.insertAt(new Et(l.slice(0,u),f.slice(1),c.slice(c.indexOf("]]")+2),t,r));continue}}else if(s.has(c.slice(1,c.indexOf(":")+1))||s.has(c.slice(1,c.indexOf("//")+2))){let T=/^\[([^\]\s]+)(?:(\s+(?=\S))([^\]]*))?\][\w\s]*$/u.exec(c);if(T){super.insertAt(new Et(l.slice(0,u),T.slice(1),c.slice(c.indexOf("]")+1),t,r));continue}}}}super.insertAt(new a(l,t,r))}}get image(){return this.childNodes.find(Ge("imagemap-image"))}toString(){return super.toString(`
`)}text(){return super.text(`
`).replace(/\n{2,}/gu,`
`)}getGaps(){return 1}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),n={start:e,...this.getRootNode().posFromIndex(e)};return this.image?r.push(...this.childNodes.filter(s=>{let a=String(s).trim();return s.type==="noinclude"&&a&&!a.startsWith("#")}).map(s=>C(s,n,"invalid-imagemap","invalid link in <imagemap>"))):r.push(I(this,n,"invalid-imagemap","<imagemap> without an image")),r}print(){return super.print({sep:`
`})}}});var $i={};W($i,{NowikiToken:()=>an});var an,Ii=y(()=>{"use strict";j();N();Ce();an=class extends K{constructor(){super(...arguments);x(this,"type","ext-inner")}lint(e=this.getAbsoluteIndex()){let{name:t,firstChild:{data:r}}=this;if((t==="templatestyles"||t==="section")&&r){let n=I(this,{start:e},"void-ext",m.msg("nothing should be in <$1>",t));return n.fix={range:[e-1,n.endIndex+t.length+3],text:"/>"},[n]}return super.lint(e,new RegExp(`<\\s*(?:\\/\\s*)${t==="nowiki"?"":"?"}(${t})\\b`,"giu"))}}});var Ei,rt,Zr=y(()=>{"use strict";j();N();P();_r();Xt();Ei=(g,i)=>{let e=new Set(g);return e.delete(i),[...e]},rt=class extends Ze{constructor(e,t,r,n,s=m.getConfig(),a=[]){var u;let o=e.toLowerCase(),p=new Ee(!t||t.trimStart()!==t?t:` ${t}`,"ext-attrs",o,s,a),l={...s,ext:Ei(s.ext,o),excludes:[...(u=s.excludes)!=null?u:[]]},d;switch(l.inExt=!0,o){case"tab":l.ext=Ei(l.ext,"tabs");case"indicator":case"poem":case"ref":case"option":case"combooption":case"tabs":case"poll":case"seo":o==="poem"&&l.excludes.push("heading"),d=new b(r,l,a);break;case"pre":{let{PreToken:c}=(ai(),M(oi));d=new c(r,l,a);break}case"dynamicpagelist":{let{ParamTagToken:c}=(Wr(),M(li));d=new c(r,l,a);break}case"inputbox":{l.excludes.push("heading");let{InputboxToken:c}=(xi(),M(fi));d=new c(r,l,a);break}case"references":{let{NestedToken:c}=(rr(),M(tr));d=new c(r,/<!--.*?(?:-->|$)|<(ref)(\s[^>]*)?>(.*?)<\/(ref\s*)>/gisu,["ref"],l,a);break}case"choose":{let{NestedToken:c}=(rr(),M(tr));d=new c(r,/<(option|choicetemplate)(\s[^>]*)?>(.*?)<\/(\1)>/gsu,["option","choicetemplate"],l,a);break}case"combobox":{let{NestedToken:c}=(rr(),M(tr));d=new c(r,/<(combooption)(\s[^>]*)?>(.*?)<\/(combooption\s*)>/gisu,["combooption"],l,a);break}case"gallery":{let{GalleryToken:c}=(wi(),M(vi));d=new c(r,l,a);break}case"imagemap":{let{ImagemapToken:c}=(Ni(),M(Ci));d=new c(r,l,a);break}default:{let{NowikiToken:c}=(Ii(),M($i));d=new c(r,l)}}d.setAttribute("name",o),d.type="ext-inner";super(e,p,d,n,s,a);x(this,"type","ext");this.seal("closed",!0)}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t),n;return this.name!=="nowiki"&&this.closest("html-attrs, table-attrs")&&(n={start:e,...this.getRootNode().posFromIndex(e)},r.push(I(this,n,"parsing-order","extension tag in HTML tag attributes"))),this.name==="ref"&&this.closest("heading-title")&&(n!=null||(n={start:e,...this.getRootNode().posFromIndex(e)}),r.push(I(this,n,"var-anchor","variable anchor in a section header"))),r}}});var Fi={};W(Fi,{parseCommentAndExt:()=>Zs});var Zs,Li=y(()=>{"use strict";Qn();Ne();Zn();Zr();Xr();Zs=(g,i,e,t)=>{let r="<onlyinclude>",n="</onlyinclude>",{length:s}=r,a=()=>{let u=g.indexOf(r);return{i:u,j:g.indexOf(n,u+s)}};if(t){let{i:u,j:c}=a();if(u!==-1&&c!==-1){let f="",T=A=>{new H(A,i,e),f+=`\0${e.length-1}c\x7F`};for(;u!==-1&&c!==-1;){let A=`\0${e.length}e\x7F`;new Ut(g.slice(u+s,c),i,e),u>0&&T(g.slice(0,u)),f+=A,g=g.slice(c+s+1),{i:u,j:c}=a()}return g&&T(g),f}}let o=i.ext.join("|"),p=t?"includeonly":"(?:no|only)include",l=t?"noinclude":"includeonly",d=new RegExp(`<!--.*?(?:-->|$)|<${p}(?:\\s[^>]*)?/?>|</${p}\\s*>|<(${o})(\\s[^>]*?)?(?:/>|>(.*?)</(\\1\\s*)>)|<(${l})(\\s[^>]*?)?(?:/>|>(.*?)(?:</(${l}\\s*)>|$))`,"gisu");return g.replace(d,(u,c,f,T,A,F,L,v,w)=>{let R=`\0${e.length}${c?"e":"c"}\x7F`;if(c)new rt(c,f,T,A,i,e);else if(u.startsWith("<!--")){let G=u.endsWith("-->");new tt(u.slice(4,G?-3:void 0),G,i,e)}else F?new Dt(F,L,v,w,i,e):new H(u,i,e);return R})}});var Ks,Js,Ys,lt,le,Fe,dr,Ri=y(()=>{"use strict";j();D();N();P();Ks=new Set(["if","ifeq","ifexpr","ifexist","iferror","switch"]),Js=new Set(["b","big","center","cite","code","del","dfn","em","font","i","ins","kbd","mark","pre","q","s","samp","small","strike","strong","sub","sup","tt","u","var"]),Ys=new Set(["strike","big","center","font","tt"]),dr=class extends b{constructor(e,t,r,n,s=m.getConfig(),a=[]){super(void 0,s,a);x(this,"type","html");k(this,lt,void 0);k(this,le,void 0);k(this,Fe,void 0);this.insertAt(t),this.setAttribute("name",e.toLowerCase()),S(this,lt,r),S(this,le,n),S(this,Fe,e)}get selfClosing(){return h(this,le)}get closing(){return h(this,lt)}toString(){return`<${this.closing?"/":""}${h(this,Fe)}${super.toString()}${h(this,le)?"/":""}>`}text(){let{closing:e}=this,t=h(this,Fe)+(e?"":super.text());return`<${e?"/":""}${t}${h(this,le)?"/":""}>`}getAttribute(e){return e==="padding"?h(this,Fe).length+(this.closing?2:1):super.getAttribute(e)}lint(e=this.getAbsoluteIndex(),t){var s;let r=super.lint(e,t),n;this.name==="h1"&&!this.closing&&(n=I(this,{start:e},"h1","<h1>"),r.push(n)),this.closest("table-attrs")&&(n!=null||(n=I(this,{start:e},"h1","")),r.push({...n,rule:"parsing-order",message:m.msg("HTML tag in table attributes")}));try{this.findMatchingTag()}catch(a){if(a instanceof SyntaxError){let{message:o}=a;n!=null||(n=I(this,{start:e},"h1",""));let[p]=o.split(":"),l={...n,rule:"unmatched-tag",message:m.msg(p)};if(p==="unclosed tag"&&!this.closest("heading-title"))if(Js.has(this.name)){let d=(s=this.parentNode)==null?void 0:s.childNodes,u=d==null?void 0:d.indexOf(this);d!=null&&d.slice(0,u).some(({type:c,name:f})=>c==="html"&&f===this.name)||(l.severity="warning")}else l.severity="warning";else if(p==="unmatched closing tag"){let d=this.closest("magic-word");d&&Ks.has(d.name)?l.severity="warning":l.suggestions=[{desc:"remove",range:[e,l.endIndex],text:""}]}else if(p==="tag that is both closing and self-closing"){let{html:[,,d]}=this.getAttribute("config");d.includes(this.name)&&(l.fix={range:[e+1,e+2],text:""})}r.push(l)}}return Ys.has(this.name)&&(n!=null||(n=I(this,{start:e},"h1","")),r.push({...n,rule:"obsolete-tag",message:m.msg("obsolete HTML tag"),severity:"warning"})),(this.name==="b"||this.name==="strong")&&this.closest("heading-title")&&(n!=null||(n=I(this,{start:e},"h1","")),r.push({...n,rule:"bold-header",message:m.msg("bold in section header"),severity:"warning"})),r}findMatchingTag(){let{html:[e,t,r]}=this.getAttribute("config"),{name:n,parentNode:s,closing:a}=this,o=Pn(String(this));if(a&&(h(this,le)||r.includes(n)))throw new SyntaxError(`tag that is both closing and self-closing: ${o}`);if(r.includes(n)||h(this,le)&&t.includes(n))return this;if(h(this,le)&&e.includes(n))throw new SyntaxError(`invalid self-closing tag: ${o}`);if(!s)return;let{childNodes:p}=s,l=p.indexOf(this),d=(a?p.slice(0,l).reverse():p.slice(l+1)).filter(c=>c.type==="html"&&c.name===n),u=a?-1:1;for(let c of d)if(h(c,lt)?u--:u++,u===0)return c;throw new SyntaxError(`${a?"unmatched closing":"unclosed"} tag: ${o}`)}print(){return super.print({pre:`&lt;${this.closing?"/":""}${h(this,Fe)}`,post:`${h(this,le)?"/":""}&gt;`})}json(){let e=super.json();return Object.assign(e,{closing:this.closing,selfClosing:h(this,le)}),e}};lt=new WeakMap,le=new WeakMap,Fe=new WeakMap});var Pi={};W(Pi,{parseHtml:()=>eo});var eo,Gi=y(()=>{"use strict";Xt();Ri();eo=(g,i,e)=>{let t=/^(\/?)([a-z][^\s/>]*)((?:\s|\/(?!>))[^>]*?)?(\/?>)([^<]*)$/iu,r=new Set(i.html.flat()),n=g.split("<"),s=n.shift();for(let a of n){let o=t.exec(a),p=o==null?void 0:o[2],l=p==null?void 0:p.toLowerCase();if(!o||!r.has(l)){s+=`<${a}`;continue}let[,d,,u="",c,f]=o,{length:T}=e,A=new Ee(u,"html-attrs",l,i,e),F=A.getAttr("itemprop");if(l==="meta"&&(F===void 0||A.getAttr("content")===void 0)||l==="link"&&(F===void 0||A.getAttr("href")===void 0)){s+=`<${a}`,e.length=T;continue}s+=`\0${e.length}x\x7F${f}`,new dr(p,A,d==="/",c==="/>",i,e)}return s}});var ji,qi=y(()=>{"use strict";ji=(g=0)=>(i,e)=>{var r,Bi;class t extends i{constructor(){super(...arguments);k(this,r)}getAttr(o){return h(this,r,Bi).getAttr(o)}}return r=new WeakSet,Bi=function(){return this.childNodes[g]},Object.defineProperty(t,"name",{value:i.name}),t}});var dt,ln=y(()=>{"use strict";qi();N();P();Xe();Xt();dt=class extends ji(1)(b){constructor(i,e,t,r=m.getConfig(),n=[],s={}){super(void 0,r,n,s),this.append(new oe(e,i,"table-syntax",r,n,{}),new Ee(t,"table-attrs",this.type,r,n))}}});var de,Ft,dn,Me,gn=y(()=>{"use strict";j();ce();N();P();ln();Me=class extends dt{constructor(e,t,r=m.getConfig(),n=[]){var p;let s=/\||\0\d+!\x7F/u.exec(t!=null?t:""),a=s?t.slice(0,s.index):"";/\[\[|-\{/u.test(a)&&(s=null,a="");super(/^(?:\n[^\S\n]*(?:[|!]|\|\+|\{\{\s*!\s*\}\}\+?)|(?:\||\{\{\s*!\s*\}\}){2}|!!|\{\{\s*!!\s*\}\})$/u,e,a,r,n);k(this,Ft);x(this,"type","td");k(this,de,"");s&&([Bt(this,de)._]=s);let o=new b(t==null?void 0:t.slice(((p=s==null?void 0:s.index)!=null?p:NaN)+h(this,de).length),r,n);o.type="td-inner",o.setAttribute("stage",4),this.insertAt(o)}get rowspan(){return this.getAttr("rowspan")}get colspan(){return this.getAttr("colspan")}get subtype(){return $(this,Ft,dn).call(this).subtype}afterBuild(){h(this,de).includes("\0")&&S(this,de,this.buildFromStr(h(this,de),0))}toString(){let{childNodes:[e,t,r]}=this;return String(e)+String(t)+h(this,de)+String(r)}text(){let{childNodes:[e,t,r]}=this;return e.text()+t.text()+h(this,de)+r.text()}getGaps(e){return e===1?h(this,de).length:0}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);e+=this.getRelativeIndex(this.length-1);for(let n of this.lastChild.childNodes)if(n.type==="text"){let{data:s}=n;if(s.includes("|")){let a=s.includes("||"),o=C(n,{start:e},"pipe-like",'additional "|" in a table cell',a?"error":"warning");if(a){let p={caption:"|+",td:"|",th:"!"}[this.subtype];o.fix={range:[o.startIndex,o.endIndex],text:s.replace(/\|\|/gu,`
${p}`)}}else o.suggestions=[{desc:"escape",range:[o.startIndex,o.endIndex],text:s.replace(/\|/gu,"&#124;")}];r.push(o)}}return r}isIndependent(){return this.firstChild.text().startsWith(`
`)}getAttr(e){let t=super.getAttr(e);return e==="rowspan"||e==="colspan"?parseInt(t)||1:t}print(){let{childNodes:[e,t,r]}=this;return`<span class="wpb-td">${e.print()}${t.print()}${h(this,de)}${r.print()}</span>`}json(){let e=super.json();return e.subtype=this.subtype,e}};de=new WeakMap,Ft=new WeakSet,dn=function(){var a;let e=this.firstChild.text(),t=e.slice(-1),r="td";if(t==="!"?r="th":t==="+"&&(r="caption"),this.isIndependent())return{subtype:r};let{previousSibling:n}=this;return $(a=n,Ft,dn).call(a)}});var gt,pn=y(()=>{"use strict";j();je();ln();gn();gt=class extends dt{lint(i=this.getAbsoluteIndex(),e){let t=super.lint(i,e),r=this.childNodes.find(({type:l})=>l==="table-inter");if(!r)return t;let n=r.childNodes.find(l=>l.text().trim()),s=/^\s*(?:!|\{\{\s*![!-]?\s*\}\})/u,a=Ge("arg"),o=Ge("magic-word");if(!n||s.test(String(n))||a(n)&&s.test(n.default||""))return t;if(o(n))try{if(n.getPossibleValues().every(l=>s.test(l.text())))return t}catch(l){}let p=C(r,{start:i},"fostered-content","content to be moved out from the table");return p.severity=n.type==="template"?"warning":"error",p.startIndex++,p.startLine++,p.startCol=0,t.push(p),t}getRowCount(){return Number(this.childNodes.some(i=>i instanceof Me&&i.isIndependent()&&!i.firstChild.text().endsWith("+")))}getNthCol(i,e){let t=0;for(let r of this.childNodes.slice(2))if(r instanceof Me&&(r.isIndependent()&&(t=+(r.subtype!=="caption")),i-=t,i<0))return r}}});var to,ro,un,gr,Oi=y(()=>{"use strict";j();je();N();pn();Xe();to=/^\n[^\S\n]*(?:\|\}|\{\{\s*!\s*\}\}\}|\{\{\s*!\)\s*\}\})$/u,ro=({type:g})=>g==="tr"||g==="table-syntax",un=class extends Array{},gr=class extends gt{constructor(e,t,r=m.getConfig(),n=[]){super(/^(?:\{\||\{\{\{\s*!\s*\}\}|\{\{\s*\(!\s*\}\})$/u,e,t,r,n,{});x(this,"type","table")}get closed(){return this.lastChild.type==="table-syntax"}lint(e=this.getAbsoluteIndex(),t){let r=super.lint(e,t);this.closed||r.push(C(this.firstChild,{start:e},"unclosed-table",m.msg("unclosed $1","table")));let n=this.getLayout(),{length:s}=n;if(s>1){let a=1,o=1/0,p=0;for(;p<s;p++){let l=n[p],d=l.length;if(d<a)break;d<o&&(o=d);let{colspan:u}=this.getNthCell(l[l.length-1]),c=d-u+1;if(c>o)break;c>a&&(a=c)}if(p<s){let l=C(this.getNthRow(p),{start:e},"table-layout","inconsistent table layout","warning");l.startIndex++,l.startLine++,l.startCol=0,r.push(l)}}return r}close(e=`
|}`,t){let r=this.getAttribute("config"),n=this.getAttribute("accum"),s=t?[e]:m.parse(e,this.getAttribute("include"),2,r).childNodes,a=we.run(()=>super.insertAt(new oe(void 0,to,"table-syntax",r,n,{})));t||a.afterBuild(),this.lastChild.replaceChildren(...s)}getLayout(e){let t=this.getAllRows(),{length:r}=t,n=new un(...$n(r,()=>[]));for(let s=0;s<r;s++){let a=n[s],o=0,p=0,l;for(let d of t[s].childNodes.slice(2))if(d.type==="td"){if(d.isIndependent()&&(l=d.subtype!=="caption"),l){let u={row:s,column:o},{rowspan:c,colspan:f}=d;for(o++;a[p];)p++;for(let T=s;T<Math.min(s+c,r);T++)for(let A=p;A<p+f;A++)n[T][A]=u;p+=f}}else if(ro(d))break}return n}getAllRows(){return[...super.getRowCount()?[this]:[],...this.childNodes.slice(1).filter(e=>e.type==="tr"&&e.getRowCount()>0)]}getNthCell(e){var r;let t=e;return t&&((r=this.getNthRow(t.row,!1,!1))==null?void 0:r.getNthCol(t.column))}getNthRow(e,t,r){let n=super.getRowCount();if(e===0&&n)return this;n&&e--;for(let s of this.childNodes.slice(2))if(s.type==="tr"&&s.getRowCount()&&(e--,e<0))return s}json(){let e=super.json();return e.closed=this.closed,e}}});var pr,_i=y(()=>{"use strict";N();pn();pr=class extends gt{constructor(e,t,r=m.getConfig(),n=[]){super(/^\n[^\S\n]*(?:\|-+|\{\{\s*!\s*\}\}-+|\{\{\s*!-\s*\}\}-*)$/u,e,t,r,n,{});x(this,"type","tr")}}});var pt,cn=y(()=>{"use strict";Ce();pt=class extends K{}});var ut,hn=y(()=>{"use strict";cn();ut=class extends pt{constructor(){super(...arguments);x(this,"type","dd")}}});var Mi={};W(Mi,{parseTable:()=>io});var no,io,zi=y(()=>{"use strict";P();Oi();_i();gn();hn();no=g=>g.lastChild.constructor!==b,io=({firstChild:{data:g},type:i,name:e},t,r)=>{let n=[],s=g.split(`
`),a=i==="root"||i==="parameter-value"||i==="ext-inner"&&e==="poem"?"":`
${s.shift()}`,o,p=(d,u)=>{if(!u){a+=d;return}let{lastChild:c}=u;if(no(u)){let f=new b(d,t,r);f.type="table-inter",f.setAttribute("stage",3),u.insertAt(f)}else c.setText(String(c)+d)},l=()=>o.type==="td"?n.pop():o;for(let d of s){o=n.pop();let[u]=/^(?:\s|\0\d+c\x7F)*/u.exec(d),c=d.slice(u.length),f=/^(:*)((?:\s|\0\d+c\x7F)*)(\{\||\{(?:\0\d+c\x7F)*\0\d+!\x7F|\0\d+\{\x7F)(.*)$/u.exec(c);if(f){for(;o&&o.type!=="td";)o=n.pop();let[,w,R,G,B]=f;w&&new ut(w,t,r),p(`
${u}${w&&`\0${r.length-1}d\x7F`}${R}\0${r.length}b\x7F`,o),n.push(...o?[o]:[],new gr(G,B,t,r));continue}else if(!o){a+=`
${d}`;continue}let T=/^(?:(\|\}|\0\d+!\x7F\}|\0\d+\}\x7F)|(\|-+|\0\d+!\x7F-+|\0\d+-\x7F-*)(?!-)|(!|(?:\||\0\d+!\x7F)\+?))(.*)$/u.exec(c);if(!T){p(`
${d}`,o),n.push(o);continue}let[,A,F,L,v]=T;if(A){for(;o.type!=="table";)o=n.pop();o.close(`
${u}${A}`,!0),p(v,n[n.length-1])}else if(F){o=l(),o.type==="tr"&&(o=n.pop());let w=new pr(`
${u}${F}`,v,t,r);n.push(o,w),o.insertAt(w)}else{o=l();let w=L==="!"?/!!|(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu:/(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu,R=w.exec(v),G=0,B=`
${u}${L}`,O=ee=>{let pe=new Me(B,v.slice(G,R==null?void 0:R.index),t,r);return ee.insertAt(pe),pe};for(;R;)O(o),{lastIndex:G}=w,[B]=R,R=w.exec(v);n.push(o,O(o))}}return a.slice(1)}});var ur,Wi=y(()=>{"use strict";Ce();ur=class extends K{constructor(){super(...arguments);x(this,"type","hr")}}});var cr,Ui=y(()=>{"use strict";Be();N();Ce();cr=class extends se(K){constructor(e,t,r=m.getConfig(),n=[]){super(e,r,n);x(this,"type","double-underscore")}getAttribute(e){return e==="padding"?2:super.getAttribute(e)}toString(){return`__${this.innerText}__`}print(){return super.print({pre:"__",post:"__"})}}});var Di={};W(Di,{parseHrAndDoubleUnderscore:()=>so});var so,Hi=y(()=>{"use strict";Wi();Ui();Ur();so=({firstChild:{data:g},type:i,name:e},t,r)=>{let{doubleUnderscore:n}=t,s=new Set(n[0]),a=new Set(n[1]);return i!=="root"&&(i!=="ext-inner"||e!=="poem")&&(g=`\0${g}`),g=g.replace(/^((?:\0\d+c\x7F)*)(-{4,})/gmu,(o,p,l)=>(new ur(l,t,r),`${p}\0${r.length-1}r\x7F`)).replace(new RegExp(`__(${n.flat().join("|")})__`,"giu"),(o,p)=>{let l=a.has(p);return l||s.has(p.toLowerCase())?(new cr(p,l,t,r),`\0${r.length-1}u\x7F`):o}).replace(/^((?:\0\d+c\x7F)*)(={1,6})(.+)\2((?:[^\S\n]|\0\d+c\x7F)*)$/gmu,(o,p,l,d,u)=>{let c=`${p}\0${r.length}h\x7F`;return new et(l.length,[d,u],t,r),c}),i==="root"||i==="ext-inner"&&e==="poem"?g:g.slice(1)}});var hr,Vi=y(()=>{"use strict";j();N();Ce();hr=class extends K{constructor(){super(...arguments);x(this,"type","quote")}get bold(){return this.innerText.length!==2}get italic(){return this.innerText.length!==3}lint(e=this.getAbsoluteIndex()){let{previousSibling:t,nextSibling:r,bold:n}=this,s=m.msg('lonely "$1"',"'"),a=[],o;if((t==null?void 0:t.type)==="text"&&t.data.endsWith("'")){o=I(this,{start:e},"lonely-apos",s);let{startIndex:p,startLine:l,startCol:d}=o,[,{length:u}]=/(?:^|[^'])('+)$/u.exec(t.data),c=e-u;a.push({...o,startIndex:c,endIndex:p,startCol:d-u,endLine:l,endCol:d,suggestions:[{desc:"escape",range:[c,p],text:"&apos;".repeat(u)}]})}if((r==null?void 0:r.type)==="text"&&r.data.startsWith("'")){o!=null||(o=I(this,{start:e},"lonely-apos",s));let{endIndex:p,endLine:l,endCol:d}=o,[{length:u}]=/^'+/u.exec(r.data),c=p+u;a.push({...o,startIndex:p,endIndex:c,startLine:l,startCol:d,endCol:d+u,suggestions:[{desc:"escape",range:[p,c],text:"&apos;".repeat(u)}]})}return n&&this.closest("heading-title")&&(o!=null||(o=I(this,{start:e},"lonely-apos",s)),a.push({...o,rule:"bold-header",message:m.msg("bold in section header"),severity:"warning"})),a}json(){let e=super.json();return Object.assign(e,{bold:this.bold,italic:this.italic}),e}}});var Xi={};W(Xi,{parseQuotes:()=>mn});var mn,fn=y(()=>{"use strict";Vi();mn=(g,i,e)=>{var l;let t=g.split(/('{2,})/u),{length:r}=t;if(r===1)return g;let n=0,s=0,a,o,p;for(let d=1;d<r;d+=2){let u=t[d].length;switch(u){case 2:s++;break;case 4:t[d-1]+="'",t[d]="'''";case 3:if(n++,a!==void 0)break;t[d-1].endsWith(" ")?o===void 0&&p===void 0&&(p=d):t[d-1].slice(-2,-1)===" "?a=d:o!=null||(o=d);break;default:t[d-1]+="'".repeat(u-5),t[d]="'''''",s++,n++}}if(s%2===1&&n%2===1){let d=(l=a!=null?a:o)!=null?l:p;d!==void 0&&(t[d]="''",t[d-1]+="'")}for(let d=1;d<r;d+=2)new hr(t[d],i,e),t[d]=`\0${e.length-1}q\x7F`;return t.join("")}});var Qi={};W(Qi,{parseExternalLinks:()=>xn});var xn,Tn=y(()=>{"use strict";D();sn();lr();xn=(g,i,e,t)=>{let r=new RegExp(`\\[(${`\0\\d+f\x7F|(?:(?:${i.protocol}|//)${he}|\0\\d+m\x7F)${me}(?=[[\\]<>"\\t\\p{Zs}]|\0\\d)`})(\\p{Zs}*(?=\\P{Zs}))([^\\]-\b
-\uFFFD]*)\\]`,"giu");return g.replace(r,(n,s,a,o)=>{let{length:p}=e,l=/&[lg]t;/u.exec(s);return l&&(s=s.slice(0,l.index),a="",o=s.slice(l.index)+a+o),t?(new be(s,"ext-link-url",i,e),`[\0${p}f\x7F${a}${o}]`):(new at(s,a,o,i,e),`\0${p}w\x7F`)})}});var mr,Zi=y(()=>{"use strict";St();mr=class extends fe{constructor(){super(...arguments);x(this,"type","category")}}});var Ji={};W(Ji,{parseLinks:()=>Ki});var Ki,Yi=y(()=>{"use strict";N();fn();Tn();nn();en();Zi();Ki=(g,i,e)=>{let t=i.inExt?/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)(.*?[^\]]))?\]\](.*)$/su:/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)(.*?[^\]])?)?\]\](.*)$/su,r=/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(\||\0\d+!\x7F)(.*)$/su,n=new RegExp(`^\\s*(?:${i.protocol}|//)`,"iu"),s=g.split("[["),a=s.shift();for(let o=0;o<s.length;o++){let p=!1,l,d,u,c,f=s[o],T=t.exec(f);if(T)[,l,d,u,c]=T,c.startsWith("]")&&(u!=null&&u.includes("["))&&(u+="]",c=c.slice(1));else{let G=r.exec(f);G&&(p=!0,[,l,d,u]=G)}if(l===void 0||n.test(l)||/\0\d+[exhbru]\x7F/u.test(l)){a+=`[[${f}`;continue}let A=l.trim().startsWith(":");if(A&&p){a+=`[[${f}`;continue}let F=m.normalizeTitle(l,0,!1,i,!0,!0,!0),{ns:L,valid:v,interwiki:w}=F;if(v){if(p){if(w||L!==6){a+=`[[${f}`;continue}let G=!1;for(o++;o<s.length;o++){let B=s[o],O=B.split("]]");if(O.length>2){G=!0,u+=`[[${O[0]}]]${O[1]}`,c=O.slice(2).join("]]");break}else if(O.length===2)u+=`[[${O[0]}]]${O[1]}`;else{u+=`[[${B}`;break}}if(u=Ki(u,i,e),!G){a+=`[[${l}${d}${u}`;continue}}}else{a+=`[[${f}`;continue}u&&(u=mn(u,i,e));let R=ot;A||(!w&&L===6?(u&&(u=xn(u,i,e,!0)),R=it):!w&&L===14&&(R=mr)),u===void 0&&d&&(u=""),a+=`\0${e.length}l\x7F${c}`,new R(l,u,i,e,d)}return a}});var es={};W(es,{parseMagicLinks:()=>oo});var oo,ts=y(()=>{"use strict";D();lr();oo=(g,i,e)=>{let t="[\\p{Zs}\\t]|&nbsp;|&#0*160;|&#x0*a0;",r=`(?:${t}|-)`,n=new RegExp(`(^|[^\\p{L}\\d_])(?:(?:${i.protocol})(${he}${me})|(?:RFC|PMID)(?:${t})+\\d+\\b|ISBN(?:${t})+(?:97[89]${r}?)?(?:\\d${r}?){9}[\\dx]\\b)`,"giu");return g.replace(n,(s,a,o)=>{let p=a?s.slice(a.length):s;if(o){let l="",d=/&(?:lt|gt|nbsp|#x0*(?:3[ce]|a0)|#0*(?:6[02]|160));/iu.exec(p);d&&(l=p.slice(d.index),p=p.slice(0,d.index));let u=new RegExp(`[,;\\\\.:!?${p.includes("(")?"":")"}]+$`,"u"),c=u.exec(p);if(c){let f=0;c[0].startsWith(";")&&/&(?:[a-z]+|#x[\da-f]+|#\d+)$/iu.test(p.slice(0,c.index))&&(f=1),l=p.slice(c.index+f)+l,p=p.slice(0,c.index+f)}return l.length>=o.length?s:(new be(p,void 0,i,e),`${a}\0${e.length-1}w\x7F${l}`)}else if(!/^(?:RFC|PMID|ISBN)/u.test(p))return s;return new be(p,"magic-link",i,e),`${a}\0${e.length-1}i\x7F`})}});var fr,rs=y(()=>{"use strict";cn();fr=class extends pt{constructor(){super(...arguments);x(this,"type","list")}}});var ns={};W(ns,{parseList:()=>ao});var ao,is=y(()=>{"use strict";rs();hn();ao=(g,i,e)=>{let t=/^((?:\0\d+c\x7F)*)([;:*#]+)/u.exec(g);if(!t)return g;let[r,n,s]=t,a=`${n}\0${e.length}d\x7F${g.slice(r.length)}`,o=s.split(";").length-1;if(new fr(s,i,e),!o)return a;let{html:[p]}=i,l=/:+|-\{|\0\d+[xq]\x7F/gu,d=l,u=d.exec(a),c=0,f=!1,T=!1,A=0,F=(v,w)=>(new ut(v,i,e),`${a.slice(0,w)}\0${e.length-1}d\x7F${a.slice(w+v.length)}`),L=v=>{v?c&&c--:c++};for(;u&&o;){let{0:v,index:w}=u;if(v==="-{"){if(!A){let{lastIndex:R}=d;d=/-\{|\}-/gu,d.lastIndex=R}A++}else if(v==="}-"){if(A--,!A){let{lastIndex:R}=d;d=l,d.lastIndex=R}}else if(v.endsWith("x\x7F")){let{name:R,closing:G,selfClosing:B}=e[Number(v.slice(1,-2))];(!B||p.includes(R))&&L(G)}else if(v.endsWith("q\x7F")){let{bold:R,italic:G}=e[Number(v.slice(1,-2))];R&&(L(f),f=!f),G&&(L(T),T=!T)}else if(c===0){if(v.length>=o)return F(v.slice(0,o),w);o-=v.length,d.lastIndex=w+4+String(e.length).length,a=F(v,w)}u=d.exec(a)}return a}});var ss,ye,xr,os=y(()=>{"use strict";j();N();P();Te();ss=new Set(["A","T","R","D","-","H","N"]),xr=class extends b{constructor(e,t=m.getConfig(),r=[]){super(void 0,t,r,{});x(this,"type","converter-flags");k(this,ye,void 0);this.append(...e.map(n=>new _(n,"converter-flag",t,r)))}afterBuild(){S(this,ye,this.childNodes.map(e=>e.text().trim()))}toString(){return super.toString(";")}text(){return super.text(";")}getGaps(){return 1}getUnknownFlags(){return new Set(h(this,ye).filter(e=>/\{{3}[^{}]+\}{3}/u.test(e)))}getVariantFlags(){let e=new Set(this.getAttribute("config").variants);return new Set(h(this,ye).filter(t=>e.has(t)))}lint(e=this.getAbsoluteIndex(),t){let r=this.getVariantFlags(),n=this.getUnknownFlags(),s=new Set(h(this,ye).filter(c=>ss.has(c))),a=h(this,ye).filter(c=>!c).length,o=h(this,ye).length-n.size-a,p=super.lint(e,t);if(r.size===o||s.size===o)return p;let l={start:e,...this.getRootNode().posFromIndex(e)},{childNodes:d,length:u}=this;for(let c=0;c<u;c++){let f=d[c],T=f.text().trim();if(T&&!r.has(T)&&!n.has(T)&&(r.size>0||!s.has(T))){let A=C(f,l,"no-ignored","invalid conversion flag");r.size===0&&ss.has(T.toUpperCase())?A.fix={range:[A.startIndex,A.endIndex],text:T.toUpperCase()}:A.suggestions=[{desc:"remove",range:[A.startIndex,A.endIndex],text:""}],p.push(A)}}return p}print(){return super.print({sep:";"})}};ye=new WeakMap});var ct,as=y(()=>{"use strict";N();P();Te();ct=class extends b{constructor(e,t=!0,r=m.getConfig(),n=[]){super(void 0,r,n);x(this,"type","converter-rule");let s=e.indexOf(":"),a=e.slice(0,s).indexOf("=>"),o=a===-1?e.slice(0,s):e.slice(a+2,s);t&&r.variants.includes(o.trim())?(super.insertAt(new _(o,"converter-rule-variant",r,n)),super.insertAt(new _(e.slice(s+1),"converter-rule-to",r,n)),a!==-1&&super.insertAt(new _(e.slice(0,a),"converter-rule-from",r,n),0)):super.insertAt(new _(e,"converter-rule-to",r,n))}toString(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`${String(t)}=>${String(r)}:${String(n)}`}return super.toString(":")}text(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`${t.text()}=>${r.text()}:${n.text()}`}return super.text(":")}getGaps(e){return e===0&&this.length===3?2:1}print(){let{childNodes:e}=this;if(e.length===3){let[t,r,n]=e;return`<span class="wpb-converter-rule">${t.print()}=>${r.print()}:${n.print()}</span>`}return super.print({sep:":"})}}});var Tr,ls=y(()=>{"use strict";D();N();P();os();as();Tr=class extends b{constructor(e,t,r=m.getConfig(),n=[]){super(void 0,r,n);x(this,"type","converter");this.append(new xr(e,r,n));let[s]=t,a=s.includes(":"),o=new ct(s,a,r,n);a&&o.length===1?this.insertAt(new ct(t.join(";"),!1,r,n)):this.append(o,...t.slice(1).map(p=>new ct(p,!0,r,n)))}toString(){let{childNodes:[e,...t]}=this;return`-{${String(e)}${e.length>0?"|":""}${t.map(String).join(";")}}-`}text(){let{childNodes:[e,...t]}=this;return`-{${e.text()}|${ie(t,";")}}-`}getAttribute(e){return e==="padding"?2:super.getAttribute(e)}getGaps(e){return e||this.firstChild.length>0?1:0}print(){let{childNodes:[e,...t]}=this;return`<span class="wpb-converter">-{${e.print()}${e.length>0?"|":""}${xe(t,{sep:";"})}}-</span>`}}});var ds={};W(ds,{parseConverter:()=>lo});var lo,gs=y(()=>{"use strict";ls();lo=(g,i,e)=>{let t=/-\{/gu,r=/-\{|\}-/gu,n=[],s=t,a=s.exec(g);for(;a;){let{0:o,index:p}=a;if(o==="}-"){let l=n.pop(),{length:d}=e,u=g.slice(l.index+2,p),c=u.indexOf("|"),[f,T]=c===-1?[[],u]:[u.slice(0,c).split(";"),u.slice(c+1)],A=T.replace(/(&[#a-z\d]+);/giu,"$1"),F=`(?:${i.variants.join("|")})`,L=A.split(new RegExp(`;(?=(?:[^;]*?=>)?\\s*${F}\\s*:|(?:\\s|\0\\d+c\x7F)*$)`,"u")).map(v=>v.replace(/\x01/gu,";"));new Tr(f,L,i,e),g=`${g.slice(0,l.index)}\0${d}v\x7F${g.slice(p+2)}`,n.length===0&&(s=t),s.lastIndex=l.index+3+String(d).length}else n.push(a),s=r,s.lastIndex=p+2;a=s.exec(g)}return g}});var kn={};W(kn,{Token:()=>b});var ge,q,z,ze,Lt,Rt,Pt,bn,br,ps,kr,us,yr,cs,Ar,hs,vr,ms,wr,fs,Sr,xs,Cr,Ts,Nr,bs,$r,ks,Ir,ys,Er,As,yn,b,P=y(()=>{"use strict";D();ce();j();N();Mn();Un();yn=class yn extends _t{constructor(e,t=m.getConfig(),r=[],n){super();k(this,Pt);k(this,br);k(this,kr);k(this,yr);k(this,Ar);k(this,vr);k(this,wr);k(this,Sr);k(this,Cr);k(this,Nr);k(this,$r);k(this,Ir);k(this,Er);x(this,"type","plain");k(this,ge,0);k(this,q,void 0);k(this,z,void 0);k(this,ze,void 0);k(this,Lt,!1);k(this,Rt,void 0);typeof e=="string"&&this.insertAt(e),S(this,q,t),S(this,z,r),r.push(this)}parseOnce(e=h(this,ge),t=!1){if(e<h(this,ge)||!this.getAttribute("plain")||this.length===0)return this;if(h(this,ge)>=11)return this;switch(e){case 0:if(this.type==="root"){h(this,z).shift();let r=$(this,br,ps).call(this);t&&(t=!r)}S(this,ze,t),$(this,kr,us).call(this,t);break;case 1:$(this,yr,cs).call(this);break;case 2:$(this,Ar,hs).call(this);break;case 3:$(this,vr,ms).call(this);break;case 4:$(this,wr,fs).call(this);break;case 5:$(this,Sr,xs).call(this);break;case 6:$(this,Cr,Ts).call(this);break;case 7:$(this,Nr,bs).call(this);break;case 8:$(this,$r,ks).call(this);break;case 9:$(this,Ir,ys).call(this);break;case 10:$(this,Er,As).call(this)}if(this.type==="root")for(let r of h(this,z))r.parseOnce(e,t);return Bt(this,ge)._++,this}buildFromStr(e,t){let r=e.split(/[\0\x7F]/u).map((n,s)=>{if(s%2===0)return new vt(n);if(isNaN(n.slice(-1)))return h(this,z)[Number(n.slice(0,-1))];throw new Error(`\u89E3\u6790\u9519\u8BEF\uFF01\u672A\u6B63\u786E\u6807\u8BB0\u7684 Token\uFF1A${n}`)});return t===0?r.map(String).join(""):t===1?ie(r):r}afterBuild(){if(this.type==="root")for(let e of h(this,z))e.afterBuild();S(this,Lt,!0)}parse(e=11,t){for(e=Math.min(e,11);h(this,ge)<e;)this.parseOnce(h(this,ge),t);return e&&($(this,Pt,bn).call(this),this.afterBuild()),this}getAttribute(e){switch(e){case"plain":return this.constructor===yn;case"config":return JSON.parse(JSON.stringify(h(this,q)));case"include":{if(h(this,ze)!==void 0)return h(this,ze);let t=this.getRootNode();return t!==this&&t.getAttribute("include")}case"accum":return h(this,z);default:return super.getAttribute(e)}}setAttribute(e,t){switch(e){case"stage":h(this,ge)===0&&this.type==="root"&&h(this,z).shift(),S(this,ge,t);break;default:super.setAttribute(e,t)}}insertAt(e,t=this.length){let r=typeof e=="string"?new vt(e):e;return super.insertAt(r,t),r.type==="root"&&(r.type="plain"),r}normalizeTitle(e,t=0,r,n,s){return m.normalizeTitle(e,t,h(this,ze),h(this,q),r,n,s)}lint(e=this.getAbsoluteIndex(),t){var n;let r=super.lint(e,t);if(this.type==="root"){let s={};for(let c of this.querySelectorAll("category")){let f=s[c.name];f?f.add(c):s[c.name]=new Set([c])}for(let c of Object.values(s))c.size>1&&r.push(...[...c].map(f=>{let T=I(f,{start:f.getAbsoluteIndex()},"no-duplicate","duplicated category");return T.suggestions=[{desc:"remove",range:[T.startIndex,T.endIndex],text:""}],T}));let a=/<!--\s*lint-(disable(?:(?:-next)?-line)?|enable)(\s[\sa-z,-]*)?-->/gu,o=String(this),p=[],l=a.exec(o),d=0,u=0;for(;l;){let{1:c,index:f}=l,T=(n=l[2])==null?void 0:n.trim();u+=o.slice(d,f).split(`
`).length-1,d=f,p.push({line:u+(c==="disable-line"?0:1),from:c==="disable"?a.lastIndex:void 0,to:c==="enable"?a.lastIndex:void 0,rules:T?new Set(T.split(",").map(A=>A.trim())):void 0}),l=a.exec(o)}r=r.filter(({rule:c,startLine:f,startIndex:T})=>{let A={pos:0};for(let{line:F,from:L,to:v,rules:w}of p){if(F>f+1)break;if(w&&!w.has(c))continue;if(F===f&&L===void 0&&v===void 0)return!1;L<=T&&L>A.pos?(A.pos=L,A.type="from"):v<=T&&v>A.pos&&(A.pos=v,A.type="to")}return A.type!=="from"})}return r}toString(e){var r;let t=this.getRootNode();return t.type==="root"&&h(t,Lt)?((r=h(this,Rt))!=null||S(this,Rt,super.toString(e)),h(this,Rt)):super.toString(e)}};ge=new WeakMap,q=new WeakMap,z=new WeakMap,ze=new WeakMap,Lt=new WeakMap,Rt=new WeakMap,Pt=new WeakSet,bn=function(){var n;S(this,ge,11);let{length:e,firstChild:t}=this,r=String(t);if(e===1&&t.type==="text"&&r.includes("\0")&&(this.replaceChildren(...this.buildFromStr(r)),this.normalize(),this.type==="root"))for(let s of h(this,z))$(n=s,Pt,bn).call(n)},br=new WeakSet,ps=function(){let{parseRedirect:e}=(Xn(),M(Vn)),t=String(this.firstChild),r=e(t,h(this,q),h(this,z));return r&&this.setText(r),!!r},kr=new WeakSet,us=function(e){let{parseCommentAndExt:t}=(Li(),M(Fi));this.setText(t(String(this.firstChild),h(this,q),h(this,z),e))},yr=new WeakSet,cs=function(){let{parseBraces:e}=(Hr(),M(mi)),t=this.type==="root"?String(this.firstChild):`\0${String(this.firstChild)}`,r=e(t,h(this,q),h(this,z));this.setText(this.type==="root"?r:r.slice(1))},Ar=new WeakSet,hs=function(){var t;if((t=h(this,q).excludes)!=null&&t.includes("html"))return;let{parseHtml:e}=(Gi(),M(Pi));this.setText(e(String(this.firstChild),h(this,q),h(this,z)))},vr=new WeakSet,ms=function(){var t;if((t=h(this,q).excludes)!=null&&t.includes("table"))return;let{parseTable:e}=(zi(),M(Mi));this.setText(e(this,h(this,q),h(this,z)))},wr=new WeakSet,fs=function(){var t;if((t=h(this,q).excludes)!=null&&t.includes("hr"))return;let{parseHrAndDoubleUnderscore:e}=(Hi(),M(Di));this.setText(e(this,h(this,q),h(this,z)))},Sr=new WeakSet,xs=function(){let{parseLinks:e}=(Yi(),M(Ji));this.setText(e(String(this.firstChild),h(this,q),h(this,z)))},Cr=new WeakSet,Ts=function(){var r;if((r=h(this,q).excludes)!=null&&r.includes("quote"))return;let{parseQuotes:e}=(fn(),M(Xi)),t=String(this.firstChild).split(`
`);for(let n=0;n<t.length;n++)t[n]=e(t[n],h(this,q),h(this,z));this.setText(t.join(`
`))},Nr=new WeakSet,bs=function(){var t;if((t=h(this,q).excludes)!=null&&t.includes("extLink"))return;let{parseExternalLinks:e}=(Tn(),M(Qi));this.setText(e(String(this.firstChild),h(this,q),h(this,z)))},$r=new WeakSet,ks=function(){var t;if((t=h(this,q).excludes)!=null&&t.includes("magicLink"))return;let{parseMagicLinks:e}=(ts(),M(es));this.setText(e(String(this.firstChild),h(this,q),h(this,z)))},Ir=new WeakSet,ys=function(){var n;if((n=h(this,q).excludes)!=null&&n.includes("list"))return;let{parseList:e}=(is(),M(ns)),t=String(this.firstChild).split(`
`),r=this.type==="root"||this.type==="ext-inner"&&this.name==="poem"?0:1;for(;r<t.length;r++)t[r]=e(t[r],h(this,q),h(this,z));this.setText(t.join(`
`))},Er=new WeakSet,As=function(){if(h(this,q).variants.length>0){let{parseConverter:e}=(gs(),M(ds));this.setText(e(String(this.firstChild),h(this,q),h(this,z)))}};b=yn});var We,vs,go,m,N=y(()=>{Nn();je();ce();D();We={i18n:void 0,rules:Cn,getConfig(){return{...En,...this.config,excludes:[]}},msg(g,i=""){var e,t;return g&&((t=(e=this.i18n)==null?void 0:e[g])!=null?t:g).replace("$1",this.msg(i))},normalizeTitle(g,i=0,e,t=We.getConfig(),r,n=!1,s=!1){let{Title:a}=(Bn(),M(jn));if(r)return new a(g,i,t,n,s);let{Token:o}=(P(),M(kn)),p=we.run(()=>{let d=new o(g,t);return d.type="root",d.parseOnce(0,e).parseOnce()}),l=new a(String(p),i,t,n,s);return we.run(()=>{for(let d of["main","fragment"]){let u=l[d];u!=null&&u.includes("\0")&&(l[d]=p.buildFromStr(u,1))}}),l},parse(g,i,e=11,t=We.getConfig()){g=Ln(g);let{Token:r}=(P(),M(kn));return we.run(()=>{let s=new r(g,t);return s.type="root",s.parse(e,i)})}},vs={},go=new Set(["normalizeTitle","parse"]);for(let g in We)go.has(g)||(vs[g]={enumerable:!1});Object.defineProperties(We,vs);typeof self=="object"?Object.assign(self,{Parser:We}):typeof globalThis=="object"&&Object.assign(globalThis,{Parser:We});m=We});N();})();
