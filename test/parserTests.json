[
	{
		"desc": "parserTests"
	},
	{
		"desc": "Simple paragraph",
		"wikitext": "This is a simple paragraph.",
		"html": "<p>This is a simple paragraph.\n</p>",
		"render": "<p>This is a simple paragraph.\n</p>",
		"print": "<span class=\"wpb-root\">This is a simple paragraph.</span>"
	},
	{
		"desc": "Paragraphs with extra newline spacing",
		"wikitext": "a\n\nb (+2 nls)\n\n\nc (+3 nls)\n\n\n\nd (+4 nls)\n\n\n\n\ne (+5 nls)",
		"html": "<p>a\n</p><p>b (+2 nls)\n</p><p><br />\nc (+3 nls)\n</p><p><br />\n</p><p>d (+4 nls)\n</p><p><br />\n</p><p><br />\ne (+5 nls)\n</p>",
		"render": "<p>a\n</p><p>b (+2 nls)\n</p><p><br>\nc (+3 nls)\n</p><p><br>\n</p><p>d (+4 nls)\n</p><p><br>\n</p><p><br>\ne (+5 nls)\n</p>",
		"print": "<span class=\"wpb-root\">a\n\nb (+2 nls)\n\n\nc (+3 nls)\n\n\n\nd (+4 nls)\n\n\n\n\ne (+5 nls)</span>"
	},
	{
		"desc": "Paragraphs with newline spacing with comment lines in between",
		"wikitext": "----\na\n<!--foo-->\nb\n----\na\n<!--foo--><!--More than 1 comment, still stripped-->\nb\n----\na\n <!--foo--> <!----> <!-- bar --> \nb\n----\na\n<!--foo-->\n\nb\n----\na\n\n<!--foo-->\nb\n----\na\n<!--foo-->\n\n\nb\n----\na\n\n\n<!--foo-->\nb\n----",
		"html": "<hr />\n<p>a\nb\n</p>\n<hr />\n<p>a\nb\n</p>\n<hr />\n<p>a\nb\n</p>\n<hr />\n<p>a\n</p><p>b\n</p>\n<hr />\n<p>a\n</p><p>b\n</p>\n<hr />\n<p>a\n</p><p><br />\nb\n</p>\n<hr />\n<p>a\n</p><p><br />\nb\n</p>\n<hr />",
		"render": "<hr>\n<p>a\nb\n</p>\n<hr>\n<p>a\nb\n</p>\n<hr>\n<p>a\nb\n</p>\n<hr>\n<p>a\n</p><p>b\n</p>\n<hr>\n<p>a\n</p><p>b\n</p>\n<hr>\n<p>a\n</p><p><br>\nb\n</p>\n<hr>\n<p>a\n</p><p><br>\nb\n</p>\n<hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span>\na\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span>\na\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span><span class=\"wpb-comment\">&lt;!--More than 1 comment, still stripped--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span>\na\n <span class=\"wpb-comment\">&lt;!--foo--&gt;</span> <span class=\"wpb-comment\">&lt;!----&gt;</span> <span class=\"wpb-comment\">&lt;!-- bar --&gt;</span> \nb\n<span class=\"wpb-hr\">----</span>\na\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\n\nb\n<span class=\"wpb-hr\">----</span>\na\n\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span>\na\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\n\n\nb\n<span class=\"wpb-hr\">----</span>\na\n\n\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span></span>"
	},
	{
		"desc": "Paragraphs with newline spacing with non-empty white-space lines in between",
		"wikitext": "----\na\n \nb\n----\na\n \n \nb\n----",
		"html": "<hr />\n<p>a\n</p><p>b\n</p>\n<hr />\n<p>a\n</p><p><br /> \nb\n</p>\n<hr />",
		"render": "<hr>\n<p>a\n</p><p>b\n</p>\n<hr>\n<p>a\n</p><p><br> \nb\n</p>\n<hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span>\na\n \nb\n<span class=\"wpb-hr\">----</span>\na\n \n \nb\n<span class=\"wpb-hr\">----</span></span>"
	},
	{
		"desc": "Paragraphs with newline spacing with non-empty mixed comment and white-space lines in between",
		"wikitext": "----\na\n <!--foo-->\nb\n----\na\n <!--foo--><!--More than 1 comment doesn't disable stripping of this line!-->\nb\n----\na\n \n<!--foo-->\n <!--bar-->\nb\n----\na\n \n <!--foo-->\n <!--bar-->\n \nb\n----",
		"html": "<hr />\n<p>a\nb\n</p>\n<hr />\n<p>a\nb\n</p>\n<hr />\n<p>a\n</p><p>b\n</p>\n<hr />\n<p>a\n</p><p><br /> \nb\n</p>\n<hr />",
		"render": "<hr>\n<p>a\nb\n</p>\n<hr>\n<p>a\nb\n</p>\n<hr>\n<p>a\n</p><p>b\n</p>\n<hr>\n<p>a\n</p><p><br> \nb\n</p>\n<hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span>\na\n <span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span>\na\n <span class=\"wpb-comment\">&lt;!--foo--&gt;</span><span class=\"wpb-comment\">&lt;!--More than 1 comment doesn't disable stripping of this line!--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span>\na\n \n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\n <span class=\"wpb-comment\">&lt;!--bar--&gt;</span>\nb\n<span class=\"wpb-hr\">----</span>\na\n \n <span class=\"wpb-comment\">&lt;!--foo--&gt;</span>\n <span class=\"wpb-comment\">&lt;!--bar--&gt;</span>\n \nb\n<span class=\"wpb-hr\">----</span></span>"
	},
	{
		"desc": "Extra newlines: More paragraphs with indented comment",
		"wikitext": "a\n\n   <!--boo-->\n\nb",
		"html": "<p>a\n</p><p><br />\nb\n</p>",
		"render": "<p>a\n</p><p><br>\nb\n</p>",
		"print": "<span class=\"wpb-root\">a\n\n   <span class=\"wpb-comment\">&lt;!--boo--&gt;</span>\n\nb</span>"
	},
	{
		"desc": "Extra new lines before and after lists are preserved",
		"wikitext": "a\n\n\n*b\n\n\nc",
		"html": "<p>a\n</p><p><br />\n</p>\n<ul><li>b</li></ul>\n<p><br />\nc\n</p>",
		"render": "<p>a\n</p><p><br>\n</p>\n<ul><li>b</li></ul>\n<p><br>\nc\n</p>",
		"print": "<span class=\"wpb-root\">a\n\n\n<span class=\"wpb-list\">*</span>b\n\n\nc</span>"
	},
	{
		"desc": "Multiple newlines after tables are converted to p-br-p tags",
		"wikitext": "{|\n|x\n|}\n\n\n\n\n=b=",
		"html": "<table>\n<tbody><tr>\n<td>x\n</td></tr></tbody></table>\n<p><br />\n</p><p><br />\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"b\">b</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: b\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<table >\n<tbody><tr>\n<td >x\n</td></tr></tbody></table>\n<p><br>\n</p><p><br>\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"b\">b</h1></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n\n\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">b</span>=</span></span>"
	},
	{
		"desc": "Parsing an URL",
		"wikitext": "http://fr.wikipedia.org/wiki/üç∫\n<!-- EasterEgg we love beer, better be able be able to link to it -->",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://fr.wikipedia.org/wiki/üç∫\">http://fr.wikipedia.org/wiki/üç∫</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://fr.wikipedia.org/wiki/%F0%9F%8D%BA\">http://fr.wikipedia.org/wiki/üç∫</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://fr.wikipedia.org/wiki/üç∫</span>\n<span class=\"wpb-comment\">&lt;!-- EasterEgg we love beer, better be able be able to link to it --&gt;</span></span>"
	},
	{
		"desc": "Simple list",
		"wikitext": "*Item 1\n*Item 2",
		"html": "<ul><li>Item 1</li>\n<li>Item 2</li></ul>",
		"render": "<ul><li>Item 1</li>\n<li>Item 2</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>Item 1\n<span class=\"wpb-list\">*</span>Item 2</span>"
	},
	{
		"desc": "Non-html5 tags should be accepted",
		"wikitext": "<center>''foo''</center>\n<big>''foo''</big>\n<font style=\"123\">''foo''</font>\n<strike>''foo''</strike>\n<tt>''foo''</tt>",
		"html": "<center><i>foo</i></center>\n<p><big><i>foo</i></big>\n<font style=\"123\"><i>foo</i></font>\n<strike><i>foo</i></strike>\n<tt><i>foo</i></tt>\n</p>",
		"render": "<center ><i>foo</i></center>\n<p><big ><i>foo</i></big>\n<font style=\"123\"><i>foo</i></font>\n<strike ><i>foo</i></strike>\n<tt ><i>foo</i></tt>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;center&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/center&gt;</span>\n<span class=\"wpb-html\">&lt;big&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/big&gt;</span>\n<span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span></span>&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/font&gt;</span>\n<span class=\"wpb-html\">&lt;strike&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/strike&gt;</span>\n<span class=\"wpb-html\">&lt;tt&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/tt&gt;</span></span>"
	},
	{
		"desc": "<wbr> is valid wikitext (T54468)",
		"wikitext": "<wbr>",
		"html": "<p><wbr />\n</p>",
		"render": "<p><wbr >\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;wbr&gt;</span></span>"
	},
	{
		"desc": "<s> or <strike> for strikethrough",
		"wikitext": "<strike>strike</strike>\n\n<s>s</s>",
		"html": "<p><strike>strike</strike>\n</p><p><s>s</s>\n</p>",
		"render": "<p><strike >strike</strike>\n</p><p><s >s</s>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;strike&gt;</span>strike<span class=\"wpb-html\">&lt;/strike&gt;</span>\n\n<span class=\"wpb-html\">&lt;s&gt;</span>s<span class=\"wpb-html\">&lt;/s&gt;</span></span>"
	},
	{
		"desc": "Text-level semantic html elements in wikitext",
		"wikitext": "<em>text</em>\n<strong>text</strong>\n<small>text</small>\n<s>text</s>\n<cite>text</cite>\n<q>text</q>\n<dfn>text</dfn>\n<abbr>text</abbr>\n<data>text</data>\n<time>text</time>\n<code>text</code>\n<var>text</var>\n<samp>text</samp>\n<kbd>text</kbd>\n<sub>text</sub>\n<u>text</u>\n<mark>text</mark>\n<ruby><rb>ÊòéÊó•</rb><rp>(</rp><rt>Ashita</rt><rp> </rp><rtc>„ÅÇ„Åó„Åü</rtc><rp>)</rp></ruby>\n<bdi>text</bdi>\n<bdo>text</bdo>\n<span>text</span>\n<wbr />",
		"html": "<p><em>text</em>\n<strong>text</strong>\n<small>text</small>\n<s>text</s>\n<cite>text</cite>\n<q>text</q>\n<dfn>text</dfn>\n<abbr>text</abbr>\n<data>text</data>\n<time>text</time>\n<code>text</code>\n<var>text</var>\n<samp>text</samp>\n<kbd>text</kbd>\n<sub>text</sub>\n<u>text</u>\n<mark>text</mark>\n<ruby><rb>ÊòéÊó•</rb><rp>(</rp><rt>Ashita</rt><rp> </rp><rtc>„ÅÇ„Åó„Åü</rtc><rp>)</rp></ruby>\n<bdi>text</bdi>\n<bdo>text</bdo>\n<span>text</span>\n<wbr />\n</p>",
		"render": "<p><em >text</em>\n<strong >text</strong>\n<small >text</small>\n<s >text</s>\n<cite >text</cite>\n<q >text</q>\n<dfn >text</dfn>\n<abbr >text</abbr>\n<data >text</data>\n<time >text</time>\n<code >text</code>\n<var >text</var>\n<samp >text</samp>\n<kbd >text</kbd>\n<sub >text</sub>\n<u >text</u>\n<mark >text</mark>\n<ruby ><rb >ÊòéÊó•</rb><rp >(</rp><rt >Ashita</rt><rp > </rp><rtc >„ÅÇ„Åó„Åü</rtc><rp >)</rp></ruby>\n<bdi >text</bdi>\n<bdo >text</bdo>\n<span >text</span>\n<wbr >\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;em&gt;</span>text<span class=\"wpb-html\">&lt;/em&gt;</span>\n<span class=\"wpb-html\">&lt;strong&gt;</span>text<span class=\"wpb-html\">&lt;/strong&gt;</span>\n<span class=\"wpb-html\">&lt;small&gt;</span>text<span class=\"wpb-html\">&lt;/small&gt;</span>\n<span class=\"wpb-html\">&lt;s&gt;</span>text<span class=\"wpb-html\">&lt;/s&gt;</span>\n<span class=\"wpb-html\">&lt;cite&gt;</span>text<span class=\"wpb-html\">&lt;/cite&gt;</span>\n<span class=\"wpb-html\">&lt;q&gt;</span>text<span class=\"wpb-html\">&lt;/q&gt;</span>\n<span class=\"wpb-html\">&lt;dfn&gt;</span>text<span class=\"wpb-html\">&lt;/dfn&gt;</span>\n<span class=\"wpb-html\">&lt;abbr&gt;</span>text<span class=\"wpb-html\">&lt;/abbr&gt;</span>\n<span class=\"wpb-html\">&lt;data&gt;</span>text<span class=\"wpb-html\">&lt;/data&gt;</span>\n<span class=\"wpb-html\">&lt;time&gt;</span>text<span class=\"wpb-html\">&lt;/time&gt;</span>\n<span class=\"wpb-html\">&lt;code&gt;</span>text<span class=\"wpb-html\">&lt;/code&gt;</span>\n<span class=\"wpb-html\">&lt;var&gt;</span>text<span class=\"wpb-html\">&lt;/var&gt;</span>\n<span class=\"wpb-html\">&lt;samp&gt;</span>text<span class=\"wpb-html\">&lt;/samp&gt;</span>\n<span class=\"wpb-html\">&lt;kbd&gt;</span>text<span class=\"wpb-html\">&lt;/kbd&gt;</span>\n<span class=\"wpb-html\">&lt;sub&gt;</span>text<span class=\"wpb-html\">&lt;/sub&gt;</span>\n<span class=\"wpb-html\">&lt;u&gt;</span>text<span class=\"wpb-html\">&lt;/u&gt;</span>\n<span class=\"wpb-html\">&lt;mark&gt;</span>text<span class=\"wpb-html\">&lt;/mark&gt;</span>\n<span class=\"wpb-html\">&lt;ruby&gt;</span><span class=\"wpb-html\">&lt;rb&gt;</span>ÊòéÊó•<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rp&gt;</span>(<span class=\"wpb-html\">&lt;/rp&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>Ashita<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rp&gt;</span> <span class=\"wpb-html\">&lt;/rp&gt;</span><span class=\"wpb-html\">&lt;rtc&gt;</span>„ÅÇ„Åó„Åü<span class=\"wpb-html\">&lt;/rtc&gt;</span><span class=\"wpb-html\">&lt;rp&gt;</span>)<span class=\"wpb-html\">&lt;/rp&gt;</span><span class=\"wpb-html\">&lt;/ruby&gt;</span>\n<span class=\"wpb-html\">&lt;bdi&gt;</span>text<span class=\"wpb-html\">&lt;/bdi&gt;</span>\n<span class=\"wpb-html\">&lt;bdo&gt;</span>text<span class=\"wpb-html\">&lt;/bdo&gt;</span>\n<span class=\"wpb-html\">&lt;span&gt;</span>text<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-html\">&lt;wbr<span class=\"wpb-html-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ruby markup (W3C-style)",
		"wikitext": ";Mono-ruby for individual base characters\n:<ruby>Êó•<rt>„Å´</rt>Êú¨<rt>„Åª„Çì</rt>Ë™û<rt>„Åî</rt></ruby>\n;Group ruby\n:<ruby>‰ªäÊó•<rt>„Åç„Çá„ÅÜ</rt></ruby>\n;Jukugo ruby\n:<ruby>Ê≥ï<rb>ËèØ</rb><rb>Áµå</rb><rt>„Åª</rt><rt>„Åë</rt><rt>„Åç„Çá„ÅÜ</rt></ruby>\n;Inline ruby\n:<ruby>Êù±<rb>‰∫¨</rb><rp>(</rp><rt>„Å®„ÅÜ</rt><rt>„Åç„Çá„ÅÜ</rt><rp>)</rp></ruby>\n;Double-sided ruby\n:<ruby><rb>Êóß</rb><rb>Èáë</rb><rb>Â±±</rb><rt>ji√π</rt><rt>jƒ´n</rt><rt>shƒÅn</rt><rtc>San Francisco</rtc></ruby>\n\n<ruby>\n<rb>‚ô•</rb><rtc><rt>Heart</rt></rtc><rtc lang=\"fr\"><rt>C≈ìur</rt></rtc>\n<rb>‚òò</rb><rtc><rt>Shamrock</rt></rtc><rtc lang=\"fr\"><rt>Tr√®fle</rt></rtc>\n<rb>‚ú∂</rb><rtc><rt>Star</rt></rtc><rtc lang=\"fr\"><rt>√âtoile</rt></rtc>\n</ruby>",
		"html": "<dl><dt>Mono-ruby for individual base characters</dt>\n<dd><ruby>Êó•<rt>„Å´</rt>Êú¨<rt>„Åª„Çì</rt>Ë™û<rt>„Åî</rt></ruby></dd>\n<dt>Group ruby</dt>\n<dd><ruby>‰ªäÊó•<rt>„Åç„Çá„ÅÜ</rt></ruby></dd>\n<dt>Jukugo ruby</dt>\n<dd><ruby>Ê≥ï<rb>ËèØ</rb><rb>Áµå</rb><rt>„Åª</rt><rt>„Åë</rt><rt>„Åç„Çá„ÅÜ</rt></ruby></dd>\n<dt>Inline ruby</dt>\n<dd><ruby>Êù±<rb>‰∫¨</rb><rp>(</rp><rt>„Å®„ÅÜ</rt><rt>„Åç„Çá„ÅÜ</rt><rp>)</rp></ruby></dd>\n<dt>Double-sided ruby</dt>\n<dd><ruby><rb>Êóß</rb><rb>Èáë</rb><rb>Â±±</rb><rt>ji√π</rt><rt>jƒ´n</rt><rt>shƒÅn</rt><rtc>San Francisco</rtc></ruby></dd></dl>\n<p><ruby>\n<rb>‚ô•</rb><rtc><rt>Heart</rt></rtc><rtc lang=\"fr\"><rt>C≈ìur</rt></rtc>\n<rb>‚òò</rb><rtc><rt>Shamrock</rt></rtc><rtc lang=\"fr\"><rt>Tr√®fle</rt></rtc>\n<rb>‚ú∂</rb><rtc><rt>Star</rt></rtc><rtc lang=\"fr\"><rt>√âtoile</rt></rtc>\n</ruby>\n</p>",
		"render": "<dl><dt>Mono-ruby for individual base characters</dt>\n<dd><ruby >Êó•<rt >„Å´</rt>Êú¨<rt >„Åª„Çì</rt>Ë™û<rt >„Åî</rt></ruby></dd>\n<dt>Group ruby</dt>\n<dd><ruby >‰ªäÊó•<rt >„Åç„Çá„ÅÜ</rt></ruby></dd>\n<dt>Jukugo ruby</dt>\n<dd><ruby >Ê≥ï<rb >ËèØ</rb><rb >Áµå</rb><rt >„Åª</rt><rt >„Åë</rt><rt >„Åç„Çá„ÅÜ</rt></ruby></dd>\n<dt>Inline ruby</dt>\n<dd><ruby >Êù±<rb >‰∫¨</rb><rp >(</rp><rt >„Å®„ÅÜ</rt><rt >„Åç„Çá„ÅÜ</rt><rp >)</rp></ruby></dd>\n<dt>Double-sided ruby</dt>\n<dd><ruby ><rb >Êóß</rb><rb >Èáë</rb><rb >Â±±</rb><rt >ji√π</rt><rt >jƒ´n</rt><rt >shƒÅn</rt><rtc >San Francisco</rtc></ruby></dd></dl>\n<p><ruby >\n<rb >‚ô•</rb><rtc ><rt >Heart</rt></rtc><rtc lang=\"fr\"><rt >C≈ìur</rt></rtc>\n<rb >‚òò</rb><rtc ><rt >Shamrock</rt></rtc><rtc lang=\"fr\"><rt >Tr√®fle</rt></rtc>\n<rb >‚ú∂</rb><rtc ><rt >Star</rt></rtc><rtc lang=\"fr\"><rt >√âtoile</rt></rtc>\n</ruby>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>Mono-ruby for individual base characters\n<span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;ruby&gt;</span>Êó•<span class=\"wpb-html\">&lt;rt&gt;</span>„Å´<span class=\"wpb-html\">&lt;/rt&gt;</span>Êú¨<span class=\"wpb-html\">&lt;rt&gt;</span>„Åª„Çì<span class=\"wpb-html\">&lt;/rt&gt;</span>Ë™û<span class=\"wpb-html\">&lt;rt&gt;</span>„Åî<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/ruby&gt;</span>\n<span class=\"wpb-list\">;</span>Group ruby\n<span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;ruby&gt;</span>‰ªäÊó•<span class=\"wpb-html\">&lt;rt&gt;</span>„Åç„Çá„ÅÜ<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/ruby&gt;</span>\n<span class=\"wpb-list\">;</span>Jukugo ruby\n<span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;ruby&gt;</span>Ê≥ï<span class=\"wpb-html\">&lt;rb&gt;</span>ËèØ<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rb&gt;</span>Áµå<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>„Åª<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>„Åë<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>„Åç„Çá„ÅÜ<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/ruby&gt;</span>\n<span class=\"wpb-list\">;</span>Inline ruby\n<span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;ruby&gt;</span>Êù±<span class=\"wpb-html\">&lt;rb&gt;</span>‰∫¨<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rp&gt;</span>(<span class=\"wpb-html\">&lt;/rp&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>„Å®„ÅÜ<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>„Åç„Çá„ÅÜ<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rp&gt;</span>)<span class=\"wpb-html\">&lt;/rp&gt;</span><span class=\"wpb-html\">&lt;/ruby&gt;</span>\n<span class=\"wpb-list\">;</span>Double-sided ruby\n<span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;ruby&gt;</span><span class=\"wpb-html\">&lt;rb&gt;</span>Êóß<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rb&gt;</span>Èáë<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rb&gt;</span>Â±±<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>ji√π<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>jƒ´n<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>shƒÅn<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;rtc&gt;</span>San Francisco<span class=\"wpb-html\">&lt;/rtc&gt;</span><span class=\"wpb-html\">&lt;/ruby&gt;</span>\n\n<span class=\"wpb-html\">&lt;ruby&gt;</span>\n<span class=\"wpb-html\">&lt;rb&gt;</span>‚ô•<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rtc&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>Heart<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/rtc&gt;</span><span class=\"wpb-html\">&lt;rtc<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">lang</span>=\"<span class=\"wpb-attr-value\">fr</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>C≈ìur<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/rtc&gt;</span>\n<span class=\"wpb-html\">&lt;rb&gt;</span>‚òò<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rtc&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>Shamrock<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/rtc&gt;</span><span class=\"wpb-html\">&lt;rtc<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">lang</span>=\"<span class=\"wpb-attr-value\">fr</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>Tr√®fle<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/rtc&gt;</span>\n<span class=\"wpb-html\">&lt;rb&gt;</span>‚ú∂<span class=\"wpb-html\">&lt;/rb&gt;</span><span class=\"wpb-html\">&lt;rtc&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>Star<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/rtc&gt;</span><span class=\"wpb-html\">&lt;rtc<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">lang</span>=\"<span class=\"wpb-attr-value\">fr</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;rt&gt;</span>√âtoile<span class=\"wpb-html\">&lt;/rt&gt;</span><span class=\"wpb-html\">&lt;/rtc&gt;</span>\n<span class=\"wpb-html\">&lt;/ruby&gt;</span></span>"
	},
	{
		"desc": "Non-word characters don't terminate tag names (T19663, T42670, T54022)",
		"wikitext": "<blockquote|>a</blockquote>\n\n<b‚Üí> doesn't terminate </b‚Üí>\n\n<b√§> doesn't terminate </b√§>\n\n<boo> doesn't terminate </boo>\n\n<s.foo> doesn't terminate </s.foo>\n\n<sub-ID#1>",
		"html": "<p>&lt;blockquote|&gt;a\n</p><p>&lt;b‚Üí&gt; doesn't terminate &lt;/b‚Üí&gt;\n</p><p>&lt;b√§&gt; doesn't terminate &lt;/b√§&gt;\n</p><p>&lt;boo&gt; doesn't terminate &lt;/boo&gt;\n</p><p>&lt;s.foo&gt; doesn't terminate &lt;/s.foo&gt;\n</p><p>&lt;sub-ID#1&gt;\n</p>",
		"render": "&lt;blockquote|&gt;a</blockquote>\n<p>&lt;b‚Üí&gt; doesn't terminate &lt;/b‚Üí&gt;\n</p><p>&lt;b√§&gt; doesn't terminate &lt;/b√§&gt;\n</p><p>&lt;boo&gt; doesn't terminate &lt;/boo&gt;\n</p><p>&lt;s.foo&gt; doesn't terminate &lt;/s.foo&gt;\n</p><p>&lt;sub-ID#1&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;blockquote|&gt;a<span class=\"wpb-html\">&lt;/blockquote&gt;</span>\n\n&lt;b‚Üí&gt; doesn't terminate &lt;/b‚Üí&gt;\n\n&lt;b√§&gt; doesn't terminate &lt;/b√§&gt;\n\n&lt;boo&gt; doesn't terminate &lt;/boo&gt;\n\n&lt;s.foo&gt; doesn't terminate &lt;/s.foo&gt;\n\n&lt;sub-ID#1&gt;</span>"
	},
	{
		"desc": "Isolated close tags should be treated as literal text (T54760)",
		"wikitext": "</b>\n\n<s.foo>s</s>",
		"html": "<p class=\"mw-empty-elt\">\n</p><p>&lt;s.foo&gt;s\n</p>",
		"render": "<p></b>\n</p><p>&lt;s.foo&gt;s</s>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;/b&gt;</span>\n\n&lt;s.foo&gt;s<span class=\"wpb-html\">&lt;/s&gt;</span></span>"
	},
	{
		"desc": "Self-closed tag hooks",
		"wikitext": "<pre />\n<gallery />\n<indicator name=\"something\" />",
		"html": "<pre></pre>\n<ul class=\"gallery mw-gallery-traditional\">\n</ul>",
		"render": "<pre ></pre>\n<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">something</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Bare pipe character (T54363)",
		"wikitext": "|",
		"html": "<p>|\n</p>",
		"render": "<p>|\n</p>",
		"print": "<span class=\"wpb-root\">|</span>"
	},
	{
		"desc": "Bare pipe character from a template (T54363)",
		"wikitext": "{{pipe}}",
		"html": "<p>|\n</p>",
		"render": "<p>|\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">pipe</span>}}</span></span>"
	},
	{
		"desc": "Implicit newline insertion/sol when expanding templates (T241150/T14974/T2529)",
		"wikitext": "{{1x|#foo}}{{1x|#foo}}",
		"html": "<ol><li>foo</li>\n<li>foo</li></ol>",
		"render": "<ol><li>foo</li>\n<li>foo</li></ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">#foo</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">#foo</span></span>}}</span></span>"
	},
	{
		"desc": "<nowiki> unordered list",
		"wikitext": "<nowiki>* This is not an unordered list item.</nowiki>",
		"html": "<p>* This is not an unordered list item.\n</p>",
		"render": "<p>* This is not an unordered list item.\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">* This is not an unordered list item.</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "<nowiki> spacing",
		"wikitext": "<nowiki>Lorem ipsum dolor\n\nsed abit.\n  sed nullum.\n\n:and a colon\n</nowiki>",
		"html": "<p>Lorem ipsum dolor\n\nsed abit.\n  sed nullum.\n\n:and a colon\n\n</p>",
		"render": "<p>Lorem ipsum dolor&#10;&#10;sed abit.&#10;  sed nullum.&#10;&#10;:and a colon&#10;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">Lorem ipsum dolor\n\nsed abit.\n  sed nullum.\n\n:and a colon\n</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Don't parse <nowiki><span class=\"error\"></nowiki> (T149622)",
		"wikitext": "<nowiki><span class=\"error\"></nowiki>",
		"html": "<p>&lt;span class=\"error\"&gt;\n</p>",
		"render": "<p>&lt;span class=\"error\"&gt;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;span class=\"error\"&gt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "nowiki 3",
		"wikitext": ":There is not nowiki.\n:There is <nowiki>nowiki</nowiki>.\n\n#There is not nowiki.\n#There is <nowiki>nowiki</nowiki>.\n\n*There is not nowiki.\n*There is <nowiki>nowiki</nowiki>.",
		"html": "<dl><dd>There is not nowiki.</dd>\n<dd>There is nowiki.</dd></dl>\n<ol><li>There is not nowiki.</li>\n<li>There is nowiki.</li></ol>\n<ul><li>There is not nowiki.</li>\n<li>There is nowiki.</li></ul>",
		"render": "<dl><dd>There is not nowiki.</dd>\n<dd>There is nowiki.</dd></dl>\n<ol><li>There is not nowiki.</li>\n<li>There is nowiki.</li></ol>\n<ul><li>There is not nowiki.</li>\n<li>There is nowiki.</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span>There is not nowiki.\n<span class=\"wpb-list\">:</span>There is <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">nowiki</span>&lt;/nowiki&gt;</span>.\n\n<span class=\"wpb-list\">#</span>There is not nowiki.\n<span class=\"wpb-list\">#</span>There is <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">nowiki</span>&lt;/nowiki&gt;</span>.\n\n<span class=\"wpb-list\">*</span>There is not nowiki.\n<span class=\"wpb-list\">*</span>There is <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">nowiki</span>&lt;/nowiki&gt;</span>.</span>"
	},
	{
		"desc": "Entities inside <nowiki>",
		"wikitext": "<nowiki>&lt;</nowiki>",
		"html": "<p>&lt;\n</p>",
		"render": "<p>&lt;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&amp;lt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Entities inside template parameters",
		"wikitext": "{{1x|&ndash;}}",
		"html": "<p>&#8211;\n</p>",
		"render": "<p>&ndash;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">&amp;ndash;</span></span>}}</span></span>"
	},
	{
		"desc": "Properly escape nowiki when combined with other wiki markup",
		"wikitext": "<nowiki>*</nowiki> <nowiki>&lt;/nowiki&gt;</nowiki> tag",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span> <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&amp;lt;/nowiki&amp;gt;</span>&lt;/nowiki&gt;</span> tag</span>"
	},
	{
		"desc": "T93824: Put escaped HTML tags inside nowiki",
		"wikitext": "<nowiki><h2>foo</h2></nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;h2&gt;foo&lt;/h2&gt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "T71950: 1. Put nowiki as close to cause as possible, even with non-quote escapable chars",
		"wikitext": "This text: L'[[Foo]]\nThis text: L<nowiki>''</nowiki>[[Foo]]\nThis text: L<nowiki>'''</nowiki>[[Foo]]<nowiki>''</nowiki>",
		"print": "<span class=\"wpb-root\">This text: L'<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>\nThis text: L<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''</span>&lt;/nowiki&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>\nThis text: L<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">'''</span>&lt;/nowiki&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "T71950: 2. Put nowiki as close to cause as possible, after ' :'",
		"wikitext": "This text : L<nowiki>''</nowiki>[[Foo]]",
		"print": "<span class=\"wpb-root\">This text : L<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''</span>&lt;/nowiki&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span>"
	},
	{
		"desc": "T71482: Use {{!}} instead of nowiki for single pipe in template argument",
		"wikitext": "{{1x|foo{{!}}bar}}\n{{1x|<nowiki>foo|bar |[[</nowiki>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>bar</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo|bar |[[</span>&lt;/nowiki&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "T53961: Output correct nowikis in template arguments",
		"wikitext": "{{1x|a [ b}}\n{{1x|<nowiki>a }} b</nowiki>}}\n{{1x|<nowiki>a [[ b</nowiki>}}\n{{1x|<nowiki>a | {{ ]]</nowiki>}}\n{{1x|a <nowiki>}</nowiki>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a [ b</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">a }} b</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">a [[ b</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">a | {{ ]]</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">}</span>&lt;/nowiki&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Cases where \"!!\" needs nowiki protection",
		"wikitext": "{|\n!<nowiki>this needs protection !! here</nowiki>\n|}\n\n{|\n!this does not need\nprotection !! here\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">this needs protection !! here</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">this does not need\nprotection !! here</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Nowiki with newlines in list",
		"wikitext": ":<nowiki>test\n123</nowiki>",
		"html": "<dl><dd>test\n123</dd></dl>",
		"render": "<dl><dd>test&#10;123</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">test\n123</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Nowiki and french spacing",
		"wikitext": "<nowiki>test : 123</nowiki>",
		"html": "<p>test&#160;: 123\n</p>",
		"render": "<p>test : 123\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">test : 123</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "T255007: French spacing in raw text elements",
		"wikitext": "<html>\n<script>test ; 123</script>\n<style>test : 123</style>\n</html>",
		"print": "<span class=\"wpb-root\">&lt;html&gt;\n&lt;script&gt;test ; 123&lt;/script&gt;\n&lt;style&gt;test : 123&lt;/style&gt;\n&lt;/html&gt;</span>"
	},
	{
		"desc": "French spacing and spans",
		"wikitext": "[[Test]] : <span>123</span>\n¬´ Test ¬ª<span>123</span>",
		"html": "<p><a href=\"/wiki/Test\" title=\"Test\">Test</a>&#160;: <span>123</span>\n¬´&#160;Test&#160;¬ª<span>123</span>\n</p>",
		"render": "<p><a href=\"/wiki/Test\" title=\"Test\">Test</a> : <span >123</span>\n¬´ Test ¬ª<span >123</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span> : <span class=\"wpb-html\">&lt;span&gt;</span>123<span class=\"wpb-html\">&lt;/span&gt;</span>\n¬´ Test ¬ª<span class=\"wpb-html\">&lt;span&gt;</span>123<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "post-expand include size being exceeded",
		"wikitext": "{{3x_on_newline|1234567890}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">3x_on_newline</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1234567890</span></span>}}</span></span>"
	},
	{
		"desc": "max template depth being reached",
		"wikitext": "{{1x with depth|too deep!}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x with depth</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">too deep!</span></span>}}</span></span>"
	},
	{
		"desc": "multiple templates that are redirects",
		"wikitext": "{{redirect to foo}}\n{{redirect to foo}}",
		"html": "<p>FOO\nFOO\n</p>",
		"render": "<p>FOO\nFOO\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">redirect to foo</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">redirect to foo</span>}}</span></span>"
	},
	{
		"desc": "T53086: Double newlines in blockquotes should be turned into paragraphs",
		"wikitext": "<blockquote>\nFoo\n\nBar\n</blockquote>",
		"html": "<blockquote>\n<p>Foo\n</p><p>Bar\n</p>\n</blockquote>",
		"render": "<blockquote >\n<p>Foo\n</p><p>Bar\n</p>\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\nFoo\n\nBar\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "T17491: <ins>/<del> in blockquote",
		"wikitext": "<blockquote>\nFoo <del>bar</del> <ins>baz</ins> quux\n</blockquote>",
		"html": "<blockquote>\n<p>Foo <del>bar</del> <ins>baz</ins> quux\n</p>\n</blockquote>",
		"render": "<blockquote >\n<p>Foo <del >bar</del> <ins >baz</ins> quux\n</p>\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\nFoo <span class=\"wpb-html\">&lt;del&gt;</span>bar<span class=\"wpb-html\">&lt;/del&gt;</span> <span class=\"wpb-html\">&lt;ins&gt;</span>baz<span class=\"wpb-html\">&lt;/ins&gt;</span> quux\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "T17491: <ins>/<del> in blockquote (2)",
		"wikitext": "<blockquote>Foo <del>bar</del> <ins>baz</ins> quux\n</blockquote>",
		"html": "<blockquote><p>Foo <del>bar</del> <ins>baz</ins> quux\n</p></blockquote>",
		"render": "<blockquote >Foo <del >bar</del> <ins >baz</ins> quux\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>Foo <span class=\"wpb-html\">&lt;del&gt;</span>bar<span class=\"wpb-html\">&lt;/del&gt;</span> <span class=\"wpb-html\">&lt;ins&gt;</span>baz<span class=\"wpb-html\">&lt;/ins&gt;</span> quux\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Don't paragraph-wrap empty newlines between HTML list items",
		"wikitext": "<ol>\n<li>foo</li>\n\n\n\n<li>foo</li>\n</ol>",
		"html": "<ol>\n<li>foo</li>\n\n\n\n<li>foo</li>\n</ol>",
		"render": "<ol >\n<li >foo</li>\n\n\n\n<li >foo</li>\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>foo<span class=\"wpb-html\">&lt;/li&gt;</span>\n\n\n\n<span class=\"wpb-html\">&lt;li&gt;</span>foo<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "Templates: Strip leading and trailing whitespace from named-param values",
		"wikitext": "{{1x|1= a }}\n\n{{1x|1= {{1x|b}} }}\n\n{{1x| 1 =\n c }}\n\n{{1x| 1 =\n* d\n}}",
		"html": "<p>a\n</p><p>b\n</p><p>c\n</p>\n<ul><li>d</li></ul>",
		"render": "<p>a\n</p><p>b\n</p><p>c\n</p>\n<ul><li>d</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\"> a </span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span> </span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> 1 </span>=<span class=\"wpb-parameter-value\">\n c </span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> 1 </span>=<span class=\"wpb-parameter-value\">\n<span class=\"wpb-list\">* </span>d\n</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Don't strip whitespace from positional-param values",
		"wikitext": "{{1x|a }}\n\n{{1x|{{1x|b}} }}\n\n{{1x| c \n}}\n\n{{1x| {{1x|d}}\n}}\n\n{{1x|\n e}}\n\n{{1x|\n*f}}\n\n{{1x|\n }}g",
		"html": "<p>a \n</p><p>b \n</p>\n<pre>c \n</pre>\n<p><br />\n</p>\n<pre>d\n</pre>\n<p><br />\n</p>\n<pre>e\n</pre>\n<p><br />\n</p>\n<ul><li>f</li></ul>\n<p><br />\n</p>\n<pre>g\n</pre>",
		"render": "<p>a \n</p><p>b \n</p>\n<pre>c \n</pre>\n<p><br>\n</p>\n<pre>d\n</pre>\n<p><br>\n</p>\n<pre>e\n</pre>\n<p><br>\n</p>\n<ul><li>f</li></ul>\n<p><br>\n</p>\n<pre>g\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a </span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span> </span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> c \n</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">d</span></span>}}</span>\n</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n e</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-list\">*</span>f</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n </span></span>}}</span>g</span>"
	},
	{
		"desc": "Templates: Don't recognize targets split by newlines",
		"wikitext": "{{ech\no|foo}}",
		"html": "<p>{{ech\no|foo}}\n</p>",
		"render": "<p>{{ech\no|foo}}\n</p>",
		"print": "<span class=\"wpb-root\">{{ech\no|foo}}</span>"
	},
	{
		"desc": "Templates: Recognize targets when newlines and comments don't split the target",
		"wikitext": "{{  \n <!--X--> 1<!--X-->x<!--X-->  \n   <!--X-->   <!--X-->\n\n |foo}}",
		"html": "<p>foo\n</p>",
		"render": "<p>foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">  \n <span class=\"wpb-comment\">&lt;!--X--&gt;</span> 1<span class=\"wpb-comment\">&lt;!--X--&gt;</span>x<span class=\"wpb-comment\">&lt;!--X--&gt;</span>  \n   <span class=\"wpb-comment\">&lt;!--X--&gt;</span>   <span class=\"wpb-comment\">&lt;!--X--&gt;</span>\n\n </span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Target with an extension tag",
		"wikitext": "{{{{1x|1x}}<nowiki>hi</nowiki>|ho}}",
		"html": "<p>{{1xhi|ho}}\n</p>",
		"render": "<p>{{1xhi|ho}}\n</p>",
		"print": "<span class=\"wpb-root\">{{<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1x</span></span>}}</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">hi</span>&lt;/nowiki&gt;</span>|ho}}</span>"
	},
	{
		"desc": "Templates: Handle empty comment-and-ws-only lines correctly",
		"wikitext": "{{1x|foo\n<!--should be ignored-->\n <!--should be ignored as well-->\nbar}}",
		"html": "<p>foo\nbar\n</p>",
		"render": "<p>foo\nbar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo\n<span class=\"wpb-comment\">&lt;!--should be ignored--&gt;</span>\n <span class=\"wpb-comment\">&lt;!--should be ignored as well--&gt;</span>\nbar</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Handle comments in the target",
		"wikitext": "{{1x\n<!-- should be ignored -->\n|foo}}\n\n{{1x\n<!-- should be ignored and spaces on next line should not trip us up (T147742) -->\n  |foo}}\n\n{{1x<!-- should be ignored -->\n|foo}}\n\n{{1x<!-- should be ignored -->|foo}}\n\n{{<!-- should be ignored -->1x|foo}}",
		"html": "<p>foo\n</p><p>foo\n</p><p>foo\n</p><p>foo\n</p><p>foo\n</p>",
		"render": "<p>foo\n</p><p>foo\n</p><p>foo\n</p><p>foo\n</p><p>foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x\n<span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span>\n</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x\n<span class=\"wpb-comment\">&lt;!-- should be ignored and spaces on next line should not trip us up (T147742) --&gt;</span>\n  </span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x<span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span>\n</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x<span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span>1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Handle comments in parameter names (T69657)",
		"wikitext": "{{1x|1\n<!-- should be ignored -->\n=foo}}\n\n{{1x|\n<!-- should be ignored -->\n1 = foo}}\n\n{{1x|1<!-- should be ignored -->=foo}}\n\n{{1x|<!-- should be ignored -->1=foo}}",
		"html": "<p>foo\n</p><p>foo\n</p><p>foo\n</p><p>foo\n</p>",
		"render": "<p>foo\n</p><p>foo\n</p><p>foo\n</p><p>foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1\n<span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span>\n</span>=<span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">\n<span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span>\n1 </span>=<span class=\"wpb-parameter-value\"> foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1<span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span></span>=<span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"><span class=\"wpb-comment\">&lt;!-- should be ignored --&gt;</span>1</span>=<span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Other wikitext in parameter names (T69657)",
		"wikitext": "{{1x|''1''=foo}}",
		"html": "<p>{{{1}}}\n</p>",
		"render": "<p>{{{1}}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"><span class=\"wpb-quote\">''</span>1<span class=\"wpb-quote\">''</span></span>=<span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: With colons",
		"wikitext": "{{With: Colon}}",
		"html": "<p>Template with colon\n</p>",
		"render": "<p>Template with colon\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">With: Colon</span>}}</span></span>"
	},
	{
		"desc": "Templates: Parsoid parameter escaping test 1",
		"wikitext": "{{1x|[foo]|{{1x|[bar]}}}}",
		"html": "<p>[foo]\n</p>",
		"render": "<p>[foo]\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[foo]</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[bar]</span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Pipes in external links in template parameter",
		"wikitext": "{{1x|[{{1x|http://example.com}} link]}}",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">link</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-free-ext-link\">http://example.com</span></span></span>}}</span> link]</span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: pipe in transclusion parameter",
		"wikitext": "{{1x|http://foo.com/a&#124;b}}",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://foo.com/a%7Cb\">http://foo.com/a%7Cb</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://foo.com/a|b\">http://foo.com/a&#124;b</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-free-ext-link\">http://foo.com/a&amp;#124;b</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Pipe in external link target and content in template parameter",
		"wikitext": "{{1x|[http://foo.com/a&#124;b a&#124;b]}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com/a&amp;#124;b</span> <span class=\"wpb-ext-link-text\">a&amp;#124;b</span>]</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Pipe in template with nested template in external link target in template parameter (seriously)",
		"wikitext": "{{1x|[{{fullurl:{{FULLPAGENAME}}|action=edit}} bar]}}",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.org/index.php?title=Parser_test&amp;action=edit\">bar</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\">bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">fullurl</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">FULLPAGENAME</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">action=edit</span></span>}}</span></span> <span class=\"wpb-ext-link-text\">bar</span>]</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Don't escape already nowiki-escaped text in template parameters",
		"wikitext": "{{1x|foo<nowiki>|</nowiki>bar}}\n{{1x|<nowiki>&lt;div&gt;</nowiki>}}\n{{1x|<nowiki></nowiki>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">|</span>&lt;/nowiki&gt;</span>bar</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&amp;lt;div&amp;gt;</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;&lt;/nowiki&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: '=' char in nested transclusions should not trigger nowiki escapes or conversion to named param",
		"wikitext": "{{1x|{{1x|1=bar}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">bar</span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates parameters with special tokenizing behavior dont get modified because of arg escaping",
		"wikitext": "{{1x|a : b}}",
		"html": "<p>a&#160;: b\n</p>",
		"render": "<p>a : b\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a : b</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Preserve blank parameter names",
		"wikitext": "{{1x|=foo}}",
		"html": "<p>{{{1}}}\n</p>",
		"render": "<p>{{{1}}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\">=<span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Preserve blank parameter names in other positions",
		"wikitext": "{{blank_param|bar|=foo}}",
		"html": "<p>bar\nfoo\n</p>",
		"render": "<p>bar\nfoo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">blank_param</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>|<span class=\"wpb-parameter\">=<span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Broken wikilinks (but not external links) prevent templates from closing",
		"wikitext": "[http://example.com x\n\n{{1x|[http://example.com x}}\n\n[[Foo\n\n{{1x|[[Foo}}",
		"html": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a> x\n</p><p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a> x\n</p><p>[[Foo\n</p><p>{{1x|[[Foo}}\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a> x\n</p><p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a> x\n</p><p>[[Foo\n</p><p>{{1x|[[Foo}}\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-free-ext-link\">http://example.com</span> x\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[<span class=\"wpb-free-ext-link\">http://example.com</span> x</span></span>}}</span>\n\n[[Foo\n\n{{1x|[[Foo}}</span>"
	},
	{
		"desc": "Wikilinks with embedded newlines are not broken",
		"wikitext": "{{1x|[[ Foo\nB\nC]]}}",
		"html": "<p>[[ Foo\nB\nC]]\n</p>",
		"render": "<p>[[ Foo\nB\nC]]\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[[ Foo\nB\nC]]</span></span>}}</span></span>"
	},
	{
		"desc": "Broken templates",
		"wikitext": "{{1x|[[Foo|}}]]\n\n[[Foo|{{1x|]]}}",
		"html": "<p>{{1x|<a href=\"/wiki/Foo\" title=\"Foo\">}}</a>\n</p><p>[[Foo|]]\n</p>",
		"render": "<p>{{1x|<a href=\"/wiki/Foo\" title=\"Foo\">}}</a>\n</p><p>[[Foo|]]\n</p>",
		"print": "<span class=\"wpb-root\">{{1x|<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">}}</span>]]</span>\n\n[[Foo|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">]]</span></span>}}</span></span>"
	},
	{
		"desc": "Template returning pipe used in wikilink target",
		"wikitext": "[[{{pipe page}}]]",
		"html": "<p><a href=\"/index.php?title=Main&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Main (page does not exist)\">Page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main\" title=\"Main\">Page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">pipe page</span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "T4702: Mismatched <i>, <b> and <a> tags are invalid",
		"wikitext": "''[http://example.com text'']\n[http://example.com '''text]'''\n''Something [http://example.com in italic'']\n''Something [http://example.com mixed''''', even bold]'''\n'''''Now [http://example.com both''''']",
		"html": "<p><i><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">text</a></i>\n<a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\"><b>text</b></a>\n<i>Something <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">in italic</a></i>\n<i>Something <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">mixed</a></i><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\"><b>, even bold</b></a>\n<i><b>Now <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">both</a></b></i>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"><i>text</i></a>\n<a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"><b>text</b></a>\n<i>Something </i><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"><i>in italic</i></a>\n<i>Something </i><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"><i>mixed</i><b>, even bold</b></a>\n<i><b>Now </b></i><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"><i><b>both</b></i></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">text<span class=\"wpb-quote\">''</span></span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-quote\">'''</span>text</span>]</span><span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">''</span>Something <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">in italic<span class=\"wpb-quote\">''</span></span>]</span>\n<span class=\"wpb-quote\">''</span>Something <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">mixed<span class=\"wpb-quote\">'''''</span>, even bold</span>]</span><span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">'''''</span>Now <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">both<span class=\"wpb-quote\">'''''</span></span>]</span></span>"
	},
	{
		"desc": "Serialize <a> tags with invalid link targets as plain text",
		"wikitext": "text\n<nowiki>*</nowiki>text\n<nowiki>[[foo]]</nowiki>\n<nowiki>*</nowiki>a <nowiki>[[foo]]</nowiki>",
		"print": "<span class=\"wpb-root\">text\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>text\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>a <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "mw:ExtLink -vs- mw:WikiLink (T94723)",
		"wikitext": "[[Foo|Bar]]\n[[Foo|Bar]]\n[[:en:Foo|Bar]]\n[[:en:Foo|Bar]]\n\n[[:en:European_Robin|European Robin]]\n[[:en:European_Robin|European Robin]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:en:Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:en:Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:en:European_Robin</span>|<span class=\"wpb-link-text\">European Robin</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:en:European_Robin</span>|<span class=\"wpb-link-text\">European Robin</span>]]</span></span>"
	},
	{
		"desc": "Break on | in element attribute in template",
		"wikitext": "{{1x|1=<div class=\"hi|ho\">ha</div>}}",
		"html": "<p>ho\"&gt;ha</p>",
		"render": "ho\"&gt;ha</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">&lt;div class=\"hi</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ho\"&gt;ha<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Break on | in element attribute name in template",
		"wikitext": "{{1x|<div cla|ss=\"hiho\">ha</div>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">&lt;div cla</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">ss</span>=<span class=\"wpb-parameter-value\">\"hiho\"&gt;ha<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Plain link, capitalized",
		"wikitext": "[[Main Page]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>"
	},
	{
		"desc": "Plain link, uncapitalized",
		"wikitext": "[[main Page]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">main Page</span>]]</span></span>"
	},
	{
		"desc": "Piped link",
		"wikitext": "[[Main Page|The Main Page]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">The Main Page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">The Main Page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">The Main Page</span>]]</span></span>"
	},
	{
		"desc": "Piped link with comment in link text",
		"wikitext": "[[Main Page|The Main<!--front--> Page]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">The Main Page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">The Main Page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">The Main<span class=\"wpb-comment\">&lt;!--front--&gt;</span> Page</span>]]</span></span>"
	},
	{
		"desc": "Piped link with multiple pipe characters in link text",
		"wikitext": "[[Main Page||The|Main|Page|]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">|The|Main|Page|</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">|The|Main|Page|</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">|The|Main|Page|</span>]]</span></span>"
	},
	{
		"desc": "Piped link with no link text",
		"wikitext": "[[Thomas Bek (bishop of St David's)|]]",
		"html": "<p>[[Thomas Bek (bishop of St David's)|]]\n</p>",
		"render": "<p>[[Thomas Bek (bishop of St David's)|]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Thomas Bek (bishop of St David's)|]]</span>"
	},
	{
		"desc": "Piped link with empty link text",
		"wikitext": "[[Main Page|<nowiki/>]] - empty nowiki\n[[Main Page|&nbsp;]] - empty non breaking space",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\"></a> - empty nowiki\n<a href=\"/wiki/Main_Page\" title=\"Main Page\">&#160;</a> - empty non breaking space\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\"></a> - empty nowiki\n<a href=\"/wiki/Main_Page\" title=\"Main Page\">&nbsp;</a> - empty non breaking space\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki/&gt;</span></span>]]</span> - empty nowiki\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">&amp;nbsp;</span>]]</span> - empty non breaking space</span>"
	},
	{
		"desc": "Piped link with empty link text - 2",
		"wikitext": "[[Main Page| ]] - empty space",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\"> </a> - empty space\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\"> </a> - empty space\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\"> </span>]]</span> - empty space</span>"
	},
	{
		"desc": "Broken link",
		"wikitext": "[[Zigzagzogzagzig]]",
		"html": "<p><a href=\"/index.php?title=Zigzagzogzagzig&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Zigzagzogzagzig (page does not exist)\">Zigzagzogzagzig</a>\n</p>",
		"render": "<p><a href=\"/wiki/Zigzagzogzagzig\" title=\"Zigzagzogzagzig\">Zigzagzogzagzig</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Zigzagzogzagzig</span>]]</span></span>"
	},
	{
		"desc": "Broken link with fragment",
		"wikitext": "[[Zigzagzogzagzig#zug]]",
		"html": "<p><a href=\"/index.php?title=Zigzagzogzagzig&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Zigzagzogzagzig (page does not exist)\">Zigzagzogzagzig#zug</a>\n</p>",
		"render": "<p><a href=\"/wiki/Zigzagzogzagzig#zug\" title=\"Zigzagzogzagzig\">Zigzagzogzagzig#zug</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Zigzagzogzagzig#zug</span>]]</span></span>"
	},
	{
		"desc": "Special page link with fragment",
		"wikitext": "[[Special:Version#anchor]]",
		"html": "<p><a href=\"/wiki/Special:Version#anchor\" title=\"Special:Version\">Special:Version#anchor</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3AVersion#anchor\" title=\"Special:Version\">Special:Version#anchor</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Special:Version#anchor</span>]]</span></span>"
	},
	{
		"desc": "Nonexistent special page link with fragment",
		"wikitext": "[[Special:ThisNameWillHopefullyNeverBeUsed#anchor]]",
		"html": "<p><a href=\"/wiki/Special:ThisNameWillHopefullyNeverBeUsed\" class=\"new\" title=\"Special:ThisNameWillHopefullyNeverBeUsed (page does not exist)\">Special:ThisNameWillHopefullyNeverBeUsed#anchor</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3AThisNameWillHopefullyNeverBeUsed#anchor\" title=\"Special:ThisNameWillHopefullyNeverBeUsed\">Special:ThisNameWillHopefullyNeverBeUsed#anchor</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Special:ThisNameWillHopefullyNeverBeUsed#anchor</span>]]</span></span>"
	},
	{
		"desc": "Link with prefix",
		"wikitext": "xxx[[main Page]], xxx[[Main Page]], Xxx[[main Page]] XXX[[main Page]], XXX[[Main Page]]",
		"html": "<p>xxx<a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a>, xxx<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>, Xxx<a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a> XXX<a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a>, XXX<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p>",
		"render": "<p>xxx<a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a>, xxx<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>, Xxx<a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a> XXX<a href=\"/wiki/Main_Page\" title=\"Main Page\">main Page</a>, XXX<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p>",
		"print": "<span class=\"wpb-root\">xxx<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">main Page</span>]]</span>, xxx<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>, Xxx<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">main Page</span>]]</span> XXX<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">main Page</span>]]</span>, XXX<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>"
	},
	{
		"desc": "Link with suffix",
		"wikitext": "[[Main Page]]xxx, [[Main Page]]XXX, [[Main Page]]!!!",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Pagexxx</a>, <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>XXX, <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>!!!\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>xxx, <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>XXX, <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>!!!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>xxx, <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>XXX, <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>!!!</span>"
	},
	{
		"desc": "T45661: Piped links with identical prefixes",
		"wikitext": "[[prefixed article|prefixed articles with spaces]]\n\n[[prefixed article|prefixed articlesaoeu]]\n\n[[Main Page|Main Page test]]",
		"html": "<p><a href=\"/wiki/Prefixed_article\" title=\"Prefixed article\">prefixed articles with spaces</a>\n</p><p><a href=\"/wiki/Prefixed_article\" title=\"Prefixed article\">prefixed articlesaoeu</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page test</a>\n</p>",
		"render": "<p><a href=\"/wiki/Prefixed_article\" title=\"Prefixed article\">prefixed articles with spaces</a>\n</p><p><a href=\"/wiki/Prefixed_article\" title=\"Prefixed article\">prefixed articlesaoeu</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page test</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">prefixed article</span>|<span class=\"wpb-link-text\">prefixed articles with spaces</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">prefixed article</span>|<span class=\"wpb-link-text\">prefixed articlesaoeu</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">Main Page test</span>]]</span></span>"
	},
	{
		"desc": "Link with HTML entity in suffix / tail",
		"wikitext": "[[Main Page]]&quot;, [[Main Page]]&#97;",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>&quot;, <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>&#97;\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>&quot;, <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>&#97;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>&amp;quot;, <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>&amp;#97;</span>"
	},
	{
		"desc": "Link with 3 brackets",
		"wikitext": "[[[Main Page]]]\nFoo [[[Main Page]]]",
		"html": "<p>[[[Main Page]]]\nFoo [[[Main Page]]]\n</p>",
		"render": "<p>[[[Main Page]]]\nFoo [[[Main Page]]]\n</p>",
		"print": "<span class=\"wpb-root\">[[[Main Page]]]\nFoo [[[Main Page]]]</span>"
	},
	{
		"desc": "Link with 4 brackets",
		"wikitext": "[[[[Main Page]]]]",
		"html": "<p>[[<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>]]\n</p>",
		"render": "<p>[[<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>]]\n</p>",
		"print": "<span class=\"wpb-root\">[[<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>]]</span>"
	},
	{
		"desc": "Piped link with 3 brackets",
		"wikitext": "[[[main page|the main page]]]",
		"html": "<p>[[[main page|the main page]]]\n</p>",
		"render": "<p>[[[main page|the main page]]]\n</p>",
		"print": "<span class=\"wpb-root\">[[[main page|the main page]]]</span>"
	},
	{
		"desc": "Piped link with extlink-like text",
		"wikitext": "[[Main Page|[bar]]]\n[[Main Page|This is a [bar]]]\n[[Main Page|[bar]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">[bar]</a>\n<a href=\"/wiki/Main_Page\" title=\"Main Page\">This is a [bar]</a>\n<a href=\"/wiki/Main_Page\" title=\"Main Page\">[bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">[bar]</a>\n<a href=\"/wiki/Main_Page\" title=\"Main Page\">This is a [bar]</a>\n<a href=\"/wiki/Main_Page\" title=\"Main Page\">[bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">[bar]</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">This is a [bar]</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">[bar</span>]]</span></span>"
	},
	{
		"desc": "Link with multiple pipes",
		"wikitext": "[[Main Page|The|Main|Page]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">The|Main|Page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">The|Main|Page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">The|Main|Page</span>]]</span></span>"
	},
	{
		"desc": "Anchor containing a #. (T65430)",
		"wikitext": "[[Main Page#And#Link]]",
		"html": "<p><a href=\"/wiki/Main_Page#And#Link\" title=\"Main Page\">Main Page#And#Link</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page#And%23Link\" title=\"Main Page\">Main Page#And#Link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page#And#Link</span>]]</span></span>"
	},
	{
		"desc": "Link to namespaces",
		"wikitext": "[[Talk:Parser testing]], [[Meta:Disclaimers]]",
		"html": "<p><a href=\"/wiki/Talk:Parser_testing\" title=\"Talk:Parser testing\">Talk:Parser testing</a>, <a href=\"/wiki/Meta:Disclaimers\" title=\"Meta:Disclaimers\">Meta:Disclaimers</a>\n</p>",
		"render": "<p><a href=\"/wiki/Talk%3AParser_testing\" title=\"Talk:Parser testing\">Talk:Parser testing</a>, <a href=\"/wiki/Meta%3ADisclaimers\" title=\"Meta:Disclaimers\">Meta:Disclaimers</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Talk:Parser testing</span>]]</span>, <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Meta:Disclaimers</span>]]</span></span>"
	},
	{
		"desc": "Link with space in namespace",
		"wikitext": "[[User talk:Foo bar]]",
		"html": "<p><a href=\"/wiki/User_talk:Foo_bar\" title=\"User talk:Foo bar\">User talk:Foo bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/User_talk%3AFoo_bar\" title=\"User talk:Foo bar\">User talk:Foo bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">User talk:Foo bar</span>]]</span></span>"
	},
	{
		"desc": "Namespace takes precedence over interwiki link (T53680)",
		"wikitext": "[[MemoryAlpha:AlphaTest]]",
		"html": "<p><a href=\"/wiki/MemoryAlpha:AlphaTest\" title=\"MemoryAlpha:AlphaTest\">MemoryAlpha:AlphaTest</a>\n</p>",
		"render": "<p><a href=\"/wiki/MemoryAlpha%3AAlphaTest\" title=\"MemoryAlpha:AlphaTest\">MemoryAlpha:AlphaTest</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">MemoryAlpha:AlphaTest</span>]]</span></span>"
	},
	{
		"desc": "Link to namespace preferred over interwiki with correct rel attribute",
		"wikitext": "[[MemoryAlpha:AlphaTest]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">MemoryAlpha:AlphaTest</span>]]</span></span>"
	},
	{
		"desc": "Piped link to namespace",
		"wikitext": "[[Meta:Disclaimers|The disclaimers]]",
		"html": "<p><a href=\"/wiki/Meta:Disclaimers\" title=\"Meta:Disclaimers\">The disclaimers</a>\n</p>",
		"render": "<p><a href=\"/wiki/Meta%3ADisclaimers\" title=\"Meta:Disclaimers\">The disclaimers</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Meta:Disclaimers</span>|<span class=\"wpb-link-text\">The disclaimers</span>]]</span></span>"
	},
	{
		"desc": "Link containing }",
		"wikitext": "[[Usually caused by a typo (oops}]]",
		"html": "<p>[[Usually caused by a typo (oops}]]\n</p>",
		"render": "<p>[[Usually caused by a typo (oops}]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Usually caused by a typo (oops}]]</span>"
	},
	{
		"desc": "Link containing % (not as a hex sequence)",
		"wikitext": "[[7% Solution]]\n[[7% Solution|7%25 Solution]]",
		"html": "<p><a href=\"/wiki/7%25_Solution\" title=\"7% Solution\">7% Solution</a>\n<a href=\"/wiki/7%25_Solution\" title=\"7% Solution\">7%25 Solution</a>\n</p>",
		"render": "<p><a href=\"/wiki/7%25_Solution\" title=\"7% Solution\">7% Solution</a>\n<a href=\"/wiki/7%25_Solution\" title=\"7% Solution\">7%25 Solution</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">7% Solution</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">7% Solution</span>|<span class=\"wpb-link-text\">7%25 Solution</span>]]</span></span>"
	},
	{
		"desc": "Link containing % as a single hex sequence interpreted to char",
		"wikitext": "[[7%25 Solution]]\n[[7%25 Solution|7%25 Solution]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">7%25 Solution</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">7%25 Solution</span>|<span class=\"wpb-link-text\">7%25 Solution</span>]]</span></span>"
	},
	{
		"desc": "Link containing % as a double hex sequence interpreted to hex sequence",
		"wikitext": "[[7%2525 Solution]]",
		"html": "<p>[[7%2525 Solution]]\n</p>",
		"render": "<p>[[7%2525 Solution]]\n</p>",
		"print": "<span class=\"wpb-root\">[[7%2525 Solution]]</span>"
	},
	{
		"desc": "Link containing \"#<\" and \"#>\" % as a hex sequences- these are valid section anchors",
		"wikitext": "[[%23%3c]][[%23%3e]]",
		"html": "<p><a href=\"#&lt;\">#&lt;</a><a href=\"#&gt;\">#&gt;</a>\n</p>",
		"render": "<p><a href=\"#%3C\">#&lt;</a><a href=\"#%3E\">#&gt;</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%23%3c</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%23%3e</span>]]</span></span>"
	},
	{
		"desc": "Link containing \"#<\" and \"#>\" % as a hex sequences- these are valid section anchors (legacy)",
		"wikitext": "[[%23%3c]][[%23%3e]]",
		"html": "<p><a href=\"#.3C\">#&lt;</a><a href=\"#.3E\">#&gt;</a>\n</p>",
		"render": "<p><a href=\"#%3C\">#&lt;</a><a href=\"#%3E\">#&gt;</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%23%3c</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%23%3e</span>]]</span></span>"
	},
	{
		"desc": "Link containing \"<#\" and \">#\" as a hex sequences",
		"wikitext": "[[%3c%23]][[%3e%23]]",
		"html": "<p>[[%3c%23]][[%3e%23]]\n</p>",
		"render": "<p>[[%3c%23]][[%3e%23]]\n</p>",
		"print": "<span class=\"wpb-root\">[[%3c%23]][[%3e%23]]</span>"
	},
	{
		"desc": "Link containing an equals sign",
		"wikitext": "[[Special:BookSources/isbn=4-00-026157-6]]",
		"html": "<p><a href=\"/wiki/Special:BookSources/isbn%3D4-00-026157-6\" title=\"Special:BookSources/isbn=4-00-026157-6\">Special:BookSources/isbn=4-00-026157-6</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2Fisbn%3D4-00-026157-6\" title=\"Special:BookSources/isbn=4-00-026157-6\">Special:BookSources/isbn=4-00-026157-6</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Special:BookSources/isbn=4-00-026157-6</span>]]</span></span>"
	},
	{
		"desc": "Link containing an ampersand",
		"wikitext": "[[Foo & bar]]\n\n[[Foo &amp; bar]]\n\n[[Foo &amp;amp; bar]]",
		"html": "<p><a href=\"/wiki/Foo_%26_bar\" title=\"Foo &amp; bar\">Foo &amp; bar</a>\n</p><p><a href=\"/wiki/Foo_%26_bar\" title=\"Foo &amp; bar\">Foo &amp; bar</a>\n</p><p>[[Foo &amp;amp; bar]]\n</p>",
		"render": "<p><a href=\"/wiki/Foo_%26_bar\" title=\"Foo & bar\">Foo & bar</a>\n</p><p><a href=\"/wiki/Foo_%26_bar\" title=\"Foo & bar\">Foo &amp; bar</a>\n</p><p>[[Foo &amp;amp; bar]]\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo &amp; bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo &amp;amp; bar</span>]]</span>\n\n[[Foo &amp;amp;amp; bar]]</span>"
	},
	{
		"desc": "Link containing a tilde",
		"wikitext": "[[Foo~bar]]",
		"html": "<p><a href=\"/wiki/Foo~bar\" title=\"Foo~bar\">Foo~bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo~bar\" title=\"Foo~bar\">Foo~bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo~bar</span>]]</span></span>"
	},
	{
		"desc": "Link containing double-single-quotes '' (T6598)",
		"wikitext": "[[Lista d''e paise d''o munno]]",
		"html": "<p><a href=\"/wiki/Lista_d%27%27e_paise_d%27%27o_munno\" title=\"Lista d&#39;&#39;e paise d&#39;&#39;o munno\">Lista d''e paise d''o munno</a>\n</p>",
		"render": "<p><a href=\"/wiki/Lista_d''e_paise_d''o_munno\" title=\"Lista d''e paise d''o munno\">Lista d''e paise d''o munno</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Lista d''e paise d''o munno</span>]]</span></span>"
	},
	{
		"desc": "Link containing double quotes and spaces",
		"wikitext": "[[Cool \"Gator\"]]",
		"html": "<p><a href=\"/wiki/Cool_%22Gator%22\" title=\"Cool &quot;Gator&quot;\">Cool \"Gator\"</a>\n</p>",
		"render": "<p><a href=\"/wiki/Cool_%22Gator%22\" title=\"Cool &quot;Gator&quot;\">Cool \"Gator\"</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Cool \"Gator\"</span>]]</span></span>"
	},
	{
		"desc": "Link containing double-single-quotes '' in text (T6598 check)",
		"wikitext": "Some [[Link|pretty ''italics'' and stuff]]!",
		"html": "<p>Some <a href=\"/wiki/Link\" title=\"Link\">pretty <i>italics</i> and stuff</a>!\n</p>",
		"render": "<p>Some <a href=\"/wiki/Link\" title=\"Link\">pretty <i>italics</i> and stuff</a>!\n</p>",
		"print": "<span class=\"wpb-root\">Some <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Link</span>|<span class=\"wpb-link-text\">pretty <span class=\"wpb-quote\">''</span>italics<span class=\"wpb-quote\">''</span> and stuff</span>]]</span>!</span>"
	},
	{
		"desc": "Link containing double-single-quotes '' in text embedded in italics (T6598 check)",
		"wikitext": "''Some [[Link|pretty ''italics'' and stuff]]!''",
		"html": "<p><i>Some <a href=\"/wiki/Link\" title=\"Link\">pretty <i>italics</i> and stuff</a>!</i>\n</p>",
		"render": "<p><i>Some </i><i><a href=\"/wiki/Link\" title=\"Link\">pretty <i>italics</i> and stuff</a></i><i>!</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>Some <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Link</span>|<span class=\"wpb-link-text\">pretty <span class=\"wpb-quote\">''</span>italics<span class=\"wpb-quote\">''</span> and stuff</span>]]</span>!<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Link with double quotes in title part (literal) and alternate part (interpreted)",
		"wikitext": "[[File:Denys_Savchenko_''Pentecoste''.jpg]]\n\n[[''Pentecoste'']]\n\n[[''Pentecoste''|Pentecoste]]\n\n[[''Pentecoste''|''Pentecoste'']]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Denys_Savchenko_%27%27Pentecoste%27%27.jpg\" class=\"new\" title=\"File:Denys Savchenko &#39;&#39;Pentecoste&#39;&#39;.jpg\"><span class=\"mw-file-element mw-broken-media\">File:Denys Savchenko <i>Pentecoste</i>.jpg</span></a></span>\n</p><p><a href=\"/wiki/%27%27Pentecoste%27%27\" title=\"&#39;&#39;Pentecoste&#39;&#39;\">''Pentecoste''</a>\n</p><p><a href=\"/wiki/%27%27Pentecoste%27%27\" title=\"&#39;&#39;Pentecoste&#39;&#39;\">Pentecoste</a>\n</p><p><a href=\"/wiki/%27%27Pentecoste%27%27\" title=\"&#39;&#39;Pentecoste&#39;&#39;\"><i>Pentecoste</i></a>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ADenys_Savchenko_''Pentecoste''.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ADenys_Savchenko_''Pentecoste''.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><a href=\"/wiki/''Pentecoste''\" title=\"''Pentecoste''\">''Pentecoste''</a>\n</p><p><a href=\"/wiki/''Pentecoste''\" title=\"''Pentecoste''\">Pentecoste</a>\n</p><p><a href=\"/wiki/''Pentecoste''\" title=\"''Pentecoste''\"><i>Pentecoste</i></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Denys_Savchenko_''Pentecoste''.jpg</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">''Pentecoste''</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">''Pentecoste''</span>|<span class=\"wpb-link-text\">Pentecoste</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">''Pentecoste''</span>|<span class=\"wpb-link-text\"><span class=\"wpb-quote\">''</span>Pentecoste<span class=\"wpb-quote\">''</span></span>]]</span></span>"
	},
	{
		"desc": "Plain link to URL",
		"wikitext": "[[http://www.example.com]]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external autonumber\" href=\"http://www.example.com\">[1]</a>]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">[1]</a>]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span>]</span>]</span>"
	},
	{
		"desc": "Plain link to URL with link text",
		"wikitext": "[[http://www.example.com Link text]]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">Link text</a>]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">Link text</a>]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">Link text</span>]</span>]</span>"
	},
	{
		"desc": "Plain link to URL containing special characters, with link text (see T213950).",
		"wikitext": "[[http://www.example.com/?q=%7Babc%7D Link text]]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/?q=%7Babc%7D\">Link text</a>]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?q=%7Babc%7D\">Link text</a>]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?q=%7Babc%7D</span> <span class=\"wpb-ext-link-text\">Link text</span>]</span>]</span>"
	},
	{
		"desc": "Plain link to protocol-relative URL",
		"wikitext": "[[//www.example.com]]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external autonumber\" href=\"//www.example.com\">[1]</a>]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external\" href=\"https://www.example.com/\">[1]</a>]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//www.example.com</span>]</span>]</span>"
	},
	{
		"desc": "Plain link to protocol-relative URL with link text",
		"wikitext": "[[//www.example.com Link text]]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external text\" href=\"//www.example.com\">Link text</a>]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external\" href=\"https://www.example.com/\">Link text</a>]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//www.example.com</span> <span class=\"wpb-ext-link-text\">Link text</span>]</span>]</span>"
	},
	{
		"desc": "Plain link to page with question mark in title",
		"wikitext": "[[A?b]]\n\n[[A?b|Baz]]",
		"html": "<p><a href=\"/wiki/A%3Fb\" title=\"A?b\">A?b</a>\n</p><p><a href=\"/wiki/A%3Fb\" title=\"A?b\">Baz</a>\n</p>",
		"render": "<p><a href=\"/wiki/A%3Fb\" title=\"A?b\">A?b</a>\n</p><p><a href=\"/wiki/A%3Fb\" title=\"A?b\">Baz</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">A?b</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">A?b</span>|<span class=\"wpb-link-text\">Baz</span>]]</span></span>"
	},
	{
		"desc": "Piped link to URL",
		"wikitext": "Piped link to URL: [[http://www.example.com|an example URL]]",
		"html": "<p>Piped link to URL: [<a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com%7Can\">example URL</a>]\n</p>",
		"render": "<p>Piped link to URL: [<a rel=\"nofollow\" class=\"external\">example URL</a>]\n</p>",
		"print": "<span class=\"wpb-root\">Piped link to URL: [<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com|an</span> <span class=\"wpb-ext-link-text\">example URL</span>]</span>]</span>"
	},
	{
		"desc": "Nested wikilink syntax in wikilink syntax that parses as wikilink in extlink",
		"wikitext": "[[http://example.com|[[Example]]]]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external text\" href=\"http://example.com%7C\"></a><a href=\"/wiki/Example\" title=\"Example\">Example</a>]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external\"></a><a href=\"/wiki/Example\" title=\"Example\">Example</a>]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com|</span><span class=\"wpb-ext-link-text\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Example</span>]]</span></span>]</span>]</span>"
	},
	{
		"desc": "Plain link in template argument",
		"wikitext": "{{1x|[http://www.example.com |123]}}\n\n{{1x|[[http://www.example.com |123]]}}\n\n{{1x|[[http://www.example.com |123]}}\n\n{{1x|[http://www.example.com |123]]}}",
		"html": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com\">http://www.example.com</a> \n</p><p>[<a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">|123</a>]\n</p><p>{{1x|[<a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">|123</a>}}\n</p><p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com\">http://www.example.com</a> \n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com</a> \n</p><p>[<a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">|123</a>]\n</p><p>{{1x|[<a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">|123</a>}}\n</p><p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com</a> \n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[<span class=\"wpb-free-ext-link\">http://www.example.com</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">123]</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">|123</span>]</span>]</span></span>}}</span>\n\n{{1x|[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">|123</span>]</span>}}\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[<span class=\"wpb-free-ext-link\">http://www.example.com</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">123]]</span></span>}}</span></span>"
	},
	{
		"desc": "T2002: [[page|http://url/]] should link to page, not http://url/",
		"wikitext": "[[Main Page|http://url/]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">http://url/</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">http://url/</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">http://url/</span>]]</span></span>"
	},
	{
		"desc": "T2337: Escaped self-links should be bold",
		"wikitext": "[[Bu&#103;462]] [[Bug462]]",
		"html": "<p><a class=\"mw-selflink selflink\">Bu&#103;462</a> <a class=\"mw-selflink selflink\">Bug462</a>\n</p>",
		"render": "<p><a href=\"/wiki/Bug462\" title=\"Bug462\">Bu&#103;462</a> <a href=\"/wiki/Bug462\" title=\"Bug462\">Bug462</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Bu&amp;#103;462</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Bug462</span>]]</span></span>"
	},
	{
		"desc": "Self-link to section should not be bold",
		"wikitext": "[[Main Page#section]]",
		"html": "<p><a class=\"mw-selflink-fragment\" href=\"#section\">Main Page#section</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page#section\" title=\"Main Page\">Main Page#section</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page#section</span>]]</span></span>"
	},
	{
		"desc": "Self-link hash fragment should be escaped",
		"wikitext": "[[Main Page#section with spaces]]",
		"html": "<p><a class=\"mw-selflink-fragment\" href=\"#section_with_spaces\">Main Page#section with spaces</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page#section_with_spaces\" title=\"Main Page\">Main Page#section with spaces</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page#section with spaces</span>]]</span></span>"
	},
	{
		"desc": "Self-link to numeric title",
		"wikitext": "[[0]]",
		"html": "<p><a class=\"mw-selflink selflink\">0</a>\n</p>",
		"render": "<p><a href=\"/wiki/0\" title=\"0\">0</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">0</span>]]</span></span>"
	},
	{
		"desc": "Link to numeric-equivalent title",
		"wikitext": "[[00]]",
		"html": "<p><a href=\"/wiki/00\" title=\"00\">00</a>\n</p>",
		"render": "<p><a href=\"/wiki/00\" title=\"00\">00</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">00</span>]]</span></span>"
	},
	{
		"desc": "<nowiki> inside a link",
		"wikitext": "[[Main<nowiki> Page</nowiki>]] [[Main Page|the main page <nowiki>[it's not very good]</nowiki>]]",
		"html": "<p>[[Main Page]] <a href=\"/wiki/Main_Page\" title=\"Main Page\">the main page [it's not very good]</a>\n</p>",
		"render": "<p>[[Main Page]] <a href=\"/wiki/Main_Page\" title=\"Main Page\">the main page [it's not very good]</a>\n</p>",
		"print": "<span class=\"wpb-root\">[[Main<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\"> Page</span>&lt;/nowiki&gt;</span>]] <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">the main page <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[it's not very good]</span>&lt;/nowiki&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "<pre> inside a link",
		"wikitext": "[[Main<pre> Page</pre>]] [[Main Page|the main page <pre>[it's not very good]</pre>]]",
		"html": "<p>[[Main</p><pre> Page</pre><p>]] <a href=\"/wiki/Main_Page\" title=\"Main Page\">the main page </a></p><a href=\"/wiki/Main_Page\" title=\"Main Page\"><pre>[it's not very good]</pre></a>",
		"render": "[[Main<pre > Page</pre>]] <a href=\"/wiki/Main_Page\" title=\"Main Page\">the main page <pre >[it's not very good]</pre></a>",
		"print": "<span class=\"wpb-root\">[[Main<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\"> Page</span>&lt;/pre&gt;</span>]] <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">the main page <span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">[it's not very good]</span>&lt;/pre&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "Non-breaking spaces in title",
		"wikitext": "[[&nbsp; Main &nbsp; Page &nbsp;]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">&#160; Main &#160; Page &#160;</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">&nbsp; Main &nbsp; Page &nbsp;</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">&amp;nbsp; Main &amp;nbsp; Page &amp;nbsp;</span>]]</span></span>"
	},
	{
		"desc": "Multiple spaces in titles should normalize to a single underscore",
		"wikitext": "[[Foo bar baz|x]]\n[[Foo  bar baz|x]]\n[[Foo  bar   baz|x]]",
		"html": "<p><a href=\"/wiki/Foo_bar_baz\" title=\"Foo bar baz\">x</a>\n<a href=\"/wiki/Foo_bar_baz\" title=\"Foo bar baz\">x</a>\n<a href=\"/wiki/Foo_bar_baz\" title=\"Foo bar baz\">x</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo_bar_baz\" title=\"Foo bar baz\">x</a>\n<a href=\"/wiki/Foo_bar_baz\" title=\"Foo bar baz\">x</a>\n<a href=\"/wiki/Foo_bar_baz\" title=\"Foo bar baz\">x</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo bar baz</span>|<span class=\"wpb-link-text\">x</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo  bar baz</span>|<span class=\"wpb-link-text\">x</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo  bar   baz</span>|<span class=\"wpb-link-text\">x</span>]]</span></span>"
	},
	{
		"desc": "Internal link with en linktrail: no apostrophes (T29473)",
		"wikitext": "[[Something]]'nice",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Something</span>]]</span>'nice</span>"
	},
	{
		"desc": "Link with multiple \":\" in a subpage-supporting namespace (T65636)",
		"wikitext": "[[User:Foo/Test/63636:Bar|Test]]",
		"html": "<p><a href=\"/wiki/User:Foo/Test/63636:Bar\" title=\"User:Foo/Test/63636:Bar\">Test</a>\n</p>",
		"render": "<p><a href=\"/wiki/User%3AFoo%2FTest%2F63636%3ABar\" title=\"User:Foo/Test/63636:Bar\">Test</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">User:Foo/Test/63636:Bar</span>|<span class=\"wpb-link-text\">Test</span>]]</span></span>"
	},
	{
		"desc": "Handle title parsing for subpages",
		"wikitext": "123",
		"html": "<p>123\n</p>",
		"render": "<p>123\n</p>",
		"print": "<span class=\"wpb-root\">123</span>"
	},
	{
		"desc": "Link to a subpage from a namespace other than main",
		"wikitext": "[[/123]]",
		"html": "<p><a href=\"/wiki/User:Test/123\" title=\"User:Test/123\">/123</a>\n</p>",
		"render": "<p><a href=\"/wiki/%2F123\" title=\"/123\">/123</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/123</span>]]</span></span>"
	},
	{
		"desc": "Ensure that transclusion titles are not url-decoded",
		"wikitext": "{{Bar%C3%A9}} {{/Bar%C3%A9}}",
		"html": "<p>{{Bar%C3%A9}} {{/Bar%C3%A9}}\n</p>",
		"render": "<p>{{Bar%C3%A9}} {{/Bar%C3%A9}}\n</p>",
		"print": "<span class=\"wpb-root\">{{Bar%C3%A9}} {{/Bar%C3%A9}}</span>"
	},
	{
		"desc": "Purely hash wikilink",
		"wikitext": "[[#a|b]]",
		"html": "<p><a href=\"#a\">b</a>\n</p>",
		"render": "<p><a href=\"#a\">b</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#a</span>|<span class=\"wpb-link-text\">b</span>]]</span></span>"
	},
	{
		"desc": "Serialization of purely hash wikilink",
		"wikitext": "[[#a|<nowiki>[[</nowiki>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#a</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[</span>&lt;/nowiki&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "1. Interaction of linktrail and template encapsulation",
		"wikitext": "{{1x|[[Foo]]}}l\n\n{{1x|[[Foo]]l}}\n\n{{1x|[[Foo]]l}}s\n\n{{1x|[[Foo]]<span>ls</span>}}\n\n[[{{1x|Foo}}]]l",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">Fool</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Fool</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Fools</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a><span>ls</span>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Fool</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>l\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>l\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>ls\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a><span >ls</span>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>l\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span></span>}}</span>l\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>l</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>l</span></span>}}</span>s\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span><span class=\"wpb-html\">&lt;span&gt;</span>ls<span class=\"wpb-html\">&lt;/span&gt;</span></span></span>}}</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>]]</span>l</span>"
	},
	{
		"desc": "2. Interaction of linktrail and template encapsulation",
		"wikitext": "{{1x|Some [[Fool]]}}s",
		"html": "<p>Some <a href=\"/wiki/Fool\" title=\"Fool\">Fools</a>\n</p>",
		"render": "<p>Some <a href=\"/wiki/Fool\" title=\"Fool\">Fool</a>s\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Some <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Fool</span>]]</span></span></span>}}</span>s</span>"
	},
	{
		"desc": "3. Interaction of linktrail and template encapsulation",
		"wikitext": "{{1x|Some [[Fool]]s are '''bold and foolish'''}}",
		"html": "<p>Some <a href=\"/wiki/Fool\" title=\"Fool\">Fools</a> are <b>bold and foolish</b>\n</p>",
		"render": "<p>Some <a href=\"/wiki/Fool\" title=\"Fool\">Fool</a>s are <b>bold and foolish</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Some <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Fool</span>]]</span>s are <span class=\"wpb-quote\">'''</span>bold and foolish<span class=\"wpb-quote\">'''</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid link trail escaping",
		"wikitext": "[[apple]]<nowiki/>s",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">apple</span>]]</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>s</span>"
	},
	{
		"desc": "Parsoid link bracket escaping",
		"wikitext": "[[Test]]\n\n[<nowiki/>[[Test]]]\n\n[[[[Test]]]]\n\n[[[<nowiki/>[[Test]]]]]\n\n[[[[[[Test]]]]]]\n\n[[[[[<nowiki/>[[Test]]]]]]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>\n\n[<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>]\n\n[[<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>]]\n\n[[[<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>]]]\n\n[[[[<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>]]]]\n\n[[[[[<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>]]]]]</span>"
	},
	{
		"desc": "Parsoid-centric test: Whitespace in ext- and wiki-links should be preserved",
		"wikitext": "[[Foo|  bar]]\n\n[[Foo|  ''bar'']]\n\n[http://wp.org   foo]\n\n[http://wp.org   ''foo'']",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">  bar</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">  <i>bar</i></a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"http://wp.org\">foo</a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"http://wp.org\"><i>foo</i></a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">  bar</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">  <i>bar</i></a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"http://wp.org/\">foo</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"http://wp.org/\"><i>foo</i></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">  bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">  <span class=\"wpb-quote\">''</span>bar<span class=\"wpb-quote\">''</span></span>]]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://wp.org</span>   <span class=\"wpb-ext-link-text\">foo</span>]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://wp.org</span>   <span class=\"wpb-ext-link-text\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span></span>]</span></span>"
	},
	{
		"desc": "Parsoid: Scoped parsing should handle mixed transclusions and plain text",
		"wikitext": "[[Foo|{{1x|a}} b {{1x|c}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>}}</span> b <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">c</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Link with angle bracket after anchor",
		"wikitext": "[[Foo#<bar>]]",
		"html": "<p><a href=\"/wiki/Foo#&lt;bar&gt;\" title=\"Foo\">Foo#&lt;bar&gt;</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo#%3Cbar%3E\" title=\"Foo\">Foo#&lt;bar&gt;</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo#&lt;bar&gt;</span>]]</span></span>"
	},
	{
		"desc": "Link with angle bracket after anchor (legacy)",
		"wikitext": "[[Foo#<bar>]]",
		"html": "<p><a href=\"/wiki/Foo#.3Cbar.3E\" title=\"Foo\">Foo#&lt;bar&gt;</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo#%3Cbar%3E\" title=\"Foo\">Foo#&lt;bar&gt;</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo#&lt;bar&gt;</span>]]</span></span>"
	},
	{
		"desc": "Wikilink in wikilink",
		"wikitext": "[[Hi|[[Ho]]]]",
		"html": "<p>[[Hi|<a href=\"/wiki/Ho\" title=\"Ho\">Ho</a>]]\n</p>",
		"render": "<p>[[Hi|<a href=\"/wiki/Ho\" title=\"Ho\">Ho</a>]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Hi|<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Ho</span>]]</span>]]</span>"
	},
	{
		"desc": "Parsoid T55221: Wikilinks should be properly entity-escaped",
		"wikitext": "He&amp;nbsp;llo [[Foo|He&amp;nbsp;llo]]\n\nHe&amp;nbsp;llo He&amp;nbsp;llo",
		"print": "<span class=\"wpb-root\">He&amp;amp;nbsp;llo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">He&amp;amp;nbsp;llo</span>]]</span>\n\nHe&amp;amp;nbsp;llo He&amp;amp;nbsp;llo</span>"
	},
	{
		"desc": "Wikilinks with : should roundtrip correctly, with and without redlinks",
		"wikitext": "[[16:30]]\n[[18:30]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">16:30</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">18:30</span>]]</span></span>"
	},
	{
		"desc": "Parsoid: handle constructor well",
		"wikitext": "[[constructor]]\n\n[[constructor:foo]]",
		"html": "<p><a href=\"/index.php?title=Constructor&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Constructor (page does not exist)\">constructor</a>\n</p><p><a href=\"/index.php?title=Constructor:foo&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Constructor:foo (page does not exist)\">constructor:foo</a>\n</p>",
		"render": "<p><a href=\"/wiki/Constructor\" title=\"Constructor\">constructor</a>\n</p><p><a href=\"/wiki/Constructor%3Afoo\" title=\"Constructor:foo\">constructor:foo</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">constructor</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">constructor:foo</span>]]</span></span>"
	},
	{
		"desc": "Template parameter named \"constructor\"",
		"wikitext": "{{1x|  constructor =  |hi}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">  constructor </span>=<span class=\"wpb-parameter-value\">  </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span></span>"
	},
	{
		"desc": "<br> to <br />",
		"wikitext": "1<br>2<br />3",
		"html": "<p>1<br />2<br />3\n</p>",
		"render": "<p>1<br >2<br >3\n</p>",
		"print": "<span class=\"wpb-root\">1<span class=\"wpb-html\">&lt;br&gt;</span>2<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>3</span>"
	},
	{
		"desc": "Broken br tag sanitization",
		"wikitext": "</br>",
		"html": "<p><br />\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;/br&gt;</span></span>"
	},
	{
		"desc": "Parsoid: Broken br tag recognition",
		"wikitext": "</br>\n\n<br/ >",
		"html": "<p><br />\n</p><p><br />\n</p>",
		"render": "<p><br>\n</p><p><br >\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;/br&gt;</span>\n\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"><span class=\"wpb-attr-dirty\">/ </span></span>&gt;</span></span>"
	},
	{
		"desc": "Incorrecly removing closing slashes from correctly formed XHTML",
		"wikitext": "<br style=\"clear:both;\" />",
		"html": "<p><br style=\"clear:both;\" />\n</p>",
		"render": "<p><br style=\"clear:both;\">\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">clear:both;</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Failing to transform badly formed HTML into correct XHTML",
		"wikitext": "<br style=\"clear: left;\">\n<br style=\"clear: right;\">\n<br style=\"clear: both;\">",
		"html": "<p><br style=\"clear: left;\" />\n<br style=\"clear: right;\" />\n<br style=\"clear: both;\" />\n</p>",
		"render": "<p><br style=\"clear: left;\">\n<br style=\"clear: right;\">\n<br style=\"clear: both;\">\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">clear: left;</span>\"</span></span>&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">clear: right;</span>\"</span></span>&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">clear: both;</span>\"</span></span>&gt;</span></span>"
	},
	{
		"desc": "Handling html with a div self-closing tag",
		"wikitext": "<div title />\n<div title/>\n<div title/ >\n<div title=bar />\n<div title=bar/>\n<div title=bar/ >",
		"html": "<div title=\"\">\n<div title=\"\">\n<div title=\"\">\n<div title=\"bar\">\n<div title=\"bar\">\n<div title=\"bar/\"></div></div></div></div></div></div>",
		"render": "<div title=\"\">\n<div title=\"\">\n<div title=\"\">\n<div title=\"bar\">\n<div title=\"bar\">\n<div title=\"bar/\">",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span></span> </span>/&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span></span></span>/&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span></span><span class=\"wpb-attr-dirty\">/ </span></span>&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=<span class=\"wpb-attr-value\">bar</span></span> </span>/&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=<span class=\"wpb-attr-value\">bar</span></span></span>/&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=<span class=\"wpb-attr-value\">bar/</span></span> </span>&gt;</span></span>"
	},
	{
		"desc": "Elements with solidus in various attribute positions",
		"wikitext": "<div cla/ss=\"123\">ha</div>\n\n<div / class=\"123\">ha</div>\n\n<div class= / \"123\">ha</div>",
		"html": "<div>ha</div>\n<div class=\"123\">ha</div>\n<div class=\"/\">ha</div>",
		"render": "<div  >ha</div>\n<div class=\"123\">ha</div>\n<div class=\"/\">ha</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">cla</span></span><span class=\"wpb-attr-dirty\">/</span><span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">ss</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span></span>&gt;</span>ha<span class=\"wpb-html\">&lt;/div&gt;</span>\n\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"><span class=\"wpb-attr-dirty\"> / </span><span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span></span>&gt;</span>ha<span class=\"wpb-html\">&lt;/div&gt;</span>\n\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>= <span class=\"wpb-attr-value\">/</span></span><span class=\"wpb-attr-dirty\"> \"123\"</span></span>&gt;</span>ha<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Handling html with a br self-closing tag",
		"wikitext": "<br title />\n<br title/>\n<br title/ >\n<br title=bar />\n<br title=bar/>\n<br title=bar/ >",
		"html": "<p><br title=\"\" />\n<br title=\"\" />\n<br title=\"\" />\n<br title=\"bar\" />\n<br title=\"bar\" />\n<br title=\"bar/\" />\n</p>",
		"render": "<p><br title=\"\">\n<br title=\"\">\n<br title=\"\">\n<br title=\"bar\">\n<br title=\"bar\">\n<br title=\"bar/\">\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span></span> </span>/&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span></span></span>/&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span></span><span class=\"wpb-attr-dirty\">/ </span></span>&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=<span class=\"wpb-attr-value\">bar</span></span> </span>/&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=<span class=\"wpb-attr-value\">bar</span></span></span>/&gt;</span>\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=<span class=\"wpb-attr-value\">bar/</span></span> </span>&gt;</span></span>"
	},
	{
		"desc": "Quoted attributes without spaces",
		"wikitext": "<div class=\"foo\"style=\"color:red\">red</div>",
		"html": "<div class=\"foo\" style=\"color:red\">red</div>",
		"render": "<div class=\"foo\" style=\"color:red\">red</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span><span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red</span>\"</span></span>&gt;</span>red<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Horizontal ruler (should it add that extra space?)",
		"wikitext": "<hr>\n<hr >\nfoo <hr\n> bar",
		"html": "<hr />\n<hr /><p>\nfoo </p><hr /><p> bar</p>",
		"render": "<hr >\n<hr >\nfoo <hr > bar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;hr&gt;</span>\n<span class=\"wpb-html\">&lt;hr<span class=\"wpb-html-attrs\"> </span>&gt;</span>\nfoo <span class=\"wpb-html\">&lt;hr<span class=\"wpb-html-attrs\">\n</span>&gt;</span> bar</span>"
	},
	{
		"desc": "Horizontal ruler -- 4+ dashes render hr",
		"wikitext": "----",
		"html": "<hr />",
		"render": "<hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span></span>"
	},
	{
		"desc": "Horizontal ruler -- eats additional dashes on the same line",
		"wikitext": "---------",
		"html": "<hr />",
		"render": "<hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">---------</span></span>"
	},
	{
		"desc": "Horizontal ruler -- does not collapse dashes on consecutive lines",
		"wikitext": "----\n----",
		"html": "<hr />\n<hr />",
		"render": "<hr>\n<hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span>\n<span class=\"wpb-hr\">----</span></span>"
	},
	{
		"desc": "Horizontal ruler -- <4 dashes render as plain text",
		"wikitext": "---",
		"html": "<p>---\n</p>",
		"render": "<p>---\n</p>",
		"print": "<span class=\"wpb-root\">---</span>"
	},
	{
		"desc": "Horizontal ruler -- Supports content following dashes on same line",
		"wikitext": "---- Foo",
		"html": "<hr /><p> Foo</p>",
		"render": "<hr> Foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span> Foo</span>"
	},
	{
		"desc": "Common list",
		"wikitext": "*Common list\n*item 2\n*item 3",
		"html": "<ul><li>Common list</li>\n<li>item 2</li>\n<li>item 3</li></ul>",
		"render": "<ul><li>Common list</li>\n<li>item 2</li>\n<li>item 3</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>Common list\n<span class=\"wpb-list\">*</span>item 2\n<span class=\"wpb-list\">*</span>item 3</span>"
	},
	{
		"desc": "Numbered list",
		"wikitext": "#Numbered list\n#item 2\n#item 3",
		"html": "<ol><li>Numbered list</li>\n<li>item 2</li>\n<li>item 3</li></ol>",
		"render": "<ol><li>Numbered list</li>\n<li>item 2</li>\n<li>item 3</li></ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#</span>Numbered list\n<span class=\"wpb-list\">#</span>item 2\n<span class=\"wpb-list\">#</span>item 3</span>"
	},
	{
		"desc": "Mixed list",
		"wikitext": "*Mixed list\n*#with numbers\n**and bullets\n*#and numbers\n*bullets again\n**bullet level 2\n***bullet level 3\n***#Number on level 4\n**bullet level 2\n**#Number on level 3\n**#Number on level 3\n*#number level 2\n*Level 1\n***Level 3\n#**Level 3, but ordered",
		"html": "<ul><li>Mixed list\n<ol><li>with numbers</li></ol>\n<ul><li>and bullets</li></ul>\n<ol><li>and numbers</li></ol></li>\n<li>bullets again\n<ul><li>bullet level 2\n<ul><li>bullet level 3\n<ol><li>Number on level 4</li></ol></li></ul></li>\n<li>bullet level 2\n<ol><li>Number on level 3</li>\n<li>Number on level 3</li></ol></li></ul>\n<ol><li>number level 2</li></ol></li>\n<li>Level 1\n<ul><li><ul><li>Level 3</li></ul></li></ul></li></ul>\n<ol><li><ul><li><ul><li>Level 3, but ordered</li></ul></li></ul></li></ol>",
		"render": "<ul><li>Mixed list\n<ol><li>with numbers</li></ol>\n<ul><li>and bullets</li></ul>\n<ol><li>and numbers</li></ol></li>\n<li>bullets again\n<ul><li>bullet level 2\n<ul><li>bullet level 3\n<ol><li>Number on level 4</li></ol></li></ul></li>\n<li>bullet level 2\n<ol><li>Number on level 3</li>\n<li>Number on level 3</li></ol></li></ul>\n<ol><li>number level 2</li></ol></li>\n<li>Level 1\n<ul><li><ul><li>Level 3</li></ul></li></ul></li></ul>\n<ol><li><ul><li><ul><li>Level 3, but ordered</li></ul></li></ul></li></ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>Mixed list\n<span class=\"wpb-list\">*#</span>with numbers\n<span class=\"wpb-list\">**</span>and bullets\n<span class=\"wpb-list\">*#</span>and numbers\n<span class=\"wpb-list\">*</span>bullets again\n<span class=\"wpb-list\">**</span>bullet level 2\n<span class=\"wpb-list\">***</span>bullet level 3\n<span class=\"wpb-list\">***#</span>Number on level 4\n<span class=\"wpb-list\">**</span>bullet level 2\n<span class=\"wpb-list\">**#</span>Number on level 3\n<span class=\"wpb-list\">**#</span>Number on level 3\n<span class=\"wpb-list\">*#</span>number level 2\n<span class=\"wpb-list\">*</span>Level 1\n<span class=\"wpb-list\">***</span>Level 3\n<span class=\"wpb-list\">#**</span>Level 3, but ordered</span>"
	},
	{
		"desc": "1. Nested mixed wikitext and html list",
		"wikitext": "*hi\n*<ul><li>ho</li></ul>\n*hi\n**ho",
		"html": "<ul><li>hi</li>\n<li><ul><li>ho</li></ul></li>\n<li>hi\n<ul><li>ho</li></ul></li></ul>",
		"render": "<ul><li>hi</li>\n<li><ul ><li >ho</li></ul></li>\n<li>hi\n<ul><li>ho</li></ul></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>hi\n<span class=\"wpb-list\">*</span><span class=\"wpb-html\">&lt;ul&gt;</span><span class=\"wpb-html\">&lt;li&gt;</span>ho<span class=\"wpb-html\">&lt;/li&gt;</span><span class=\"wpb-html\">&lt;/ul&gt;</span>\n<span class=\"wpb-list\">*</span>hi\n<span class=\"wpb-list\">**</span>ho</span>"
	},
	{
		"desc": "2. Nested mixed wikitext and html list (incompatible)",
		"wikitext": ";hi\n:{{1x|<li>ho</li>}}",
		"html": "<dl><dt>hi</dt>\n<dd><li>ho</li></dd></dl>",
		"render": "<dl><dt>hi</dt>\n<dd><li >ho</li></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>hi\n<span class=\"wpb-list\">:</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;li&gt;</span>ho<span class=\"wpb-html\">&lt;/li&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Nested lists 1",
		"wikitext": "*foo\n**bar",
		"html": "<ul><li>foo\n<ul><li>bar</li></ul></li></ul>",
		"render": "<ul><li>foo\n<ul><li>bar</li></ul></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">**</span>bar</span>"
	},
	{
		"desc": "Nested lists 2",
		"wikitext": "**foo\n*bar",
		"html": "<ul><li><ul><li>foo</li></ul></li>\n<li>bar</li></ul>",
		"render": "<ul><li><ul><li>foo</li></ul></li>\n<li>bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">**</span>foo\n<span class=\"wpb-list\">*</span>bar</span>"
	},
	{
		"desc": "Nested lists 3 (first element empty)",
		"wikitext": "*\n**bar",
		"html": "<ul><li>\n<ul><li>bar</li></ul></li></ul>",
		"render": "<ul><li>\n<ul><li>bar</li></ul></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>\n<span class=\"wpb-list\">**</span>bar</span>"
	},
	{
		"desc": "Nested lists 4 (first element empty)",
		"wikitext": "**\n*bar",
		"html": "<ul><li><ul><li class=\"mw-empty-elt\"></li></ul></li>\n<li>bar</li></ul>",
		"render": "<ul><li><ul><li></li></ul></li>\n<li>bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">**</span>\n<span class=\"wpb-list\">*</span>bar</span>"
	},
	{
		"desc": "Nested lists 5 (both elements empty)",
		"wikitext": "**\n*",
		"html": "<ul><li><ul><li class=\"mw-empty-elt\"></li></ul></li>\n<li class=\"mw-empty-elt\"></li></ul>",
		"render": "<ul><li><ul><li></li></ul></li>\n<li></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">**</span>\n<span class=\"wpb-list\">*</span></span>"
	},
	{
		"desc": "Nested lists 6 (both elements empty)",
		"wikitext": "*\n**",
		"html": "<ul><li>\n<ul><li class=\"mw-empty-elt\"></li></ul></li></ul>",
		"render": "<ul><li>\n<ul><li></li></ul></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>\n<span class=\"wpb-list\">**</span></span>"
	},
	{
		"desc": "Nested lists 7 (skip initial nesting levels)",
		"wikitext": "***foo",
		"html": "<ul><li><ul><li><ul><li>foo</li></ul></li></ul></li></ul>",
		"render": "<ul><li><ul><li><ul><li>foo</li></ul></li></ul></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">***</span>foo</span>"
	},
	{
		"desc": "Nested lists 8 (multiple nesting transitions)",
		"wikitext": "*foo\n***bar\n**baz\n*boo",
		"html": "<ul><li>foo\n<ul><li><ul><li>bar</li></ul></li>\n<li>baz</li></ul></li>\n<li>boo</li></ul>",
		"render": "<ul><li>foo\n<ul><li><ul><li>bar</li></ul></li>\n<li>baz</li></ul></li>\n<li>boo</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">***</span>bar\n<span class=\"wpb-list\">**</span>baz\n<span class=\"wpb-list\">*</span>boo</span>"
	},
	{
		"desc": "Nested lists 10 (list and span siblings: wt2wt regression)",
		"wikitext": "*a <span>x</span>\n**b <span>y</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a <span class=\"wpb-html\">&lt;span&gt;</span>x<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-list\">**</span>b <span class=\"wpb-html\">&lt;span&gt;</span>y<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Nested lists 11 (T262409: trailing whitespace & selser)",
		"wikitext": "**a\n***b",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">**</span>a\n<span class=\"wpb-list\">***</span>b</span>"
	},
	{
		"desc": "1. Lists and block-element interaction",
		"wikitext": "*<div>a\n*b\n</div>‡≤ï",
		"html": "<ul><li><div>a</div></li>\n<li>b</li></ul>\n<p>‡≤ï</p>",
		"render": "<ul><li><div >a</li>\n<li>b</li></ul>\n</div>‡≤ï",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-html\">&lt;div&gt;</span>a\n<span class=\"wpb-list\">*</span>b\n<span class=\"wpb-html\">&lt;/div&gt;</span>‡≤ï</span>"
	},
	{
		"desc": "2. Lists and block-element interaction",
		"wikitext": "*{{1x|<div>a\n*b\n}}</div>‡≤ï",
		"html": "<ul><li><div>a</div></li>\n<li>b</li></ul>\n<p>‡≤ï</p>",
		"render": "<ul><li><div >a</li>\n<li>b</li></ul>\n</div>‡≤ï",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>a\n<span class=\"wpb-list\">*</span>b\n</span></span>}}</span><span class=\"wpb-html\">&lt;/div&gt;</span>‡≤ï</span>"
	},
	{
		"desc": "1. Lists with start-of-line-transparent tokens before bullets: Comments",
		"wikitext": "*foo\n*<!--cmt-->bar\n<!--cmt-->*baz",
		"html": "<ul><li>foo</li>\n<li>bar</li>\n<li>baz</li></ul>",
		"render": "<ul><li>foo</li>\n<li>bar</li>\n<li>baz</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">*</span><span class=\"wpb-comment\">&lt;!--cmt--&gt;</span>bar\n<span class=\"wpb-comment\">&lt;!--cmt--&gt;</span><span class=\"wpb-list\">*</span>baz</span>"
	},
	{
		"desc": "2. Lists with start-of-line-transparent tokens before bullets: Template close",
		"wikitext": "*foo {{1x|bar\n}}*baz",
		"html": "<ul><li>foo bar</li>\n<li>baz</li></ul>",
		"render": "<ul><li>foo bar</li>\n<li>baz</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar\n</span></span>}}</span>*baz</span>"
	},
	{
		"desc": "List items are not parsed correctly following a <pre> block (T2785)",
		"wikitext": "*<pre>foo</pre>\n*<pre>bar</pre>\n*zar",
		"html": "<ul><li><pre>foo</pre></li>\n<li><pre>bar</pre></li>\n<li>zar</li></ul>",
		"render": "<ul><li><pre >foo</pre></li>\n<li><pre >bar</pre></li>\n<li>zar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/pre&gt;</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/pre&gt;</span>\n<span class=\"wpb-list\">*</span>zar</span>"
	},
	{
		"desc": "List items from template",
		"wikitext": "{{inner list}}\n*item 2\n\n*item 0\n{{inner list}}\n*item 2\n\n*item 0\n*notSOL{{inner list}}\n*item 2",
		"html": "<ul><li>item 1</li>\n<li>item 2</li></ul>\n<ul><li>item 0</li>\n<li>item 1</li>\n<li>item 2</li></ul>\n<ul><li>item 0</li>\n<li>notSOL</li>\n<li>item 1</li>\n<li>item 2</li></ul>",
		"render": "<ul><li>item 1</li>\n<li>item 2</li></ul>\n<ul><li>item 0</li>\n<li>item 1</li>\n<li>item 2</li></ul>\n<ul><li>item 0</li>\n<li>notSOL</li>\n<li>item 1</li>\n<li>item 2</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">inner list</span>}}</span>\n<span class=\"wpb-list\">*</span>item 2\n\n<span class=\"wpb-list\">*</span>item 0\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">inner list</span>}}</span>\n<span class=\"wpb-list\">*</span>item 2\n\n<span class=\"wpb-list\">*</span>item 0\n<span class=\"wpb-list\">*</span>notSOL<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">inner list</span>}}</span>\n<span class=\"wpb-list\">*</span>item 2</span>"
	},
	{
		"desc": "List interrupted by empty line or heading",
		"wikitext": "*foo\n\n**bar\n==A heading==\n*Another list item",
		"html": "<ul><li>foo</li></ul>\n<ul><li><ul><li>bar</li></ul></li></ul>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"A_heading\">A heading</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: A heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<ul><li>Another list item</li></ul>",
		"render": "<ul><li>foo</li></ul>\n<ul><li><ul><li>bar</li></ul></li></ul>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"A_heading\">A heading</h2></div>\n<ul><li>Another list item</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo\n\n<span class=\"wpb-list\">**</span>bar\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">A heading</span>==</span>\n<span class=\"wpb-list\">*</span>Another list item</span>"
	},
	{
		"desc": "Multiple list tags generated by templates",
		"wikitext": "{{1x|<li>}}a\n{{1x|<li>}}b\n{{1x|<li>}}c",
		"html": "<li>a\n</li><li>b\n</li><li>c</li>",
		"render": "<li >a\n<li >b\n<li >c",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;li&gt;</span></span></span>}}</span>a\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;li&gt;</span></span></span>}}</span>b\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;li&gt;</span></span></span>}}</span>c</span>"
	},
	{
		"desc": "Multiple newlines in between HTML list items don't induce paragraph wrapping",
		"wikitext": "<ul>\n<li>hi</li>\n\n\n\n\n<li>ho</li>\n</ul>\n\n<dl>\n<dt>hi</dt>\n<dd>ho<div>123</div>\n</dd>\n\n\n</dl>",
		"html": "<ul>\n<li>hi</li>\n\n\n\n\n<li>ho</li>\n</ul>\n<dl>\n<dt>hi</dt>\n<dd>ho<div>123</div>\n</dd>\n\n\n</dl>",
		"render": "<ul >\n<li >hi</li>\n\n\n\n\n<li >ho</li>\n</ul>\n<dl >\n<dt >hi</dt>\n<dd >ho<div >123</div>\n</dd>\n\n\n</dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>hi<span class=\"wpb-html\">&lt;/li&gt;</span>\n\n\n\n\n<span class=\"wpb-html\">&lt;li&gt;</span>ho<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span>\n\n<span class=\"wpb-html\">&lt;dl&gt;</span>\n<span class=\"wpb-html\">&lt;dt&gt;</span>hi<span class=\"wpb-html\">&lt;/dt&gt;</span>\n<span class=\"wpb-html\">&lt;dd&gt;</span>ho<span class=\"wpb-html\">&lt;div&gt;</span>123<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;/dd&gt;</span>\n\n\n<span class=\"wpb-html\">&lt;/dl&gt;</span></span>"
	},
	{
		"desc": "Single-comment whitespace lines dont break lists, and neither do multi-comment whitespace lines",
		"wikitext": "*a\n<!--This line will NOT split the list-->\n*b\n <!--This line will NOT split the list either-->\n*c\n <!--foo--> <!----> <!--This line NOT split the list either--> \n*d",
		"html": "<ul><li>a</li>\n<li>b</li>\n<li>c</li>\n<li>d</li></ul>",
		"render": "<ul><li>a</li>\n<li>b</li>\n<li>c</li>\n<li>d</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-comment\">&lt;!--This line will NOT split the list--&gt;</span>\n<span class=\"wpb-list\">*</span>b\n <span class=\"wpb-comment\">&lt;!--This line will NOT split the list either--&gt;</span>\n<span class=\"wpb-list\">*</span>c\n <span class=\"wpb-comment\">&lt;!--foo--&gt;</span> <span class=\"wpb-comment\">&lt;!----&gt;</span> <span class=\"wpb-comment\">&lt;!--This line NOT split the list either--&gt;</span> \n<span class=\"wpb-list\">*</span>d</span>"
	},
	{
		"desc": "Replacing whitespace with tabs still doesn't break the list (gerrit 78327)",
		"wikitext": "*a\n<!--This line will NOT split the list-->\t\n*b\n\t<!--This line will NOT split the list either--> \t\n*c\n\t<!--foo--> <!---->\t<!--This line NOT split the list\n        either-->\t \n*d",
		"html": "<ul><li>a</li>\n<li>b</li>\n<li>c</li>\n<li>d</li></ul>",
		"render": "<ul><li>a</li>\n<li>b</li>\n<li>c</li>\n<li>d</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-comment\">&lt;!--This line will NOT split the list--&gt;</span>\t\n<span class=\"wpb-list\">*</span>b\n\t<span class=\"wpb-comment\">&lt;!--This line will NOT split the list either--&gt;</span> \t\n<span class=\"wpb-list\">*</span>c\n\t<span class=\"wpb-comment\">&lt;!--foo--&gt;</span> <span class=\"wpb-comment\">&lt;!----&gt;</span>\t<span class=\"wpb-comment\">&lt;!--This line NOT split the list\n        either--&gt;</span>\t \n<span class=\"wpb-list\">*</span>d</span>"
	},
	{
		"desc": "Test the li-hack (a hack from Tidy days, but doesn't work as advertised with Remex)",
		"wikitext": "*foo\n*<li>li-hack\n**bar1\n*{{1x|<li>templated li-hack}}\n**bar2\n*<!--foo--><li> unsupported li-hack with preceding comments\n\n<ul>\n<li><li>not a li-hack\n</li>\n</ul>",
		"html": "<ul><li>foo</li>\n<li class=\"mw-empty-elt\"></li><li>li-hack\n<ul><li>bar1</li></ul></li>\n<li class=\"mw-empty-elt\"></li><li>templated li-hack\n<ul><li>bar2</li></ul></li>\n<li class=\"mw-empty-elt\"></li><li> unsupported li-hack with preceding comments</li></ul>\n<ul>\n<li class=\"mw-empty-elt\"></li><li>not a li-hack\n</li>\n</ul>",
		"render": "<ul><li>foo</li>\n<li><li >li-hack\n<ul><li>bar1</li></ul></li>\n<li><li >templated li-hack\n<ul><li>bar2</li></ul></li>\n<li><li > unsupported li-hack with preceding comments</li></ul>\n<ul >\n<li ><li >not a li-hack\n</li>\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">*</span><span class=\"wpb-html\">&lt;li&gt;</span>li-hack\n<span class=\"wpb-list\">**</span>bar1\n<span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;li&gt;</span>templated li-hack</span></span>}}</span>\n<span class=\"wpb-list\">**</span>bar2\n<span class=\"wpb-list\">*</span><span class=\"wpb-comment\">&lt;!--foo--&gt;</span><span class=\"wpb-html\">&lt;li&gt;</span> unsupported li-hack with preceding comments\n\n<span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span><span class=\"wpb-html\">&lt;li&gt;</span>not a li-hack\n<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "Parsoid: Make sure nested lists are serialized on their own line even if HTML contains no newlines",
		"wikitext": "#foo\n##bar\n\n*foo\n**bar\n\n:foo\n::bar",
		"html": "<ol><li>foo\n<ol><li>bar</li></ol></li></ol>\n<ul><li>foo\n<ul><li>bar</li></ul></li></ul>\n<dl><dd>foo\n<dl><dd>bar</dd></dl></dd></dl>",
		"render": "<ol><li>foo\n<ol><li>bar</li></ol></li></ol>\n<ul><li>foo\n<ul><li>bar</li></ul></li></ul>\n<dl><dd>foo\n<dl><dd>bar</dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#</span>foo\n<span class=\"wpb-list\">##</span>bar\n\n<span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">**</span>bar\n\n<span class=\"wpb-list\">:</span>foo\n<span class=\"wpb-list\">::</span>bar</span>"
	},
	{
		"desc": "Parsoid: Test of whitespace serialization with Templated bullets",
		"wikitext": "* {{bullet}}",
		"html": "<ul><li class=\"mw-empty-elt\"></li>\n<li>Bar</li></ul>",
		"render": "<ul><li></li>\n<li>Bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">bullet</span>}}</span></span>"
	},
	{
		"desc": "Unbalanced closing block tags break a list",
		"wikitext": "<div>\n*a</div><div>\n*b</div>",
		"html": "<div>\n<ul><li>a</li></ul></div><div>\n<li>b</li></div>",
		"render": "<div >\n<ul><li>a</div><div ></li>\n<li>b</div></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>\n<span class=\"wpb-list\">*</span>a<span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span>\n<span class=\"wpb-list\">*</span>b<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Unbalanced closing wikitext block tags break a list",
		"wikitext": "<p>\n*a</p><p>\n*b</p>",
		"html": "<p class=\"mw-empty-elt\">\n</p><ul><li>a<p class=\"mw-empty-elt\"></p><p class=\"mw-empty-elt\"></p></li>\n<li>b<p class=\"mw-empty-elt\"></p></li></ul>",
		"render": "<p >\n<ul><li>a</p><p ></li>\n<li>b</p></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p&gt;</span>\n<span class=\"wpb-list\">*</span>a<span class=\"wpb-html\">&lt;/p&gt;</span><span class=\"wpb-html\">&lt;p&gt;</span>\n<span class=\"wpb-list\">*</span>b<span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Unbalanced closing non-block tags don't break a list",
		"wikitext": "<span>\n*a</span><span>\n*b</span>",
		"html": "<p><span>\n</span></p>\n<ul><li>a<span></span></li>\n<li>b</li></ul>",
		"render": "<p><span >\n</p>\n<ul><li>a</span><span ></li>\n<li>b</span></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span&gt;</span>\n<span class=\"wpb-list\">*</span>a<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-html\">&lt;span&gt;</span>\n<span class=\"wpb-list\">*</span>b<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Unclosed formatting tags that straddle lists are closed and reopened",
		"wikitext": "#<s> a\n#b </s>",
		"html": "<ol><li><s> a</s></li><s>\n</s><li><s>b </s></li></ol>",
		"render": "<ol><li><s > a</li>\n<li>b </s></li></ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#</span><span class=\"wpb-html\">&lt;s&gt;</span> a\n<span class=\"wpb-list\">#</span>b <span class=\"wpb-html\">&lt;/s&gt;</span></span>"
	},
	{
		"desc": "1. List embedded in a formatting tag",
		"wikitext": "<small>\n*foo\n</small>",
		"html": "<p><small>\n</small></p><small><ul><li>foo</li></ul></small><small></small><p><small></small>\n</p>",
		"render": "<p><small >\n</p>\n<ul><li>foo</li></ul>\n<p></small>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;small&gt;</span>\n<span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "2. List embedded in a formatting tag in a misnested way",
		"wikitext": "<small>\n*a\n*b</small>",
		"html": "<p><small>\n</small></p><small></small><ul><small><li>a</li>\n</small><li><small>b</small></li></ul>",
		"render": "<p><small >\n</p>\n<ul><li>a</li>\n<li>b</small></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;small&gt;</span>\n<span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">*</span>b<span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "3. List embedded in a formatting tag in a misnested way",
		"wikitext": "<small>\n\n** 123</small>",
		"html": "<p><small>\n</small></p><small></small><ul><small></small><li><small></small><ul><small></small><li><small>123</small></li></ul></li></ul>",
		"render": "<p><small >\n</p>\n<ul><li><ul><li>123</small></li></ul></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;small&gt;</span>\n\n<span class=\"wpb-list\">** </span>123<span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "Parsoid: unknown parser function (T314524)",
		"wikitext": "{{#tag:b|This is a known parser function}}\n\nNow show the unknown parser functions for comparison.\n\n{{#foo}}\n\n{{#foo:bar|bat}}",
		"html": "<p><b>This is a known parser function</b>\n</p><p>Now show the unknown parser functions for comparison.\n</p><p>{{#foo}}\n</p><p>{{#foo:bar|bat}}\n</p>",
		"render": "<p><br>\nNow show the unknown parser functions for comparison.\n</p><p>{{#foo}}\n</p><p>{{#foo:bar|bat}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">This is a known parser function</span></span>}}</span>\n\nNow show the unknown parser functions for comparison.\n\n{{#foo}}\n\n{{#foo:bar|bat}}</span>"
	},
	{
		"desc": "Parsoid: Page property magic word with magic word contents",
		"wikitext": "{{DISPLAYTITLE:''{{PAGENAME}}''}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span><span class=\"wpb-quote\">''</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Template-generated DISPLAYTITLE",
		"wikitext": "{{{{1x|DISPLAYTITLE}}:Foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">DISPLAYTITLE</span></span>}}</span>:Foo</span>}}</span></span>"
	},
	{
		"desc": "Parsoid html2wt b/c check: Cached Parsoid HTML for DISPLAYTITLE should be handled properly",
		"wikitext": "{{DISPLAYTITLE:foo}}\n{{DISPLAYTITLE:''{{PAGENAME}}''}}\n{{{{1x|DISPLAYTITLE}}:Foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span><span class=\"wpb-quote\">''</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">DISPLAYTITLE</span></span>}}</span>:Foo</span>}}</span></span>"
	},
	{
		"desc": "Namespace 1 {{ns:1}}",
		"wikitext": "{{ns:1}}",
		"html": "<p>Talk\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace 1 {{ns:01}}",
		"wikitext": "{{ns:01}}",
		"html": "<p>Talk\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">01</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace 0 {{ns:0}} (T6783)",
		"wikitext": "{{ns:0}}",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">0</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace 0 {{ns:00}} (T6783)",
		"wikitext": "{{ns:00}}",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">00</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace -1 {{ns:-1}}",
		"wikitext": "{{ns:-1}}",
		"html": "<p>Special\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-1</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace User {{ns:User}}",
		"wikitext": "{{ns:User}}",
		"html": "<p>User\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">User</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace User talk {{ns:User_talk}}",
		"wikitext": "{{ns:User_talk}}",
		"html": "<p>User talk\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">User_talk</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace User talk {{ns:uSeR tAlK}}",
		"wikitext": "{{ns:uSeR tAlK}}",
		"html": "<p>User talk\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">uSeR tAlK</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace File {{ns:File}}",
		"wikitext": "{{ns:File}}",
		"html": "<p>File\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">File</span></span>}}</span></span>"
	},
	{
		"desc": "Namespace File {{ns:Image}}",
		"wikitext": "{{ns:Image}}",
		"html": "<p>File\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Image</span></span>}}</span></span>"
	},
	{
		"desc": "Urlencode",
		"wikitext": "{{urlencode:hi world?!}}\n{{urlencode:hi world?!|WIKI}}\n{{urlencode:hi world?!|PATH}}\n{{urlencode:hi world?!|QUERY}}",
		"html": "<p>hi+world%3F%21\nhi_world%3F!\nhi%20world%3F%21\nhi+world%3F%21\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi world?!</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi world?!</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">WIKI</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi world?!</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">PATH</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi world?!</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">QUERY</span></span>}}</span></span>"
	},
	{
		"desc": "__proto__ is treated as normal wikitext (T105997)",
		"wikitext": "__proto__",
		"html": "<p>__proto__\n</p>",
		"render": "<p>__proto__\n</p>",
		"print": "<span class=\"wpb-root\">__proto__</span>"
	},
	{
		"desc": "Template titles with entities in them",
		"wikitext": "*{{Foo‚Äìbar}}\n*{{Foo&ndash;bar}}",
		"html": "<ul><li>foo</li>\n<li>foo</li></ul>",
		"render": "<ul><li>foo</li>\n<li><a href=\"/wiki/Template%3AFoo%26ndash%3Bbar?action=edit&redlink=1\" class=\"new\" title=\"Template:Foo&ndash;bar (page does not exist)\">Template:Foo&ndash;bar</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Foo‚Äìbar</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Foo&amp;ndash;bar</span>}}</span></span>"
	},
	{
		"desc": "Nonexistent template",
		"wikitext": "{{thistemplatedoesnotexist}}",
		"html": "<p><a href=\"/index.php?title=Template:Thistemplatedoesnotexist&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:Thistemplatedoesnotexist (page does not exist)\">Template:Thistemplatedoesnotexist</a>\n</p>",
		"render": "<p><a href=\"/wiki/Template%3AThistemplatedoesnotexist?action=edit&redlink=1\" class=\"new\" title=\"Template:Thistemplatedoesnotexist (page does not exist)\">Template:Thistemplatedoesnotexist</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">thistemplatedoesnotexist</span>}}</span></span>"
	},
	{
		"desc": "Template with invalid target containing tags",
		"wikitext": "{{a<b>b</b>|{{1x|foo}}|{{1x|a}}={{1x|b}}|a = b}}",
		"html": "<p>{{a<b>b</b>|foo|a=b|a = b}}\n</p>",
		"render": "<p>{{a<b >b</b>|foo|a=b|a = b}}\n</p>",
		"print": "<span class=\"wpb-root\">{{a<span class=\"wpb-html\">&lt;b&gt;</span>b<span class=\"wpb-html\">&lt;/b&gt;</span>|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>}}</span>=<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span>|a = b}}</span>"
	},
	{
		"desc": "Template with invalid target containing unclosed tag",
		"wikitext": "{{a<b>|{{1x|foo}}|{{1x|a}}={{1x|b}}|a = b}}",
		"html": "<p>{{a<b>|foo|a=b|a = b}}\n</b></p>",
		"render": "<p>{{a<b >|foo|a=b|a = b}}\n</p>",
		"print": "<span class=\"wpb-root\">{{a<span class=\"wpb-html\">&lt;b&gt;</span>|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>}}</span>=<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span>|a = b}}</span>"
	},
	{
		"desc": "Template with invalid target containing wikilink",
		"wikitext": "{{[[Main Page]]}}",
		"html": "<p>{{<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>}}\n</p>",
		"render": "<p>{{<a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>}}\n</p>",
		"print": "<span class=\"wpb-root\">{{<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>}}</span>"
	},
	{
		"desc": "Template with just whitespace in it, T70421",
		"wikitext": "{{1x|{{ }}}}",
		"html": "<p>{{ }}\n</p>",
		"render": "<p>{{ }}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">{{ }}</span></span>}}</span></span>"
	},
	{
		"desc": "Template with just whitespace (bad template brace matching)",
		"wikitext": "{{1x|{{ }<nowiki>}</nowiki>}}",
		"html": "<p>{{1x|{{ }}}}\n</p>",
		"render": "<p>{{1x|{{ }}}}\n</p>",
		"print": "<span class=\"wpb-root\">{{1x|{{ }<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">}</span>&lt;/nowiki&gt;</span>}}</span>"
	},
	{
		"desc": "Simple template",
		"wikitext": "{{test}}",
		"html": "<p>This is a test template\n</p>",
		"render": "<p>This is a test template\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">test</span>}}</span></span>"
	},
	{
		"desc": "Template with explicit namespace",
		"wikitext": "{{Template:test}}",
		"html": "<p>This is a test template\n</p>",
		"render": "<p>This is a test template\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Template:test</span>}}</span></span>"
	},
	{
		"desc": "Template parameter",
		"wikitext": "{{paramtest|param=foo}}",
		"html": "<p>This is a test template with parameter foo\n</p>",
		"render": "<p>This is a test template with parameter foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">paramtest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">param</span>=<span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Template unnamed parameter",
		"wikitext": "{{paramtestnum|Main Page|the main page}}",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">the main page</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">the main page</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">paramtestnum</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Main Page</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">the main page</span></span>}}</span></span>"
	},
	{
		"desc": "Template with template name as unnamed argument",
		"wikitext": "{{templateasargtestnum|templatesimple}}",
		"html": "<p>(test)\n</p>",
		"render": "<p>(test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">templateasargtestnum</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">templatesimple</span></span>}}</span></span>"
	},
	{
		"desc": "Template with template name as argument",
		"wikitext": "{{templateasargtest|templ=simple}}",
		"html": "<p>(test)\n</p>",
		"render": "<p>(test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">templateasargtest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">templ</span>=<span class=\"wpb-parameter-value\">simple</span></span>}}</span></span>"
	},
	{
		"desc": "Template with template name as argument (2)",
		"wikitext": "{{templateasargtest2|templ=templatesimple}}",
		"html": "<p>(test)\n</p>",
		"render": "<p>(test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">templateasargtest2</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">templ</span>=<span class=\"wpb-parameter-value\">templatesimple</span></span>}}</span></span>"
	},
	{
		"desc": "Template with default value",
		"wikitext": "{{templateasargtestdefault}}",
		"html": "<p>(test)\n</p>",
		"render": "<p>(test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">templateasargtestdefault</span>}}</span></span>"
	},
	{
		"desc": "Template with default value (value set)",
		"wikitext": "{{templateasargtestdefault|templ=templa}}",
		"html": "<p><b>templ</b>\n</p>",
		"render": "<p><b>templ</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">templateasargtestdefault</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">templ</span>=<span class=\"wpb-parameter-value\">templa</span></span>}}</span></span>"
	},
	{
		"desc": "Template redirect",
		"wikitext": "{{templateredirect}}",
		"html": "<p>(test)\n</p>",
		"render": "<p>(test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">templateredirect</span>}}</span></span>"
	},
	{
		"desc": "Template with argument in separate line",
		"wikitext": "{{ templateasargtest  |\n templ = simple }}",
		"html": "<p>(test)\n</p>",
		"render": "<p>(test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"> templateasargtest  </span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">\n templ </span>=<span class=\"wpb-parameter-value\"> simple </span></span>}}</span></span>"
	},
	{
		"desc": "Template with complex template as argument",
		"wikitext": "{{paramtest|\n  param ={{ templateasargtest  |\n templ = simple }}}}",
		"html": "<p>This is a test template with parameter (test)\n</p>",
		"render": "<p>This is a test template with parameter (test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">paramtest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">\n  param </span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"> templateasargtest  </span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">\n templ </span>=<span class=\"wpb-parameter-value\"> simple </span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates with templated name",
		"wikitext": "{{{{1x|1x}}|foo}}\n{{{{1x|inner list}} }}",
		"html": "<p>foo\n</p>\n<ul><li>item 1</li></ul>",
		"render": "<p>foo\n</p>\n<ul><li>item 1</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1x</span></span>}}</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">inner list</span></span>}}</span> </span>}}</span></span>"
	},
	{
		"desc": "Templates with templated name and top level template args",
		"wikitext": "{{1{{2{{{3}}}|4=5}}}}",
		"html": "<p>{{1{{2{{{3}}}|4=5}}}}\n</p>",
		"render": "<p>{{1{{2{{{3}}}|4=5}}}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">2<span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">3</span>}}}</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">4</span>=<span class=\"wpb-parameter-value\">5</span></span>}}</span></span>}}</span></span>"
	},
	{
		"desc": "Templates with invalid templated targets",
		"wikitext": "{{1x\n{{1x|foo}}\n}}",
		"html": "<p>{{1x\nfoo\n}}\n</p>",
		"render": "<p>{{1x\nfoo\n}}\n</p>",
		"print": "<span class=\"wpb-root\">{{1x\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>\n}}</span>"
	},
	{
		"desc": "Template with complex arguments",
		"wikitext": "{{complextemplate|\n  param ={{ templateasargtest  |\n templ = simple }}|[[Template:complextemplate|link]]}}",
		"html": "<p><a href=\"/wiki/Template:Complextemplate\" title=\"Template:Complextemplate\">link</a> This is a test template with parameter (test)\n</p>",
		"render": "<p><a href=\"/wiki/Template%3AComplextemplate\" title=\"Template:Complextemplate\">link</a> This is a test template with parameter (test)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">complextemplate</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">\n  param </span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"> templateasargtest  </span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">\n templ </span>=<span class=\"wpb-parameter-value\"> simple </span></span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Template:complextemplate</span>|<span class=\"wpb-link-text\">link</span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "T2553: link with two variables in a piped link",
		"wikitext": "{|\n|[[{{{1}}}|{{{2}}}]]\n|}",
		"html": "<table>\n<tbody><tr>\n<td>[[{{{1}}}|{{{2}}}]]\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >[[{{{1}}}|{{{2}}}]]\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">1</span>}}}</span></span>|<span class=\"wpb-link-text\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">2</span>}}}</span></span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Bail on table cell attribute parsing on wikilink",
		"wikitext": "{|\n|testing [[one|two]] |three||four\n|testing one two |three||four\n|testing=\"[[one|two]]\" |three||four\n|}",
		"html": "<table>\n<tbody><tr>\n<td>testing <a href=\"/wiki/One\" title=\"One\">two</a> |three</td>\n<td>four\n</td>\n<td>three</td>\n<td>four\n</td>\n<td>testing=\"<a href=\"/wiki/One\" title=\"One\">two</a>\" |three</td>\n<td>four\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >testing <a href=\"/wiki/One\" title=\"One\">two</a> |three</td>\n<td >four\n</td>\n<td   >three</td>\n<td >four\n</td>\n<td >testing=\"<a href=\"/wiki/One\" title=\"One\">two</a>\" |three</td>\n<td >four\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">testing <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">one</span>|<span class=\"wpb-link-text\">two</span>]]</span> |three</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">four</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">testing</span></span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">one</span></span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">two</span></span> </span>|<span class=\"wpb-td-inner\">three</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">four</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">testing=\"<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">one</span>|<span class=\"wpb-link-text\">two</span>]]</span>\" |three</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">four</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Don't bail on table cell attribute parsing if wikilink is found in template arg",
		"wikitext": "{|\n|Test {{#tag:spantag|One two \"[[three]]\" four}}\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Test <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">spantag</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">One two \"<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">three</span>]]</span>\" four</span></span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Magic variable as template parameter",
		"wikitext": "{{paramtest|param={{SITENAME}}}}",
		"html": "<p>This is a test template with parameter MediaWiki\n</p>",
		"render": "<p>This is a test template with parameter \n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">paramtest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">param</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SITENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Template parameter as link source",
		"wikitext": "{{linktest|param=Main Page}}",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">linktest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">param</span>=<span class=\"wpb-parameter-value\">Main Page</span></span>}}</span></span>"
	},
	{
		"desc": "Template passing argument to another template",
		"wikitext": "{{paramtest2|arg='hmm'}}",
		"html": "<p>including another template, This is a test template with parameter 'hmm'\n</p>",
		"render": "<p>including another template, This is a test template with parameter 'hmm'\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">paramtest2</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">arg</span>=<span class=\"wpb-parameter-value\">'hmm'</span></span>}}</span></span>"
	},
	{
		"desc": "Template as link source",
		"wikitext": "[[{{linktest2}}]]\n\n[[{{linktest2}}|Main Page]]\n\n[[{{linktest2}}]]Page",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>Page\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>Page\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">linktest2</span>}}</span></span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">linktest2</span>}}</span></span>|<span class=\"wpb-link-text\">Main Page</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">linktest2</span>}}</span></span>]]</span>Page</span>"
	},
	{
		"desc": "Template infinite loop",
		"wikitext": "{{loop1}}",
		"html": "<p><span class=\"error\">Template loop detected: <a href=\"/wiki/Template:Loop1\" title=\"Template:Loop1\">Template:Loop1</a></span>\n</p>",
		"render": "<p><span class=\"error\">Template loop detected: <a href=\"/wiki/Template%3ALoop1\" title=\"Template:Loop1\">Template:Loop1</a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">loop1</span>}}</span></span>"
	},
	{
		"desc": "Template from main namespace",
		"wikitext": "{{:Main Page}}",
		"html": "<p>blah blah\n</p>",
		"render": "<p>blah blah\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">:Main Page</span>}}</span></span>"
	},
	{
		"desc": "Template from non-includable namespace",
		"wikitext": "{{1x|uh oh!}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">uh oh!</span></span>}}</span></span>"
	},
	{
		"desc": "T2529: Template with table, not included at beginning of line",
		"wikitext": "foo {{table}}",
		"html": "<p>foo \n</p>\n<table>\n<tbody><tr>\n<td>1</td>\n<td>2\n</td></tr>\n<tr>\n<td>3</td>\n<td>4\n</td></tr></tbody></table>",
		"render": "<p>foo \n</p>\n<table >\n<tbody><tr>\n<td >1</td>\n<td >2\n</td></tr><tr >\n<td >3</td>\n<td >4\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\">foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table</span>}}</span></span>"
	},
	{
		"desc": "T2523: Template shouldn't eat newline (or add an extra one before table)",
		"wikitext": "foo\n{{table}}",
		"html": "<p>foo\n</p>\n<table>\n<tbody><tr>\n<td>1</td>\n<td>2\n</td></tr>\n<tr>\n<td>3</td>\n<td>4\n</td></tr></tbody></table>",
		"render": "<p>foo\n</p>\n<table >\n<tbody><tr>\n<td >1</td>\n<td >2\n</td></tr><tr >\n<td >3</td>\n<td >4\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table</span>}}</span></span>"
	},
	{
		"desc": "T2041: Template parameters shown as broken links",
		"wikitext": "{{{parameter}}}",
		"html": "<p>{{{parameter}}}\n</p>",
		"render": "<p>{{{parameter}}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">parameter</span>}}}</span></span>"
	},
	{
		"desc": "Template with targets containing wikilinks",
		"wikitext": "{{[[foo]]}}\n\n{{[[{{1x|foo}}]]}}\n\n{{{{1x|[[foo}}]]}}",
		"html": "<p>{{<a href=\"/wiki/Foo\" title=\"Foo\">foo</a>}}\n</p><p>{{<a href=\"/wiki/Foo\" title=\"Foo\">foo</a>}}\n</p><p>{{[[foo}}]]\n</p>",
		"render": "<p>{{<a href=\"/wiki/Foo\" title=\"Foo\">foo</a>}}\n</p><p>{{<a href=\"/wiki/Foo\" title=\"Foo\">foo</a>}}\n</p><p>{{[[foo}}]]\n</p>",
		"print": "<span class=\"wpb-root\">{{<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">foo</span>]]</span>}}\n\n{{<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>]]</span>}}\n\n{{<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[[foo}}]]</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Double quotes as template target",
		"wikitext": "foo {{''}} baz",
		"html": "<p>foo bar baz\n</p>",
		"render": "<p>foo bar baz\n</p>",
		"print": "<span class=\"wpb-root\">foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">''</span>}}</span> baz</span>"
	},
	{
		"desc": "Templates with intersecting and overlapping ranges",
		"wikitext": "{|{{1x|1=class=\"foo\"\n<p>ha</p>}}\n{|{{1x|1=class=\"bar\"\n<p>ho</p>}}\n{{1x|{{!}}hi}}\n|}",
		"html": "<p>ha</p><table class=\"foo\">\n\n</table><p>ho</p><table class=\"bar\">\n\n<tbody><tr>\n<td>hi\n</td></tr></tbody></table>",
		"render": "<p >ha</p><table class=\"foo\">\n<tbody></tbody></table>\n<p >ho</p><table class=\"bar\">\n<tbody><tr>\n<td >hi\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">class=\"foo\"\n<span class=\"wpb-html\">&lt;p&gt;</span>ha<span class=\"wpb-html\">&lt;/p&gt;</span></span></span>}}</span></span></span></span></span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">class=\"bar\"\n<span class=\"wpb-html\">&lt;p&gt;</span>ho<span class=\"wpb-html\">&lt;/p&gt;</span></span></span>}}</span></span></span></span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>hi</span></span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "msgnw keyword",
		"wikitext": "{{msgnw:MSGNW test}}",
		"html": "<p>&#39;&#39;None&#39;&#39; of &#39;&#39;&#39;this&#39;&#39;&#39; should be \n&#42; interpreted\n&#32;but rather passed unmodified\n&#123;&#123;test&#125;&#125;\n&#60;gallery&#62;\nFile:Foobar.jpg\n&#60;/gallery&#62;\n&#60;!-- comment --&#62;\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">msgnw</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">MSGNW test</span></span>}}</span></span>"
	},
	{
		"desc": "int keyword",
		"wikitext": "{{int:new-messages|lots of money|not!}}",
		"html": "<p>You have lots of money (not!).\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">int</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">new-messages</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">lots of money</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">not!</span></span>}}</span></span>"
	},
	{
		"desc": "int keyword - non-existing message",
		"wikitext": "{{int:var}}",
		"html": "<p>‚ßºvar‚ßΩ\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">int</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">var</span></span>}}</span></span>"
	},
	{
		"desc": "<includeonly> and <noinclude> being included",
		"wikitext": "{{Includes}}",
		"html": "<p>Foobar\n</p>",
		"render": "<p>Foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Includes</span>}}</span></span>"
	},
	{
		"desc": "<onlyinclude> being included",
		"wikitext": "{{Includes2}}",
		"html": "<p>Foo\n</p>",
		"render": "<p>Foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Includes2</span>}}</span></span>"
	},
	{
		"desc": "<onlyinclude> and <includeonly> being included",
		"wikitext": "{{Includes3}}",
		"html": "<p>Foo\n</p>",
		"render": "<p>Foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Includes3</span>}}</span></span>"
	},
	{
		"desc": "<includeonly> and <noinclude> on a page",
		"wikitext": "Foo<noinclude>zar</noinclude><includeonly>bar</includeonly>",
		"html": "<p>Foozar\n</p>",
		"render": "<p>Foozar\n</p>",
		"print": "<span class=\"wpb-root\">Foo<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>zar<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-include\">&lt;includeonly&gt;bar&lt;/includeonly&gt;</span></span>"
	},
	{
		"desc": "Un-closed <noinclude>",
		"wikitext": "<noinclude>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span></span>"
	},
	{
		"desc": "Empty <noinclude>",
		"wikitext": "Hello<noinclude></noinclude>!",
		"html": "<p>Hello!\n</p>",
		"render": "<p>Hello!\n</p>",
		"print": "<span class=\"wpb-root\">Hello<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>!</span>"
	},
	{
		"desc": "Nested <noinclude>s",
		"wikitext": "<noinclude>\nx\n<noinclude>y</noinclude>\nz\n</noinclude>",
		"html": "<p>x\ny\nz\n</p>",
		"render": "<p>x\ny\nz\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>\nx\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>y<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>\nz\n<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span>"
	},
	{
		"desc": "<onlyinclude> on a page",
		"wikitext": "<onlyinclude>Foo</onlyinclude>bar",
		"html": "<p>Foobar\n</p>",
		"render": "<p>Foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span>Foo<span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span>bar</span>"
	},
	{
		"desc": "Un-closed <onlyinclude>",
		"wikitext": "<onlyinclude>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span></span>"
	},
	{
		"desc": "T236868: Un-closed <noinclude> caused bad SourceRange length",
		"wikitext": "{| <noinclude>\n|- <noinclude>\n| A\n|-</noinclude>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-noinclude\">&lt;noinclude&gt;</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-noinclude\">&lt;noinclude&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> A</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Self-closed noinclude, includeonly, onlyinclude tags",
		"wikitext": "<noinclude />\n<includeonly />\n<onlyinclude />",
		"html": "<p><br />\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-noinclude\">&lt;noinclude /&gt;</span>\n<span class=\"wpb-include\">&lt;includeonly /&gt;</span>\n<span class=\"wpb-noinclude\">&lt;onlyinclude /&gt;</span></span>"
	},
	{
		"desc": "Unbalanced includeonly and noinclude tags",
		"wikitext": "{|\n|a</noinclude>\n|b</noinclude></noinclude>\n|c</noinclude></includeonly>\n|d</includeonly></includeonly>\n|}",
		"html": "<table>\n<tbody><tr>\n<td>a\n</td>\n<td>b\n</td>\n<td>c&lt;/includeonly&gt;\n</td>\n<td>d&lt;/includeonly&gt;&lt;/includeonly&gt;\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >a\n</td>\n<td >b\n</td>\n<td >c&lt;/includeonly&gt;\n</td>\n<td >d&lt;/includeonly&gt;&lt;/includeonly&gt;\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">b<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">c<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>&lt;/includeonly&gt;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">d&lt;/includeonly&gt;&lt;/includeonly&gt;</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "includeonly / noinclude / onlyinclude and headers",
		"wikitext": "<includeonly><!--hello1 --></includeonly>== test 1 == <includeonly><!--hello2 --></includeonly>\n<noinclude><!--hello3 --></noinclude>== test 2 == <noinclude><!--hello4 --></noinclude>\n<onlyinclude><!--hello5 --></onlyinclude>== test 3 == <onlyinclude><!--hello6 --></onlyinclude>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;&lt;!--hello1 --&gt;&lt;/includeonly&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> test 1 </span>==<span class=\"wpb-heading-trail\"> <span class=\"wpb-include\">&lt;includeonly&gt;&lt;!--hello2 --&gt;&lt;/includeonly&gt;</span></span></span>\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-comment\">&lt;!--hello3 --&gt;</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> test 2 </span>==<span class=\"wpb-heading-trail\"> <span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-comment\">&lt;!--hello4 --&gt;</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span>\n<span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span><span class=\"wpb-comment\">&lt;!--hello5 --&gt;</span><span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> test 3 </span>==<span class=\"wpb-heading-trail\"> <span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span><span class=\"wpb-comment\">&lt;!--hello6 --&gt;</span><span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span></span></span></span>"
	},
	{
		"desc": "T8563: Section extraction for section shown by <includeonly>",
		"wikitext": "<includeonly>\n==Includeonly section==\n</includeonly>\n==Section T-2==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;\n==Includeonly section==\n&lt;/includeonly&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section T-2</span>==</span></span>"
	},
	{
		"desc": "T8563: Section extraction for section suppressed by <includeonly>",
		"wikitext": "<includeonly>\n==Includeonly section==\n</includeonly>\n==Section 1==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;\n==Includeonly section==\n&lt;/includeonly&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 1</span>==</span></span>"
	},
	{
		"desc": "Un-closed <includeonly>",
		"wikitext": "<includeonly>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;</span></span>"
	},
	{
		"desc": "Includes and comments at SOL",
		"wikitext": "<!-- comment --><noinclude><!-- comment --></noinclude><!-- comment -->==hu==\n\n<noinclude>\nsome\n</noinclude>*stuff\n*here\n\n<noinclude>\nsome</noinclude>* stuff\n* here\n\n<includeonly>can have stuff</includeonly>===here===\n\n__INDEX__== hi ==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"hu\">hu</h2></div>\n<p>some\n</p>\n<ul><li>stuff</li>\n<li>here</li></ul>\n<p><br />\nsome* stuff\n</p>\n<ul><li>here</li></ul>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"here\">here</h3></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"hi\">hi</h2></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"hu\">hu</h2></div>\n<p>some\n</p>\n<ul><li>stuff</li>\n<li>here</li></ul>\n<p><br>\nsome* stuff\n</p>\n<ul><li>here</li></ul>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"here\">here</h3></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"hi\">hi</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- comment --&gt;</span><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-comment\">&lt;!-- comment --&gt;</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-comment\">&lt;!-- comment --&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">hu</span>==<span class=\"wpb-heading-trail\">\n\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span></span></span>\nsome\n<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-list\">*</span>stuff\n<span class=\"wpb-list\">*</span>here\n\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>\nsome<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>* stuff\n<span class=\"wpb-list\">* </span>here\n\n<span class=\"wpb-include\">&lt;includeonly&gt;can have stuff&lt;/includeonly&gt;</span><span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">here</span>===<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-double-underscore\">__INDEX__</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> hi </span>==</span></span>"
	},
	{
		"desc": "Parsoid: DOM fragment reuse",
		"wikitext": "a{{1x|b<table></table>c}}d\n\na{{1x|b\n<table></table>\nc}}d\n\n{{1x|a\n\n<table></table>\n\nb}}",
		"print": "<span class=\"wpb-root\">a<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b<span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span>c</span></span>}}</span>d\n\na<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b\n<span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span>\nc</span></span>}}</span>d\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\n\n<span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span>\n\nb</span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Merge double tds (T52603)",
		"wikitext": "{|\n|{{1x|{{!}} foo}}\n|}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> foo</span></span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Parsoid: Merge double tds in nested transclusion content (T52603)",
		"wikitext": "{{1x|<div>}}\n{|\n|{{1x|{{!}} foo}}\n|}\n{{1x|</div>}}",
		"html": "<div>\n<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>\n</div>",
		"render": "<div >\n<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span></span></span>}}</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> foo</span></span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Template name with question mark",
		"wikitext": "{{temp?|123}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">temp?</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">123</span></span>}}</span></span>"
	},
	{
		"desc": "0. includeonly around the entire attribute",
		"wikitext": "<span <includeonly>id=\"v1\"</includeonly><noinclude>id=\"v2\"</noinclude>>bar</span>",
		"html": "<p><span id=\"v2\">bar</span>\n</p>",
		"render": "<p><span id=\"v2\">bar</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-include\">&lt;includeonly&gt;id=\"v1\"&lt;/includeonly&gt;</span><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>id</span>=\"<span class=\"wpb-attr-value\">v2</span>\"</span><span class=\"wpb-attr-dirty\"><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "1. includeonly in html attr key",
		"wikitext": "<span <noinclude>id</noinclude><includeonly>about</includeonly>=\"foo\">bar</span>",
		"html": "<p><span id=\"foo\">bar</span>\n</p>",
		"render": "<p><span id=\"foo\">bar</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>id<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-include\">&lt;includeonly&gt;about&lt;/includeonly&gt;</span></span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "2. includeonly in html attr value",
		"wikitext": "<span id=\"<noinclude>v1</noinclude><includeonly>v2</includeonly>\">bar</span>\n<span id=<noinclude>\"v1\"</noinclude><includeonly>\"v2\"</includeonly>>bar</span>",
		"html": "<p><span id=\"v1\">bar</span>\n<span id=\"v1\">bar</span>\n</p>",
		"render": "<p><span id=\"v1\">bar</span>\n<span id=\"v1\">bar</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>v1<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-include\">&lt;includeonly&gt;v2&lt;/includeonly&gt;</span></span>\"</span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=&lt;noinclude&gt;\"<span class=\"wpb-attr-value\">v1</span>\"</span><span class=\"wpb-attr-dirty\"><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-include\">&lt;includeonly&gt;\"v2\"&lt;/includeonly&gt;</span></span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "3. includeonly in part of an attr value",
		"wikitext": "<span style=\"color:<noinclude>red</noinclude><includeonly>blue</includeonly>;\">bar</span>",
		"html": "<p><span style=\"color:red;\">bar</span>\n</p>",
		"render": "<p><span style=\"color:red;\">bar</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>red<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-include\">&lt;includeonly&gt;blue&lt;/includeonly&gt;</span>;</span>\"</span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "4. includeonly in table attributes",
		"wikitext": "{|\n|- <noinclude>\n|-\n|a\n</noinclude>\n|- <includeonly>\n|-\n|b\n</includeonly>\n|}",
		"html": "<table>\n\n\n<tbody><tr>\n<td>a\n</td></tr>\n</tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >a\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-noinclude\">&lt;noinclude&gt;</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a\n<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-include\">&lt;includeonly&gt;\n|-\n|b\n&lt;/includeonly&gt;</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "1. Table tag in SOL posn. should get reparsed correctly with valid TSR",
		"wikitext": "{{1x|}}{| width = '100%'\n|foo\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|}}</span>{| width = '100%'\n|foo\n|}</span>"
	},
	{
		"desc": "2. Table tag in SOL posn. should get reparsed correctly with valid TSR",
		"wikitext": "<includeonly>a</includeonly>{| {{{b}}}\n|c\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;a&lt;/includeonly&gt;</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">b</span>}}}</span></span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">c</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table wikitext syntax outside wiki-tables",
		"wikitext": "a\n|+ not a caption\n! not a table heading\n|- not a table row\n| not a table cell\n| class=\"foo bar\" | baz\nb\n|}\n|-\nc",
		"html": "<p>a\n|+ not a caption\n! not a table heading\n|- not a table row\n| not a table cell\n| class=\"foo bar\" | baz\nb\n|}\n|-\nc\n</p>",
		"render": "<p>a\n|+ not a caption\n! not a table heading\n|- not a table row\n| not a table cell\n| class=\"foo bar\" | baz\nb\n|}\n|-\nc\n</p>",
		"print": "<span class=\"wpb-root\">a\n|+ not a caption\n! not a table heading\n|- not a table row\n| not a table cell\n| class=\"foo bar\" | baz\nb\n|}\n|-\nc</span>"
	},
	{
		"desc": "Content after <tr> like wikitext should get fully processed",
		"wikitext": "x\n|- [[Foo]] and {{1x|bar}}\ny",
		"html": "<p>x\n|- <a href=\"/wiki/Foo\" title=\"Foo\">Foo</a> and bar\ny\n</p>",
		"render": "<p>x\n|- <a href=\"/wiki/Foo\" title=\"Foo\">Foo</a> and bar\ny\n</p>",
		"print": "<span class=\"wpb-root\">x\n|- <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span> and <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span>\ny</span>"
	},
	{
		"desc": "P-wrapping should not break after <td>s separated by newlines are converted back to pipes",
		"wikitext": "a\n|b\n\n|c\nd",
		"html": "<p>a\n|b\n</p><p>|c\nd\n</p>",
		"render": "<p>a\n|b\n</p><p>|c\nd\n</p>",
		"print": "<span class=\"wpb-root\">a\n|b\n\n|c\nd</span>"
	},
	{
		"desc": "Orphaned table row wikitext with templated table for an attribute should not duplicate table",
		"wikitext": "|-{{1x|\n{{{!}}\n{{!}}foo\n{{!}}}\n}}",
		"html": "<p>|-\n</p>\n<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<p>|-\n</p>\n<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\">|-<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>}</span></span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Template Name/Arg clash: 1. Use of positional param",
		"wikitext": "{{quote|foo}}",
		"html": "<p>foo\n</p>",
		"render": "<p>foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">quote</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Template Name/Arg clash: 2. Use of named param",
		"wikitext": "{{quote|quote=foo}}",
		"html": "<p>foo\n</p>",
		"render": "<p>foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">quote</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">quote</span>=<span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: 1. Simple use",
		"wikitext": "{{1x|Foo}}",
		"html": "<p>Foo\n</p>",
		"render": "<p>Foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: 2. Inside a block tag",
		"wikitext": "<div>{{1x|Foo}}</div>\n<blockquote>{{1x|Foo}}</blockquote>",
		"html": "<div>Foo</div>\n<blockquote><p>Foo</p></blockquote>",
		"render": "<div >Foo</div>\n<blockquote >Foo</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span><span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;blockquote&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span><span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Templates: P-wrapping: 1a. Templates on consecutive lines",
		"wikitext": "{{1x|Foo}}\n{{1x|bar}}",
		"html": "<p>Foo\nbar\n</p>",
		"render": "<p>Foo\nbar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: P-wrapping: 1b. Templates on consecutive lines",
		"wikitext": "Foo\n\n{{1x|bar}}\n{{1x|baz}}",
		"html": "<p>Foo\n</p><p>bar\nbaz\n</p>",
		"render": "<p>Foo\n</p><p>bar\nbaz\n</p>",
		"print": "<span class=\"wpb-root\">Foo\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">baz</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: P-wrapping: 1c. Templates on consecutive lines",
		"wikitext": "{{1x|Foo}}\n{{1x|bar}} <div>baz</div>",
		"html": "<p>Foo\n</p><p>\nbar </p><div>baz</div>",
		"render": "<p>Foo\n</p>\nbar <div >baz</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span> <span class=\"wpb-html\">&lt;div&gt;</span>baz<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: P-wrapping: 1d. Template preceded by comment-only line",
		"wikitext": "<!-- foo -->\n{{1x|Bar}}",
		"html": "<p>Bar\n</p>",
		"render": "<p>Bar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- foo --&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bar</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Scopes should not be expanded unnecessarily",
		"wikitext": "{{1x|<div>a</div>}}b{{1x|\n<div>c</div>}}",
		"html": "<div>a</div><p>b\n</p><div>c</div>",
		"render": "<div >a</div>b\n<div >c</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>a<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span>b<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-html\">&lt;div&gt;</span>c<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Inline Text: 1. Multiple template uses",
		"wikitext": "{{1x|Foo}}bar{{1x|baz}}",
		"html": "<p>Foobarbaz\n</p>",
		"render": "<p>Foobarbaz\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span>bar<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">baz</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Inline Text: 2. Back-to-back template uses",
		"wikitext": "{{1x|Foo}}{{1x|bar}}",
		"html": "<p>Foobar\n</p>",
		"render": "<p>Foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Block Tags: 1. Multiple template uses",
		"wikitext": "{{1x|<div>Foo</div>}}<div>bar</div>{{1x|<div>baz</div>}}",
		"html": "<div>Foo</div><div>bar</div><div>baz</div>",
		"render": "<div >Foo</div><div >bar</div><div >baz</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>Foo<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;div&gt;</span>bar<span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>baz<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Block Tags: 2. Back-to-back template uses",
		"wikitext": "{{1x|<div>Foo</div>}}{{1x|<div>bar</div>}}",
		"html": "<div>Foo</div><div>bar</div>",
		"render": "<div >Foo</div><div >bar</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>Foo<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>bar<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Correctly encapsulate templates producing </p> tag without a corresponding <p> tag",
		"wikitext": "{{1x|a\nb</p>}}",
		"html": "<p>a\n</p><p>\nb</p><p class=\"mw-empty-elt\"></p>",
		"render": "<p>a\n</p>\nb</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\nb<span class=\"wpb-html\">&lt;/p&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Drop stripped tag markers, unless they have encapsulation info",
		"wikitext": "{{1x|<tr></tr>}}",
		"html": "",
		"render": "<tr ></tr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Links: 1. Simple example",
		"wikitext": "{{1x|[[Foo|bar]]}}",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">bar</span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Links: 2. Generation of link href",
		"wikitext": "[[{{1x|Foo}}|bar]]",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span></span>"
	},
	{
		"desc": "Templates: Links: 3. Generation of part of a link href",
		"wikitext": "[[Fo{{1x|o}}|bar]]\n\n[[Foo{{1x|bar}}]]\n\n[[Foo{{1x|bar}}baz]]\n\n[[Foo{{1x|bar}}|bar]]\n\n[[:Foo{{1x|bar}}]]\n\n[[:Foo{{1x|bar}}|bar]]",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">Foobar</a>\n</p><p><a href=\"/wiki/Foobarbaz\" title=\"Foobarbaz\">Foobarbaz</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">bar</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">Foobar</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">Foobar</a>\n</p><p><a href=\"/wiki/Foobarbaz\" title=\"Foobarbaz\">Foobarbaz</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">bar</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">Foobar</a>\n</p><p><a href=\"/wiki/Foobar\" title=\"Foobar\">bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Fo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">o</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span>baz</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Foo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Foo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span></span>"
	},
	{
		"desc": "Templates: Links: 4. Multiple templates generating link href",
		"wikitext": "[[{{1x|F}}{{1x|o}}ob{{1x|ar}}]]",
		"html": "<p><a href=\"/wiki/Foobar\" title=\"Foobar\">Foobar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foobar\" title=\"Foobar\">Foobar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">F</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">o</span></span>}}</span>ob<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ar</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Templates: Links: 5. Generation of link text",
		"wikitext": "[[Foo|{{1x|bar}}]]",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Templates: Links: 5. Nested templates (only outermost template should be marked)",
		"wikitext": "{{1x|[[{{1x|Foo}}|bar]]}}",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "File with template filename",
		"wikitext": "[[File:{{1x|Foobar.jpg}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foobar.jpg</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 1. Generation of HTML attr. key",
		"wikitext": "<div {{1x|style}}=\"color:red;\">foo</div>",
		"html": "<div style=\"color:red;\">foo</div>",
		"render": "<div style=\"color:red;\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">style</span></span>}}</span></span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 2. Generation of HTML attr. value",
		"wikitext": "<div style={{1x|'color:red;'}}>foo</div>",
		"html": "<div style=\"color:red;\">foo</div>",
		"render": "<div style=\"color:red;\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">'color:red;'</span></span>}}</span></span></span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 3. Generation of HTML attr key and value",
		"wikitext": "<div {{1x|style}}={{1x|'color:red;'}}>foo</div>",
		"html": "<div style=\"color:red;\">foo</div>",
		"render": "<div style=\"color:red;\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">style</span></span>}}</span></span>=<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">'color:red;'</span></span>}}</span></span></span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 4. Generation of starting piece of HTML attr value",
		"wikitext": "<div title=\"{{1x|This is a long title}} with just one piece templated\">foo</div>",
		"html": "<div title=\"This is a long title with just one piece templated\">foo</div>",
		"render": "<div title=\"This is a long title with just one piece templated\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">This is a long title</span></span>}}</span> with just one piece templated</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 5. Generation of middle piece of HTML attr value",
		"wikitext": "<div title=\"This is a long title with just {{1x|one piece}} templated\">foo</div>",
		"html": "<div title=\"This is a long title with just one piece templated\">foo</div>",
		"render": "<div title=\"This is a long title with just one piece templated\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">This is a long title with just <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">one piece</span></span>}}</span> templated</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 6. Generation of end piece of HTML attr value",
		"wikitext": "<div title=\"This is a long title with just one piece {{1x|templated}}\">foo</div>",
		"html": "<div title=\"This is a long title with just one piece templated\">foo</div>",
		"render": "<div title=\"This is a long title with just one piece templated\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">This is a long title with just one piece <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">templated</span></span>}}</span></span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 7. Generation of partial attribute key string",
		"wikitext": "<div st{{1x|yle}}=\"color:red;\">foo</div>",
		"html": "<div style=\"color:red;\">foo</div>",
		"render": "<div style=\"color:red;\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">st<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">yle</span></span>}}</span></span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 8. Template-generated attribute (k=v)",
		"wikitext": "<div {{1x|1=id=\"v1\"}}>bar</div>",
		"html": "<div id=\"v1\">bar</div>",
		"render": "<div id=\"v1\">bar</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">id=\"v1\"</span></span>}}</span></span></span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tag: 9. Multiple template-generated attributes",
		"wikitext": "<div {{1x|1=id=\"v1\" title=\"foo\"}}>bar</div>",
		"html": "<div id=\"v1\" title=\"foo\">bar</div>",
		"render": "<div id=\"v1\" title=\"foo\">bar</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">id=\"v1\" title=\"foo\"</span></span>}}</span></span></span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templates: Support for templates generating attributes and content",
		"wikitext": "{| {{mixed_attr_content_template}}\n|-\n|bar\n|}",
		"html": "<table style=\"color:red;\" title=\"T48811\">\n\n<tbody><tr>\n<td>foo\n</td></tr>\n<tr>\n<td>bar\n</td></tr></tbody></table>",
		"render": "<table style=\"color:red;\" title=\"T48811\">\n<tbody><tr >\n<td >foo\n</td></tr><tr >\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">mixed_attr_content_template</span>}}</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templates: Support for templates generating table attributes and content (with fostered categories)",
		"wikitext": "{| {{mixed_attr_content_template_2}}\n|-\n|bar\n|}",
		"html": "<table style=\"color:red;\" title=\"T249740\">\n<tbody><tr>\n<td>foo\n</td></tr>\n<tr>\n<td>bar\n</td></tr></tbody></table>",
		"render": "<table style=\"color:red;\" title=\"T249740\">\n<tbody><tr >\n<td >foo\n</td></tr><tr >\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">mixed_attr_content_template_2</span>}}</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table cell with attribute before expanded attribute",
		"wikitext": "{|\n| align=\"center\" {{attribute_from_template}} |456\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">align</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">attribute_from_template</span>}}</span></span></span> </span>|<span class=\"wpb-td-inner\">456</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "1. Entities and nowikis inside templated attributes should be handled correctly",
		"wikitext": "<div {{1x|style{{=}}\"background:&#35;f9f9f9;\"}}>foo</div>",
		"html": "<div style=\"background:#f9f9f9;\">foo</div>",
		"render": "<div style=\"background:&#35;f9f9f9;\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">style<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">=</span>}}</span>\"background:&amp;#35;f9f9f9;\"</span></span>}}</span></span></span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "2. Entities and nowikis inside templated attributes should be handled correctly",
		"wikitext": "{|\n|{{table_attribs_3}}\n|}",
		"html": "<table>\n<tbody><tr>\n<td style=\"background:#f9f9f9;\">Foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td style=\"background:&#35;f9f9f9;\">Foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_3</span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "3. Entities and nowikis inside templated attributes should be handled correctly inside templated tables",
		"wikitext": "{{tbl-start}}\n|{{table_attribs_3}}\n{{tbl-end}}",
		"html": "<table>\n<tbody><tr>\n<td style=\"background:#f9f9f9;\">Foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td style=\"background:&#35;f9f9f9;\">Foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-start</span>}}</span>\n|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_3</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-end</span>}}</span></span>"
	},
	{
		"desc": "4. Entities and nowikis inside templated attributes should be handled correctly inside templated tables",
		"wikitext": "{|\n|{{table_attribs_6}} hi\n|}",
		"html": "<table>\n<tbody><tr>\n<td style=\"background: red;\">hi\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td style=\"background:    red;\">hi\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_6</span>}}</span> hi</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Extension tag in templated tag attribute",
		"wikitext": "{{1x|1=\n{{{!}} class=\"123\" <nowiki />\n{{!}} hi\n{{!}}}\n}}",
		"html": "<table class=\"123\">\n<tbody><tr>\n<td>hi\n</td></tr></tbody></table>",
		"render": "<table class=\"123\">\n<tbody><tr>\n<td >hi\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span><span class=\"wpb-attr-dirty\"> <span class=\"wpb-ext\">&lt;nowiki<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td-inner\"> hi</span></span><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>}</span></span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 1. Generating start of a HTML table",
		"wikitext": "{{1x|<table><tr><td>foo</td>}}</tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 2a. Generating middle of a HTML table",
		"wikitext": "<table><tr>{{1x|<td>foo</td>}}</tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 2b. Generating middle of a HTML table",
		"wikitext": "<table>{{1x|<tr><td>foo</td></tr>}}</table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 3. Generating end of a HTML table",
		"wikitext": "<table><tr>{{1x|<td>foo</td></tr></table>}}",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 4a. Generating a single tag of a HTML table",
		"wikitext": "{{1x|<table>}}<tr><td>foo</td></tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 4b. Generating a single tag of a HTML table",
		"wikitext": "<table>{{1x|<tr>}}<td>foo</td></tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;tr&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 4c. Generating a single tag of a HTML table",
		"wikitext": "<table><tr>{{1x|<td>}}foo</td></tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;td&gt;</span></span></span>}}</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 4d. Generating a single tag of a HTML table",
		"wikitext": "<table><tr><td>foo{{1x|</td>}}</tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/td&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 4e. Generating a single tag of a HTML table",
		"wikitext": "<table><tr><td>foo</td>{{1x|</tr>}}</table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/tr&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 4f. Generating a single tag of a HTML table",
		"wikitext": "<table><tr><td>foo</td></tr>{{1x|</table>}}",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/table&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: HTML Tables: 5. Proper fostering of categories from inside",
		"wikitext": "<table>[[Category:foo1]]<tr><td>foo</td></tr></table>\n<!--Two categories (T52330)-->\n<table>[[Category:bar1]][[Category:bar2]]<tr><td>foo</td></tr></table>",
		"html": "<table><tbody><tr><td>foo</td></tr></tbody></table>\n<table><tbody><tr><td>foo</td></tr></tbody></table>",
		"render": "<table ><tr ><td >foo</td></tr></table>\n<table ><tr ><td >foo</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:foo1</span>]]</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span>\n<span class=\"wpb-comment\">&lt;!--Two categories (T52330)--&gt;</span>\n<span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:bar1</span>]]</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:bar2</span>]]</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 1a. Fostering of entire template content",
		"wikitext": "{|\n{{1x|a}}\n|}",
		"html": "a\n<table><tbody><tr><td></td></tr></tbody></table>",
		"render": "a<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 1b. Fostering of entire template content",
		"wikitext": "{|\n{{1x|<div>}}\nfoo\n{{1x|</div>}}\n|}",
		"html": "<div>\n<p>foo\n</p>\n</div><table>\n\n<tbody><tr><td></td></tr></tbody></table>",
		"render": "<div > foo </div><table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span></span></span>}}</span>\nfoo\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 2. Fostering of partial template content",
		"wikitext": "{|\n{{1x|a\n<div>b</div>}}\n|}",
		"html": "a\n<div>b</div><table>\n<tbody><tr><td></td></tr></tbody></table>",
		"render": "a <div >b</div><table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\n<span class=\"wpb-html\">&lt;div&gt;</span>b<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 3. td-content via multiple templates",
		"wikitext": "{|\n{{1x|{{pipe}}a}}{{1x|b}}\n|}",
		"html": "<table>\n<tbody><tr>\n<td>ab\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >ab\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">pipe</span>}}</span>a</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 4. Templated tags, no content",
		"wikitext": "{{tbl-start}}\n{{tbl-end}}",
		"html": "<table>\n<tbody><tr><td></td></tr></tbody></table>",
		"render": "<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-start</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-end</span>}}</span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 5. Templated tags, regular td-tags",
		"wikitext": "{{tbl-start}}\n|foo\n{{tbl-end}}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-start</span>}}</span>\n|foo\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-end</span>}}</span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 6. Templated tags, templated td-tags",
		"wikitext": "{{tbl-start}}\n{{!}}foo\n{{tbl-end}}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-start</span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>foo\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-end</span>}}</span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 8. Fosterable meta-tags should get fostered",
		"wikitext": "{{UnclosedTableEndsWithTR}}\n<onlyinclude>\n|foo\n</onlyinclude>\n|}\n\n<noinclude>\n{{UnclosedTableEndsWithTR}}\n</noinclude>\n|foo\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">UnclosedTableEndsWithTR</span>}}</span>\n<span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span>\n|foo\n<span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span>\n|}\n\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">UnclosedTableEndsWithTR</span>}}</span>\n<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>\n|foo\n|}</span>"
	},
	{
		"desc": "Templates: Lists: Multi-line list-items via templates",
		"wikitext": "*{{1x|a {{nonexistent|\nunused}}}}\n*{{1x|b {{nonexistent|\nunused}}}}",
		"html": "<ul><li>a <a href=\"/index.php?title=Template:Nonexistent&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:Nonexistent (page does not exist)\">Template:Nonexistent</a></li>\n<li>b <a href=\"/index.php?title=Template:Nonexistent&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:Nonexistent (page does not exist)\">Template:Nonexistent</a></li></ul>",
		"render": "<ul><li>a <a href=\"/wiki/Template%3ANonexistent?action=edit&redlink=1\" class=\"new\" title=\"Template:Nonexistent (page does not exist)\">Template:Nonexistent</a></li>\n<li>b <a href=\"/wiki/Template%3ANonexistent?action=edit&redlink=1\" class=\"new\" title=\"Template:Nonexistent (page does not exist)\">Template:Nonexistent</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">nonexistent</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\nunused</span></span>}}</span></span></span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">nonexistent</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\nunused</span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly nesting: 1. Quotes opened/closed across templates (1x)",
		"wikitext": "{{1x|''a}}{{1x|b''c''d}}{{1x|''e}}",
		"html": "<p><i>ab</i>c<i>d</i>e\n</p>",
		"render": "<p><i>ab</i>c<i>d</i>e\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>a</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b<span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span>d</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>e</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly nesting: 2. Quotes opened/closed across templates (1x_with_span)",
		"wikitext": "{{1x_with_span|''a}}{{1x_with_span|b''c''d}}{{1x_with_span|''e}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x_with_span</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>a</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x_with_span</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b<span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span>d</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x_with_span</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>e</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly nesting: 3. Quotes opened/closed across templates (1x_with_div)",
		"wikitext": "{{1x_with_div|''a}}{{1x_with_div|b''c''d}}{{1x_with_div|''e}}",
		"html": "<div><i>a</i></div><div><i>b</i>c<i>d</i></div><div>e</div>",
		"render": "<div ><i>a</i></div><div ><i>b</i>c<i>d</i></div><div >e</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x_with_div</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>a</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x_with_div</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b<span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span>d</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x_with_div</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>e</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly nesting: 4. Divs opened/closed across templates",
		"wikitext": "a<div>b{{1x|c</div>d}}e",
		"html": "<p>a</p><div>bc</div><p>de</p>",
		"render": "a<div >bc</div>de",
		"print": "<span class=\"wpb-root\">a<span class=\"wpb-html\">&lt;div&gt;</span>b<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">c<span class=\"wpb-html\">&lt;/div&gt;</span>d</span></span>}}</span>e</span>"
	},
	{
		"desc": "Templates: Ugly templates: 3. newline-only template parameter",
		"wikitext": "foo {{1x|\n}}",
		"html": "<p>foo \n</p>",
		"render": "<p>foo \n</p>",
		"print": "<span class=\"wpb-root\">foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly templates: 4. newline-only template parameter inconsistency",
		"wikitext": "{{1x|\n}}",
		"html": "<p><br />\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly templates: 5. Template encapsulation test: Non-trivial overlap of template ranges is properly handled",
		"wikitext": "{{1x|<table>}}\n{{1x|<div>foo}}\n{{1x|</table>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>foo</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/table&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Ugly templates: 6. Template encapsulation test: Cyclical nesting of template ranges is properly handled",
		"wikitext": "{{1x|<table><tr><td><table>}}\n{{1x|<div>}}\n{{1x|</div>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span><span class=\"wpb-html\">&lt;table&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Parameters substituted at the top-level",
		"wikitext": "{{{foo|''who'' {{1x|me}}? '''never!'''}}}\n\n{{{foo|bar|baz}}}",
		"html": "<p><i>who</i> me? <b>never!</b>\n</p><p>bar\n</p>",
		"render": "<p><i>who</i> me? <b>never!</b>\n</p><p>bar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">foo</span>|<span class=\"wpb-arg-default\"><span class=\"wpb-quote\">''</span>who<span class=\"wpb-quote\">''</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">me</span></span>}}</span>? <span class=\"wpb-quote\">'''</span>never!<span class=\"wpb-quote\">'''</span></span>}}}</span>\n\n<span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">foo</span>|<span class=\"wpb-arg-default\">bar</span>|<span class=\"wpb-hidden\">baz</span>}}}</span></span>"
	},
	{
		"desc": "Templates: Param with empty arg in the final position",
		"wikitext": "{{{hi|}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">hi</span>|}}}</span></span>"
	},
	{
		"desc": "Compound transclusion with template and top level templatearg",
		"wikitext": "{{1x|<table>}}\n{{{top|<td>123</td>}}}\n</table>",
		"html": "<table>\n<tbody><tr><td>123</td>\n</tr></tbody></table>",
		"render": "<table >\n<td >123</td>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span></span></span>}}</span>\n<span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">top</span>|<span class=\"wpb-arg-default\"><span class=\"wpb-html\">&lt;td&gt;</span>123<span class=\"wpb-html\">&lt;/td&gt;</span></span>}}}</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Parser Functions: 1. Simple example",
		"wikitext": "{{uc:foo}}",
		"html": "<p>FOO\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">uc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Parser Functions: 2. Nested use (only outermost should be marked up)",
		"wikitext": "{{uc:{{lc:FOO}}}}",
		"html": "<p>FOO\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">uc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">lc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">FOO</span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Recognize nowiki with odd capitalization",
		"wikitext": "<noWikI ><div>[[foo]]</Nowiki >",
		"html": "<p>&lt;div&gt;[[foo]]\n</p>",
		"render": "<p>&lt;div&gt;[[foo]]\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;noWikI<span class=\"wpb-ext-attrs\"> </span>&gt;<span class=\"wpb-ext-inner\">&lt;div&gt;[[foo]]</span>&lt;/Nowiki &gt;</span></span>"
	},
	{
		"desc": "Parsoid: Escape nowiki with trailing space in tags",
		"wikitext": "&lt;nowiki &gt; foo &lt;/nowiki &gt;\n\na&lt;nowiki /&gt;b\n\nc&lt;nowiki/ &gt;d",
		"print": "<span class=\"wpb-root\">&amp;lt;nowiki &amp;gt; foo &amp;lt;/nowiki &amp;gt;\n\na&amp;lt;nowiki /&amp;gt;b\n\nc&amp;lt;nowiki/ &amp;gt;d</span>"
	},
	{
		"desc": "Parsoid: Escape weird noWikI capitalizations",
		"wikitext": "&lt;noWikI &gt; foo &lt;/NoWikI &gt;",
		"print": "<span class=\"wpb-root\">&amp;lt;noWikI &amp;gt; foo &amp;lt;/NoWikI &amp;gt;</span>"
	},
	{
		"desc": "message transform: magic variables",
		"wikitext": "{{SITENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SITENAME</span>}}</span></span>"
	},
	{
		"desc": "message transform: should not transform wiki markup",
		"wikitext": "''test''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>test<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "message transform: <noinclude> in transcluded template (T6926)",
		"wikitext": "{{Includes}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Includes</span>}}</span></span>"
	},
	{
		"desc": "message transform: <onlyinclude> in transcluded template (T6926)",
		"wikitext": "{{Includes2}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Includes2</span>}}</span></span>"
	},
	{
		"desc": "{{#special:}} page name, known",
		"wikitext": "{{#special:Recentchanges}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#special</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Recentchanges</span></span>}}</span></span>"
	},
	{
		"desc": "{{#special:}} page name with subpage, known",
		"wikitext": "{{#special:Recentchanges/param}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#special</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Recentchanges/param</span></span>}}</span></span>"
	},
	{
		"desc": "{{#special:}} page name, unknown",
		"wikitext": "{{#special:foobar nonexistent}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#special</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foobar nonexistent</span></span>}}</span></span>"
	},
	{
		"desc": "{{#speciale:}} page name, known",
		"wikitext": "{{#speciale:Recentchanges}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#speciale</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Recentchanges</span></span>}}</span></span>"
	},
	{
		"desc": "{{#speciale:}} page name with subpage, known",
		"wikitext": "{{#speciale:Recentchanges/param}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#speciale</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Recentchanges/param</span></span>}}</span></span>"
	},
	{
		"desc": "{{#speciale:}} page name, unknown",
		"wikitext": "{{#speciale:foobar nonexistent}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#speciale</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foobar nonexistent</span></span>}}</span></span>"
	},
	{
		"desc": "Subpage link",
		"wikitext": "[[/subpage]]",
		"html": "<p><a href=\"/wiki/Subpage_test/subpage\" title=\"Subpage test/subpage\">/subpage</a>\n</p>",
		"render": "<p><a href=\"/wiki/%2Fsubpage\" title=\"/subpage\">/subpage</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/subpage</span>]]</span></span>"
	},
	{
		"desc": "Subpage noslash link",
		"wikitext": "[[/subpage/]]",
		"html": "<p><a href=\"/wiki/Subpage_test/subpage\" title=\"Subpage test/subpage\">subpage</a>\n</p>",
		"render": "<p><a href=\"/wiki/%2Fsubpage%2F\" title=\"/subpage/\">/subpage/</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/subpage/</span>]]</span></span>"
	},
	{
		"desc": "Relative subpage noslash link",
		"wikitext": "[[../../subpage/]]\n\n[[../../subpage]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../../subpage/</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../../subpage</span>]]</span></span>"
	},
	{
		"desc": "Parsoid: dot-slash prefixed wikilinks",
		"wikitext": "[[./foo]]\n\n[[././bar]]\n\n[[././baz/]]",
		"html": "<p>[[./foo]]\n</p><p>[[././bar]]\n</p><p>[[././baz/]]\n</p>",
		"render": "<p>[[./foo]]\n</p><p>[[././bar]]\n</p><p>[[././baz/]]\n</p>",
		"print": "<span class=\"wpb-root\">[[./foo]]\n\n[[././bar]]\n\n[[././baz/]]</span>"
	},
	{
		"desc": "Render invalid page names as plain text (T53090)",
		"wikitext": "[[./../foo|bar]]\n[[fooÔøΩ|bar]]\n[[foo/.|bar]]\n[[foo/..|bar]]\n[[foo~~~bar]]\n[[foo>bar]]\n[[foo[bar]]\n[[.]]\n[[..]]\n[[foo././bar]]\n[[foo[http://example.com]xyz]]\n\n[[{{1x|./../foo}}|bar]]\n[[{{1x|foo/.}}|bar]]\n[[{{1x|foo/..}}|bar]]\n[[{{1x|foo~~~~bar}}]]\n[[{{1x|foo>bar}}]]\n[[{{1x|foo././bar}}]]\n[[{{1x|foo{bar}}]]\n[[{{1x|foo}bar}}]]\n[[{{1x|foo[bar}}]]\n[[{{1x|foo]bar}}]]\n[[{{1x|foo<bar}}]]",
		"html": "<p>[[./../foo|bar]]\n[[fooÔøΩ|bar]]\n[[foo/.|bar]]\n[[foo/..|bar]]\n[[foo~~~bar]]\n[[foo&gt;bar]]\n[[foo[bar]]\n[[.]]\n[[..]]\n[[foo././bar]]\n[[foo<a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com\">[1]</a>xyz]]\n</p><p>[[./../foo|bar]]\n[[foo/.|bar]]\n[[foo/..|bar]]\n[[foo~~~~bar]]\n[[foo&gt;bar]]\n[[foo././bar]]\n[[foo{bar]]\n[[foo}bar]]\n[[foo[bar]]\n[[foo]bar]]\n[[foo&lt;bar]]\n</p>",
		"render": "<p>[[./../foo|bar]]\n<a href=\"/wiki/Foo%EF%BF%BD\" title=\"FooÔøΩ\">bar</a>\n[[foo/.|bar]]\n[[foo/..|bar]]\n<a href=\"/wiki/Foo~~~bar\" title=\"Foo~~~bar\">foo~~~bar</a>\n[[foo&gt;bar]]\n[[foo[bar]]\n[[.]]\n[[..]]\n[[foo././bar]]\n[[foo<a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">[1]</a>xyz]]\n</p><p>[[./../foo|bar]]\n[[foo/.|bar]]\n[[foo/..|bar]]\n<a href=\"/wiki/Foo~~~~bar\" title=\"Foo~~~~bar\">foo~~~~bar</a>\n[[foo&gt;bar]]\n[[foo././bar]]\n[[foo{bar]]\n[[foo}bar]]\n[[foo[bar]]\n[[foo]bar]]\n[[foo&lt;bar]]\n</p>",
		"print": "<span class=\"wpb-root\">[[./../foo|bar]]\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">fooÔøΩ</span>|<span class=\"wpb-link-text\">bar</span>]]</span>\n[[foo/.|bar]]\n[[foo/..|bar]]\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">foo~~~bar</span>]]</span>\n[[foo&gt;bar]]\n[[foo[bar]]\n[[.]]\n[[..]]\n[[foo././bar]]\n[[foo<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span>]</span>xyz]]\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">./../foo</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo/.</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo/..</span></span>}}</span></span>|<span class=\"wpb-link-text\">bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo~~~~bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&gt;bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo././bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo{bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo}bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo[bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo]bar</span></span>}}</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&lt;bar</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Disabled subpages",
		"wikitext": "[[/subpage]]",
		"html": "<p><a href=\"/index.php?title=/subpage&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"/subpage (page does not exist)\">/subpage</a>\n</p>",
		"render": "<p><a href=\"/wiki/%2Fsubpage\" title=\"/subpage\">/subpage</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/subpage</span>]]</span></span>"
	},
	{
		"desc": "T2561: {{/Subpage}}",
		"wikitext": "{{/Subpage}}",
		"html": "<p><a href=\"/index.php?title=Page/Subpage&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Page/Subpage (page does not exist)\">Page/Subpage</a>\n</p>",
		"render": "<p><a href=\"/wiki/Template%3A%2FSubpage?action=edit&redlink=1\" class=\"new\" title=\"Template:/Subpage (page does not exist)\">Template:/Subpage</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">/Subpage</span>}}</span></span>"
	},
	{
		"desc": "Subpage with namespaces",
		"wikitext": "[[User:../subpage]]\n[[meatball:../subpage]]",
		"html": "<p>[[User:../subpage]]\n[[meatball:../subpage]]\n</p>",
		"render": "<p>[[User:../subpage]]\n<a href=\"/wiki/Meatball%3A..%2Fsubpage\" title=\"Meatball:../subpage\">meatball:../subpage</a>\n</p>",
		"print": "<span class=\"wpb-root\">[[User:../subpage]]\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">meatball:../subpage</span>]]</span></span>"
	},
	{
		"desc": "T335847: Resolve forward slash title",
		"wikitext": "===123===",
		"html": "<div class=\"mw-heading mw-heading3\"><h3 id=\"123\">123</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=/&amp;action=edit&amp;section=1\" title=\"Edit section: 123\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading3\"><h3 id=\"123\">123</h3></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">123</span>===</span></span>"
	},
	{
		"desc": "T335847: Resolve subpage of control title",
		"wikitext": "[[../Hi]]",
		"html": "<p>[[../Hi]]\n</p>",
		"render": "<p><a href=\"/wiki/..%2FHi\" title=\"../Hi\">../Hi</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../Hi</span>]]</span></span>"
	},
	{
		"desc": "T335847: Resolve subpage of forward slash title",
		"wikitext": "[[../Hi]]",
		"html": "<p><a href=\"/index.php?title=/Hi&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"/Hi (page does not exist)\">/Hi</a>\n</p>",
		"render": "<p><a href=\"/wiki/..%2FHi\" title=\"../Hi\">../Hi</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../Hi</span>]]</span></span>"
	},
	{
		"desc": "Link to category",
		"wikitext": "[[:Category:MediaWiki User's Guide]]",
		"html": "<p><a href=\"/wiki/Category:MediaWiki_User%27s_Guide\" title=\"Category:MediaWiki User&#39;s Guide\">Category:MediaWiki User's Guide</a>\n</p>",
		"render": "<p><a href=\"/wiki/Category%3AMediaWiki_User's_Guide\" title=\"Category:MediaWiki User's Guide\">Category:MediaWiki User's Guide</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Category:MediaWiki User's Guide</span>]]</span></span>"
	},
	{
		"desc": "Simple category",
		"wikitext": "[[Category:MediaWiki User's Guide]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:MediaWiki User's Guide</span>]]</span></span>"
	},
	{
		"desc": "Simple category with whitespace as sort key",
		"wikitext": "[[Category:Foo| ]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>|<span class=\"wpb-link-text\"> </span>]]</span></span>"
	},
	{
		"desc": "PAGESINCATEGORY invalid title fatal (r33546 fix)",
		"wikitext": "{{PAGESINCATEGORY:<bogus>}}",
		"html": "<p>0\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGESINCATEGORY</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">&lt;bogus&gt;</span></span>}}</span></span>"
	},
	{
		"desc": "Category with different sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|Foo]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:MediaWiki User's Guide</span>|<span class=\"wpb-link-text\">Foo</span>]]</span></span>"
	},
	{
		"desc": "Category with identical sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|MediaWiki User's Guide]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:MediaWiki User's Guide</span>|<span class=\"wpb-link-text\">MediaWiki User's Guide</span>]]</span></span>"
	},
	{
		"desc": "Category with identical sort key, except underscores",
		"wikitext": "[[Category:MediaWiki User's Guide|MediaWiki_User's_Guide]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:MediaWiki User's Guide</span>|<span class=\"wpb-link-text\">MediaWiki_User's_Guide</span>]]</span></span>"
	},
	{
		"desc": "Category with newline in sort key",
		"wikitext": "[[Category:Wikidata:Tools|\n*]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Wikidata:Tools</span>|<span class=\"wpb-link-text\">\n*</span>]]</span></span>"
	},
	{
		"desc": "Category with template-generated sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|MediaWiki {{1x|Foo}} Guide]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:MediaWiki User's Guide</span>|<span class=\"wpb-link-text\">MediaWiki <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span> Guide</span>]]</span></span>"
	},
	{
		"desc": "Category / paragraph interactions",
		"wikitext": "Foo [[Category:Baz]] Bar\n\nFoo [[Category:Baz]]\nBar\n\nFoo\n[[Category:Baz]]\nBar\n\nFoo\n[[Category:Baz]] Bar\n\nFoo\n[[Category:Baz]]\n [[Category:Baz]]\n[[Category:Baz]]\nBar\n\n[[Category:Baz]]\n [[Category:Baz]]\n[[Category:Baz]]\n\n[[Category:Baz]]\n {{1x|[[Category:Baz]]}}\n[[Category:Baz]]",
		"html": "<p>Foo  Bar\n</p><p>Foo \nBar\n</p><p>Foo\nBar\n</p><p>Foo Bar\n</p><p>Foo\nBar\n</p>",
		"render": "<p>Foo  Bar\n</p><p>Foo \nBar\n</p><p>Foo\nBar\n</p><p>Foo Bar\n</p><p>Foo\nBar\n</p>",
		"print": "<span class=\"wpb-root\">Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span> Bar\n\nFoo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\nBar\n\nFoo\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\nBar\n\nFoo\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span> Bar\n\nFoo\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\nBar\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span></span></span>}}</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span></span>"
	},
	{
		"desc": "Category / non-newline whitespace interactions (T359886)",
		"wikitext": "* Foo[[Category:Foo]]Bar\n* Foo[[Category:Foo]] Bar\n* Foo [[Category:Foo]]Bar\n* Foo [[Category:Foo]] Bar\n\n* Foo[[Category:Foo]][[Category:Bar]]Bar\n* Foo[[Category:Foo]][[Category:Bar]] Bar\n* Foo[[Category:Foo]] [[Category:Bar]]Bar\n* Foo[[Category:Foo]] [[Category:Bar]] Bar\n* Foo [[Category:Foo]][[Category:Bar]]Bar\n* Foo [[Category:Foo]][[Category:Bar]] Bar\n* Foo [[Category:Foo]] [[Category:Bar]]Bar\n* Foo [[Category:Foo]] [[Category:Bar]] Bar",
		"html": "<ul><li>FooBar</li>\n<li>Foo Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li></ul>\n<ul><li>FooBar</li>\n<li>Foo Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li>\n<li>Foo  Bar</li>\n<li>Foo   Bar</li></ul>",
		"render": "<ul><li>FooBar</li>\n<li>Foo Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li></ul>\n<ul><li>FooBar</li>\n<li>Foo Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li>\n<li>Foo  Bar</li>\n<li>Foo   Bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>Foo<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> Bar\n\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span> Bar</span>"
	},
	{
		"desc": "Language link / non-newline whitespace interactions (T359886)",
		"wikitext": "* Foo[[es:Foo]]Bar\n* Foo[[es:Foo]] Bar\n* Foo [[es:Foo]]Bar\n* Foo [[es:Foo]] Bar\n\n* Foo[[es:Foo]][[es:Bar]]Bar\n* Foo[[es:Foo]][[es:Bar]] Bar\n* Foo[[es:Foo]] [[es:Bar]]Bar\n* Foo[[es:Foo]] [[es:Bar]] Bar\n* Foo [[es:Foo]][[es:Bar]]Bar\n* Foo [[es:Foo]][[es:Bar]] Bar\n* Foo [[es:Foo]] [[es:Bar]]Bar\n* Foo [[es:Foo]] [[es:Bar]] Bar",
		"html": "<ul><li>FooBar</li>\n<li>Foo Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li></ul>\n<ul><li>FooBar</li>\n<li>Foo Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li>\n<li>Foo Bar</li>\n<li>Foo  Bar</li>\n<li>Foo  Bar</li>\n<li>Foo   Bar</li></ul>",
		"render": "<ul><li>Foo<a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a>Bar</li>\n<li>Foo<a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a> Bar</li>\n<li>Foo <a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a>Bar</li>\n<li>Foo <a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a> Bar</li></ul>\n<ul><li>Foo<a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a><a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a>Bar</li>\n<li>Foo<a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a><a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a> Bar</li>\n<li>Foo<a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a> <a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a>Bar</li>\n<li>Foo<a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a> <a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a> Bar</li>\n<li>Foo <a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a><a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a>Bar</li>\n<li>Foo <a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a><a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a> Bar</li>\n<li>Foo <a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a> <a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a>Bar</li>\n<li>Foo <a href=\"/wiki/Es%3AFoo\" title=\"Es:Foo\">es:Foo</a> <a href=\"/wiki/Es%3ABar\" title=\"Es:Bar\">es:Bar</a> Bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>Foo<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span> Bar\n\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span> Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span>Bar\n<span class=\"wpb-list\">* </span>Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Foo</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Bar</span>]]</span> Bar</span>"
	},
	{
		"desc": "1. Categories and newlines: All preceding newlines should be suppressed (courtesy T2087)",
		"wikitext": "This\n   \n[[Category:Foo]] and this should be part of same paragraph (not an indent-pre)\n   \n{{1x|[[Category:Foo]] and so should this!}}",
		"html": "<p>This and this should be part of same paragraph (not an indent-pre) and so should this!\n</p>",
		"render": "<p>This and this should be part of same paragraph (not an indent-pre) and so should this!\n</p>",
		"print": "<span class=\"wpb-root\">This\n   \n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> and this should be part of same paragraph (not an indent-pre)\n   \n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> and so should this!</span></span>}}</span></span>"
	},
	{
		"desc": "2. Categories and newlines: All preceding newlines should be suppressed (courtesy T2087)",
		"wikitext": "* This\n   \n[[Category:Foo]] and this should be part of the same list item\n* So should this\n\n{{1x|[[Category:Foo]] and this should be part of the same list item}}",
		"html": "<ul><li>This and this should be part of the same list item</li>\n<li>So should this and this should be part of the same list item</li></ul>",
		"render": "<ul><li>This and this should be part of the same list item</li>\n<li>So should this and this should be part of the same list item</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>This\n   \n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> and this should be part of the same list item\n<span class=\"wpb-list\">* </span>So should this\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span> and this should be part of the same list item</span></span>}}</span></span>"
	},
	{
		"desc": "3. Categories and newlines: newline suppression for last list item should RT properly",
		"wikitext": "*a\n*b\n   \n[[Category:Foo]]\n   \n[[Category:Bar]]\n[[Category:Baz]]\n\n:c\n\n[[Category:C]]\n\n;d\n\n[[Category:D]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">*</span>b\n   \n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n   \n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span>\n\n<span class=\"wpb-list\">:</span>c\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:C</span>]]</span>\n\n<span class=\"wpb-list\">;</span>d\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:D</span>]]</span></span>"
	},
	{
		"desc": "4. Categories and newlines: newline suppression for last list item should RT properly",
		"wikitext": "*a\n****b\n\n[[Category:Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">****</span>b\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span></span>"
	},
	{
		"desc": "5. Categories and newlines: migrateTrailingCategories dom pass should only run on the rightmost path of nested lists",
		"wikitext": "*a\n**b\n[[Category:Foo]]\n*c\n**d\n[[Category:Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">**</span>b\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n<span class=\"wpb-list\">*</span>c\n<span class=\"wpb-list\">**</span>d\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span></span>"
	},
	{
		"desc": "6. Categories and newlines: migrateTrailingCategories dom pass should not migrate categories not preceded by newlines",
		"wikitext": "*a [[Category:Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span></span>"
	},
	{
		"desc": "7. Categories and newlines: migrateTrailingCategories dom pass should leave template content alone",
		"wikitext": "*{{1x|a\n[[Category:Foo]]}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "8. Categories and newlines: migrateTrailingCategories dom pass should not get tripped by intervening templates",
		"wikitext": "*a\n\n{{1x|[[Category:Foo]]\n[[Category:Bar]]}}\n[[Category:Baz]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span></span></span>}}</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span></span>"
	},
	{
		"desc": "Categories and newlines: migrateTrailingCategories dom pass should not get tripped by comments and whitespace",
		"wikitext": "*a\n\n[[Category:Bar]]<!--boo1--> <!--boo2-->\n[[Category:Baz]]<!--boo3--> <!--boo4-->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span><span class=\"wpb-comment\">&lt;!--boo1--&gt;</span> <span class=\"wpb-comment\">&lt;!--boo2--&gt;</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span><span class=\"wpb-comment\">&lt;!--boo3--&gt;</span> <span class=\"wpb-comment\">&lt;!--boo4--&gt;</span></span>"
	},
	{
		"desc": "No regressions on internal links following category (T174639)",
		"wikitext": "[[Category:Foo]]<div>a\n\n[[Foo]]</div>",
		"html": "<div>a\n<a href=\"/wiki/Foo\" title=\"Foo\">Foo</a></div>",
		"render": "<div >a\n<a href=\"/wiki/Foo\" title=\"Foo\">Foo</a></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span><span class=\"wpb-html\">&lt;div&gt;</span>a\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "11. Special case where only newlines separate links (T175416)",
		"wikitext": "[[Category:Foo]]\n\n[[Foo]][[es:Alimento]]\n\n[[Foo]]",
		"html": "<p><br />\n<a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>\n</p>",
		"render": "<p><br>\n<a href=\"/wiki/Foo\" title=\"Foo\">Foo</a><a href=\"/wiki/Es%3AAlimento\" title=\"Es:Alimento\">es:Alimento</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Foo</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Alimento</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span>"
	},
	{
		"desc": "Category links with multiple namespaces",
		"wikitext": "[[Category:Project:Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Project:Foo</span>]]</span></span>"
	},
	{
		"desc": "Parsoid: Serialize link to category page with colon escape",
		"wikitext": "[[:Category:Foo]]\n[[:Category:Foo|Bar]]",
		"html": "<p><a href=\"/index.php?title=Category:Foo&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Category:Foo (page does not exist)\">Category:Foo</a>\n<a href=\"/index.php?title=Category:Foo&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Category:Foo (page does not exist)\">Bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/Category%3AFoo\" title=\"Category:Foo\">Category:Foo</a>\n<a href=\"/wiki/Category%3AFoo\" title=\"Category:Foo\">Bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Category:Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Category:Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span></span>"
	},
	{
		"desc": "Parsoid: Serialize link to file page with colon escape",
		"wikitext": "[[:File:Foo.png]]\n[[:File:Foo.png|Bar]]",
		"html": "<p><a href=\"/index.php?title=File:Foo.png&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"File:Foo.png (page does not exist)\">File:Foo.png</a>\n<a href=\"/index.php?title=File:Foo.png&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"File:Foo.png (page does not exist)\">Bar</a>\n</p>",
		"render": "<p><a href=\"/wiki/File%3AFoo.png\" title=\"File:Foo.png\">File:Foo.png</a>\n<a href=\"/wiki/File%3AFoo.png\" title=\"File:Foo.png\">Bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:File:Foo.png</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:File:Foo.png</span>|<span class=\"wpb-link-text\">Bar</span>]]</span></span>"
	},
	{
		"desc": "Parsoid: Serialize a genuine category link without colon escape",
		"wikitext": "[[Category:Foo]]\n[[Category:Foo|Bar]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span></span>"
	},
	{
		"desc": "Normalize hrefs properly before testing for invalid link targets (T72894)",
		"wikitext": "[[Category:Toxine bact√©rienne]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Toxine bact√©rienne</span>]]</span></span>"
	},
	{
		"desc": "Empty templates should be handled properly without being redlinked",
		"wikitext": "{{emptytemplate}}",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">emptytemplate</span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Defaultsort",
		"wikitext": "{{DEFAULTSORT:Foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DEFAULTSORT</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Defaultsort variations (T236846)",
		"wikitext": "{{DEFAULTSORT}}\n\n{{DEFAULTSORT:}}\n{{DEFAULTSORT:DOGGIE}}",
		"html": "<p><a href=\"/index.php?title=Template:DEFAULTSORT&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:DEFAULTSORT (page does not exist)\">Template:DEFAULTSORT</a>\n</p><p><br />\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DEFAULTSORT</span>}}</span>\n\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DEFAULTSORT</span>:}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DEFAULTSORT</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">DOGGIE</span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid html2wt b/c check: Defaultsort with key content being added (T236846)",
		"wikitext": "{{DEFAULTSORT:BIRD}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DEFAULTSORT</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">BIRD</span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Defaultsort (template-generated)",
		"wikitext": "{{{{1x|DEFAULTSORT}}:Foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">DEFAULTSORT</span></span>}}</span>:Foo</span>}}</span></span>"
	},
	{
		"desc": "{{defaultsort}} should be location-independent (T353530)",
		"wikitext": "[[Category:Foo]]\n{{DEFAULTSORT:Bar}}\n[[Category:Bat]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DEFAULTSORT</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bar</span></span>}}</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bat</span>]]</span></span>"
	},
	{
		"desc": "Interlanguage links",
		"wikitext": "[[es:Alimento]]\n[[fr:Nourriture]]\n[[zh:È£üÂìÅ]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Alimento</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">fr:Nourriture</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">zh:È£üÂìÅ</span>]]</span></span>"
	},
	{
		"desc": "Duplicate interlanguage links (T26502)",
		"wikitext": "[[es:1]]\n[[es:2]]\n[[fr:1]]\n[[fr:2]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:1</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:2</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">fr:1</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">fr:2</span>]]</span></span>"
	},
	{
		"desc": "Single-line or multiline-comments can follow headings",
		"wikitext": "==foo==<!---->\n==bar==<!--c1-->\n==baz==<!--\nc2\nc3-->",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"foo\">foo</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: foo\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"bar\">bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"baz\">baz</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: baz\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"foo\">foo</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"bar\">bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"baz\">baz</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">foo</span>==<span class=\"wpb-heading-trail\"><span class=\"wpb-comment\">&lt;!----&gt;</span></span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">bar</span>==<span class=\"wpb-heading-trail\"><span class=\"wpb-comment\">&lt;!--c1--&gt;</span></span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">baz</span>==<span class=\"wpb-heading-trail\"><span class=\"wpb-comment\">&lt;!--\nc2\nc3--&gt;</span></span></span></span>"
	},
	{
		"desc": "T3186 news: in the middle of text",
		"wikitext": "http://en.wikinews.org/wiki/Wikinews:Workplace",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://en.wikinews.org/wiki/Wikinews:Workplace\">http://en.wikinews.org/wiki/Wikinews:Workplace</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://en.wikinews.org/wiki/Wikinews:Workplace\">http://en.wikinews.org/wiki/Wikinews:Workplace</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://en.wikinews.org/wiki/Wikinews:Workplace</span></span>"
	},
	{
		"desc": "Namespaced link must have a title",
		"wikitext": "[[Project:]]",
		"html": "<p>[[Project:]]\n</p>",
		"render": "<p>[[Project:]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Project:]]</span>"
	},
	{
		"desc": "Namespaced link must have a title (bad fragment version)",
		"wikitext": "[[Project:#fragment]]",
		"html": "<p>[[Project:#fragment]]\n</p>",
		"render": "<p>[[Project:#fragment]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Project:#fragment]]</span>"
	},
	{
		"desc": "div with no attributes",
		"wikitext": "<div>HTML rocks</div>",
		"html": "<div>HTML rocks</div>",
		"render": "<div >HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with double-quoted attribute",
		"wikitext": "<div id=\"rock\">HTML rocks</div>",
		"html": "<div id=\"rock\">HTML rocks</div>",
		"render": "<div id=\"rock\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">rock</span>\"</span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with single-quoted attribute",
		"wikitext": "<div id='rock'>HTML rocks</div>",
		"html": "<div id=\"rock\">HTML rocks</div>",
		"render": "<div id=\"rock\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>='<span class=\"wpb-attr-value\">rock</span>'</span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with unquoted attribute",
		"wikitext": "<div id=rock>HTML rocks</div>",
		"html": "<div id=\"rock\">HTML rocks</div>",
		"render": "<div id=\"rock\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=<span class=\"wpb-attr-value\">rock</span></span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with illegal double attributes",
		"wikitext": "<div id=\"a\" id=\"b\">HTML rocks</div>",
		"html": "<div id=\"b\">HTML rocks</div>",
		"render": "<div id=\"b\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with empty attribute value, space before equals",
		"wikitext": "<div class =>HTML rocks</div>",
		"html": "<div class=\"\">HTML rocks</div>",
		"render": "<div class=\"\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span> =</span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with multiple empty attribute values",
		"wikitext": "<div id= title=>HTML rocks</div>",
		"html": "<div id=\"title=\">HTML rocks</div>",
		"render": "<div id=\"title=\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>= <span class=\"wpb-attr-value\">title=</span></span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Extension tag in attribute value",
		"wikitext": "<span title=\"<html><div>123</div></html>\">ok</span>",
		"print": "<span class=\"wpb-root\">&lt;span title=\"&lt;html&gt;<span class=\"wpb-html\">&lt;div&gt;</span>123<span class=\"wpb-html\">&lt;/div&gt;</span>&lt;/html&gt;\"&gt;ok<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "table with multiple empty attribute values",
		"wikitext": "{| title= id=\n|hi\n|}",
		"html": "<table title=\"id=\">\n<tbody><tr>\n<td>hi\n</td></tr></tbody></table>",
		"render": "<table title=\"id=\">\n<tbody><tr>\n<td >hi\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">title</span>= <span class=\"wpb-attr-value\">id=</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">hi</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "div with braces in attribute value",
		"wikitext": "<div title=\"{}\">Foo</div>",
		"html": "<div title=\"&#123;&#125;\">Foo</div>",
		"render": "<div title=\"{}\">Foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">{}</span>\"</span></span>&gt;</span>Foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "div with empty attribute value, no space before equals",
		"wikitext": "<div class=>HTML rocks</div>",
		"html": "<div class=\"\">HTML rocks</div>",
		"render": "<div class=\"\">HTML rocks</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=</span></span>&gt;</span>HTML rocks<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "HTML multiple attributes correction",
		"wikitext": "<p class=\"error\" class=\"awesome\">Awesome!</p>",
		"html": "<p class=\"awesome\">Awesome!</p>",
		"render": "<p class=\"awesome\">Awesome!</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">error</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">awesome</span>\"</span></span>&gt;</span>Awesome!<span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Table multiple attributes correction",
		"wikitext": "{|\n!+ class=\"error\" class=\"awesome\"|status\n|}",
		"html": "<table>\n<tbody><tr>\n<th class=\"awesome\">status\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th class=\"awesome\">status\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">+ </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">error</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">awesome</span>\"</span></span>|<span class=\"wpb-td-inner\">status</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "DIV IN UPPERCASE",
		"wikitext": "<DIV ID=\"x\">HTML ROCKS</DIV>",
		"html": "<div id=\"x\">HTML ROCKS</div>",
		"render": "<div id=\"x\">HTML ROCKS</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;DIV<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">ID</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>HTML ROCKS<span class=\"wpb-html\">&lt;/DIV&gt;</span></span>"
	},
	{
		"desc": "Non-ASCII pseudo-tags are rendered as text",
		"wikitext": "<khy√¥>",
		"html": "<p>&lt;khy√¥&gt;\n</p>",
		"render": "<p>&lt;khy√¥&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;khy√¥&gt;</span>"
	},
	{
		"desc": "Pseudo-tag with URL 'name' renders as url link",
		"wikitext": "<http://example.com/>",
		"html": "<p>&lt;<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a>&gt;\n</p>",
		"render": "<p>&lt;<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a>&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;<span class=\"wpb-free-ext-link\">http://example.com/</span>&gt;</span>"
	},
	{
		"desc": "text with amp in the middle of nowhere",
		"wikitext": "Remember AT&T?",
		"html": "<p>Remember AT&amp;T?\n</p>",
		"render": "<p>Remember AT&T?\n</p>",
		"print": "<span class=\"wpb-root\">Remember AT&amp;T?</span>"
	},
	{
		"desc": "text with character entity: eacute",
		"wikitext": "I always thought &eacute; was a cute letter.",
		"html": "<p>I always thought &#233; was a cute letter.\n</p>",
		"render": "<p>I always thought &eacute; was a cute letter.\n</p>",
		"print": "<span class=\"wpb-root\">I always thought &amp;eacute; was a cute letter.</span>"
	},
	{
		"desc": "text with entity-escaped character entity-like string: eacute",
		"wikitext": "I always thought &amp;eacute; was a cute letter.",
		"html": "<p>I always thought &amp;eacute; was a cute letter.\n</p>",
		"render": "<p>I always thought &amp;eacute; was a cute letter.\n</p>",
		"print": "<span class=\"wpb-root\">I always thought &amp;amp;eacute; was a cute letter.</span>"
	},
	{
		"desc": "text with undefined character entity: xacute",
		"wikitext": "I always thought &xacute; was a cute letter.",
		"html": "<p>I always thought &amp;xacute; was a cute letter.\n</p>",
		"render": "<p>I always thought &xacute; was a cute letter.\n</p>",
		"print": "<span class=\"wpb-root\">I always thought &amp;xacute; was a cute letter.</span>"
	},
	{
		"desc": "Text with HTML5 semicolon-less entity (should not decode)",
		"wikitext": "&ampamp;",
		"html": "<p>&amp;ampamp;\n</p>",
		"render": "<p>&amp;ampamp;\n</p>",
		"print": "<span class=\"wpb-root\">&amp;ampamp;</span>"
	},
	{
		"desc": "HTML5 tags",
		"wikitext": "<data value=\"5\">five</data>\n<time datetime=\"2000-01-01T00:00Z\">The new millenium started</time>\n<mark>This highlighted text</mark>",
		"html": "<p><data value=\"5\">five</data>\n<time datetime=\"2000-01-01T00:00Z\">The new millenium started</time>\n<mark>This highlighted text</mark>\n</p>",
		"render": "<p><data value=\"5\">five</data>\n<time datetime=\"2000-01-01T00:00Z\">The new millenium started</time>\n<mark >This highlighted text</mark>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;data<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">value</span>=\"<span class=\"wpb-attr-value\">5</span>\"</span></span>&gt;</span>five<span class=\"wpb-html\">&lt;/data&gt;</span>\n<span class=\"wpb-html\">&lt;time<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">datetime</span>=\"<span class=\"wpb-attr-value\">2000-01-01T00:00Z</span>\"</span></span>&gt;</span>The new millenium started<span class=\"wpb-html\">&lt;/time&gt;</span>\n<span class=\"wpb-html\">&lt;mark&gt;</span>This highlighted text<span class=\"wpb-html\">&lt;/mark&gt;</span></span>"
	},
	{
		"desc": "HTML tag with leading space is parsed as text",
		"wikitext": "< div>foo< /div>",
		"html": "<p>&lt; div&gt;foo&lt; /div&gt;\n</p>",
		"render": "<p>&lt; div&gt;foo&lt; /div&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt; div&gt;foo&lt; /div&gt;</span>"
	},
	{
		"desc": "Element with broken attribute syntax",
		"wikitext": "<div style=\" style=\"123\">hi</div>\n<div =>ho</div>",
		"html": "<div style=\"style=\">hi</div>\n<div>ho</div>",
		"render": "<div style=\"style=\">hi</div>\n<div >ho</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"> style=</span>\"</span><span class=\"wpb-attr-dirty\">123\"</span></span>&gt;</span>hi<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"><span class=\"wpb-attr-dirty\"> =</span></span>&gt;</span>ho<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Ensure that HTML adoption agency algorithm is properly implemented.",
		"wikitext": "<small>X<small>Y</small>Z</small>",
		"html": "<p><small>X<small>Y</small>Z</small>\n</p>",
		"render": "<p><small >X<small >Y</small>Z</small>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;small&gt;</span>X<span class=\"wpb-html\">&lt;small&gt;</span>Y<span class=\"wpb-html\">&lt;/small&gt;</span>Z<span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "Nesting of <kbd>",
		"wikitext": "<kbd>X<kbd>Y</kbd>Z</kbd>",
		"html": "<p><kbd>X<kbd>Y</kbd>Z</kbd>\n</p>",
		"render": "<p><kbd >X<kbd >Y</kbd>Z</kbd>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;kbd&gt;</span>X<span class=\"wpb-html\">&lt;kbd&gt;</span>Y<span class=\"wpb-html\">&lt;/kbd&gt;</span>Z<span class=\"wpb-html\">&lt;/kbd&gt;</span></span>"
	},
	{
		"desc": "Nesting of <em>",
		"wikitext": "<em>X<em>Y</em>Z</em>",
		"html": "<p><em>X<em>Y</em>Z</em>\n</p>",
		"render": "<p><em >X<em >Y</em>Z</em>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;em&gt;</span>X<span class=\"wpb-html\">&lt;em&gt;</span>Y<span class=\"wpb-html\">&lt;/em&gt;</span>Z<span class=\"wpb-html\">&lt;/em&gt;</span></span>"
	},
	{
		"desc": "Nesting of <strong>",
		"wikitext": "<strong>X<strong>Y</strong>Z</strong>",
		"html": "<p><strong>X<strong>Y</strong>Z</strong>\n</p>",
		"render": "<p><strong >X<strong >Y</strong>Z</strong>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;strong&gt;</span>X<span class=\"wpb-html\">&lt;strong&gt;</span>Y<span class=\"wpb-html\">&lt;/strong&gt;</span>Z<span class=\"wpb-html\">&lt;/strong&gt;</span></span>"
	},
	{
		"desc": "Nesting of <q>",
		"wikitext": "<q>X<q>Y</q>Z</q>",
		"html": "<p><q>X<q>Y</q>Z</q>\n</p>",
		"render": "<p><q >X<q >Y</q>Z</q>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;q&gt;</span>X<span class=\"wpb-html\">&lt;q&gt;</span>Y<span class=\"wpb-html\">&lt;/q&gt;</span>Z<span class=\"wpb-html\">&lt;/q&gt;</span></span>"
	},
	{
		"desc": "Nesting of <ruby>",
		"wikitext": "<ruby>X<ruby>Y</ruby>Z</ruby>",
		"html": "<p><ruby>X<ruby>Y</ruby>Z</ruby>\n</p>",
		"render": "<p><ruby >X<ruby >Y</ruby>Z</ruby>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ruby&gt;</span>X<span class=\"wpb-html\">&lt;ruby&gt;</span>Y<span class=\"wpb-html\">&lt;/ruby&gt;</span>Z<span class=\"wpb-html\">&lt;/ruby&gt;</span></span>"
	},
	{
		"desc": "Nesting of <bdo>",
		"wikitext": "<bdo>X<bdo>Y</bdo>Z</bdo>",
		"html": "<p><bdo>X<bdo>Y</bdo>Z</bdo>\n</p>",
		"render": "<p><bdo >X<bdo >Y</bdo>Z</bdo>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;bdo&gt;</span>X<span class=\"wpb-html\">&lt;bdo&gt;</span>Y<span class=\"wpb-html\">&lt;/bdo&gt;</span>Z<span class=\"wpb-html\">&lt;/bdo&gt;</span></span>"
	},
	{
		"desc": "Media link",
		"wikitext": "[[Media:Foobar.jpg]]\n[[Media:Video.ogv]]\n[[:Media:Video.ogv]]",
		"html": "<p><a href=\"http://example.com/images/3/3a/Foobar.jpg\" class=\"internal\" title=\"Foobar.jpg\">Media:Foobar.jpg</a>\n<a href=\"http://example.com/images/0/00/Video.ogv\" class=\"internal\" title=\"Video.ogv\">Media:Video.ogv</a>\n<a href=\"http://example.com/images/0/00/Video.ogv\" class=\"internal\" title=\"Video.ogv\">Media:Video.ogv</a>\n</p>",
		"render": "<p><a href=\"/wiki/Media%3AFoobar.jpg\" title=\"Foobar.jpg\">Media:Foobar.jpg</a>\n<a href=\"/wiki/Media%3AVideo.ogv\" title=\"Video.ogv\">Media:Video.ogv</a>\n<a href=\"/wiki/Media%3AVideo.ogv\" title=\"Video.ogv\">Media:Video.ogv</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Foobar.jpg</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Video.ogv</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Media:Video.ogv</span>]]</span></span>"
	},
	{
		"desc": "Media link with text",
		"wikitext": "[[Media:Foobar.jpg|A neat file to look at]]",
		"html": "<p><a href=\"http://example.com/images/3/3a/Foobar.jpg\" class=\"internal\" title=\"Foobar.jpg\">A neat file to look at</a>\n</p>",
		"render": "<p><a href=\"/wiki/Media%3AFoobar.jpg\" title=\"Foobar.jpg\">A neat file to look at</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Foobar.jpg</span>|<span class=\"wpb-link-text\">A neat file to look at</span>]]</span></span>"
	},
	{
		"desc": "Media link redirect",
		"wikitext": "[[Media:Redirect to foobar.jpg]]",
		"html": "<p><a href=\"http://example.com/images/3/3a/Foobar.jpg\" class=\"internal\" title=\"Foobar.jpg\">Media:Redirect to foobar.jpg</a>\n</p>",
		"render": "<p><a href=\"/wiki/Media%3AFoobar.jpg\" title=\"Foobar.jpg\">Media:Redirect to foobar.jpg</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Redirect to foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Media link with nasty text",
		"wikitext": "[[Media:Foobar.jpg|Safe Link<div style=display:none>\" onmouseover=\"alert(document.cookie)\" onfoo=\"</div>]]",
		"html": "<p><a href=\"http://example.com/images/3/3a/Foobar.jpg\" class=\"internal\" title=\"Foobar.jpg\">Safe Link</a></p><a href=\"http://example.com/images/3/3a/Foobar.jpg\" class=\"internal\" title=\"Foobar.jpg\"><div style=\"display:none\">\" onmouseover=\"alert(document.cookie)\" onfoo=\"</div></a>",
		"render": "<a href=\"/wiki/Media%3AFoobar.jpg\" title=\"Foobar.jpg\">Safe Link<div style=\"display:none\">\" onmouseover=\"alert(document.cookie)\" onfoo=\"</div></a>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Foobar.jpg</span>|<span class=\"wpb-link-text\">Safe Link<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=<span class=\"wpb-attr-value\">display:none</span></span></span>&gt;</span>\" onmouseover=\"alert(document.cookie)\" onfoo=\"<span class=\"wpb-html\">&lt;/div&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "Media link from missing resource (parsoid-only)",
		"wikitext": "[[Media:Foobar.jpg|Bat!]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Foobar.jpg</span>|<span class=\"wpb-link-text\">Bat!</span>]]</span></span>"
	},
	{
		"desc": "Media link from old 1.7.0 DOM spec (crash test, parsoid-only) T198511",
		"wikitext": "This is what Parsoid would emit (and we still handle this HTML fine):\n\n[[Media:Foobar.jpg|A neat file to look at]]\n\nBut VisualEditor would mangle the rel attribute, and give us back this:\n\n[http://example.com/images/3/3a/Foobar.jpg A neat file to look at]\n\nBut at least we don't crash when trying to handle the mangled HTML!",
		"print": "<span class=\"wpb-root\">This is what Parsoid would emit (and we still handle this HTML fine):\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Foobar.jpg</span>|<span class=\"wpb-link-text\">A neat file to look at</span>]]</span>\n\nBut VisualEditor would mangle the rel attribute, and give us back this:\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/images/3/3a/Foobar.jpg</span> <span class=\"wpb-ext-link-text\">A neat file to look at</span>]</span>\n\nBut at least we don't crash when trying to handle the mangled HTML!</span>"
	},
	{
		"desc": "Media link to nonexistent file (T3702)",
		"wikitext": "[[Media:No such.jpg]]\n[[Media:No_such file.jpg]]",
		"html": "<p><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=No_such.jpg\" class=\"new\" title=\"No such.jpg\">Media:No such.jpg</a>\n<a href=\"/index.php?title=Special:Upload&amp;wpDestFile=No_such_file.jpg\" class=\"new\" title=\"No such file.jpg\">Media:No_such file.jpg</a>\n</p>",
		"render": "<p><a href=\"/wiki/Media%3ANo_such.jpg\" title=\"No such.jpg\">Media:No such.jpg</a>\n<a href=\"/wiki/Media%3ANo_such_file.jpg\" title=\"No such file.jpg\">Media:No_such file.jpg</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:No such.jpg</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:No_such file.jpg</span>]]</span></span>"
	},
	{
		"desc": "Media link with nested wikilinks",
		"wikitext": "[[Media:Foobar.jpg|[[Test]]]]\n[[Media:Foobar.jpg|[[File:Foobar.jpg]]]]",
		"html": "<p>[[Media:Foobar.jpg|<a href=\"/wiki/Test\" title=\"Test\">Test</a>]]\n[[Media:Foobar.jpg|<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>]]\n</p>",
		"render": "<p>[[Media:Foobar.jpg|<a href=\"/wiki/Test\" title=\"Test\">Test</a>]]\n[[Media:Foobar.jpg|<span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Media:Foobar.jpg|<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>]]</span>]]\n[[Media:Foobar.jpg|<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span>]]</span>"
	},
	{
		"desc": "Media link with multiple options",
		"wikitext": "[[Media:Foobar.jpg|123|345]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Foobar.jpg</span>|<span class=\"wpb-link-text\">123|345</span>]]</span></span>"
	},
	{
		"desc": "Character reference normalization in link text (T3938)",
		"wikitext": "[[Main Page|this&that]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">this&amp;that</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">this&that</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">this&amp;that</span>]]</span></span>"
	},
	{
		"desc": "(T21451) Links should refer to the normalized form.",
		"wikitext": "[[&#xFB2E;]]\n[[&#x5d0;&#x5b7;]]\n[[&#x5d0;÷∑]]\n[[◊ê&#x5b7;]]\n[[◊ê÷∑]]",
		"html": "<p><a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">&#xfb2e;</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">&#x5d0;&#x5b7;</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">&#x5d0;÷∑</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">◊ê&#x5b7;</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">◊ê÷∑</a>\n</p>",
		"render": "<p><a href=\"/wiki/%EF%AC%AE\" title=\"Ô¨Æ\">&#xFB2E;</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">&#x5d0;&#x5b7;</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">&#x5d0;÷∑</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">◊ê&#x5b7;</a>\n<a href=\"/wiki/%D7%90%D6%B7\" title=\"◊ê÷∑\">◊ê÷∑</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">&amp;#xFB2E;</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">&amp;#x5d0;&amp;#x5b7;</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">&amp;#x5d0;÷∑</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">◊ê&amp;#x5b7;</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">◊ê÷∑</span>]]</span></span>"
	},
	{
		"desc": "Empty attribute crash test (T4067)",
		"wikitext": "<font color=\"\">foo</font>",
		"html": "<p><font color=\"\">foo</font>\n</p>",
		"render": "<p><font color=\"\">foo</font>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=\"\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "Empty attribute crash test single-quotes (T4067)",
		"wikitext": "<font color=''>foo</font>",
		"html": "<p><font color=\"\">foo</font>\n</p>",
		"render": "<p><font color=\"\">foo</font>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=''</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "Attribute test: equals, then nothing",
		"wikitext": "<font color=>foo</font>",
		"html": "<p><font color=\"\">foo</font>\n</p>",
		"render": "<p><font color=\"\">foo</font>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "Attribute test: unquoted value",
		"wikitext": "<font color=x>foo</font>",
		"html": "<p><font color=\"x\">foo</font>\n</p>",
		"render": "<p><font color=\"x\">foo</font>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=<span class=\"wpb-attr-value\">x</span></span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "Attribute test: unquoted but illegal value (hash)",
		"wikitext": "<font color=#x>foo</font>",
		"html": "<p><font color=\"#x\">foo</font>\n</p>",
		"render": "<p><font color=\"#x\">foo</font>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=<span class=\"wpb-attr-value\">#x</span></span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "Attribute test: no value (T54330)",
		"wikitext": "<font color>foo</font>",
		"html": "<p><font color=\"\">foo</font>\n</p>",
		"render": "<p><font color=\"\">foo</font>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span></span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "T4095: link with three closing brackets",
		"wikitext": "[[Main Page]]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>]\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>]\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>]</span>"
	},
	{
		"desc": "T4095: link with pipe and three closing brackets",
		"wikitext": "[[Main Page|link]]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a>]\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a>]\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">link</span>]]</span>]</span>"
	},
	{
		"desc": "T4095: link with pipe and three closing brackets, version 2",
		"wikitext": "[[Main Page|[http://example.com/]]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">[http://example.com/]</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">[http://example.com/]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">[http://example.com/]</span>]]</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (safe template; regression T4309)",
		"wikitext": "<div title=\"{{test}}\"></div>",
		"html": "<div title=\"This is a test template\"></div>",
		"render": "<div title=\"This is a test template\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">test</span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (dangerous template; 2309)",
		"wikitext": "<div title=\"{{dangerous attribute}}\"></div>",
		"html": "<div title=\"\"></div>",
		"render": "<div title=\"\" ></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">dangerous attribute</span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (dangerous style template; 2309)",
		"wikitext": "<div style=\"{{dangerous style attribute}}\"></div>",
		"html": "<div style=\"/* insecure input */\"></div>",
		"render": "<div ></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">dangerous style attribute</span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (safe parameter; 2309)",
		"wikitext": "{{div style|width: 200px}}",
		"html": "<div style=\"float: right; width: 200px\">Magic div</div>",
		"render": "<div style=\"float: right; width: 200px\">Magic div</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">div style</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">width: 200px</span></span>}}</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (unsafe parameter; 2309)",
		"wikitext": "{{div style|width: expression(alert(document.cookie))}}",
		"html": "<div style=\"/* insecure input */\">Magic div</div>",
		"render": "<div >Magic div</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">div style</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">width: expression(alert(document.cookie))</span></span>}}</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (unsafe breakout parameter; 2309)",
		"wikitext": "{{div style|\"><script>alert(document.cookie)</script>}}",
		"html": "<div style=\"float: right;\">&lt;script&gt;alert(document.cookie)&lt;/script&gt;\"&gt;Magic div</div>",
		"render": "<div style=\"float: right;\">&lt;script&gt;alert(document.cookie)&lt;/script&gt;\"&gt;Magic div</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">div style</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\"&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span>}}</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (unsafe breakout parameter 2; 2309)",
		"wikitext": "{{div style|\" ><script>alert(document.cookie)</script>}}",
		"html": "<div style=\"float: right;\">&lt;script&gt;alert(document.cookie)&lt;/script&gt;\"&gt;Magic div</div>",
		"render": "<div style=\"float: right;\">&lt;script&gt;alert(document.cookie)&lt;/script&gt;\"&gt;Magic div</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">div style</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\" &gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span>}}</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (link)",
		"wikitext": "<div title=\"[[Main Page]]\"></div>",
		"html": "<div title=\"&#91;&#91;Main Page&#93;&#93;\"></div>",
		"render": "<div title=\"[[Main Page]]\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">[[Main Page]]</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (italics)",
		"wikitext": "<div title=\"''foobar''\"></div>",
		"html": "<div title=\"&#39;&#39;foobar&#39;&#39;\"></div>",
		"render": "<div title=\"''foobar''\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">''foobar''</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (bold)",
		"wikitext": "<div title=\"'''foobar'''\"></div>",
		"html": "<div title=\"&#39;&#39;&#39;foobar&#39;&#39;&#39;\"></div>",
		"render": "<div title=\"'''foobar'''\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">'''foobar'''</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (ISBN)",
		"wikitext": "<div title=\"ISBN 1234567890\"></div>",
		"html": "<div title=\"&#73;SBN 1234567890\"></div>",
		"render": "<div title=\"ISBN 1234567890\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">ISBN 1234567890</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (RFC)",
		"wikitext": "<div title=\"RFC 1234\"></div>",
		"html": "<div title=\"&#82;FC 1234\"></div>",
		"render": "<div title=\"RFC 1234\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">RFC 1234</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (PMID)",
		"wikitext": "<div title=\"PMID 1234567890\"></div>",
		"html": "<div title=\"&#80;MID 1234567890\"></div>",
		"render": "<div title=\"PMID 1234567890\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">PMID 1234567890</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (web link)",
		"wikitext": "<div title=\"http://example.com/\"></div>",
		"html": "<div title=\"http&#58;//example.com/\"></div>",
		"render": "<div title=\"http://example.com/\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">http://example.com/</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T4304: HTML attribute safety (named web link)",
		"wikitext": "<div title=\"[http://example.com/ link]\"></div>",
		"html": "<div title=\"&#91;http&#58;//example.com/ link&#93;\"></div>",
		"render": "<div title=\"[http://example.com/ link]\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">[http://example.com/ link]</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T5244: HTML attribute safety (extension; safe)",
		"wikitext": "<div style=\"<nowiki>background:blue</nowiki>\"></div>",
		"html": "<div style=\"background:blue\"></div>",
		"render": "<div style=\"background:blue\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">background:blue</span>&lt;/nowiki&gt;</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T5244: HTML attribute safety (extension; unsafe)",
		"wikitext": "<div style=\"<nowiki>border-left:expression(alert(document.cookie))</nowiki>\"></div>",
		"html": "<div style=\"/* insecure input */\"></div>",
		"render": "<div ></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">border-left:expression(alert(document.cookie))</span>&lt;/nowiki&gt;</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "MSIE CSS safety test: spurious slash",
		"wikitext": "<div style=\"background-image:u\\rl(javascript:alert('boo'))\">evil</div>",
		"html": "<div style=\"/* insecure input */\">evil</div>",
		"render": "<div style=\"background-image:u\\rl(javascript:alert('boo'))\">evil</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-image:u\\rl(javascript:alert('boo'))</span>\"</span></span>&gt;</span>evil<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "MSIE CSS safety test: hex code",
		"wikitext": "<div style=\"background-image:u\\72l(javascript:alert('boo'))\">evil</div>",
		"html": "<div style=\"/* insecure input */\">evil</div>",
		"render": "<div style=\"background-image:u\\72l(javascript:alert('boo'))\">evil</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-image:u\\72l(javascript:alert('boo'))</span>\"</span></span>&gt;</span>evil<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "MSIE CSS safety test: comment in url",
		"wikitext": "<div style=\"background-image:u/**/rl(javascript:alert('boo'))\">evil</div>",
		"html": "<div style=\"background-image:u rl(javascript:alert(&#39;boo&#39;))\">evil</div>",
		"render": "<div style=\"background-image:u/**/rl(javascript:alert('boo'))\">evil</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-image:u/**/rl(javascript:alert('boo'))</span>\"</span></span>&gt;</span>evil<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "MSIE CSS safety test: comment in expression",
		"wikitext": "<div style=\"background-image:expres/**/sion(alert('boo4'))\">evil4</div>",
		"html": "<div style=\"background-image:expres sion(alert(&#39;boo4&#39;))\">evil4</div>",
		"render": "<div style=\"background-image:expres/**/sion(alert('boo4'))\">evil4</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-image:expres/**/sion(alert('boo4'))</span>\"</span></span>&gt;</span>evil4<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "CSS safety test (all browsers): vertical tab (T57332 / CVE-2013-4567)",
		"wikitext": "<p style=\"font-size: 100px; background-image:url\\b(https://www.google.com/images/srpr/logo6w.png)\">A</p>",
		"html": "<p style=\"/* invalid control char */\">A</p>",
		"render": "<p style=\"font-size: 100px; background-image:url\\b(https://www.google.com/images/srpr/logo6w.png)\">A</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">font-size: 100px; background-image:url\\b(https://www.google.com/images/srpr/logo6w.png)</span>\"</span></span>&gt;</span>A<span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Opera -o-link CSS",
		"wikitext": "<div\ntitle=\"&#100;&#97;&#116;&#97;&#58;&#116;&#101;&#120;&#116;&#47;&#104;&#116;&#109;&#108;&#44;&#60;&#105;&#109;&#103;&#32;&#115;&#114;&#99;&#61;&#49;&#32;&#111;&#110;&#101;&#114;&#114;&#111;&#114;&#61;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;&#62;\"\nstyle=\"-o-link:attr(title);-o-link-source:current\">X</div>",
		"html": "<div title=\"data:text/html,&lt;img src=1 onerror=alert(1)&gt;\" style=\"/* insecure input */\">X</div>",
		"render": "<div title=\"&#100;&#97;&#116;&#97;&#58;&#116;&#101;&#120;&#116;&#47;&#104;&#116;&#109;&#108;&#44;&#60;&#105;&#109;&#103;&#32;&#115;&#114;&#99;&#61;&#49;&#32;&#111;&#110;&#101;&#114;&#114;&#111;&#114;&#61;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;&#62;\" >X</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\">\n<span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">&amp;#100;&amp;#97;&amp;#116;&amp;#97;&amp;#58;&amp;#116;&amp;#101;&amp;#120;&amp;#116;&amp;#47;&amp;#104;&amp;#116;&amp;#109;&amp;#108;&amp;#44;&amp;#60;&amp;#105;&amp;#109;&amp;#103;&amp;#32;&amp;#115;&amp;#114;&amp;#99;&amp;#61;&amp;#49;&amp;#32;&amp;#111;&amp;#110;&amp;#101;&amp;#114;&amp;#114;&amp;#111;&amp;#114;&amp;#61;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&amp;#62;</span>\"</span>\n<span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">-o-link:attr(title);-o-link-source:current</span>\"</span></span>&gt;</span>X<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Table attribute legitimate extension",
		"wikitext": "{|\n!+ style=\"<nowiki>color:blue</nowiki>\"|status\n|}",
		"html": "<table>\n<tbody><tr>\n<th style=\"color:blue\">status\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th style=\"color:blue\">status\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">+ </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">color:blue</span>&lt;/nowiki&gt;</span></span>\"</span></span>|<span class=\"wpb-td-inner\">status</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table attribute safety",
		"wikitext": "{|\n!+ style=\"<nowiki>border-width:expression(0+alert(document.cookie))</nowiki>\"|status\n|}",
		"html": "<table>\n<tbody><tr>\n<th style=\"/* insecure input */\">status\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >status\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">+ </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">border-width:expression(0+alert(document.cookie))</span>&lt;/nowiki&gt;</span></span>\"</span></span>|<span class=\"wpb-td-inner\">status</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "CSS line continuation 1",
		"wikitext": "<div style=\"background-image: u\\&#10;rl(test.jpg);\"></div>",
		"html": "<div style=\"/* insecure input */\"></div>",
		"render": "<div style=\"background-image: u\\ rl(test.jpg);\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-image: u\\&amp;#10;rl(test.jpg);</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "CSS line continuation 2",
		"wikitext": "<div style=\"background-image: u\\&#13;rl(test.jpg); \"></div>",
		"html": "<div style=\"/* invalid control char */\"></div>",
		"render": "<div style=\"background-image: u\\&#13;rl(test.jpg);\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-image: u\\&amp;#13;rl(test.jpg); </span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Allow aria attributes",
		"wikitext": "<span aria-describedby=\"id1\" aria-flowto=\"id2\" aria-hidden=\"true\" aria-label=\"id3\" aria-labelledby=\"id4\" aria-level=\"3\" aria-owns=\"id5\">foo</span>\n<span aria-bogus=\"stripped\">bar</span>",
		"html": "<p><span aria-describedby=\"id1\" aria-flowto=\"id2\" aria-hidden=\"true\" aria-label=\"id3\" aria-labelledby=\"id4\" aria-level=\"3\" aria-owns=\"id5\">foo</span>\n<span>bar</span>\n</p>",
		"render": "<p><span aria-describedby=\"id1\" aria-flowto=\"id2\" aria-hidden=\"true\" aria-label=\"id3\" aria-labelledby=\"id4\" aria-level=\"3\" aria-owns=\"id5\">foo</span>\n<span >bar</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-describedby</span>=\"<span class=\"wpb-attr-value\">id1</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-flowto</span>=\"<span class=\"wpb-attr-value\">id2</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-hidden</span>=\"<span class=\"wpb-attr-value\">true</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-label</span>=\"<span class=\"wpb-attr-value\">id3</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-labelledby</span>=\"<span class=\"wpb-attr-value\">id4</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-level</span>=\"<span class=\"wpb-attr-value\">3</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-owns</span>=\"<span class=\"wpb-attr-value\">id5</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">aria-bogus</span>=\"<span class=\"wpb-attr-value\">stripped</span>\"</span></span>&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Expansion of multi-line templates in attribute values (T8255)",
		"wikitext": "<div style=\"background: {{1x|#00FF00}}\">-</div>",
		"html": "<div style=\"background: #00FF00\">-</div>",
		"render": "<div style=\"background: #00FF00\">-</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background: <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">#00FF00</span></span>}}</span></span>\"</span></span>&gt;</span>-<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Expansion of multi-line parser-functions in attribute values (T8255)",
		"wikitext": "<div style=\"background: {{#if:1|#00FF00|#FF00FF}}\">-</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background: <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">#00FF00</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">#FF00FF</span></span>}}</span></span>\"</span></span>&gt;</span>-<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Expansion of multi-line templates in attribute values (T8255 check)",
		"wikitext": "<div style=\"background:\n#00FF00\">-</div>",
		"html": "<div style=\"background: #00FF00\">-</div>",
		"render": "<div style=\"background: #00FF00\">-</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background:\n#00FF00</span>\"</span></span>&gt;</span>-<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Expansion of multi-line templates in attribute values (T8255 check 2)",
		"wikitext": "<div style=\"background: &#10;#00FF00\">-</div>",
		"html": "<div style=\"background: &#10;#00FF00\">-</div>",
		"render": "<div style=\"background:  #00FF00\">-</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background: &amp;#10;#00FF00</span>\"</span></span>&gt;</span>-<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Tags which are hidden from tidiers cannot pass through the Sanitizer",
		"wikitext": "<mw:editsection><script>alert();</script></mw:editsection>\n\n<meta property=\"mw:PageProp/toc\" />",
		"html": "<p>&lt;mw:editsection&gt;&lt;script&gt;alert();&lt;/script&gt;&lt;/mw:editsection&gt;\n</p><p>&lt;meta property=\"mw:PageProp/toc\" /&gt;\n</p>",
		"render": "<p>&lt;mw:editsection&gt;&lt;script&gt;alert();&lt;/script&gt;&lt;/mw:editsection&gt;\n</p><p>&lt;meta property=\"mw:PageProp/toc\" /&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;mw:editsection&gt;&lt;script&gt;alert();&lt;/script&gt;&lt;/mw:editsection&gt;\n\n&lt;meta property=\"mw:PageProp/toc\" /&gt;</span>"
	},
	{
		"desc": "Nested template calls",
		"wikitext": "{{Map-one-parameter|One-parameter|param}}",
		"html": "<p>(My parameter is: param)\n</p>",
		"render": "<p><a href=\"/wiki/Template%3AMap-one-parameter?action=edit&redlink=1\" class=\"new\" title=\"Template:Map-one-parameter (page does not exist)\">Template:Map-one-parameter</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Map-one-parameter</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">One-parameter</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">param</span></span>}}</span></span>"
	},
	{
		"desc": "Sanitizer: Closing of open tags",
		"wikitext": "<s></s><table></table>",
		"html": "<p><s></s></p><table></table>",
		"render": "<s ></s><table ></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;s&gt;</span><span class=\"wpb-html\">&lt;/s&gt;</span><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Closing of open but not closed tags",
		"wikitext": "<s>foo",
		"html": "<p><s>foo\n</s></p>",
		"render": "<p><s >foo\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;s&gt;</span>foo</span>"
	},
	{
		"desc": "Sanitizer: Closing of closed but not open tags",
		"wikitext": "</s>",
		"html": "<p class=\"mw-empty-elt\">\n</p>",
		"render": "<p></s>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;/s&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Closing of closed but not open table tags",
		"wikitext": "Table not started</td></tr></table>",
		"html": "<p>Table not started</p>",
		"render": "Table not started</td></tr></table>",
		"print": "<span class=\"wpb-root\">Table not started<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Escaping of spaces, multibyte characters, colons & other stuff in id=\"\"",
		"wikitext": "<span id=\"√¶: v\">byte</span>[[#√¶: v|backlink]]",
		"html": "<p><span id=\"√¶:_v\">byte</span><a href=\"#√¶:_v\">backlink</a>\n</p>",
		"render": "<p><span id=\"√¶:_v\">byte</span><a href=\"#%C3%A6%3A_v\">backlink</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">√¶: v</span>\"</span></span>&gt;</span>byte<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#√¶: v</span>|<span class=\"wpb-link-text\">backlink</span>]]</span></span>"
	},
	{
		"desc": "Sanitizer: Escaping of spaces, multibyte characters, colons & other stuff in id=\"\" (legacy)",
		"wikitext": "<span id=\"√¶: v\">byte</span>[[#√¶: v|backlink]]",
		"html": "<p><span id=\".C3.A6:_v\">byte</span><a href=\"#.C3.A6:_v\">backlink</a>\n</p>",
		"render": "<p><span id=\"√¶:_v\">byte</span><a href=\"#%C3%A6%3A_v\">backlink</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">√¶: v</span>\"</span></span>&gt;</span>byte<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#√¶: v</span>|<span class=\"wpb-link-text\">backlink</span>]]</span></span>"
	},
	{
		"desc": "Sanitizer: Validating the contents of the id attribute (T6515)",
		"wikitext": "<br id=\"\" /><br id=\"a space\" />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"\"</span> </span>/&gt;</span><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">a space</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Validating id attribute uniqueness (T6515, T8301)",
		"wikitext": "<br id=\"foo\" /><br id=\"foo\" />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Validating that <meta> and <link> work, but only for Microdata",
		"wikitext": "<div itemscope>\n\t<meta itemprop=\"hello\" content=\"world\">\n\t<meta http-equiv=\"refresh\" content=\"5\">\n\t<meta itemprop=\"hello\" http-equiv=\"refresh\" content=\"5\">\n\t<link itemprop=\"hello\" href=\"{{SERVER}}\">\n\t<link rel=\"stylesheet\" href=\"{{SERVER}}\">\n\t<link rel=\"stylesheet\" itemprop=\"hello\" href=\"{{SERVER}}\">\n</div>",
		"html": "<div itemscope=\"\">\n<p>\t<meta itemprop=\"hello\" content=\"world\" />\n\t&lt;meta http-equiv=\"refresh\" content=\"5\"&gt;\n\t<meta itemprop=\"hello\" content=\"5\" />\n\t<link itemprop=\"hello\" href=\"http&#58;//example.org\" />\n\t&lt;link rel=\"stylesheet\" href=\"<a rel=\"nofollow\" class=\"external free\" href=\"http://example.org\">http://example.org</a>\"&gt;\n\t<link itemprop=\"hello\" href=\"http&#58;//example.org\" />\n</p>\n</div>",
		"render": "<div itemscope=\"\">\n<p>\t<meta itemprop=\"hello\" content=\"world\">\n\t&lt;meta http-equiv=\"refresh\" content=\"5\"&gt;\n\t<meta itemprop=\"hello\"  content=\"5\">\n\t<link itemprop=\"hello\" href=\"\">\n\t&lt;link rel=\"stylesheet\" href=\"\"&gt;\n\t<link  itemprop=\"hello\" href=\"\">\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">itemscope</span></span></span>&gt;</span>\n\t<span class=\"wpb-html\">&lt;meta<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">itemprop</span>=\"<span class=\"wpb-attr-value\">hello</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">content</span>=\"<span class=\"wpb-attr-value\">world</span>\"</span></span>&gt;</span>\n\t&lt;meta http-equiv=\"refresh\" content=\"5\"&gt;\n\t<span class=\"wpb-html\">&lt;meta<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">itemprop</span>=\"<span class=\"wpb-attr-value\">hello</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">http-equiv</span>=\"<span class=\"wpb-attr-value\">refresh</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">content</span>=\"<span class=\"wpb-attr-value\">5</span>\"</span></span>&gt;</span>\n\t<span class=\"wpb-html\">&lt;link<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">itemprop</span>=\"<span class=\"wpb-attr-value\">hello</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">href</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SERVER</span>}}</span></span>\"</span></span>&gt;</span>\n\t&lt;link rel=\"stylesheet\" href=\"<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SERVER</span>}}</span>\"&gt;\n\t<span class=\"wpb-html\">&lt;link<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">rel</span>=\"<span class=\"wpb-attr-value\">stylesheet</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">itemprop</span>=\"<span class=\"wpb-attr-value\">hello</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">href</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SERVER</span>}}</span></span>\"</span></span>&gt;</span>\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Strip comments from CSS attributes",
		"wikitext": "<span style=\"margin:/*negate mbox-text padding */-0.125em -0.45em; /*rainbow*/rgba(255, 0, 0, 0.3)\">2013</span>",
		"html": "<p><span style=\"margin: -0.125em -0.45em;  rgba(255, 0, 0, 0.3)\">2013</span>\n</p>",
		"render": "<p><span style=\"margin:/*negate mbox-text padding */-0.125em -0.45em; /*rainbow*/rgba(255, 0, 0, 0.3)\">2013</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">margin:/*negate mbox-text padding */-0.125em -0.45em; /*rainbow*/rgba(255, 0, 0, 0.3)</span>\"</span></span>&gt;</span>2013<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Sanitizer: Avoid unnecessary percent encoded characters in interwiki links",
		"wikitext": "[[meatball:Soft\"Security]]",
		"html": "<p><a href=\"http://www.usemod.com/cgi-bin/mb.pl?Soft%22Security\" class=\"extiw\" title=\"meatball:Soft&quot;Security\">meatball:Soft\"Security</a>\n</p>",
		"render": "<p><a href=\"/wiki/Meatball%3ASoft%22Security\" title=\"Meatball:Soft&quot;Security\">meatball:Soft\"Security</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">meatball:Soft\"Security</span>]]</span></span>"
	},
	{
		"desc": "Sanitizer: angle brackets are invalid, even in interwiki links (T182338)",
		"wikitext": "[[meatball:Foo<Bar]]\n[[meatball:Foo>Bar]]\n[[meatball:Foo&lt;bar]]\n[[meatball:Foo&gt;bar]]",
		"html": "<p>[[meatball:Foo&lt;Bar]]\n[[meatball:Foo&gt;Bar]]\n[[meatball:Foo&lt;bar]]\n[[meatball:Foo&gt;bar]]\n</p>",
		"render": "<p>[[meatball:Foo&lt;Bar]]\n[[meatball:Foo&gt;Bar]]\n[[meatball:Foo&lt;bar]]\n[[meatball:Foo&gt;bar]]\n</p>",
		"print": "<span class=\"wpb-root\">[[meatball:Foo&lt;Bar]]\n[[meatball:Foo&gt;Bar]]\n[[meatball:Foo&amp;lt;bar]]\n[[meatball:Foo&amp;gt;bar]]</span>"
	},
	{
		"desc": "Self closed html pairs (T7487)",
		"wikitext": "<center><font id=\"bug\" />Centered text</center>\n<div><font id=\"bug2\" />In div text</div>",
		"html": "<center><font id=\"bug\">Centered text</font></center><font id=\"bug\"><div><font id=\"bug2\">In div text</font></div></font>",
		"render": "<center ><font id=\"bug\">Centered text</center>\n<div ><font id=\"bug2\">In div text</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;center&gt;</span><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">bug</span>\"</span> </span>/&gt;</span>Centered text<span class=\"wpb-html\">&lt;/center&gt;</span>\n<span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">bug2</span>\"</span> </span>/&gt;</span>In div text<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Punctuation: nbsp before exclamation",
		"wikitext": "C'est grave !",
		"html": "<p>C'est grave&#160;!\n</p>",
		"render": "<p>C'est grave !\n</p>",
		"print": "<span class=\"wpb-root\">C'est grave !</span>"
	},
	{
		"desc": "Punctuation: CSS !important (T13874)",
		"wikitext": "<div style=\"width:50% !important\">important</div>",
		"html": "<div style=\"width:50% !important\">important</div>",
		"render": "<div style=\"width:50% !important\">important</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">width:50% !important</span>\"</span></span>&gt;</span>important<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Punctuation: CSS ! important (T13874; with space after)",
		"wikitext": "<div style=\"width:50% ! important\">important</div>",
		"html": "<div style=\"width:50% ! important\">important</div>",
		"render": "<div style=\"width:50% ! important\">important</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">width:50% ! important</span>\"</span></span>&gt;</span>important<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "HTML bullet list, closed tags (T7497)",
		"wikitext": "<ul>\n<li>One</li>\n<li>Two</li>\n</ul>",
		"html": "<ul>\n<li>One</li>\n<li>Two</li>\n</ul>",
		"render": "<ul >\n<li >One</li>\n<li >Two</li>\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Two<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "HTML bullet list, unclosed tags (T7497)",
		"wikitext": "<ul>\n<li>One\n<li>Two\n</ul>",
		"html": "<ul>\n<li>One\n</li><li>Two\n</li></ul>",
		"render": "<ul >\n<li >One\n<li >Two\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One\n<span class=\"wpb-html\">&lt;li&gt;</span>Two\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "HTML ordered list, closed tags (T7497)",
		"wikitext": "<ol>\n<li>One</li>\n<li>Two</li>\n</ol>",
		"html": "<ol>\n<li>One</li>\n<li>Two</li>\n</ol>",
		"render": "<ol >\n<li >One</li>\n<li >Two</li>\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Two<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "HTML ordered list, unclosed tags (T7497)",
		"wikitext": "<ol>\n<li>One\n<li>Two\n</ol>",
		"html": "<ol>\n<li>One\n</li><li>Two\n</li></ol>",
		"render": "<ol >\n<li >One\n<li >Two\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One\n<span class=\"wpb-html\">&lt;li&gt;</span>Two\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "HTML nested bullet list, closed tags (T7497)",
		"wikitext": "<ul>\n<li>One</li>\n<li>Two:\n<ul>\n<li>Sub-one</li>\n<li>Sub-two</li>\n</ul>\n</li>\n</ul>",
		"html": "<ul>\n<li>One</li>\n<li>Two:\n<ul>\n<li>Sub-one</li>\n<li>Sub-two</li>\n</ul>\n</li>\n</ul>",
		"render": "<ul >\n<li >One</li>\n<li >Two:\n<ul >\n<li >Sub-one</li>\n<li >Sub-two</li>\n</ul>\n</li>\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Two:\n<span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-one<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-two<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span>\n<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "HTML nested bullet list, open tags (T7497)",
		"wikitext": "<ul>\n<li>One\n<li>Two:\n<ul>\n<li>Sub-one\n<li>Sub-two\n</ul>\n</ul>",
		"html": "<ul>\n<li>One\n</li><li>Two:\n<ul>\n<li>Sub-one\n</li><li>Sub-two\n</li></ul>\n</li></ul>",
		"render": "<ul >\n<li >One\n<li >Two:\n<ul >\n<li >Sub-one\n<li >Sub-two\n</ul>\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One\n<span class=\"wpb-html\">&lt;li&gt;</span>Two:\n<span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-one\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-two\n<span class=\"wpb-html\">&lt;/ul&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "HTML nested ordered list, closed tags (T7497)",
		"wikitext": "<ol>\n<li>One</li>\n<li>Two:\n<ol>\n<li>Sub-one</li>\n<li>Sub-two</li>\n</ol>\n</li>\n</ol>",
		"html": "<ol>\n<li>One</li>\n<li>Two:\n<ol>\n<li>Sub-one</li>\n<li>Sub-two</li>\n</ol>\n</li>\n</ol>",
		"render": "<ol >\n<li >One</li>\n<li >Two:\n<ol >\n<li >Sub-one</li>\n<li >Sub-two</li>\n</ol>\n</li>\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Two:\n<span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-one<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-two<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span>\n<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "HTML nested ordered list, open tags (T7497)",
		"wikitext": "<ol>\n<li>One\n<li>Two:\n<ol>\n<li>Sub-one\n<li>Sub-two\n</ol>\n</ol>",
		"html": "<ol>\n<li>One\n</li><li>Two:\n<ol>\n<li>Sub-one\n</li><li>Sub-two\n</li></ol>\n</li></ol>",
		"render": "<ol >\n<li >One\n<li >Two:\n<ol >\n<li >Sub-one\n<li >Sub-two\n</ol>\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>One\n<span class=\"wpb-html\">&lt;li&gt;</span>Two:\n<span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-one\n<span class=\"wpb-html\">&lt;li&gt;</span>Sub-two\n<span class=\"wpb-html\">&lt;/ol&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "HTML ordered list item with parameters oddity",
		"wikitext": "<ol><li id=\"fragment\">One</li>\n</ol>",
		"html": "<ol><li id=\"fragment\">One</li>\n</ol>",
		"render": "<ol ><li id=\"fragment\">One</li>\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span><span class=\"wpb-html\">&lt;li<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">fragment</span>\"</span></span>&gt;</span>One<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "T7918: autonumbering",
		"wikitext": "[http://first/] [http://second] [ftp://ftp]\n\nftp://inlineftp\n\n[mailto:enclosed@mail.tld With target]\n\n[mailto:enclosed@mail.tld]\n\nmailto:inline@mail.tld",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://first/\">[1]</a> <a rel=\"nofollow\" class=\"external autonumber\" href=\"http://second\">[2]</a> <a rel=\"nofollow\" class=\"external autonumber\" href=\"ftp://ftp\">[3]</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"ftp://inlineftp\">ftp://inlineftp</a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"mailto:enclosed@mail.tld\">With target</a>\n</p><p><a rel=\"nofollow\" class=\"external autonumber\" href=\"mailto:enclosed@mail.tld\">[4]</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"mailto:inline@mail.tld\">mailto:inline@mail.tld</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://first/\">[1]</a> <a rel=\"nofollow\" class=\"external\" href=\"http://second/\">[2]</a> <a rel=\"nofollow\" class=\"external\" href=\"ftp://ftp/\">[3]</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"ftp://inlineftp/\">ftp://inlineftp</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"mailto:enclosed@mail.tld\">With target</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"mailto:enclosed@mail.tld\">[4]</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"mailto:inline@mail.tld\">mailto:inline@mail.tld</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://first/</span>]</span> <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://second</span>]</span> <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">ftp://ftp</span>]</span>\n\n<span class=\"wpb-free-ext-link\">ftp://inlineftp</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">mailto:enclosed@mail.tld</span> <span class=\"wpb-ext-link-text\">With target</span>]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">mailto:enclosed@mail.tld</span>]</span>\n\n<span class=\"wpb-free-ext-link\">mailto:inline@mail.tld</span></span>"
	},
	{
		"desc": "Fuzz testing: Parser13",
		"wikitext": "{| \n| http://a|",
		"html": "<table>\n<tbody><tr>\n<td>\n</td>\n</tr>\n</tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td  >\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> </span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">http:</span></span><span class=\"wpb-attr-dirty\">//</span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">a</span></span></span>|</span></span></span>"
	},
	{
		"desc": "Fuzz testing: Parser16",
		"wikitext": "{|\n!https://||||||",
		"html": "<table>\n<tbody><tr>\n<th>https://</th>\n<th></th>\n<th></th>\n<th>\n\n</th></tr>\n</tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >https://</th>\n<th ></th>\n<th ></th>\n<th >\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">https://</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span></span></span></span>"
	},
	{
		"desc": "Fuzz testing: Parser21",
		"wikitext": "{|\n!irc://{{ftp://a\" onmouseover=\"alert('hello world');\"\n|",
		"html": "<table>\n<tbody><tr>\n<th><a rel=\"nofollow\" class=\"external free\" href=\"irc://{{ftp://a\">irc://{{ftp://a</a>\" onmouseover=\"alert('hello world');\"\n</th>\n<td>\n</td>\n</tr>\n</tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th ><a rel=\"nofollow\" class=\"external free\" href=\"irc://{{ftp//a\">irc://{{ftp://a</a>\" onmouseover=\"alert('hello world');\"\n</th>\n<td >\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-free-ext-link\">irc://{{ftp://a</span>\" onmouseover=\"alert('hello world');\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span></span></span></span>"
	},
	{
		"desc": "Fuzz testing: Parser22",
		"wikitext": "http://===r:::https://b\n\n{|",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://===r:::https://b\">http://===r:::https://b</a>\n</p>\n<table>\n<tbody><tr><td></td></tr>\n</tbody></table>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\">http://===r:::https://b</a>\n</p>\n<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://===r:::https://b</span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span></span></span>"
	},
	{
		"desc": "Fuzz testing: Parser24 (minimized)",
		"wikitext": "{{<u {{{{[[Sx-->}}",
		"html": "<p>{{<u>}}\n</u></p>",
		"render": "<p>{{<u >}}\n</p>",
		"print": "<span class=\"wpb-root\">{{<span class=\"wpb-html\">&lt;u<span class=\"wpb-html-attrs\"><span class=\"wpb-attr-dirty\"> {{{{[[Sx--</span></span>&gt;</span>}}</span>"
	},
	{
		"desc": "Fuzz testing: Parser24",
		"wikitext": "{|\n{{{|\n<u CLASS=\n| {{{{SSSll!!!!!!!VVVV)]]][[Special:*xxxxxxx--><noinclude>}}}} >\n<br style=\"onmouseover='alert(document.cookie);' \" />\n\nMOVE YOUR MOUSE CURSOR OVER THIS TEXT\n|",
		"html": "{{{|\n<u class=\"&#124;\">}}}} &gt;\n<br style=\"onmouseover=&#39;alert(document.cookie);&#39;\" />\n\nMOVE YOUR MOUSE CURSOR OVER THIS TEXT\n</u><table><tbody><tr>\n<td>\n</td>\n</tr>\n</tbody></table>",
		"render": "{{{| <u class=\"|\">}}}} &gt; <br style=\"onmouseover='alert(document.cookie);'\">  MOVE YOUR MOUSE CURSOR OVER THIS TEXT<table >\n<tbody><tr>\n<td >\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n{{{|\n<span class=\"wpb-html\">&lt;u<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">CLASS</span>=\n<span class=\"wpb-attr-value\">|</span></span><span class=\"wpb-attr-dirty\"> {{{{SSSll!!!!!!!VVVV)]]][[Special:*xxxxxxx--</span></span>&gt;</span><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>}}}} &gt;\n<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">onmouseover='alert(document.cookie);' </span>\"</span> </span>/&gt;</span>\n\nMOVE YOUR MOUSE CURSOR OVER THIS TEXT</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span></span></span></span>"
	},
	{
		"desc": "Fuzz testing: Parser25 (T8055)",
		"wikitext": "{{{\n| \n<LI CLASS=||\n >\n}}}blah\" onmouseover=\"alert('hello world');\" align=\"left\"'''MOVE MOUSE CURSOR OVER HERE",
		"html": "<p>&lt;LI CLASS=blah\" onmouseover=\"alert('hello world');\" align=\"left\"<b>MOVE MOUSE CURSOR OVER HERE</b>\n</p>",
		"render": "<p>&lt;LI CLASS=blah\" onmouseover=\"alert('hello world');\" align=\"left\"<b>MOVE MOUSE CURSOR OVER HERE</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">\n</span>|<span class=\"wpb-arg-default\"> \n&lt;LI CLASS=</span>||<span class=\"wpb-hidden\">\n &gt;\n</span>}}}</span>blah\" onmouseover=\"alert('hello world');\" align=\"left\"<span class=\"wpb-quote\">'''</span>MOVE MOUSE CURSOR OVER HERE</span>"
	},
	{
		"desc": "Fuzz testing: URL adjacent extension (with space, clean)",
		"wikitext": "http://example.com <nowiki>junk</nowiki>",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a> junk\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a> junk\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span> <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">junk</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Fuzz testing: URL adjacent extension (no space, dirty; nowiki)",
		"wikitext": "http://example.com<nowiki>junk</nowiki>",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>junk\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>junk\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">junk</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Fuzz testing: URL adjacent extension (no space, dirty; pre)",
		"wikitext": "http://example.com<pre>junk</pre>",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a></p><pre>junk</pre>",
		"render": "<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a><pre >junk</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">junk</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Fuzz testing: encoded newline in generated HTML replacements (T8577)",
		"wikitext": "<pre dir=\"&#10;\"></pre>",
		"html": "<pre dir=\"&#10;\"></pre>",
		"render": "<pre dir=\" \"></pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">&amp;#10;</span>\"</span></span>&gt;&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Fuzz testing: encoded newline in generated HTML replacements, html2wt (T8577)",
		"wikitext": "<pre dir=\"\n\"></pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">\n</span>\"</span></span>&gt;&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Templates in extension attributes are not expanded",
		"wikitext": "<pre dir=\"{{1x|ltr}}\"></pre>",
		"html": "<pre dir=\"{{1x|ltr}}\"></pre>",
		"render": "<pre dir=\"{{1x|ltr}}\"></pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">{{1x|ltr}}</span>\"</span></span>&gt;&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Parsing optional HTML elements (T8171)",
		"wikitext": "<table>\n  <tr>\n    <td> Some tabular data</td>\n    <td> More tabular data ...\n    <td> And yet som tabular data</td>\n  </tr>\n</table>",
		"html": "<table>\n  <tbody><tr>\n    <td> Some tabular data</td>\n    <td> More tabular data ...\n    </td><td> And yet som tabular data</td>\n  </tr>\n</tbody></table>",
		"render": "<table >\n  <tr >\n    <td > Some tabular data</td>\n    <td > More tabular data ...\n    <td > And yet som tabular data</td>\n  </tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n  <span class=\"wpb-html\">&lt;tr&gt;</span>\n    <span class=\"wpb-html\">&lt;td&gt;</span> Some tabular data<span class=\"wpb-html\">&lt;/td&gt;</span>\n    <span class=\"wpb-html\">&lt;td&gt;</span> More tabular data ...\n    <span class=\"wpb-html\">&lt;td&gt;</span> And yet som tabular data<span class=\"wpb-html\">&lt;/td&gt;</span>\n  <span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Correct handling of <td>, <tr> (T8171)",
		"wikitext": "<table>\n  <tr>\n    <td> Some tabular data</td>\n    <td> More tabular data ...</td>\n    <td> And yet som tabular data</td>\n  </tr>\n</table>",
		"html": "<table>\n  <tbody><tr>\n    <td> Some tabular data</td>\n    <td> More tabular data ...</td>\n    <td> And yet som tabular data</td>\n  </tr>\n</tbody></table>",
		"render": "<table >\n  <tr >\n    <td > Some tabular data</td>\n    <td > More tabular data ...</td>\n    <td > And yet som tabular data</td>\n  </tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n  <span class=\"wpb-html\">&lt;tr&gt;</span>\n    <span class=\"wpb-html\">&lt;td&gt;</span> Some tabular data<span class=\"wpb-html\">&lt;/td&gt;</span>\n    <span class=\"wpb-html\">&lt;td&gt;</span> More tabular data ...<span class=\"wpb-html\">&lt;/td&gt;</span>\n    <span class=\"wpb-html\">&lt;td&gt;</span> And yet som tabular data<span class=\"wpb-html\">&lt;/td&gt;</span>\n  <span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Parsing crashing regression (fr:JavaScript)",
		"wikitext": "</body></x>",
		"html": "<p>&lt;/body&gt;&lt;/x&gt;\n</p>",
		"render": "<p>&lt;/body&gt;&lt;/x&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;/body&gt;&lt;/x&gt;</span>"
	},
	{
		"desc": "Inline wiki vs wiki block nesting",
		"wikitext": "'''Bold paragraph\n\nNew wiki paragraph",
		"html": "<p><b>Bold paragraph</b>\n</p><p>New wiki paragraph\n</p>",
		"render": "<p><b>Bold paragraph</b>\n</p><p>New wiki paragraph\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>Bold paragraph\n\nNew wiki paragraph</span>"
	},
	{
		"desc": "Inline HTML vs wiki block nesting",
		"wikitext": "<b>Bold paragraph\n\nNew wiki paragraph",
		"html": "<p><b>Bold paragraph\n</b></p><p><b>New wiki paragraph\n</b></p>",
		"render": "<p><b >Bold paragraph\n</p><p>New wiki paragraph\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;b&gt;</span>Bold paragraph\n\nNew wiki paragraph</span>"
	},
	{
		"desc": "Mixing markup for italics and bold",
		"wikitext": "'''bold''''''bold''bolditalics'''''",
		"html": "<p>'<i>bold'</i><b>bold<i>bolditalics</i></b>\n</p>",
		"render": "<p>'<i>bold'</i><b>bold</b><i><b>bolditalics</b></i>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">''</span>bold'<span class=\"wpb-quote\">'''''</span>bold<span class=\"wpb-quote\">''</span>bolditalics<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Special page transclusion",
		"wikitext": "{{Special:Prefixindex/Xyzzyx}}",
		"html": "<ul class=\"mw-prefixindex-list\"><li><a href=\"/wiki/Xyzzyx\" title=\"Xyzzyx\">Xyzzyx</a></li>\n</ul>",
		"render": "<p><a href=\"/wiki/Special%3APrefixindex%2FXyzzyx?action=edit&redlink=1\" class=\"new\" title=\"Special:Prefixindex/Xyzzyx (page does not exist)\">Special:Prefixindex/Xyzzyx</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Special:Prefixindex/Xyzzyx</span>}}</span></span>"
	},
	{
		"desc": "Special page transclusion twice (T7021)",
		"wikitext": "{{Special:Prefixindex/Xyzzyx}}\n{{Special:Prefixindex/Xyzzyx}}",
		"html": "<ul class=\"mw-prefixindex-list\"><li><a href=\"/wiki/Xyzzyx\" title=\"Xyzzyx\">Xyzzyx</a></li>\n</ul>\n<ul class=\"mw-prefixindex-list\"><li><a href=\"/wiki/Xyzzyx\" title=\"Xyzzyx\">Xyzzyx</a></li>\n</ul>",
		"render": "<p><a href=\"/wiki/Special%3APrefixindex%2FXyzzyx?action=edit&redlink=1\" class=\"new\" title=\"Special:Prefixindex/Xyzzyx (page does not exist)\">Special:Prefixindex/Xyzzyx</a>\n<a href=\"/wiki/Special%3APrefixindex%2FXyzzyx?action=edit&redlink=1\" class=\"new\" title=\"Special:Prefixindex/Xyzzyx (page does not exist)\">Special:Prefixindex/Xyzzyx</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Special:Prefixindex/Xyzzyx</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Special:Prefixindex/Xyzzyx</span>}}</span></span>"
	},
	{
		"desc": "Transclusion of default MediaWiki message",
		"wikitext": "{{MediaWiki:Mainpage}}",
		"html": "<p>Main Page\n</p>",
		"render": "<p><a href=\"/wiki/MediaWiki%3AMainpage?action=edit&redlink=1\" class=\"new\" title=\"MediaWiki:Mainpage (page does not exist)\">MediaWiki:Mainpage</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">MediaWiki:Mainpage</span>}}</span></span>"
	},
	{
		"desc": "Transclusion of nonexistent MediaWiki message",
		"wikitext": "{{MediaWiki:Mainpagexxx}}",
		"html": "<p><a href=\"/index.php?title=MediaWiki:Mainpagexxx&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"MediaWiki:Mainpagexxx (page does not exist)\">MediaWiki:Mainpagexxx</a>\n</p>",
		"render": "<p><a href=\"/wiki/MediaWiki%3AMainpagexxx?action=edit&redlink=1\" class=\"new\" title=\"MediaWiki:Mainpagexxx (page does not exist)\">MediaWiki:Mainpagexxx</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">MediaWiki:Mainpagexxx</span>}}</span></span>"
	},
	{
		"desc": "Transclusion of MediaWiki message with underscore",
		"wikitext": "{{MediaWiki:history_short}}",
		"html": "<p>History\n</p>",
		"render": "<p><a href=\"/wiki/MediaWiki%3AHistory_short?action=edit&redlink=1\" class=\"new\" title=\"MediaWiki:History_short (page does not exist)\">MediaWiki:History_short</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">MediaWiki:history_short</span>}}</span></span>"
	},
	{
		"desc": "Transclusion of MediaWiki message with space",
		"wikitext": "{{MediaWiki:history short}}",
		"html": "<p>History\n</p>",
		"render": "<p><a href=\"/wiki/MediaWiki%3AHistory_short?action=edit&redlink=1\" class=\"new\" title=\"MediaWiki:History_short (page does not exist)\">MediaWiki:History_short</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">MediaWiki:history short</span>}}</span></span>"
	},
	{
		"desc": "Invalid header with following text",
		"wikitext": "= x = y",
		"html": "<p>= x = y\n</p>",
		"render": "<p>= x = y\n</p>",
		"print": "<span class=\"wpb-root\">= x = y</span>"
	},
	{
		"desc": "Section extraction test (section 0)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 1)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 2)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 3)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 4)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 5)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 6)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 7)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 8)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 9)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (section 10)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test (nonexistent section 11)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section extraction test with bogus heading (section 1)",
		"wikitext": "==a==\n==bogus== not a legal section\n==b==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n==bogus== not a legal section\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span></span>"
	},
	{
		"desc": "Section extraction test with bogus heading (section 2)",
		"wikitext": "==a==\n==bogus== not a legal section\n==b==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n==bogus== not a legal section\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span></span>"
	},
	{
		"desc": "Section extraction test with comment after heading (section 1)",
		"wikitext": "==a==\n==b== <!-- -->\n==c==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==<span class=\"wpb-heading-trail\"> <span class=\"wpb-comment\">&lt;!-- --&gt;</span></span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span></span>"
	},
	{
		"desc": "Section extraction test with comment after heading (section 2)",
		"wikitext": "==a==\n==b== <!-- -->\n==c==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==<span class=\"wpb-heading-trail\"> <span class=\"wpb-comment\">&lt;!-- --&gt;</span></span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span></span>"
	},
	{
		"desc": "Section extraction test with bogus <nowiki> heading (section 1)",
		"wikitext": "==a==\n==bogus== <nowiki>not a legal section</nowiki>\n==b==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n==bogus== <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">not a legal section</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span></span>"
	},
	{
		"desc": "Section extraction test with bogus <nowiki> heading (section 2)",
		"wikitext": "==a==\n==bogus== <nowiki>not a legal section</nowiki>\n==b==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n==bogus== <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">not a legal section</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span></span>"
	},
	{
		"desc": "Section extraction prefixed by comment (section 1)",
		"wikitext": "<!-- -->==sec1==\n==sec2==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- --&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">sec1</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">sec2</span>==</span></span>"
	},
	{
		"desc": "Section extraction prefixed by comment (section 2)",
		"wikitext": "<!-- -->==sec1==\n==sec2==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- --&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">sec1</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">sec2</span>==</span></span>"
	},
	{
		"desc": "Section extraction, mixed wiki and html (section 1)",
		"wikitext": "<h2>unmarked</h2>\nunmarked\n==1==\none\n==2==\ntwo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;h2&gt;</span>unmarked<span class=\"wpb-html\">&lt;/h2&gt;</span>\nunmarked\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">1</span>==</span>\none\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">2</span>==</span>\ntwo</span>"
	},
	{
		"desc": "Section extraction, mixed wiki and html (section 2)",
		"wikitext": "<h2>unmarked</h2>\nunmarked\n==1==\none\n==2==\ntwo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;h2&gt;</span>unmarked<span class=\"wpb-html\">&lt;/h2&gt;</span>\nunmarked\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">1</span>==</span>\none\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">2</span>==</span>\ntwo</span>"
	},
	{
		"desc": "Section extraction, heading surrounded by <noinclude>",
		"wikitext": "<noinclude>==unmarked==</noinclude>\n==marked==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">unmarked</span>==<span class=\"wpb-heading-trail\"><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span></span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">marked</span>==</span></span>"
	},
	{
		"desc": "Sectiion with all-equals",
		"wikitext": "=== \nThe line above must have a trailing space\n=== <!--\n--> <!-- -->\nBut just in case it doesn't...",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=</span>=<span class=\"wpb-heading-trail\"> </span></span>\nThe line above must have a trailing space\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=</span>=<span class=\"wpb-heading-trail\"> <span class=\"wpb-comment\">&lt;!--\n--&gt;</span> <span class=\"wpb-comment\">&lt;!-- --&gt;</span></span></span>\nBut just in case it doesn't...</span>"
	},
	{
		"desc": "Section replacement test (section 0)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 1)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 2)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 3)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 4)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 5)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 6)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 7)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 8)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 9)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test (section 10)",
		"wikitext": "start\n==a==\n===aa===\n====aaa====\n==b==\n===ba===\n===bb===\n====bba====\n===bc===\n==c==\n===ca===",
		"print": "<span class=\"wpb-root\">start\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">aa</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">aaa</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ba</span>===</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bb</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">bba</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">bc</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">ca</span>===</span></span>"
	},
	{
		"desc": "Section replacement test with initial whitespace (T15728)",
		"wikitext": " Preformatted initial line\n==a==\n===a===",
		"print": "<span class=\"wpb-root\"> Preformatted initial line\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">a</span>===</span></span>"
	},
	{
		"desc": "Section extraction, heading followed by pre with 20 spaces (T8398)",
		"wikitext": "==a==\n                    a",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n                    a</span>"
	},
	{
		"desc": "Section extraction, heading followed by pre with 19 spaces (T8398 check)",
		"wikitext": "==a==\n                   a",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n                   a</span>"
	},
	{
		"desc": "Section extraction, <pre> around bogus header (T12309)",
		"wikitext": "== Section One ==\n<pre>\n=======\n</pre>\n\n== Section Two ==\nstuff",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Section One </span>==</span>\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n=======\n</span>&lt;/pre&gt;</span>\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Section Two </span>==</span>\nstuff</span>"
	},
	{
		"desc": "Section replacement, <pre> around bogus header (T12309)",
		"wikitext": "== Section One ==\n<pre>\n=======\n</pre>\n\n== Section Two ==\nstuff",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Section One </span>==</span>\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n=======\n</span>&lt;/pre&gt;</span>\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Section Two </span>==</span>\nstuff</span>"
	},
	{
		"desc": "Handling of &#x0A; in URLs",
		"wikitext": "*irc://&#x0A;a",
		"html": "<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"irc://%0Aa\">irc://%0Aa</a></li></ul>",
		"render": "<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"irc://a\">irc://&#x0A;a</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">irc://&amp;#x0A;a</span></span>"
	},
	{
		"desc": "Handling of %0A in URLs",
		"wikitext": "*irc://%0Aa",
		"html": "<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"irc://%0Aa\">irc://%0Aa</a></li></ul>",
		"render": "<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"irc://%0Aa\">irc://%0Aa</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">irc://%0Aa</span></span>"
	},
	{
		"desc": "5 quotes, code coverage +1 line",
		"wikitext": "'''''",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Special:Search page linking.",
		"wikitext": "{{Special:search}}",
		"html": "<p><a href=\"/wiki/Special:Search\" title=\"Special:Search\">Special:Search</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ASearch?action=edit&redlink=1\" class=\"new\" title=\"Special:Search (page does not exist)\">Special:Search</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Special:search</span>}}</span></span>"
	},
	{
		"desc": "{{!}} is a magic word",
		"wikitext": "{{!}} is a magic word there and {{!}} is still a magic word here\n| is not a magic word here but {{!}} is still a magic word here",
		"html": "<p>| is a magic word there and | is still a magic word here\n| is not a magic word here but | is still a magic word here\n</p>",
		"render": "<p>| is a magic word there and | is still a magic word here\n| is not a magic word here but | is still a magic word here\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> is a magic word there and <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> is still a magic word here\n| is not a magic word here but <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> is still a magic word here</span>"
	},
	{
		"desc": "Single {{!}} in table cell",
		"wikitext": "{|\n| colspan=\"1\" |foo {{!}} bar\n|}",
		"html": "<table>\n<tbody><tr>\n<td colspan=\"1\">foo | bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td colspan=\"1\">foo | bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">colspan</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span> </span>|<span class=\"wpb-td-inner\">foo <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Using {{!}} in wikilinks (T290526)",
		"wikitext": "[[Main Page{{!}}Something else]]\n\n[[{{T290526}}]]",
		"html": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Something else</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Something else</a>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Something else</a>\n</p><p><a href=\"/wiki/Main_Page\" title=\"Main Page\">Something else</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>{{!}}<span class=\"wpb-link-text\">Something else</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">T290526</span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Using {{!}} in template arguments (T290526)",
		"wikitext": "{{1x|Main Page{{!}}Something else}}\n\n{{1x|{{T290526}}}}",
		"html": "<p>Main Page|Something else\n</p><p>Main Page|Something else\n</p>",
		"render": "<p>Main Page|Something else\n</p><p>Main Page|Something else\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Main Page<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>Something else</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">T290526</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Using {{!}} in template arguments, part 2 (T290526)",
		"wikitext": "{{ Main Page|Something else }}\n\n{{ {{T290526}} }}",
		"html": "<p><a href=\"/index.php?title=Template:Main_Page&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:Main Page (page does not exist)\">Template:Main Page</a>\n</p><p>{{ Main Page|Something else }}\n</p>",
		"render": "<p><a href=\"/wiki/Template%3AMain_Page?action=edit&redlink=1\" class=\"new\" title=\"Template:Main_Page (page does not exist)\">Template:Main_Page</a>\n</p><p>{{ Main Page{{!}}Something else }}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\"> Main Page</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Something else </span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">T290526</span>}}</span> </span>}}</span></span>"
	},
	{
		"desc": "Say the magic word",
		"wikitext": "*{{PAGENAME}}\n*{{PAGENAMEE}}\n*{{FULLPAGENAME}}\n*{{FULLPAGENAMEE}}\n*{{BASEPAGENAME}}\n*{{BASEPAGENAMEE}}\n*{{SUBPAGENAME}}\n*{{SUBPAGENAMEE}}\n*{{ROOTPAGENAME}}\n*{{ROOTPAGENAMEE}}\n*{{TALKPAGENAME}}\n*{{TALKPAGENAMEE}}\n*{{SUBJECTPAGENAME}}\n*{{SUBJECTPAGENAMEE}}\n*{{NAMESPACEE}}\n*{{NAMESPACE}}\n*{{NAMESPACENUMBER}}\n*{{TALKSPACE}}\n*{{TALKSPACEE}}\n*{{SUBJECTSPACE}}\n*{{SUBJECTSPACEE}}\n*{{Dynamic|{{NUMBEROFUSERS}}|{{NUMBEROFPAGES}}|{{CURRENTVERSION}}|{{CONTENTLANGUAGE}}|{{DIRECTIONMARK}}|{{CURRENTTIMESTAMP}}|{{NUMBEROFARTICLES}}}}",
		"html": "<ul><li>Parser test</li>\n<li>Parser_test</li>\n<li>Parser test</li>\n<li>Parser_test</li>\n<li>Parser test</li>\n<li>Parser_test</li>\n<li>Parser test</li>\n<li>Parser_test</li>\n<li>Parser test</li>\n<li>Parser_test</li>\n<li>Talk:Parser test</li>\n<li>Talk:Parser_test</li>\n<li>Parser test</li>\n<li>Parser_test</li>\n<li class=\"mw-empty-elt\"></li>\n<li class=\"mw-empty-elt\"></li>\n<li>0</li>\n<li>Talk</li>\n<li>Talk</li>\n<li class=\"mw-empty-elt\"></li>\n<li class=\"mw-empty-elt\"></li>\n<li><a href=\"/index.php?title=Template:Dynamic&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:Dynamic (page does not exist)\">Template:Dynamic</a></li></ul>",
		"render": "<ul><li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li><a href=\"/wiki/Template%3ADynamic?action=edit&redlink=1\" class=\"new\" title=\"Template:Dynamic (page does not exist)\">Template:Dynamic</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">FULLPAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">FULLPAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">BASEPAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">BASEPAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBPAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBPAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ROOTPAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ROOTPAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKPAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKPAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTPAGENAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTPAGENAMEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NAMESPACEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NAMESPACE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NAMESPACENUMBER</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKSPACE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKSPACEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTSPACE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTSPACEE</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Dynamic</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NUMBEROFUSERS</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NUMBEROFPAGES</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTVERSION</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CONTENTLANGUAGE</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DIRECTIONMARK</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTTIMESTAMP</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NUMBEROFARTICLES</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "HTML Hex character encoding (spells the word \"JavaScript\")",
		"wikitext": "&#x4A;&#x061;&#x0076;&#x00061;&#x000053;&#x0000063;&#114;&#x0000069;&#00000112;&#x0000000074;",
		"html": "<p>&#x4a;&#x61;&#x76;&#x61;&#x53;&#x63;&#114;&#x69;&#112;&#x74;\n</p>",
		"render": "<p>&#x4A;&#x061;&#x0076;&#x00061;&#x000053;&#x0000063;&#114;&#x0000069;&#00000112;&#x0000000074;\n</p>",
		"print": "<span class=\"wpb-root\">&amp;#x4A;&amp;#x061;&amp;#x0076;&amp;#x00061;&amp;#x000053;&amp;#x0000063;&amp;#114;&amp;#x0000069;&amp;#00000112;&amp;#x0000000074;</span>"
	},
	{
		"desc": "HTML Hex character encoding bogus encoding (T28437 regression check)",
		"wikitext": "&#xsee;&#XSEE;",
		"html": "<p>&amp;#xsee;&amp;#XSEE;\n</p>",
		"render": "<p>&#xsee;&#XSEE;\n</p>",
		"print": "<span class=\"wpb-root\">&amp;#xsee;&amp;#XSEE;</span>"
	},
	{
		"desc": "HTML Hex character encoding mixed case",
		"wikitext": "&#xEE;&#Xee;",
		"html": "<p>&#xee;&#xee;\n</p>",
		"render": "<p>&#xEE;&#Xee;\n</p>",
		"print": "<span class=\"wpb-root\">&amp;#xEE;&amp;#Xee;</span>"
	},
	{
		"desc": "Illegal character references (T106578, T113194)",
		"wikitext": "; Null: &#00;\n; FF: &#xC;\n; CR: &#xD;\n; Control (low): &#8;\n; Control (high): &#x7F; &#x9F;\n; Unsupported legacy: &#128; &#130; &#131; &#150; &#159;\n; Surrogate: &#xD83D;&#xDCA9;\n; Invalid characters: &#xfffe; &#xffff;\n; This is an okay astral character: &#x1F4A9;\n; This is an okay multi-codepoint HTML5 entity: &acE;\n; This are valid wikitext-specific entities: &◊®◊ú◊û; &ÿ±ŸÑŸÖ;\n; Highest valid characters: &#x10fffd; &#x10fffe; &#x10ffff;",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">; </span>Null<span class=\"wpb-dd\">:</span> &amp;#00;\n<span class=\"wpb-list\">; </span>FF: &amp;#xC;\n<span class=\"wpb-list\">; </span>CR: &amp;#xD;\n<span class=\"wpb-list\">; </span>Control (low): &amp;#8;\n<span class=\"wpb-list\">; </span>Control (high): &amp;#x7F; &amp;#x9F;\n<span class=\"wpb-list\">; </span>Unsupported legacy: &amp;#128; &amp;#130; &amp;#131; &amp;#150; &amp;#159;\n<span class=\"wpb-list\">; </span>Surrogate: &amp;#xD83D;&amp;#xDCA9;\n<span class=\"wpb-list\">; </span>Invalid characters: &amp;#xfffe; &amp;#xffff;\n<span class=\"wpb-list\">; </span>This is an okay astral character: &amp;#x1F4A9;\n<span class=\"wpb-list\">; </span>This is an okay multi-codepoint HTML5 entity: &amp;acE;\n<span class=\"wpb-list\">; </span>This are valid wikitext-specific entities: &amp;◊®◊ú◊û; &amp;ÿ±ŸÑŸÖ;\n<span class=\"wpb-list\">; </span>Highest valid characters: &amp;#x10fffd; &amp;#x10fffe; &amp;#x10ffff;</span>"
	},
	{
		"desc": "ISBN code coverage",
		"wikitext": "ISBN  978-0-1234-56&#x20;789",
		"html": "<p><a href=\"/wiki/Special:BookSources/9780123456\" class=\"internal mw-magiclink-isbn\">ISBN 978-0-1234-56</a>&#x20;789\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F9780123456\">ISBN 978-0-1234-56</a>&#x20;789\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN  978-0-1234-56</span>&amp;#x20;789</span>"
	},
	{
		"desc": "ISBN followed by 5 spaces",
		"wikitext": "ISBN",
		"html": "<p>ISBN    \n</p>",
		"render": "<p>ISBN\n</p>",
		"print": "<span class=\"wpb-root\">ISBN</span>"
	},
	{
		"desc": "Double ISBN",
		"wikitext": "ISBN ISBN 1234567890",
		"html": "<p>ISBN <a href=\"/wiki/Special:BookSources/1234567890\" class=\"internal mw-magiclink-isbn\">ISBN 1234567890</a>\n</p>",
		"render": "<p>ISBN <a href=\"/wiki/Special%3ABookSources%2F1234567890\">ISBN 1234567890</a>\n</p>",
		"print": "<span class=\"wpb-root\">ISBN <span class=\"wpb-magic-link\">ISBN 1234567890</span></span>"
	},
	{
		"desc": "ISBN with an X",
		"wikitext": "ISBN 3-462-04561-X\nISBN 3-462-04561-x\nISBN 080442957X\nISBN 080442957x\nISBN 978080442957X\nISBN 978080442957x",
		"html": "<p><a href=\"/wiki/Special:BookSources/346204561X\" class=\"internal mw-magiclink-isbn\">ISBN 3-462-04561-X</a>\n<a href=\"/wiki/Special:BookSources/346204561X\" class=\"internal mw-magiclink-isbn\">ISBN 3-462-04561-x</a>\n<a href=\"/wiki/Special:BookSources/080442957X\" class=\"internal mw-magiclink-isbn\">ISBN 080442957X</a>\n<a href=\"/wiki/Special:BookSources/080442957X\" class=\"internal mw-magiclink-isbn\">ISBN 080442957x</a>\n<a href=\"/wiki/Special:BookSources/978080442957X\" class=\"internal mw-magiclink-isbn\">ISBN 978080442957X</a>\n<a href=\"/wiki/Special:BookSources/978080442957X\" class=\"internal mw-magiclink-isbn\">ISBN 978080442957x</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F346204561X\">ISBN 3-462-04561-X</a>\n<a href=\"/wiki/Special%3ABookSources%2F346204561X\">ISBN 3-462-04561-x</a>\n<a href=\"/wiki/Special%3ABookSources%2F080442957X\">ISBN 080442957X</a>\n<a href=\"/wiki/Special%3ABookSources%2F080442957X\">ISBN 080442957x</a>\n<a href=\"/wiki/Special%3ABookSources%2F978080442957X\">ISBN 978080442957X</a>\n<a href=\"/wiki/Special%3ABookSources%2F978080442957X\">ISBN 978080442957x</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 3-462-04561-X</span>\n<span class=\"wpb-magic-link\">ISBN 3-462-04561-x</span>\n<span class=\"wpb-magic-link\">ISBN 080442957X</span>\n<span class=\"wpb-magic-link\">ISBN 080442957x</span>\n<span class=\"wpb-magic-link\">ISBN 978080442957X</span>\n<span class=\"wpb-magic-link\">ISBN 978080442957x</span></span>"
	},
	{
		"desc": "ISBN with empty prefix (parsoid test)",
		"wikitext": "ISBN 1234567890",
		"html": "<p><a href=\"/wiki/Special:BookSources/1234567890\" class=\"internal mw-magiclink-isbn\">ISBN 1234567890</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F1234567890\">ISBN 1234567890</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 1234567890</span></span>"
	},
	{
		"desc": "T24905: <abbr> followed by ISBN followed by </a>",
		"wikitext": "<abbr>(fr)</abbr> ISBN 2753300917 [http://www.example.com example.com]",
		"html": "<p><abbr>(fr)</abbr> <a href=\"/wiki/Special:BookSources/2753300917\" class=\"internal mw-magiclink-isbn\">ISBN 2753300917</a> <a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">example.com</a>\n</p>",
		"render": "<p><abbr >(fr)</abbr> <a href=\"/wiki/Special%3ABookSources%2F2753300917\">ISBN 2753300917</a> <a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">example.com</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;abbr&gt;</span>(fr)<span class=\"wpb-html\">&lt;/abbr&gt;</span> <span class=\"wpb-magic-link\">ISBN 2753300917</span> <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">example.com</span>]</span></span>"
	},
	{
		"desc": "Double RFC",
		"wikitext": "RFC RFC 1234",
		"html": "<p>RFC <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc1234\">RFC 1234</a>\n</p>",
		"render": "<p>RFC <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc1234\">RFC 1234</a>\n</p>",
		"print": "<span class=\"wpb-root\">RFC <span class=\"wpb-magic-link\">RFC 1234</span></span>"
	},
	{
		"desc": "Double RFC with a wiki link",
		"wikitext": "RFC [[RFC 1234]]",
		"html": "<p>RFC <a href=\"/index.php?title=RFC_1234&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"RFC 1234 (page does not exist)\">RFC 1234</a>\n</p>",
		"render": "<p>RFC <a href=\"/wiki/RFC_1234\" title=\"RFC 1234\">RFC 1234</a>\n</p>",
		"print": "<span class=\"wpb-root\">RFC <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">RFC 1234</span>]]</span></span>"
	},
	{
		"desc": "RFC code coverage",
		"wikitext": "RFC   983&#x20;987",
		"html": "<p><a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc983\">RFC 983</a>&#x20;987\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc983\">RFC 983</a>&#x20;987\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">RFC   983</span>&amp;#x20;987</span>"
	},
	{
		"desc": "Another italics / bold test",
		"wikitext": " ''' ''x'",
		"html": "<pre>'<i> </i>x'\n</pre>",
		"render": "<pre>'<i> </i>x'\n</pre>",
		"print": "<span class=\"wpb-root\"> '<span class=\"wpb-quote\">''</span> <span class=\"wpb-quote\">''</span>x'</span>"
	},
	{
		"desc": "dt/dd/dl test",
		"wikitext": ":;;;::",
		"html": "<dl><dd><dl><dt><dl><dt><dl><dt><dl><dd><dl><dd></dd></dl></dd></dl></dt></dl></dt></dl></dt></dl></dd></dl>",
		"render": "<dl><dd><dl><dt><dl><dt><dl><dt><dl><dd><dl><dd></dd></dl></dd></dl></dt></dl></dt></dl></dt></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;::</span></span>"
	},
	{
		"desc": "[Before] HTML without raw HTML enabled ($wgRawHtml==false)",
		"wikitext": "<html><script>alert(1);</script></html>",
		"html": "<p>&lt;html&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/html&gt;\n</p>",
		"render": "<p>&lt;html&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/html&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;html&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/html&gt;</span>"
	},
	{
		"desc": "HTML with raw HTML ($wgRawHtml==true)",
		"wikitext": "<html><script>alert(1);</script></html>",
		"print": "<span class=\"wpb-root\">&lt;html&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/html&gt;</span>"
	},
	{
		"desc": "Empty tag w/ raw HTML ($wgRawHtml==true)",
		"wikitext": "<html />",
		"print": "<span class=\"wpb-root\">&lt;html /&gt;</span>"
	},
	{
		"desc": "Parents of subpages, one level up",
		"wikitext": "[[../|L2]]",
		"html": "<p><a href=\"/wiki/Subpage_test/L1/L2\" title=\"Subpage test/L1/L2\">L2</a>\n</p>",
		"render": "<p><a href=\"/wiki/..%2F\" title=\"../\">L2</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../</span>|<span class=\"wpb-link-text\">L2</span>]]</span></span>"
	},
	{
		"desc": "Parents of subpages, one level up, not named",
		"wikitext": "[[../]]",
		"html": "<p><a href=\"/wiki/Subpage_test/L1/L2\" title=\"Subpage test/L1/L2\">Subpage test/L1/L2</a>\n</p>",
		"render": "<p><a href=\"/wiki/..%2F\" title=\"../\">../</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../</span>]]</span></span>"
	},
	{
		"desc": "Parents of subpages, two levels up",
		"wikitext": "[[../../|L1]]2\n\n[[../../|L1]]l",
		"html": "<p><a href=\"/wiki/Subpage_test/L1\" title=\"Subpage test/L1\">L1</a>2\n</p><p><a href=\"/wiki/Subpage_test/L1\" title=\"Subpage test/L1\">L1l</a>\n</p>",
		"render": "<p><a href=\"/wiki/..%2F..%2F\" title=\"../../\">L1</a>2\n</p><p><a href=\"/wiki/..%2F..%2F\" title=\"../../\">L1</a>l\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../../</span>|<span class=\"wpb-link-text\">L1</span>]]</span>2\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../../</span>|<span class=\"wpb-link-text\">L1</span>]]</span>l</span>"
	},
	{
		"desc": "Parents of subpages, two levels up, without trailing slash or name.",
		"wikitext": "[[../..]]",
		"html": "<p>[[../..]]\n</p>",
		"render": "<p>[[../..]]\n</p>",
		"print": "<span class=\"wpb-root\">[[../..]]</span>"
	},
	{
		"desc": "Parents of subpages, two levels up, with lots of extra trailing slashes.",
		"wikitext": "[[../../////]]",
		"html": "<p><a href=\"/wiki/Subpage_test/L1\" title=\"Subpage test/L1\">Subpage test/L1</a>\n</p>",
		"render": "<p><a href=\"/wiki/..%2F..%2F%2F%2F%2F%2F\" title=\"../../////\">../../////</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">../../////</span>]]</span></span>"
	},
	{
		"desc": "Transclusion of a sibling page (one level up)",
		"wikitext": "{{../L3Sibling}}",
		"html": "<p>Sibling article\n</p>",
		"render": "<p><a href=\"/wiki/..%2FL3Sibling?action=edit&redlink=1\" class=\"new\" title=\"../L3Sibling (page does not exist)\">../L3Sibling</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">../L3Sibling</span>}}</span></span>"
	},
	{
		"desc": "Transclusion of a child page",
		"wikitext": "{{/L3Sibling}}",
		"html": "<p>Sibling article\n</p>",
		"render": "<p><a href=\"/wiki/Template%3A%2FL3Sibling?action=edit&redlink=1\" class=\"new\" title=\"Template:/L3Sibling (page does not exist)\">Template:/L3Sibling</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">/L3Sibling</span>}}</span></span>"
	},
	{
		"desc": "Non-transclusion because of too many up levels",
		"wikitext": "{{../../../../More than parent}}",
		"html": "<p>{{../../../../More than parent}}\n</p>",
		"render": "<p><a href=\"/wiki/..%2F..%2F..%2F..%2FMore_than_parent?action=edit&redlink=1\" class=\"new\" title=\"../../../../More_than_parent (page does not exist)\">../../../../More_than_parent</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">../../../../More than parent</span>}}</span></span>"
	},
	{
		"desc": "Definition list code coverage",
		"wikitext": ";title   :def\n;title :def\n;title:def",
		"html": "<dl><dt>title</dt>\n<dd>def</dd>\n<dt>title</dt>\n<dd>def</dd>\n<dt>title</dt>\n<dd>def</dd></dl>",
		"render": "<dl><dt>title</dt>\n<dd>def</dd>\n<dt>title</dt>\n<dd>def</dd>\n<dt>title</dt>\n<dd>def</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>title   <span class=\"wpb-dd\">:</span>def\n<span class=\"wpb-list\">;</span>title <span class=\"wpb-dd\">:</span>def\n<span class=\"wpb-list\">;</span>title<span class=\"wpb-dd\">:</span>def</span>"
	},
	{
		"desc": "Don't fall for the self-closing div",
		"wikitext": "<div>hello world</div/>",
		"html": "<div>hello world</div>",
		"render": "<div >hello world</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>hello world<span class=\"wpb-html\">&lt;/div/&gt;</span></span>"
	},
	{
		"desc": "MSGNW magic word",
		"wikitext": "{{MSGNW:msg}}",
		"html": "<p>&#91;&#91;:Template:Msg&#93;&#93;\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">MSGNW</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">msg</span></span>}}</span></span>"
	},
	{
		"desc": "RAW magic word",
		"wikitext": "{{RAW:QUERTY}}",
		"html": "<p><a href=\"/index.php?title=Template:QUERTY&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:QUERTY (page does not exist)\">Template:QUERTY</a>\n</p>",
		"render": "<p><a href=\"/wiki/Template%3AQUERTY?action=edit&redlink=1\" class=\"new\" title=\"Template:QUERTY (page does not exist)\">Template:QUERTY</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{RAW:<span class=\"wpb-template-name\">QUERTY</span>}}</span></span>"
	},
	{
		"desc": "Always escape literal '>' in output, not just after '<'",
		"wikitext": "><>",
		"html": "<p>&gt;&lt;&gt;\n</p>",
		"render": "<p>&gt;&lt;&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&gt;&lt;&gt;</span>"
	},
	{
		"desc": "Template caching",
		"wikitext": "{{Test}}\n{{Test}}",
		"html": "<p>This is a test template\nThis is a test template\n</p>",
		"render": "<p>This is a test template\nThis is a test template\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Test</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Test</span>}}</span></span>"
	},
	{
		"desc": "ISBN with a dummy number",
		"wikitext": "ISBN ---",
		"html": "<p>ISBN ---\n</p>",
		"render": "<p>ISBN ---\n</p>",
		"print": "<span class=\"wpb-root\">ISBN ---</span>"
	},
	{
		"desc": "ISBN with space-delimited number",
		"wikitext": "ISBN 92 9017 032 8",
		"html": "<p><a href=\"/wiki/Special:BookSources/9290170328\" class=\"internal mw-magiclink-isbn\">ISBN 92 9017 032 8</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F9290170328\">ISBN 92 9017 032 8</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 92 9017 032 8</span></span>"
	},
	{
		"desc": "ISBN with multiple spaces, no number",
		"wikitext": "ISBN  foo",
		"html": "<p>ISBN  foo\n</p>",
		"render": "<p>ISBN  foo\n</p>",
		"print": "<span class=\"wpb-root\">ISBN  foo</span>"
	},
	{
		"desc": "ISBN length",
		"wikitext": "ISBN 123456789\n\nISBN 1234567890\n\nISBN 12345678901",
		"html": "<p>ISBN 123456789\n</p><p><a href=\"/wiki/Special:BookSources/1234567890\" class=\"internal mw-magiclink-isbn\">ISBN 1234567890</a>\n</p><p>ISBN 12345678901\n</p>",
		"render": "<p>ISBN 123456789\n</p><p><a href=\"/wiki/Special%3ABookSources%2F1234567890\">ISBN 1234567890</a>\n</p><p>ISBN 12345678901\n</p>",
		"print": "<span class=\"wpb-root\">ISBN 123456789\n\n<span class=\"wpb-magic-link\">ISBN 1234567890</span>\n\nISBN 12345678901</span>"
	},
	{
		"desc": "ISBN with trailing year (T9110)",
		"wikitext": "ISBN 1-234-56789-0 - 2006\n\nISBN 1 234 56789 0 - 2006",
		"html": "<p><a href=\"/wiki/Special:BookSources/1234567890\" class=\"internal mw-magiclink-isbn\">ISBN 1-234-56789-0</a> - 2006\n</p><p><a href=\"/wiki/Special:BookSources/1234567890\" class=\"internal mw-magiclink-isbn\">ISBN 1 234 56789 0</a> - 2006\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F1234567890\">ISBN 1-234-56789-0</a> - 2006\n</p><p><a href=\"/wiki/Special%3ABookSources%2F1234567890\">ISBN 1 234 56789 0</a> - 2006\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 1-234-56789-0</span> - 2006\n\n<span class=\"wpb-magic-link\">ISBN 1 234 56789 0</span> - 2006</span>"
	},
	{
		"desc": "anchorencode",
		"wikitext": "{{anchorencode:foo bar¬©#%n}}",
		"html": "<p>foo_bar¬©#%n\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo bar¬©#%n</span></span>}}</span></span>"
	},
	{
		"desc": "anchorencode (legacy)",
		"wikitext": "{{anchorencode:foo bar¬©#%n}}",
		"html": "<p>foo_bar.C2.A9.23.25n\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo bar¬©#%n</span></span>}}</span></span>"
	},
	{
		"desc": "anchorencode trims spaces",
		"wikitext": "{{anchorencode: __pretty__please__}}",
		"html": "<p>pretty_please\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> __pretty__please__</span></span>}}</span></span>"
	},
	{
		"desc": "anchorencode deals with links",
		"wikitext": "{{anchorencode: [[hello|world]] [[hi]]}}",
		"html": "<p>world_hi\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">hello</span>|<span class=\"wpb-link-text\">world</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">hi</span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "anchorencode deals with templates",
		"wikitext": "{{anchorencode: {{Foo}} x}}",
		"html": "<p>FOO_x\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Foo</span>}}</span> x</span></span>}}</span></span>"
	},
	{
		"desc": "anchorencode encodes like the TOC generator: (T20431)",
		"wikitext": "===_ +:.3A%3A _ &&amp;]] x===\n{{anchorencode: _ +:.3A%3A _ &&amp;]] x}}\n\n__NOEDITSECTION__",
		"html": "<div class=\"mw-heading mw-heading3\"><h3 id=\"+:.3A%3A_&amp;&amp;]]_x\"><span id=\".2B:.3A.253A_.26.26.5D.5D_x\"></span>_ +:.3A%3A _ &amp;&amp;]] x</h3></div>\n<p>+:.3A%253A_&amp;&amp;&#93;&#93;_x\n</p><p><br />\n</p>",
		"render": "<div class=\"mw-heading mw-heading3\"><h3 id=\"_+:.3A%3A_&amp;&amp;]]_x\">_ +:.3A%3A _ &&amp;]] x</h3></div>\n<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">_ +:.3A%3A _ &amp;&amp;amp;]] x</span>===</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> _ +:.3A%3A _ &amp;&amp;amp;]] x</span></span>}}</span>\n\n<span class=\"wpb-double-underscore\">__NOEDITSECTION__</span></span>"
	},
	{
		"desc": "anchorencode encodes like the TOC generator: (T20431) (legacy)",
		"wikitext": "===_ +:.3A%3A&&amp;]]===\n{{anchorencode: _ +:.3A%3A&&amp;]] }}\n__NOEDITSECTION__",
		"html": "<div class=\"mw-heading mw-heading3\"><h3 id=\".2B:.3A.253A.26.26.5D.5D\">_ +:.3A%3A&amp;&amp;]]</h3></div>\n<p>.2B:.3A.253A.26.26.5D.5D\n</p>",
		"render": "<div class=\"mw-heading mw-heading3\"><h3 id=\"_+:.3A%3A&amp;&amp;]]\">_ +:.3A%3A&&amp;]]</h3></div>\n<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">_ +:.3A%3A&amp;&amp;amp;]]</span>===</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> _ +:.3A%3A&amp;&amp;amp;]] </span></span>}}</span>\n<span class=\"wpb-double-underscore\">__NOEDITSECTION__</span></span>"
	},
	{
		"desc": "T8200: blockquotes and paragraph formatting",
		"wikitext": "<blockquote>\nfoo\n</blockquote>\n\nbar\n\n baz",
		"html": "<blockquote>\n<p>foo\n</p>\n</blockquote>\n<p>bar\n</p>\n<pre>baz\n</pre>",
		"render": "<blockquote >\n<p>foo\n</p>\n</blockquote>\n<p>bar\n</p>\n<pre>baz\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\nfoo\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span>\n\nbar\n\n baz</span>"
	},
	{
		"desc": "T10293: Use of center tag ruins paragraph formatting",
		"wikitext": "<center>\nfoo\n</center>\n\nbar\n\n baz",
		"html": "<center>\n<p>foo\n</p>\n</center>\n<p>bar\n</p>\n<pre>baz\n</pre>",
		"render": "<center >\n<p>foo\n</p>\n</center>\n<p>bar\n</p>\n<pre>baz\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;center&gt;</span>\nfoo\n<span class=\"wpb-html\">&lt;/center&gt;</span>\n\nbar\n\n baz</span>"
	},
	{
		"desc": "Parsing of overlapping (improperly nested) inline html tags",
		"wikitext": "<span><s>x</span></s>",
		"html": "<p><span><s>x</s></span>\n</p>",
		"render": "<p><span ><s >x</span></s>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-html\">&lt;s&gt;</span>x<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-html\">&lt;/s&gt;</span></span>"
	},
	{
		"desc": "T2529: Uncovered bullet",
		"wikitext": "*Foo {{bullet}}",
		"html": "<ul><li>Foo</li>\n<li>Bar</li></ul>",
		"render": "<ul><li>Foo</li>\n<li>Bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>Foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">bullet</span>}}</span></span>"
	},
	{
		"desc": "T2529: Uncovered bullet in a deeply nested list",
		"wikitext": "*******Foo {{bullet}}",
		"html": "<ul><li><ul><li><ul><li><ul><li><ul><li><ul><li><ul><li>Foo</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li>\n<li>Bar</li></ul>",
		"render": "<ul><li><ul><li><ul><li><ul><li><ul><li><ul><li><ul><li>Foo</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li>\n<li>Bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*******</span>Foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">bullet</span>}}</span></span>"
	},
	{
		"desc": "T2529: Uncovered table already at line-start",
		"wikitext": "x\n\n{{table}}\ny",
		"html": "<p>x\n</p>\n<table>\n<tbody><tr>\n<td>1</td>\n<td>2\n</td></tr>\n<tr>\n<td>3</td>\n<td>4\n</td></tr></tbody></table>\n<p>y\n</p>",
		"render": "<p>x\n</p>\n<table >\n<tbody><tr>\n<td >1</td>\n<td >2\n</td></tr><tr >\n<td >3</td>\n<td >4\n</td></tr></tbody></table>\n<p>y\n</p>",
		"print": "<span class=\"wpb-root\">x\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table</span>}}</span>\ny</span>"
	},
	{
		"desc": "T2529: Uncovered bullet in parser function result",
		"wikitext": "*Foo{{lc:{{bullet}} }}",
		"html": "<ul><li>Foo</li>\n<li>bar</li></ul>",
		"render": "<ul><li>Foo</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>Foo<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">lc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">bullet</span>}}</span> </span></span>}}</span></span>"
	},
	{
		"desc": "T7678: Double-parsed template argument",
		"wikitext": "{{lc:{{{1}}}|hello}}",
		"html": "<p>{{{1}}}\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">lc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">1</span>}}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hello</span></span>}}</span></span>"
	},
	{
		"desc": "T7678: Double-parsed template invocation",
		"wikitext": "{{lc:{{paramtest {{!}} param = hello }} }}",
		"html": "<p>{{paramtest | param = hello }}\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">lc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">{{paramtest <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> param = hello }} </span></span>}}</span></span>"
	},
	{
		"desc": "Paragraphs inside divs (no extra line breaks)",
		"wikitext": "<div>Line one\n\nLine two</div>",
		"html": "<div>Line one\nLine two</div>",
		"render": "<div >Line one\nLine two</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>Line one\n\nLine two<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside divs (extra line break on open)",
		"wikitext": "<div>\nLine one\n\nLine two</div>",
		"html": "<div>\n<p>Line one\n</p>\nLine two</div>",
		"render": "<div >\n<p>Line one\n</p>\nLine two</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>\nLine one\n\nLine two<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside divs (extra line break on close)",
		"wikitext": "<div>Line one\n\nLine two\n</div>",
		"html": "<div>Line one\n<p>Line two\n</p>\n</div>",
		"render": "<div >Line one\n<p>Line two\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>Line one\n\nLine two\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside divs (extra line break on open and close)",
		"wikitext": "<div>\nLine one\n\nLine two\n</div>",
		"html": "<div>\n<p>Line one\n</p><p>Line two\n</p>\n</div>",
		"render": "<div >\n<p>Line one\n</p><p>Line two\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>\nLine one\n\nLine two\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Nesting tags, paragraphs on lines which begin with <div>",
		"wikitext": "<div></div><strong>A\nB</strong>",
		"html": "<div></div><p><strong>A\n</strong></p><strong></strong><p><strong>B</strong>\n</p>",
		"render": "<div ></div><strong >A\n<p>B</strong>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;strong&gt;</span>A\nB<span class=\"wpb-html\">&lt;/strong&gt;</span></span>"
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (no extra line breaks)",
		"wikitext": "<blockquote>Line one\n\nLine two</blockquote>",
		"html": "<blockquote><p>Line one\nLine two</p></blockquote>",
		"render": "<blockquote >Line one\nLine two</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>Line one\n\nLine two<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (extra line break on open)",
		"wikitext": "<blockquote>\nLine one\n\nLine two</blockquote>",
		"html": "<blockquote>\n<p>Line one\n</p><p>\nLine two</p></blockquote>",
		"render": "<blockquote >\n<p>Line one\n</p>\nLine two</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\nLine one\n\nLine two<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (extra line break on close)",
		"wikitext": "<blockquote>Line one\n\nLine two\n</blockquote>",
		"html": "<blockquote><p>Line one\n</p><p>Line two\n</p>\n</blockquote>",
		"render": "<blockquote >Line one\n<p>Line two\n</p>\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>Line one\n\nLine two\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (extra line break on open and close)",
		"wikitext": "<blockquote>\nLine one\n\nLine two\n</blockquote>",
		"html": "<blockquote>\n<p>Line one\n</p><p>Line two\n</p>\n</blockquote>",
		"render": "<blockquote >\n<p>Line one\n</p><p>Line two\n</p>\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\nLine one\n\nLine two\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (no extra line breaks)",
		"wikitext": "<blockquote><div>Line one\n\nLine two</div></blockquote>",
		"html": "<blockquote><div>Line one\nLine two</div></blockquote>",
		"render": "<blockquote ><div >Line one\nLine two</div></blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span>Line one\n\nLine two<span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (extra line break on open)",
		"wikitext": "<blockquote><div>\nLine one\n\nLine two</div></blockquote>",
		"html": "<blockquote><div>\n<p>Line one\n</p>\nLine two</div></blockquote>",
		"render": "<blockquote ><div >\n<p>Line one\n</p>\nLine two</div></blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span>\nLine one\n\nLine two<span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (extra line break on close)",
		"wikitext": "<blockquote><div>Line one\n\nLine two\n</div></blockquote>",
		"html": "<blockquote><div>Line one\n<p>Line two\n</p>\n</div></blockquote>",
		"render": "<blockquote ><div >Line one\n<p>Line two\n</p>\n</div></blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span>Line one\n\nLine two\n<span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (extra line break on open and close)",
		"wikitext": "<blockquote><div>\nLine one\n\nLine two\n</div></blockquote>",
		"html": "<blockquote><div>\n<p>Line one\n</p><p>Line two\n</p>\n</div></blockquote>",
		"render": "<blockquote ><div >\n<p>Line one\n</p><p>Line two\n</p>\n</div></blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span>\nLine one\n\nLine two\n<span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Interwiki links trounced by handleExternalLinks after early LinkHolderArray expansion",
		"wikitext": "[[meatball:1]]\n[[meatball:2]]\n[[meatball:3]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">meatball:1</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">meatball:2</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">meatball:3</span>]]</span></span>"
	},
	{
		"desc": "Multibyte character in padleft",
		"wikitext": "{{padleft:-Hello|7|√Ü}}",
		"html": "<p>√Ü-Hello\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padleft</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-Hello</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">7</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">√Ü</span></span>}}</span></span>"
	},
	{
		"desc": "Multibyte character in padright",
		"wikitext": "{{padright:Hello-|7|√Ü}}",
		"html": "<p>Hello-√Ü\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padright</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Hello-</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">7</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">√Ü</span></span>}}</span></span>"
	},
	{
		"desc": "formatdate parser function",
		"wikitext": "{{#formatdate:2009-03-24}}",
		"html": "<p><span class=\"mw-formatted-date\" title=\"2009-03-24\">2009-03-24</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2009-03-24</span></span>}}</span></span>"
	},
	{
		"desc": "formatdate parser function, with default format",
		"wikitext": "{{#formatdate:2009-03-24|mdy}}",
		"html": "<p><span class=\"mw-formatted-date\" title=\"2009-03-24\">March 24, 2009</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2009-03-24</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">mdy</span></span>}}</span></span>"
	},
	{
		"desc": "Spacing of numbers in formatted dates",
		"wikitext": "{{#formatdate:January 15}}",
		"html": "<p><span class=\"mw-formatted-date\" title=\"01-15\">January 15</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">January 15</span></span>}}</span></span>"
	},
	{
		"desc": "formatdate with invalid month",
		"wikitext": "{{#formatdate:2019-22-22|dmy}}",
		"html": "<p>2019-22-22\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2019-22-22</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">dmy</span></span>}}</span></span>"
	},
	{
		"desc": "formatdate uses correct capitalisation in English",
		"wikitext": "{{#formatdate:june 3|dmy}}",
		"html": "<p><span class=\"mw-formatted-date\" title=\"06-03\">3 June</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">june 3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">dmy</span></span>}}</span></span>"
	},
	{
		"desc": "formatdate formats ISO year 0 as 1 BC",
		"wikitext": "{{#formatdate:-0001-12-31|mdy}}\n{{#formatdate:0000-12-31|mdy}}\n{{#formatdate:0001-12-31|mdy}}",
		"html": "<p><span class=\"mw-formatted-date\" title=\"-0001-12-31\">December 31, 2 BC</span>\n<span class=\"mw-formatted-date\" title=\"0000-12-31\">December 31, 1 BC</span>\n<span class=\"mw-formatted-date\" title=\"0001-12-31\">December 31, 1</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-0001-12-31</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">mdy</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">0000-12-31</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">mdy</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#formatdate</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">0001-12-31</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">mdy</span></span>}}</span></span>"
	},
	{
		"desc": "Edit comment with link",
		"wikitext": "I like the [[Main Page]] a lot",
		"print": "<span class=\"wpb-root\">I like the <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span> a lot</span>"
	},
	{
		"desc": "Edit comment with link and link text",
		"wikitext": "I like the [[Main Page|best pages]] a lot",
		"print": "<span class=\"wpb-root\">I like the <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">best pages</span>]]</span> a lot</span>"
	},
	{
		"desc": "Edit comment with link and link text with suffix",
		"wikitext": "I like the [[Main Page|best page]]s a lot",
		"print": "<span class=\"wpb-root\">I like the <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">best page</span>]]</span>s a lot</span>"
	},
	{
		"desc": "Edit comment with section link (non-local, eg in history list)",
		"wikitext": "/* External links */ removed bogus entries",
		"print": "<span class=\"wpb-root\">/* External links */ removed bogus entries</span>"
	},
	{
		"desc": "Edit comment with section link and text before it (non-local, eg in history list)",
		"wikitext": "pre-comment text /* External links */ removed bogus entries",
		"print": "<span class=\"wpb-root\">pre-comment text /* External links */ removed bogus entries</span>"
	},
	{
		"desc": "Edit comment with section link (local, eg in diff view)",
		"wikitext": "/* External links */ removed bogus entries",
		"print": "<span class=\"wpb-root\">/* External links */ removed bogus entries</span>"
	},
	{
		"desc": "Edit comment with section link that has a link in it",
		"wikitext": "/* [[A link]] */",
		"print": "<span class=\"wpb-root\">/* <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">A link</span>]]</span> */</span>"
	},
	{
		"desc": "Edit comment with section link that has a template in it",
		"wikitext": "/* {{foobar|param}} */",
		"print": "<span class=\"wpb-root\">/* <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">foobar</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">param</span></span>}}</span> */</span>"
	},
	{
		"desc": "Edit comment with subpage link (T16080)",
		"wikitext": "Poked at a [[/subpage]] here...",
		"print": "<span class=\"wpb-root\">Poked at a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/subpage</span>]]</span> here...</span>"
	},
	{
		"desc": "Edit comment with subpage link and link text (T16080)",
		"wikitext": "Poked at a [[/subpage|neat little page]] here...",
		"print": "<span class=\"wpb-root\">Poked at a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/subpage</span>|<span class=\"wpb-link-text\">neat little page</span>]]</span> here...</span>"
	},
	{
		"desc": "Edit comment with bogus subpage link in non-subpage NS (T16080)",
		"wikitext": "Poked at a [[/subpage]] here...",
		"print": "<span class=\"wpb-root\">Poked at a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">/subpage</span>]]</span> here...</span>"
	},
	{
		"desc": "Edit comment with bare anchor link (local, as on diff)",
		"wikitext": "[[#section]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#section</span>]]</span></span>"
	},
	{
		"desc": "Edit comment with bare anchor link (non-local, as on history)",
		"wikitext": "[[#section]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#section</span>]]</span></span>"
	},
	{
		"desc": "Anchor starting with underscore",
		"wikitext": "[[#_ref|One]]",
		"html": "<p><a href=\"#_ref\">One</a>\n</p>",
		"render": "<p><a href=\"#_ref\">One</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#_ref</span>|<span class=\"wpb-link-text\">One</span>]]</span></span>"
	},
	{
		"desc": "Id starting with underscore",
		"wikitext": "<div id=\"_ref\"></div>",
		"html": "<div id=\"_ref\"></div>",
		"render": "<div id=\"_ref\"></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">_ref</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Edit comment with link with more than one pipe (T99346)",
		"wikitext": "[[Main Page|Many|pipes]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">Many|pipes</span>]]</span></span>"
	},
	{
		"desc": "Complex edit comment with link with more than one pipe (T99346)",
		"wikitext": "Created page with \"<noinclude>[[Category:Requests for permissions/Bot|{{subst:#titleparts:{{subst:PAGENAME}}|1|3}}]]</noinclude> === [[User:MineoBot|]] 8=== {{Request for permissions/links|Mineo...\"",
		"print": "<span class=\"wpb-root\">Created page with \"<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Requests for permissions/Bot</span>|<span class=\"wpb-link-text\"><span class=\"wpb-magic-word\">{{subst:<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{subst:<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">3</span></span>}}</span></span>]]</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span> === [[User:MineoBot|]] 8=== {{Request for permissions/links|Mineo...\"</span>"
	},
	{
		"desc": "Space normalisation on autocomment (T24784)",
		"wikitext": "/* __hello__world__ */",
		"print": "<span class=\"wpb-root\">/* __hello__world__ */</span>"
	},
	{
		"desc": "percent-encoding and + signs in comments (T28410)",
		"wikitext": "[[ABC%33D% ++]] [[ABC%33D% ++|+%20]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">ABC%33D% ++</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">ABC%33D% ++</span>|<span class=\"wpb-link-text\">+%20</span>]]</span></span>"
	},
	{
		"desc": "Verify that displaytitle works (T24501) no displaytitle",
		"wikitext": "this is not the title",
		"print": "<span class=\"wpb-root\">this is not the title</span>"
	},
	{
		"desc": "Verify that displaytitle works (T24501) RestrictDisplayTitle=false",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:whatever}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">whatever</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle works (T24501) RestrictDisplayTitle=true mismatch",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:whatever}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">whatever</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle works (T24501) RestrictDisplayTitle=true matching",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:screen}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">screen</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle works (T24501) AllowDisplayTitle=false",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:screen}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">screen</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle works (T24501) AllowDisplayTitle=false no DISPLAYTITLE",
		"wikitext": "this is not the title",
		"print": "<span class=\"wpb-root\">this is not the title</span>"
	},
	{
		"desc": "Verify that displaytitle handles inline CSS styles (T28547) - rejected value",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:<span style=\"display: none;\">s</span>creen}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">display: none;</span>\"</span></span>&gt;</span>s<span class=\"wpb-html\">&lt;/span&gt;</span>creen</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle handles inline CSS styles (T28547) - accepted value",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:<span style=\"color: red;\">s</span>creen}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span></span>&gt;</span>s<span class=\"wpb-html\">&lt;/span&gt;</span>creen</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle encodes & to &amp; (T291985)",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:art&copy}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">art&amp;copy</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that displaytitle encodes &amp; to &amp; (T291985)",
		"wikitext": "this is not the title\n{{DISPLAYTITLE:art&amp;copy}}",
		"print": "<span class=\"wpb-root\">this is not the title\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">DISPLAYTITLE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">art&amp;amp;copy</span></span>}}</span></span>"
	},
	{
		"desc": "Verify that without displaytitle the title encodes & to &amp; (T291985)",
		"wikitext": "this is not the title",
		"print": "<span class=\"wpb-root\">this is not the title</span>"
	},
	{
		"desc": "preload: check <noinclude> and <includeonly>",
		"wikitext": "Hello <noinclude>cruel</noinclude><includeonly>kind</includeonly> world.",
		"print": "<span class=\"wpb-root\">Hello <span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>cruel<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span><span class=\"wpb-include\">&lt;includeonly&gt;kind&lt;/includeonly&gt;</span> world.</span>"
	},
	{
		"desc": "preload: check <onlyinclude>",
		"wikitext": "Goodbye <onlyinclude>Hello world</onlyinclude>",
		"print": "<span class=\"wpb-root\">Goodbye <span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span>Hello world<span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span></span>"
	},
	{
		"desc": "preload: can pass tags through if we want to",
		"wikitext": "<includeonly><</includeonly>includeonly>Hello world<includeonly><</includeonly>/includeonly>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;&lt;&lt;/includeonly&gt;</span>includeonly&gt;Hello world<span class=\"wpb-include\">&lt;includeonly&gt;&lt;&lt;/includeonly&gt;</span>/includeonly&gt;</span>"
	},
	{
		"desc": "preload: check that it doesn't try to do tricks",
		"wikitext": "* <!-- Hello --> ''{{world}}'' {{<includeonly>subst:</includeonly>How are you}}{{ {{{|safesubst:}}} #if:1|2|3}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span><span class=\"wpb-comment\">&lt;!-- Hello --&gt;</span> <span class=\"wpb-quote\">''</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">world</span>}}</span><span class=\"wpb-quote\">''</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\"><span class=\"wpb-include\">&lt;includeonly&gt;subst:&lt;/includeonly&gt;</span>How are you</span>}}</span><span class=\"wpb-magic-word\">{{ {{{|safesubst:}}}<span class=\"wpb-magic-word-name\"> #if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">3</span></span>}}</span></span>"
	},
	{
		"desc": "Play a bit with r67090 and T5158",
		"wikitext": "<div style=\"width:50% !important\">&nbsp;</div>\n<div style=\"width:50%&nbsp;!important\">&nbsp;</div>\n<div style=\"width:50%&#160;!important\">&nbsp;</div>\n<div style=\"border : solid;\">&nbsp;</div>",
		"html": "<div style=\"width:50% !important\">&#160;</div>\n<div style=\"width:50%&#160;!important\">&#160;</div>\n<div style=\"width:50%&#160;!important\">&#160;</div>\n<div style=\"border : solid;\">&#160;</div>",
		"render": "<div style=\"width:50% !important\">&nbsp;</div>\n<div style=\"width:50%&nbsp;!important\">&nbsp;</div>\n<div style=\"width:50%&#160;!important\">&nbsp;</div>\n<div style=\"border : solid;\">&nbsp;</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">width:50% !important</span>\"</span></span>&gt;</span>&amp;nbsp;<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">width:50%&amp;nbsp;!important</span>\"</span></span>&gt;</span>&amp;nbsp;<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">width:50%&amp;#160;!important</span>\"</span></span>&gt;</span>&amp;nbsp;<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">border : solid;</span>\"</span></span>&gt;</span>&amp;nbsp;<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "French spaces in wikitext",
		"wikitext": "foo ! bar ? bat 50 % is less than 75 %.\n\nHello : this ; is ¬´ something ‚Äπ else ‚Ä∫ again ¬ª",
		"html": "<p>foo&#160;! bar&#160;? bat 50&#160;% is less than 75&#160;%.\n</p><p>Hello&#160;: this&#160;; is ¬´&#160;something ‚Äπ&#160;else&#160;‚Ä∫ again&#160;¬ª\n</p>",
		"render": "<p>foo ! bar ? bat 50 % is less than 75 %.\n</p><p>Hello : this ; is ¬´ something ‚Äπ else ‚Ä∫ again ¬ª\n</p>",
		"print": "<span class=\"wpb-root\">foo ! bar ? bat 50 % is less than 75 %.\n\nHello : this ; is ¬´ something ‚Äπ else ‚Ä∫ again ¬ª</span>"
	},
	{
		"desc": "Corner case: french spaces in definition list",
		"wikitext": ";foo : bar",
		"html": "<dl><dt>foo</dt>\n<dd>bar</dd></dl>",
		"render": "<dl><dt>foo</dt>\n<dd>bar</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>foo <span class=\"wpb-dd\">:</span> bar</span>"
	},
	{
		"desc": "T5158: Test for French spaces in attributes",
		"wikitext": "<br style=\" clear : both ; \" />",
		"html": "<p><br style=\"clear : both ;\" />\n</p>",
		"render": "<p><br style=\"clear : both ;\">\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"> clear : both ; </span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "HTML5 data attributes",
		"wikitext": "<span data-foo=\"bar\">Baz</span>\n<p data-abc-def_hij=\"\">Quuz</p>",
		"html": "<p><span data-foo=\"bar\">Baz</span>\n</p>\n<p data-abc-def_hij=\"\">Quuz</p>",
		"render": "<p><span >Baz</span>\n</p>\n<p >Quuz</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-foo</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span></span>&gt;</span>Baz<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-html\">&lt;p<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-abc-def_hij</span>=\"\"</span></span>&gt;</span>Quuz<span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Strip reserved data attributes",
		"wikitext": "<div data-mw=\"foo\" data-parsoid=\"bar\" data-mw-someext=\"baz\" data-ok=\"fred\" data-object-id=\"123\" data-ooui=\"xyzzy\" data-bad:ns=\"ns\">d</div>",
		"html": "<div data-ok=\"fred\" data-object-id=\"123\">d</div>",
		"render": "<div       >d</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-mw</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-parsoid</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-mw-someext</span>=\"<span class=\"wpb-attr-value\">baz</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-ok</span>=\"<span class=\"wpb-attr-value\">fred</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-object-id</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-ooui</span>=\"<span class=\"wpb-attr-value\">xyzzy</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-bad:ns</span>=\"<span class=\"wpb-attr-value\">ns</span>\"</span></span>&gt;</span>d<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "percent-encoding and + signs in internal links (T28410)",
		"wikitext": "[[User:+%]] [[Page+title%]]\n[[%+]] [[%+|%20]] [[%+ ]] [[%+r]]\n[[%]] [[+]] [[File:%+abc%39|foo|[[bar]]]]\n[[%33%45]] [[%33%45+]]",
		"html": "<p><a href=\"/index.php?title=User:%2B%25&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"User:+% (page does not exist)\">User:+%</a> <a href=\"/index.php?title=Page%2Btitle%25&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Page+title% (page does not exist)\">Page+title%</a>\n<a href=\"/index.php?title=%25%2B&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"%+ (page does not exist)\">%+</a> <a href=\"/index.php?title=%25%2B&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"%+ (page does not exist)\">%20</a> <a href=\"/index.php?title=%25%2B&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"%+ (page does not exist)\">%+ </a> <a href=\"/index.php?title=%25%2Br&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"%+r (page does not exist)\">%+r</a>\n<a href=\"/index.php?title=%25&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"% (page does not exist)\">%</a> <a href=\"/index.php?title=%2B&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"+ (page does not exist)\">+</a> <span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=%25%2Babc9\" class=\"new\" title=\"File:%+abc9\"><span class=\"mw-file-element mw-broken-media\">bar</span></a></span>\n<a href=\"/index.php?title=3E&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"3E (page does not exist)\">3E</a> <a href=\"/index.php?title=3E%2B&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"3E+ (page does not exist)\">3E+</a>\n</p>",
		"render": "<p><a href=\"/wiki/User%3A%2B%25\" title=\"User:+%\">User:+%</a> <a href=\"/wiki/Page%2Btitle%25\" title=\"Page+title%\">Page+title%</a>\n<a href=\"/wiki/%25%2B\" title=\"%+\">%+</a> <a href=\"/wiki/%25%2B\" title=\"%+\">%20</a> <a href=\"/wiki/%25%2B\" title=\"%+\">%+ </a> <a href=\"/wiki/%25%2Br\" title=\"%+r\">%+r</a>\n<a href=\"/wiki/%25\" title=\"%\">%</a> <a href=\"/wiki/%2B\" title=\"+\">+</a> <span><a href=\"/wiki/File%3A%25%2Babc9\" class=\"mw-file-description\" title=\"bar\"><img alt=\"bar\" src=\"/wiki/File%3A%25%2Babc9\" class=\"mw-file-element\"></a></span>\n<a href=\"/wiki/3E\" title=\"3E\">3E</a> <a href=\"/wiki/3E%2B\" title=\"3E+\">3E+</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">User:+%</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Page+title%</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%+</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%+</span>|<span class=\"wpb-link-text\">%20</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%+ </span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%+r</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">+</span>]]</span> <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:%+abc%39</span>|<span class=\"wpb-image-caption\">foo</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">bar</span>]]</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%33%45</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">%33%45+</span>]]</span></span>"
	},
	{
		"desc": "Confirm that 'apos' named character reference doesn't make it to output (not legal in HTML 4)",
		"wikitext": "Text&apos;s been normalized?",
		"html": "<p>Text&#39;s been normalized?\n</p>",
		"render": "<p>Text&apos;s been normalized?\n</p>",
		"print": "<span class=\"wpb-root\">Text&amp;apos;s been normalized?</span>"
	},
	{
		"desc": "T21052 U+3000 IDEOGRAPHIC SPACE should terminate free external links",
		"wikitext": "http://www.example.org/„ÄÄ<-- U+3000 (vim: ^Vu3000)",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.org/\">http://www.example.org/</a>„ÄÄ&lt;-- U+3000 (vim: ^Vu3000)\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.org/\">http://www.example.org/</a>„ÄÄ&lt;-- U+3000 (vim: ^Vu3000)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.org/</span>„ÄÄ&lt;-- U+3000 (vim: ^Vu3000)</span>"
	},
	{
		"desc": "T21052 U+3000 IDEOGRAPHIC SPACE should terminate bracketed external links",
		"wikitext": "[http://www.example.org/„ÄÄideograms]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.org/\">ideograms</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.org/\">ideograms</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.org/</span>„ÄÄ<span class=\"wpb-ext-link-text\">ideograms</span>]</span></span>"
	},
	{
		"desc": "T21052 U+3000 IDEOGRAPHIC SPACE should terminate external images links",
		"wikitext": "http://www.example.org/pic.png„ÄÄ<-- U+3000 (vim: ^Vu3000)",
		"html": "<p><img src=\"http://www.example.org/pic.png\" alt=\"pic.png\" />„ÄÄ&lt;-- U+3000 (vim: ^Vu3000)\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.org/pic.png\">http://www.example.org/pic.png</a>„ÄÄ&lt;-- U+3000 (vim: ^Vu3000)\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.org/pic.png</span>„ÄÄ&lt;-- U+3000 (vim: ^Vu3000)</span>"
	},
	{
		"desc": "T33098 Template which includes system messages which includes the template",
		"wikitext": "{{Identical}}",
		"html": "<p><span class=\"error\">Template loop detected: <a href=\"/wiki/Template:Identical\" title=\"Template:Identical\">Template:Identical</a></span>\n<span class=\"error\">Template loop detected: <a href=\"/wiki/Template:Identical\" title=\"Template:Identical\">Template:Identical</a></span>\n</p>",
		"render": "<p><a href=\"/wiki/Template%3AIdentical?action=edit&redlink=1\" class=\"new\" title=\"Template:Identical (page does not exist)\">Template:Identical</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Identical</span>}}</span></span>"
	},
	{
		"desc": "T33490 ucfƒ±rst (with a dotless i) with English language",
		"wikitext": "{{ucfƒ±rst:blah}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">ucfƒ±rst:blah</span>}}</span></span>"
	},
	{
		"desc": "T34057: Title needed when expanding <h> nodes.",
		"wikitext": "{{int:T34057}}",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"OK\">OK</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Main_Page&amp;action=edit&amp;section=1\" title=\"Edit section: OK\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">int</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">T34057</span></span>}}</span></span>"
	},
	{
		"desc": "Title needed when expanding templates.",
		"wikitext": "{{Template with pagename}}",
		"html": "<p>This is Main Page.\n</p>",
		"render": "<p>This is .\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Template with pagename</span>}}</span></span>"
	},
	{
		"desc": "Strip marker in urlencode",
		"wikitext": "{{urlencode:x<nowiki/>y}}\n{{urlencode:x<nowiki/>y|wiki}}\n{{urlencode:x<nowiki/>y|path}}\n{{urlencode:x<pre id=\"one\">two</pre>y}}",
		"html": "<p>xy\nxy\nxy\nxy\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wiki</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">path</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">urlencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">one</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">two</span>&lt;/pre&gt;</span>y</span></span>}}</span></span>"
	},
	{
		"desc": "Strip marker in lc",
		"wikitext": "{{lc:x<nowiki/>y}}",
		"html": "<p>xy\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">lc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>}}</span></span>"
	},
	{
		"desc": "Strip marker in uc",
		"wikitext": "{{uc:x<nowiki/>y}}",
		"html": "<p>XY\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">uc</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>}}</span></span>"
	},
	{
		"desc": "Strip marker in formatNum",
		"wikitext": "{{formatnum:1<nowiki/>2}}\n{{formatnum:1<nowiki/>2|R}}",
		"html": "<p>12\n12\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">formatnum</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">formatnum</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">R</span></span>}}</span></span>"
	},
	{
		"desc": "Wrong option for formatNum (T58199)",
		"wikitext": "{{formatnum:1,234.56|Random}}\n{{formatnum:1,234.56|EVERYTHING}}\n{{formatnum:1234.56|any argument that has the string 'NOSEP'}}",
		"html": "<p>1,234.56\n1,234.56\n1,234.56\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">formatnum</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1,234.56</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Random</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">formatnum</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1,234.56</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">EVERYTHING</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">formatnum</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1234.56</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">any argument that has the string 'NOSEP'</span></span>}}</span></span>"
	},
	{
		"desc": "Strip marker in padleft",
		"wikitext": "{{padleft:|2|x<nowiki/>y}}",
		"html": "<p>xy\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padleft</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>}}</span></span>"
	},
	{
		"desc": "Strip marker in padright",
		"wikitext": "{{padright:|2|x<nowiki/>y}}",
		"html": "<p>xy\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padright</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>}}</span></span>"
	},
	{
		"desc": "Strip marker in anchorencode",
		"wikitext": "{{anchorencode:x<nowiki/>y}}",
		"html": "<p>xy\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span></span>}}</span></span>"
	},
	{
		"desc": "new support for bdi element (T33817)",
		"wikitext": "<p dir=\"rtl\" lang=\"he\">◊ï◊ú◊ì◊ô◊û◊ô◊® ◊ú◊†◊ô◊ü (◊ë◊®◊ï◊°◊ô◊™: <bdi lang=\"ru\">–í–ª–∞–¥–∏–º–∏—Ä –õ–µ–Ω–∏–Ω</bdi>, 24 ◊ë◊ê◊§◊®◊ô◊ú 1870‚Äì22 ◊ë◊ô◊†◊ï◊ê◊® 1924) ◊î◊ï◊ê ◊û◊†◊î◊ô◊í ◊§◊ï◊ú◊ô◊ò◊ô ◊ß◊ï◊û◊ï◊†◊ô◊°◊ò◊ô ◊®◊ï◊°◊ô.</p>",
		"html": "<p dir=\"rtl\" lang=\"he\">◊ï◊ú◊ì◊ô◊û◊ô◊® ◊ú◊†◊ô◊ü (◊ë◊®◊ï◊°◊ô◊™: <bdi lang=\"ru\">–í–ª–∞–¥–∏–º–∏—Ä –õ–µ–Ω–∏–Ω</bdi>, 24 ◊ë◊ê◊§◊®◊ô◊ú 1870‚Äì22 ◊ë◊ô◊†◊ï◊ê◊® 1924) ◊î◊ï◊ê ◊û◊†◊î◊ô◊í ◊§◊ï◊ú◊ô◊ò◊ô ◊ß◊ï◊û◊ï◊†◊ô◊°◊ò◊ô ◊®◊ï◊°◊ô.</p>",
		"render": "<p dir=\"rtl\" lang=\"he\">◊ï◊ú◊ì◊ô◊û◊ô◊® ◊ú◊†◊ô◊ü (◊ë◊®◊ï◊°◊ô◊™: <bdi lang=\"ru\">–í–ª–∞–¥–∏–º–∏—Ä –õ–µ–Ω–∏–Ω</bdi>, 24 ◊ë◊ê◊§◊®◊ô◊ú 1870‚Äì22 ◊ë◊ô◊†◊ï◊ê◊® 1924) ◊î◊ï◊ê ◊û◊†◊î◊ô◊í ◊§◊ï◊ú◊ô◊ò◊ô ◊ß◊ï◊û◊ï◊†◊ô◊°◊ò◊ô ◊®◊ï◊°◊ô.</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">lang</span>=\"<span class=\"wpb-attr-value\">he</span>\"</span></span>&gt;</span>◊ï◊ú◊ì◊ô◊û◊ô◊® ◊ú◊†◊ô◊ü (◊ë◊®◊ï◊°◊ô◊™: <span class=\"wpb-html\">&lt;bdi<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">lang</span>=\"<span class=\"wpb-attr-value\">ru</span>\"</span></span>&gt;</span>–í–ª–∞–¥–∏–º–∏—Ä –õ–µ–Ω–∏–Ω<span class=\"wpb-html\">&lt;/bdi&gt;</span>, 24 ◊ë◊ê◊§◊®◊ô◊ú 1870‚Äì22 ◊ë◊ô◊†◊ï◊ê◊® 1924) ◊î◊ï◊ê ◊û◊†◊î◊ô◊í ◊§◊ï◊ú◊ô◊ò◊ô ◊ß◊ï◊û◊ï◊†◊ô◊°◊ò◊ô ◊®◊ï◊°◊ô.<span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Ignore pipe between table row attributes",
		"wikitext": "{|\n|quux\n|- id=foo | style='color: red'\n|bar\n|}",
		"html": "<table>\n<tbody><tr>\n<td>quux\n</td></tr>\n<tr id=\"foo\" style=\"color: red\">\n<td>bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >quux\n</td></tr><tr id=\"foo\" style=\"color: red\">\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">quux</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=<span class=\"wpb-attr-value\">foo</span></span><span class=\"wpb-attr-dirty\"> | </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color: red</span>'</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Language parser function",
		"wikitext": "{{#language:ar}}",
		"html": "<p>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#language</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ar</span></span>}}</span></span>"
	},
	{
		"desc": "Padleft and padright (default 0-padding)",
		"wikitext": "{{padleft:xyz|5}}\n{{padright:xyz|5}}",
		"html": "<p>00xyz\nxyz00\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padleft</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">xyz</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">5</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padright</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">xyz</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">5</span></span>}}</span></span>"
	},
	{
		"desc": "Padleft and padright (partial fill)",
		"wikitext": "{{padleft:xyz|6|ab}}\n{{padright:xyz|6|ab}}",
		"html": "<p>abaxyz\nxyzaba\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padleft</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">xyz</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">6</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ab</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padright</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">xyz</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">6</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ab</span></span>}}</span></span>"
	},
	{
		"desc": "Padleft and padright as substr",
		"wikitext": "{{padleft:|3|abcde}}\n{{padright:|3|abcde}}",
		"html": "<p>abc\nabc\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padleft</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">abcde</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padright</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">abcde</span></span>}}</span></span>"
	},
	{
		"desc": "Padleft and padright with non-numerical length (T180403)",
		"wikitext": "{{padleft:abcdef|junk}}\n{{padright:abcdef|junk}}",
		"html": "<p>abcdef\nabcdef\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padleft</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">abcdef</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">junk</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">padright</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">abcdef</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">junk</span></span>}}</span></span>"
	},
	{
		"desc": "Special parser function",
		"wikitext": "{{#special:RandomPage}}\n{{#special:BaDtItLe}}\n{{#special:Foobar}}",
		"html": "<p>Special:Random\nSpecial:Badtitle\nSpecial:Foobar\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#special</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">RandomPage</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#special</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">BaDtItLe</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#special</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foobar</span></span>}}</span></span>"
	},
	{
		"desc": "Using {{=}} when it expands to \"=\" should not create a tracking category",
		"wikitext": "This uses {{=}} and {{Template:=}}.",
		"html": "<p>This uses = and =.\n</p>",
		"render": "<p>This uses = and no.\n</p>",
		"print": "<span class=\"wpb-root\">This uses <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">=</span>}}</span> and <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Template:=</span>}}</span>.</span>"
	},
	{
		"desc": "Using {{=}} when it expands to \"=\" should not create a tracking category (cat)",
		"wikitext": "This uses {{=}} and {{Template:=}}.",
		"html": "<p>This uses = and =.\n</p>",
		"render": "<p>This uses = and no.\n</p>",
		"print": "<span class=\"wpb-root\">This uses <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">=</span>}}</span> and <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Template:=</span>}}</span>.</span>"
	},
	{
		"desc": "T36939 - Case insensitive link parsing ([HttP://])",
		"wikitext": "[HttP://MediaWiki.Org/]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"HttP://MediaWiki.Org/\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://mediawiki.org/\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">HttP://MediaWiki.Org/</span>]</span></span>"
	},
	{
		"desc": "T36939 - Case insensitive link parsing ([HttP:// title])",
		"wikitext": "[HttP://MediaWiki.Org/ MediaWiki]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"HttP://MediaWiki.Org/\">MediaWiki</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://mediawiki.org/\">MediaWiki</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">HttP://MediaWiki.Org/</span> <span class=\"wpb-ext-link-text\">MediaWiki</span>]</span></span>"
	},
	{
		"desc": "T36939 - Case insensitive link parsing (HttP://)",
		"wikitext": "HttP://MediaWiki.Org/",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"HttP://MediaWiki.Org/\">HttP://MediaWiki.Org/</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://mediawiki.org/\">HttP://MediaWiki.Org/</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">HttP://MediaWiki.Org/</span></span>"
	},
	{
		"desc": "1. SOL-sensitive wikitext tokens as template-args",
		"wikitext": "{{1x|*a}}\n{{1x|#a}}\n{{1x|:a}}",
		"html": "<ul><li>a</li></ul>\n<ol><li>a</li></ol>\n<dl><dd>a</dd></dl>",
		"render": "<ul><li>a</li></ul>\n<ol><li>a</li></ol>\n<dl><dd>a</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">*a</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">#a</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">:a</span></span>}}</span></span>"
	},
	{
		"desc": "Wikilink with only closing tag in target",
		"wikitext": "[[Test|</span>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>|<span class=\"wpb-link-text\"><span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "LST Sections: Backwards compatibility",
		"wikitext": "<section begin=\"2011-05-16\" />\n<section end=\"2014-04-10 (MW 1.23wmf22)\" />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;section<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">begin</span>=\"<span class=\"wpb-attr-value\">2011-05-16</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;section<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">end</span>=\"<span class=\"wpb-attr-value\">2014-04-10 (MW 1.23wmf22)</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "LST Sections: Newfangled approach",
		"wikitext": "<section begin=\"2011-05-16\" />\n<section end=\"2014-04-10 (MW 1.23wmf22)\" />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;section<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">begin</span>=\"<span class=\"wpb-attr-value\">2011-05-16</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;section<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">end</span>=\"<span class=\"wpb-attr-value\">2014-04-10 (MW 1.23wmf22)</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "LST Sections: Fostering",
		"wikitext": "{|\n<section name=\"testing\"/>\n| 123\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-ext\">&lt;section<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">testing</span>\"</span></span>/&gt;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> 123</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Empty LI and TR nodes should be stripped from template content",
		"wikitext": "{{EmptyLITest}}\n{{EmptyTRTest}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">EmptyLITest</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">EmptyTRTest</span>}}</span></span>"
	},
	{
		"desc": "Empty LI and TR nodes should not be stripped from top-level content",
		"wikitext": "*a\n*\n*b\n\n{|\n|-\n|-\n|foo\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">*</span>\n<span class=\"wpb-list\">*</span>b\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Empty TR nodes should not be stripped if they have any attributes set",
		"wikitext": "{{EmptyTRWithHTMLAttrTest}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">EmptyTRWithHTMLAttrTest</span>}}</span></span>"
	},
	{
		"desc": "\nTag-like HTML structures are passed through as text",
		"wikitext": "<x y>\n\n<x.y>\n\n<x-y>\n\n1>2\n\nx<y\n\na>b\n\n1<d e>f",
		"html": "<p>&lt;x y&gt;\n</p><p>&lt;x.y&gt;\n</p><p>&lt;x-y&gt;\n</p><p>1&gt;2\n</p><p>x&lt;y\n</p><p>a&gt;b\n</p><p>1&lt;d e&gt;f\n</p>",
		"render": "<p>&lt;x y&gt;\n</p><p>&lt;x.y&gt;\n</p><p>&lt;x-y&gt;\n</p><p>1&gt;2\n</p><p>x&lt;y\n</p><p>a&gt;b\n</p><p>1&lt;d e&gt;f\n</p>",
		"print": "<span class=\"wpb-root\">&lt;x y&gt;\n\n&lt;x.y&gt;\n\n&lt;x-y&gt;\n\n1&gt;2\n\nx&lt;y\n\na&gt;b\n\n1&lt;d e&gt;f</span>"
	},
	{
		"desc": "HTML tag with necessary entities in attributes",
		"wikitext": "<span title=\"&amp;amp;\">foo</span>",
		"html": "<p><span title=\"&amp;amp;\">foo</span>\n</p>",
		"render": "<p><span title=\"&amp;amp;\">foo</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">&amp;amp;amp;</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "HTML tag with 'unnecessary' entity encoding in attributes",
		"wikitext": "<span title=\"&amp;\">foo</span>",
		"html": "<p><span title=\"&amp;\">foo</span>\n</p>",
		"render": "<p><span title=\"&amp;\">foo</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">&amp;amp;</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "HTML tag with broken attribute value quoting",
		"wikitext": "<span title=\"Hello world>Foo</span>",
		"html": "<p><span title=\"Hello world\">Foo</span>\n</p>",
		"render": "<p><span title=\"Hello world\">Foo</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">Hello world</span></span></span>&gt;</span>Foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Self-closed tag with broken attribute value quoting",
		"wikitext": "<div title=\"Hello world />Foo",
		"html": "<div title=\"Hello world\">Foo</div>",
		"render": "<div title=\"Hello world\">Foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">Hello world </span></span></span>/&gt;</span>Foo</span>"
	},
	{
		"desc": "Table with broken attribute value quoting",
		"wikitext": "{|\n| title=\"Hello world|Foo\n|}",
		"html": "<table>\n<tbody><tr>\n<td title=\"Hello world\">Foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td title=\"Hello world\">Foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">Hello world</span></span></span>|<span class=\"wpb-td-inner\">Foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table with broken attribute value quoting on consecutive lines",
		"wikitext": "{|\n| title=\"Hello world|Foo\n| style=\"color:red|Bar\n|}",
		"html": "<table>\n<tbody><tr>\n<td title=\"Hello world\">Foo\n</td>\n<td style=\"color:red\">Bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td title=\"Hello world\">Foo\n</td>\n<td style=\"color:red\">Bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">Hello world</span></span></span>|<span class=\"wpb-td-inner\">Foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red</span></span></span>|<span class=\"wpb-td-inner\">Bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept empty td cell attribute",
		"wikitext": "{|\n| align=\"center\" |foo||  |\n|}",
		"html": "<table>\n<tbody><tr>\n<td align=\"center\">foo</td>\n<td>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td align=\"center\">foo</td>\n<td >\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">align</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> </span>|<span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-table-attrs\">  </span>|</span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Non-empty attributes in th-cells",
		"wikitext": "{|\n!Foo!! style=\"color: red\" |Bar\n|}",
		"html": "<table>\n<tbody><tr>\n<th>Foo</th>\n<th style=\"color: red\">Bar\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >Foo</th>\n<th style=\"color: red\">Bar\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">Foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red</span>\"</span> </span>|<span class=\"wpb-td-inner\">Bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept empty attributes in th-cells",
		"wikitext": "{|\n!|foo!!|bar\n|}",
		"html": "<table>\n<tbody><tr>\n<th>foo</th>\n<th>bar\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >foo</th>\n<th >bar\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span>|<span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span>|<span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Empty table rows go away",
		"wikitext": "{|\n|Hello\n|there\n|- class=\"foo\"\n|-\n|}",
		"html": "<table>\n<tbody><tr>\n<td>Hello\n</td>\n<td>there\n</td></tr>\n\n</tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >Hello\n</td>\n<td >there\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Hello</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">there</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "RT-ed inter-element separators should be valid separators",
		"wikitext": "{|\n|- [[foo]]\n|}",
		"html": "<table>\n\n</table>",
		"render": "<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> [[foo]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Trailing newlines in a deep dom-subtree that ends a wikitext line should be migrated out",
		"wikitext": "{|\n|<small>foo\nbar\n|}\n\n{|\n|<small>foo<small>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;small&gt;</span>foo\nbar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;small&gt;</span>foo<span class=\"wpb-html\">&lt;small&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Empty TD followed by TD with tpl-generated attribute",
		"wikitext": "{|\n|-\n|\n|{{1x|style='color:red'}}|foo\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td>\n</td>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >\n</td>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">style</span>=<span class=\"wpb-parameter-value\">'color:red'</span></span>}}</span></span></span></span>|<span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Indented table with an empty td",
		"wikitext": " {|\n |-\n |\n |foo\n |}",
		"html": "<table>\n\n<tbody><tr>\n<td>\n</td>\n<td>foo\n</td></tr></tbody></table>",
		"render": " <table >\n<tbody><tr >\n<td >\n</td>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n |-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n |}</span></span></span>"
	},
	{
		"desc": "Indented table with blank lines in between (T85627)",
		"wikitext": " {|\n |foo\n \n \n |}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n<p><br /> \n</p>\n</td></tr></tbody></table>",
		"render": " <table >\n<tbody><tr>\n<td >foo\n<p><br> \n</p>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">foo\n \n </span></span><span class=\"wpb-table-syntax\">\n |}</span></span></span>"
	},
	{
		"desc": "Indented block & table",
		"wikitext": " <div>foo</div>\n {|\n |foo\n |}",
		"html": "<div>foo</div>\n<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": " <div >foo</div>\n <table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-html\">&lt;div&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span>\n <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n |}</span></span></span>"
	},
	{
		"desc": "Indent and comment before table row",
		"wikitext": "{|\n <!--hi-->|-\n |there\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td>there\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >there\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n <span class=\"wpb-comment\">&lt;!--hi--&gt;</span>|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">there</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Empty TR followed by a template-generated TR",
		"wikitext": "{|\n|-\n{{1x|<tr><td>foo</td></tr>}}\n|}",
		"html": "<table>\n\n<tbody><tr><td>foo</td></tr>\n</tbody></table>",
		"render": "<tr ><td >foo</td></tr><table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span></span></span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Empty TR followed by mixed-ws-comment line should RT correctly",
		"wikitext": "{|\n|-\n <!--c-->\n|-\n<!--c--> <!--d-->\n|}",
		"html": "<table>\n\n\n</table>",
		"render": "<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n <span class=\"wpb-comment\">&lt;!--c--&gt;</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-comment\">&lt;!--c--&gt;</span> <span class=\"wpb-comment\">&lt;!--d--&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Multi-line image caption generated by templates with/without trailing newlines",
		"wikitext": "[[File:Foobar.jpg|thumb|300x300px|foo\\n{{1x|A}}\\n{{1x|B}}\\n{{1x|C}}]]\n[[File:Foobar.jpg|thumb|300x300px|foo\\n{{1x|A}}\\n{{1x|B}}\\n{{1x|C}}\\n\\n]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">300x300</span>px</span>|<span class=\"wpb-image-caption\">foo\\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A</span></span>}}</span>\\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">B</span></span>}}</span>\\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">C</span></span>}}</span></span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">300x300</span>px</span>|<span class=\"wpb-image-caption\">foo\\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A</span></span>}}</span>\\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">B</span></span>}}</span>\\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">C</span></span>}}</span>\\n\\n</span>]]</span></span>"
	},
	{
		"desc": "New element inserted (without intervening newlines) after an old sol-transparent node should serialize correctly",
		"wikitext": "<includeonly>foo</includeonly>\nnew para\n\n[[Category:Foo]]\n\n= new heading =",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;foo&lt;/includeonly&gt;</span>\nnew para\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> new heading </span>=</span></span>"
	},
	{
		"desc": "Improperly nested inline or quotes tags with whitespace in between",
		"wikitext": "<span> <s>x</s></span><s> </s>\n''' ''x'''''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span&gt;</span> <span class=\"wpb-html\">&lt;s&gt;</span>x<span class=\"wpb-html\">&lt;/s&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-html\">&lt;s&gt;</span> <span class=\"wpb-html\">&lt;/s&gt;</span>\n<span class=\"wpb-quote\">'''</span> <span class=\"wpb-quote\">''</span>x<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Encapsulate protected attributes from wt",
		"wikitext": "<div typeof=\"mw:placeholder stuff\" data-mw=\"whoo\" data-parsoid=\"weird\" data-parsoid-other=\"no\" about=\"time\" rel=\"mw:true\">foo</div>\n\n{| typeof=\"mw:placeholder stuff\" data-mw=\"whoo\" data-parsoid=\"weird\" data-parsoid-other=\"no\" about=\"time\" rel=\"mw:true\"\n|ok\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">typeof</span>=\"<span class=\"wpb-attr-value\">mw:placeholder stuff</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-mw</span>=\"<span class=\"wpb-attr-value\">whoo</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-parsoid</span>=\"<span class=\"wpb-attr-value\">weird</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-parsoid-other</span>=\"<span class=\"wpb-attr-value\">no</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">about</span>=\"<span class=\"wpb-attr-value\">time</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">rel</span>=\"<span class=\"wpb-attr-value\">mw:true</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">typeof</span>=\"<span class=\"wpb-attr-value\">mw:placeholder stuff</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">data-mw</span>=\"<span class=\"wpb-attr-value\">whoo</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">data-parsoid</span>=\"<span class=\"wpb-attr-value\">weird</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">data-parsoid-other</span>=\"<span class=\"wpb-attr-value\">no</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">about</span>=\"<span class=\"wpb-attr-value\">time</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">rel</span>=\"<span class=\"wpb-attr-value\">mw:true</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">ok</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Ensure ParagraphWrapper can deal with stray closing pre tags",
		"wikitext": "plain text</pre>",
		"print": "<span class=\"wpb-root\">plain text<span class=\"wpb-html\">&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "1. Ensure fostered text content is wrapped in element nodes",
		"wikitext": "<table>hi</table><table>ho</table>",
		"html": "hi<table></table>ho<table></table>",
		"render": "<table >hi</table><table >ho</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>hi<span class=\"wpb-html\">&lt;/table&gt;</span><span class=\"wpb-html\">&lt;table&gt;</span>ho<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "2. Ensure fostered text content is wrapped in element nodes (traps regressions around fostered marker on the element getting lost)",
		"wikitext": "<table>\n<tr> || ||\n<td> a\n</table>",
		"html": "|| ||\n<table>\n<tbody><tr><td> a\n</td></tr></tbody></table>",
		"render": "<table >\n<tr > || ||\n<td > a\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span> || ||\n<span class=\"wpb-html\">&lt;td&gt;</span> a\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Encapsulation properly handles null DSR information from foster box",
		"wikitext": "{{1x|<table>foo<tr><td>bar</td></tr></table>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span>foo<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>bar<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "1. Encapsulate foster-parented transclusion content",
		"wikitext": "<table>{{1x|foo<tr><td>bar</td></tr>}}</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>bar<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "2. Encapsulate foster-parented transclusion content",
		"wikitext": "<table><div>{{1x|foo}}</div><tr><td>bar</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>bar<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "3. Encapsulate foster-parented transclusion content",
		"wikitext": "<table><div><p>{{1x|foo</p></div><tr><td>}}bar</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-html\">&lt;/p&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span></span></span>}}</span>bar<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "4. Encapsulate foster-parented transclusion content",
		"wikitext": "<table><div><p>{{1x|foo</p></div><tr><td>}}bar</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-html\">&lt;/p&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span></span></span>}}</span>bar<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "5. Encapsulate foster-parented transclusion content",
		"wikitext": "<table><tr><td><div><p>{{1x|foo</p></div></td>foo}}</tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-html\">&lt;/p&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/td&gt;</span>foo</span></span>}}</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "6. Encapsulate foster-parented transclusion content",
		"wikitext": "<table><tr><td><div><p>{{1x|foo</p></div></td>foo</tr></table>}}<p>ok</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-html\">&lt;/p&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/td&gt;</span>foo<span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;p&gt;</span>ok<span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "7. Encapsulate foster-parented transclusion content",
		"wikitext": "<table>{{1x|<p>foo</p>}}<td>bar</td></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;p&gt;</span>foo<span class=\"wpb-html\">&lt;/p&gt;</span></span></span>}}</span><span class=\"wpb-html\">&lt;td&gt;</span>bar<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "8. Encapsulate foster-parented transclusion content",
		"wikitext": "{{1x|a\n}}{|{{1x|style='color:red'}}\n|-\n|b\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\n</span></span>}}</span>{|<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">style</span>=<span class=\"wpb-parameter-value\">'color:red'</span></span>}}</span>\n|-\n|b\n|}</span>"
	},
	{
		"desc": "9. Encapsulate foster-parented transclusion content",
		"wikitext": "<table>{{1x|hi</table>hello}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi<span class=\"wpb-html\">&lt;/table&gt;</span>hello</span></span>}}</span></span>"
	},
	{
		"desc": "Table in fosterable position",
		"wikitext": "{{OpenTable}}\n<div>\n{|\n|}\n</div>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">OpenTable</span>}}</span>\n<span class=\"wpb-html\">&lt;div&gt;</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-html\">&lt;/div&gt;</span>\n|}</span>"
	},
	{
		"desc": "Properly encapsulate empty-content transclusions in fosterable positions",
		"wikitext": "<table>\n{{#if:|\n<td>foo</td>\n}}\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span>\n</span></span>}}</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Always encapsulate foster box when template range is expanded to table",
		"wikitext": "{|\nhello\n{{OpenTable}}\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\nhello\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">OpenTable</span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T115289: Unclosed table",
		"wikitext": "{{1x|<table>}}<!--c-->[[Category:Two]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;table&gt;</span></span></span>}}</span><span class=\"wpb-comment\">&lt;!--c--&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Two</span>]]</span></span>"
	},
	{
		"desc": "T115289: Don't migrate newlines out of tables with fostered content",
		"wikitext": "<table><td></td>{{1x|<tr>[[Category:One]]}}<!--c-->[[Category:Two]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span><span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:One</span>]]</span></span></span>}}</span><span class=\"wpb-comment\">&lt;!--c--&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Two</span>]]</span></span>"
	},
	{
		"desc": "T73074: More fostering fun",
		"wikitext": "<table><td></td>{{1x|<tr>}}<!--c-->[[Category:Two]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span><span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;tr&gt;</span></span></span>}}</span><span class=\"wpb-comment\">&lt;!--c--&gt;</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Two</span>]]</span></span>"
	},
	{
		"desc": "Fostered content with a dom fragment token starting with a transclusion",
		"wikitext": "{|\n[[File:Foobar.jpg|right|{{1x|<div>123</div>}}]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>123<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>]]</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "1. Template wrapping shouldn't ignore fostered content",
		"wikitext": "{|\n{{tr}}\n{{1x|\n}}\n\nhiho",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tr</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n</span></span>}}</span>\n\nhiho</span></span></span>"
	},
	{
		"desc": "2. Template wrapping shouldn't ignore fostered content",
		"wikitext": "{|\n{{tr}}\n{{1x|\n }}\n\nhiho",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tr</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n </span></span>}}</span>\n\nhiho</span></span></span>"
	},
	{
		"desc": "Support <object> element with .data attribute",
		"wikitext": "<object data=\"test.swf\"></object>",
		"print": "<span class=\"wpb-root\">&lt;object data=\"test.swf\"&gt;&lt;/object&gt;</span>"
	},
	{
		"desc": "T72867: Don't block XML namespace declaration",
		"wikitext": "<span xmlns:dct=\"http://purl.org/dc/terms/\" property=\"dct:title\">MediaWiki</span>",
		"html": "<p><span xmlns:dct=\"http&#58;//purl.org/dc/terms/\" property=\"dct:title\">MediaWiki</span>\n</p>",
		"render": "<p><span  property=\"dct:title\">MediaWiki</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">xmlns:dct</span>=\"<span class=\"wpb-attr-value\">http://purl.org/dc/terms/</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">property</span>=\"<span class=\"wpb-attr-value\">dct:title</span>\"</span></span>&gt;</span>MediaWiki<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Ignore rel attribute in a-tags during serialization to url-links",
		"wikitext": "http://en.wikipedia.org/wiki/Foobar\nhttp://en.wikipedia.org/wiki/Foobar\nhttp://en.wikipedia.org/wiki/Foobar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://en.wikipedia.org/wiki/Foobar</span>\n<span class=\"wpb-free-ext-link\">http://en.wikipedia.org/wiki/Foobar</span>\n<span class=\"wpb-free-ext-link\">http://en.wikipedia.org/wiki/Foobar</span></span>"
	},
	{
		"desc": "Serialize interwiki links pointing to the current wiki as plain wiki links (T67869)",
		"wikitext": "[[Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span>"
	},
	{
		"desc": "Parsoid should accept interwiki shortcuts",
		"wikitext": "[[:fr:Foo|Foo]]\n[[:fr:Foo|Foo]]\n[[:fr:Foo|Foo]]\n\n[[:fr:Foo|Foo]]\n[[:fr:Foo|Foo]]\n[[:fr:Foo|Foo]]\n\n[[:fr:Foo|Foo]]\n[[:fr:Foo|Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:fr:Foo</span>|<span class=\"wpb-link-text\">Foo</span>]]</span></span>"
	},
	{
		"desc": "Parsoid should not accept invalid interwiki shortcuts",
		"wikitext": "[news:Foo Foo]\n[news:Foo Foo]\n[news:Foo Foo]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">news:Foo</span> <span class=\"wpb-ext-link-text\">Foo</span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">news:Foo</span> <span class=\"wpb-ext-link-text\">Foo</span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">news:Foo</span> <span class=\"wpb-ext-link-text\">Foo</span>]</span></span>"
	},
	{
		"desc": "New wikilinks should be serialized properly",
		"wikitext": "[[Foo]]\n[[Foo]]\n[[:en:Foo|//en.wikipedia.org/wiki/Foo]]\nhttp://en.wikipedia.org/wiki/Foo\n[[:en:Foo_bar|//en.wikipedia.org/wiki/Foo bar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:en:Foo</span>|<span class=\"wpb-link-text\">//en.wikipedia.org/wiki/Foo</span>]]</span>\n<span class=\"wpb-free-ext-link\">http://en.wikipedia.org/wiki/Foo</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:en:Foo_bar</span>|<span class=\"wpb-link-text\">//en.wikipedia.org/wiki/Foo bar</span>]]</span></span>"
	},
	{
		"desc": "New wiki links (href variations)",
		"wikitext": "[[Foo_bar]]\n[[Foo_bar]]\n[[Foo_bar]]\n[[Toxine bact√©rienne]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo_bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo_bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo_bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Toxine bact√©rienne</span>]]</span></span>"
	},
	{
		"desc": "New wiki links (content string variations)",
		"wikitext": "[[Foo_bar]]\n[[Foo bar]]\n[[Foo_bar|./Foo_bar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo_bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo_bar</span>|<span class=\"wpb-link-text\">./Foo_bar</span>]]</span></span>"
	},
	{
		"desc": "New category links (href variations)",
		"wikitext": "[[Category:Toxine bact√©rienne]]\n[[Category:Toxine bact√©rienne]]\n[[Category:Toxine bact√©rienne]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Toxine bact√©rienne</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Toxine bact√©rienne</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Toxine bact√©rienne</span>]]</span></span>"
	},
	{
		"desc": "New interlanguage links (href variations)",
		"wikitext": "[[es:Toxine bact√©rienne]]\n[[es:Toxine_bact√©rienne]]\n[[es:Toxine_bact√©rienne]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Toxine bact√©rienne</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Toxine_bact√©rienne</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">es:Toxine_bact√©rienne</span>]]</span></span>"
	},
	{
		"desc": "Emit simple non-piped link where possible",
		"wikitext": "[[VisualEditor]]\n[[visualEditor]]\n[[VisualEditor link]]\n[[visualEditor link]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">VisualEditor</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">visualEditor</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">VisualEditor link</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">visualEditor link</span>]]</span></span>"
	},
	{
		"desc": "Lists: Serialize correctly even when list content is wrapped in p-tags (like VE does)",
		"wikitext": "* foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>foo</span>"
	},
	{
		"desc": "Lists: Serialize correctly even when list tags has unneeded whitespace between tags",
		"wikitext": "* foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>foo</span>"
	},
	{
		"desc": "Don't strip leading whitespace when handling indent-pre suppressing tags",
		"wikitext": "{|\n  | indented row\n|}\n<blockquote>\n '''This is very bold of you!'''\n\n{|\n|\n indented cell (no pre-wrapping!)\n|}\n</blockquote>\nfoo\n <div>bar</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n  |</span><span class=\"wpb-td-inner\"> indented row</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-html\">&lt;blockquote&gt;</span>\n <span class=\"wpb-quote\">'''</span>This is very bold of you!<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n indented cell (no pre-wrapping!)</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span>\nfoo\n <span class=\"wpb-html\">&lt;div&gt;</span>bar<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Strip leading whitespace when handling indent-pre inducing tags",
		"wikitext": "foo\n \n<span>bar</span>\n\n<span>foo2\n</span>bar2\n\n<div>foo</div>\n<span>bar</span>\n\n<div>\n<span>foo</span>\n</div>",
		"print": "<span class=\"wpb-root\">foo\n \n<span class=\"wpb-html\">&lt;span&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-html\">&lt;span&gt;</span>foo2\n<span class=\"wpb-html\">&lt;/span&gt;</span>bar2\n\n<span class=\"wpb-html\">&lt;div&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;span&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-html\">&lt;div&gt;</span>\n<span class=\"wpb-html\">&lt;span&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Lists: Dont insert newlines in a serialized list item.",
		"wikitext": "* a<br />b\n* c",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>a<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>b\n<span class=\"wpb-list\">* </span>c</span>"
	},
	{
		"desc": "Headings: Force sol-transparent links and behavior switches to serialize before/after",
		"wikitext": "== hello there ==\n[[Category:A1]]\n[[Category:A2]]\n\n== hi pal ==\n\n<!--foo-->  [[Category:A3]]\n\n== how goes it ==\n\n== it goes well ==\n[[Category:A4]]  <!--bar-->\n\n__TOC__\n\n== ok ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> hello there </span>==</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:A1</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:A2</span>]]</span>\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> hi pal </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span>  <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:A3</span>]]</span>\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> how goes it </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> it goes well </span>==</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:A4</span>]]</span>  <span class=\"wpb-comment\">&lt;!--bar--&gt;</span>\n\n<span class=\"wpb-double-underscore\">__TOC__</span>\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> ok </span>==</span></span>"
	},
	{
		"desc": "Headings: Don't hoist metas that come from templates",
		"wikitext": "== {{1x|foo [[Category:Foo]]}} ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span></span></span>}}</span> </span>==</span></span>"
	},
	{
		"desc": "Parsoid: Serialize positional parameters with = in them as named parameter",
		"wikitext": "{{1x|1=f=oo}}\n\n{{1x|1=f=oo|2=bar}}\n\n<!--Orig params with data-parsoid has heuristics for handling = chars-->\n<!--FIXME: But maybe the heuristic needs fixing to apply to new params as well-->\n{{1x|<nowiki>f=oo</nowiki>|bar}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">f=oo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">f=oo</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">2</span>=<span class=\"wpb-parameter-value\">bar</span></span>}}</span>\n\n<span class=\"wpb-comment\">&lt;!--Orig params with data-parsoid has heuristics for handling = chars--&gt;</span>\n<span class=\"wpb-comment\">&lt;!--FIXME: But maybe the heuristic needs fixing to apply to new params as well--&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">f=oo</span>&lt;/nowiki&gt;</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Serialize positional parameters with = in extlink as named parameter",
		"wikitext": "{{1x|1=http://stuff?is=ok}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-free-ext-link\">http://stuff?is=ok</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parsoid: Correctly serialize block-node children when they are a combination of text and p-nodes",
		"wikitext": "<div>a\nb\n</div>\n<div>a\nb\n</div>\n<div>\na\n\nb\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>a\nb\n<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;div&gt;</span>a\nb\n<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-html\">&lt;div&gt;</span>\na\n\nb\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Substrings resembling wikitext in hrefs should not get nowiki escapes",
		"wikitext": "[[Foo''bar''baz]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo''bar''baz</span>]]</span></span>"
	},
	{
		"desc": "Ignore single-line context for wikilinks",
		"wikitext": "* [[Foo|\nbar]]\n\n== [[Foo|\nbar]] ==\n\n* [[Foo|bar\n<span style=\"background-color:green;\ncolor:blue\">x</span>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">\nbar</span>]]</span>\n\n== <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">\nbar</span>]]</span> ==\n\n<span class=\"wpb-list\">* </span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">bar\n<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background-color:green;\ncolor:blue</span>\"</span></span>&gt;</span>x<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "Selser: Ignore single-line context for wikilinks",
		"wikitext": "* [[Foo|\nbar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">\nbar</span>]]</span></span>"
	},
	{
		"desc": "1. I/B quote minimization: wikitext-only tags should be combined",
		"wikitext": "''AB''\n\n'''AB'''\n\n''A'''B'''''\n\n'''A''B'''''\n\n'''A''BC''D'''\n\n'''''AB'''''\n\n'''''AB'''''\n\n'''''AB'''''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>AB<span class=\"wpb-quote\">''</span>\n\n<span class=\"wpb-quote\">'''</span>AB<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-quote\">''</span>A<span class=\"wpb-quote\">'''</span>B<span class=\"wpb-quote\">'''''</span>\n\n<span class=\"wpb-quote\">'''</span>A<span class=\"wpb-quote\">''</span>B<span class=\"wpb-quote\">'''''</span>\n\n<span class=\"wpb-quote\">'''</span>A<span class=\"wpb-quote\">''</span>BC<span class=\"wpb-quote\">''</span>D<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-quote\">'''''</span>AB<span class=\"wpb-quote\">'''''</span>\n\n<span class=\"wpb-quote\">'''''</span>AB<span class=\"wpb-quote\">'''''</span>\n\n<span class=\"wpb-quote\">'''''</span>AB<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "2. I/B quote minimization: wikitext and html tags should not be combined",
		"wikitext": "''A''<i>B</i>\n\n''A''<nowiki/>'''<i>B</i>'''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>A<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;i&gt;</span>B<span class=\"wpb-html\">&lt;/i&gt;</span>\n\n<span class=\"wpb-quote\">''</span>A<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;i&gt;</span>B<span class=\"wpb-html\">&lt;/i&gt;</span><span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "3. I/B quote minimization: templated content stops minimization",
		"wikitext": "''A''{{1x|''B''}}\n\n''A''{{1x|'''''B'''''}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>A<span class=\"wpb-quote\">''</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>B<span class=\"wpb-quote\">''</span></span></span>}}</span>\n\n<span class=\"wpb-quote\">''</span>A<span class=\"wpb-quote\">''</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">'''''</span>B<span class=\"wpb-quote\">'''''</span></span></span>}}</span></span>"
	},
	{
		"desc": "4. I/B quote minimization: new content should be mimimized with adjacent old content",
		"wikitext": "''AB''\n\n'''AB'''\n\n''A'''B'''''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>AB<span class=\"wpb-quote\">''</span>\n\n<span class=\"wpb-quote\">'''</span>AB<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-quote\">''</span>A<span class=\"wpb-quote\">'''</span>B<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "5a. Merge adjacent quote nodes if they've been edited",
		"wikitext": "''a''b''c''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>a<span class=\"wpb-quote\">''</span>b<span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "5b. Merge adjacent quote nodes if they've been edited",
		"wikitext": "''a''<span id=\"x\">b</span>''c''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>a<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>b<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "1. Merge adjacent link nodes as long as at least one element is new",
		"wikitext": "[[Football]]\n[[Football]]\n[[Football|Foot]][[Football|ball]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>|<span class=\"wpb-link-text\">Foot</span>]]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>|<span class=\"wpb-link-text\">ball</span>]]</span></span>"
	},
	{
		"desc": "2. Merge adjacent link nodes and enable additional normalizations",
		"wikitext": "''[[Football]]''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span><span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "1. Move format tags outside of WikiLink",
		"wikitext": "''[[Football]]''\n'''''[[Football]]'''''\n<u>'''''[[Football]]'''''</u>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span><span class=\"wpb-quote\">''</span>\n<span class=\"wpb-quote\">'''''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span><span class=\"wpb-quote\">'''''</span>\n<span class=\"wpb-html\">&lt;u&gt;</span><span class=\"wpb-quote\">'''''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span><span class=\"wpb-quote\">'''''</span><span class=\"wpb-html\">&lt;/u&gt;</span></span>"
	},
	{
		"desc": "2. Move format tags outside of WikiLink with mergable A tags",
		"wikitext": "'''''[[Football]]'''''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Football</span>]]</span><span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "3. Move format tags outside of WikiLink while preserving formats already outside WikiLink",
		"wikitext": "<font color=\"red\"><u>'''[[Foo]]'''</u></font>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=\"<span class=\"wpb-attr-value\">red</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;u&gt;</span><span class=\"wpb-quote\">'''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span><span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;/u&gt;</span><span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "4. Do not move format tags outside of WikiLink which includes attributes color, style and class",
		"wikitext": "[[Foo|<font color=\"red\">Foo</font>]]\n[[Foo|<span style=\"color: blue; font-size: 46px;\">Foo></span>]]\n[[Foo|<span class=\"Bar\">Foo</span>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">color</span>=\"<span class=\"wpb-attr-value\">red</span>\"</span></span>&gt;</span>Foo<span class=\"wpb-html\">&lt;/font&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: blue; font-size: 46px;</span>\"</span></span>&gt;</span>Foo&gt;<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">Bar</span>\"</span></span>&gt;</span>Foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "5. T194083 Regression test: Manual edit test to move format tags outside wikilinks",
		"wikitext": "[[Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span>"
	},
	{
		"desc": "6. Regression test: Manual edit test to ensure diff markers are not lost",
		"wikitext": "''Foo''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>Foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "7. T194083 Regression test: Manual edit test to ensure nested diff markers aren't inserted",
		"wikitext": "<div>placeholder</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>placeholder<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T192913 Regression test: 1. html2wt of links should not trip on parser functions found in target",
		"wikitext": "[[Category:Bugs-{{#if:blah|Regression|None}}]]\n[[Category:Bugs-{{#if:blah|Regression|None}}|{{#if:blah|2020|None}}-#fragment]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bugs-<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Regression</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">None</span></span>}}</span></span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bugs-<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Regression</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">None</span></span>}}</span></span>|<span class=\"wpb-link-text\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2020</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">None</span></span>}}</span>-#fragment</span>]]</span></span>"
	},
	{
		"desc": "T192913 Regression test: 2. html2wt of links should not trip on parser functions found in target (2)",
		"wikitext": "[[Category:Bugs-{{#if:blah|Regression|None}}|fragment]]\n[[Category:Bugs-{{#if:blah|Regression|None}}-{{#if:blah|2020|None}}|fragment]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bugs-<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Regression</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">None</span></span>}}</span></span>|<span class=\"wpb-link-text\">fragment</span>]]</span>\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bugs-<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Regression</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">None</span></span>}}</span>-<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2020</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">None</span></span>}}</span></span>|<span class=\"wpb-link-text\">fragment</span>]]</span></span>"
	},
	{
		"desc": "T56262: New entities",
		"wikitext": "&nbsp;",
		"print": "<span class=\"wpb-root\">&amp;nbsp;</span>"
	},
	{
		"desc": "Consecutive <pre>s should not get merged",
		"wikitext": " a\n\n b\n\n c\n\n d\n\n e\n \n\n \n f",
		"print": "<span class=\"wpb-root\"> a\n\n b\n\n c\n\n d\n\n e\n \n\n \n f</span>"
	},
	{
		"desc": "Edited ISBN links not serializable as ISBN links should serialize as wikilinks",
		"wikitext": "[[Special:BookSources/1234567890|ISBN 1234567895]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Special:BookSources/1234567890</span>|<span class=\"wpb-link-text\">ISBN 1234567895</span>]]</span></span>"
	},
	{
		"desc": "Edited RFC links not serializable as RFC links should serialize as extlinks",
		"wikitext": "[https://tools.ietf.org/html/rfc123 New RFC]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://tools.ietf.org/html/rfc123</span> <span class=\"wpb-ext-link-text\">New RFC</span>]</span></span>"
	},
	{
		"desc": "Edited PMID links not serializable as PMID links should serialize as extlinks",
		"wikitext": "[//www.ncbi.nlm.nih.gov/pubmed/123?dopt=Abstract New PMID]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//www.ncbi.nlm.nih.gov/pubmed/123?dopt=Abstract</span> <span class=\"wpb-ext-link-text\">New PMID</span>]</span></span>"
	},
	{
		"desc": "WTS of autolinks with trailing/surrounding context",
		"wikitext": "http://cscott.net'''foo'''\n\nhttp://cscott.net<b>foo</b>\n\n'''http://cscott.net'''\n\n'''http://cscott.net '''\n\n'''http://cscott.net<nowiki/>x'''\n\nhttp://cscott.net<nowiki/>x",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-html\">&lt;b&gt;</span>foo<span class=\"wpb-html\">&lt;/b&gt;</span>\n\n<span class=\"wpb-quote\">'''</span><span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-quote\">'''</span><span class=\"wpb-free-ext-link\">http://cscott.net</span> <span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-quote\">'''</span><span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>x<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>x</span>"
	},
	{
		"desc": "WTS of autolinks with nowikis (round-trip)",
		"wikitext": "x<nowiki/>http://cscott.net<nowiki/>x",
		"print": "<span class=\"wpb-root\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>x</span>"
	},
	{
		"desc": "WTS of autolinks with escapes (editing)",
		"wikitext": "x<nowiki/>http://cscott.net<nowiki/>x",
		"print": "<span class=\"wpb-root\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-free-ext-link\">http://cscott.net</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>x</span>"
	},
	{
		"desc": "WTS of edited autolink-like text (T103364)",
		"wikitext": "Not a link: <nowiki>http://example.com</nowiki>.",
		"print": "<span class=\"wpb-root\">Not a link: <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">http://example.com</span>&lt;/nowiki&gt;</span>.</span>"
	},
	{
		"desc": "WTS of newly-authored autolink-like text (T103364)",
		"wikitext": "<nowiki>http://example.com</nowiki> is not a link.",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">http://example.com</span>&lt;/nowiki&gt;</span> is not a link.</span>"
	},
	{
		"desc": "WTS of autolink-like text after an autolink (T108563)",
		"wikitext": "http://example.com <nowiki>http://example.com</nowiki> is not a link.",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span> <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">http://example.com</span>&lt;/nowiki&gt;</span> is not a link.</span>"
	},
	{
		"desc": "WTS of an autolink surrounded by square brackets (T220018)",
		"wikitext": "<nowiki>[</nowiki>http://example.com]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[</span>&lt;/nowiki&gt;</span><span class=\"wpb-free-ext-link\">http://example.com</span>]</span>"
	},
	{
		"desc": "WTS of edited autolink surrounded by square brackets (T220018)",
		"wikitext": "http://example.com",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span></span>"
	},
	{
		"desc": "WTS of an external link surrounded by square brackets (T220018)",
		"wikitext": "<nowiki>[</nowiki>[http://example.com foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[</span>&lt;/nowiki&gt;</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">foo</span>]</span>]</span>"
	},
	{
		"desc": "WTS of edited external link surrounded by square brackets (T220018)",
		"wikitext": "[http://example.com foo]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">foo</span>]</span></span>"
	},
	{
		"desc": "Magic links inside links (not autolinked)",
		"wikitext": "[[Foo|http://example.com]]\n[[Foo|RFC 1234]]\n[[Foo|PMID 1234]]\n[[Foo|ISBN 123456789x]]\n\n[http://foo.com http://example.com]\n[http://foo.com RFC 1234]\n[http://foo.com PMID 1234]\n[http://foo.com ISBN 123456789x]",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">http://example.com</a>\n<a href=\"/wiki/Foo\" title=\"Foo\">RFC 1234</a>\n<a href=\"/wiki/Foo\" title=\"Foo\">PMID 1234</a>\n<a href=\"/wiki/Foo\" title=\"Foo\">ISBN 123456789x</a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"http://foo.com\">http://example.com</a>\n<a rel=\"nofollow\" class=\"external text\" href=\"http://foo.com\">RFC 1234</a>\n<a rel=\"nofollow\" class=\"external text\" href=\"http://foo.com\">PMID 1234</a>\n<a rel=\"nofollow\" class=\"external text\" href=\"http://foo.com\">ISBN 123456789x</a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">http://example.com</a>\n<a href=\"/wiki/Foo\" title=\"Foo\">RFC 1234</a>\n<a href=\"/wiki/Foo\" title=\"Foo\">PMID 1234</a>\n<a href=\"/wiki/Foo\" title=\"Foo\">ISBN 123456789x</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"http://foo.com/\">http://example.com</a>\n<a rel=\"nofollow\" class=\"external\" href=\"http://foo.com/\">RFC 1234</a>\n<a rel=\"nofollow\" class=\"external\" href=\"http://foo.com/\">PMID 1234</a>\n<a rel=\"nofollow\" class=\"external\" href=\"http://foo.com/\">ISBN 123456789x</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">http://example.com</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">RFC 1234</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">PMID 1234</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">ISBN 123456789x</span>]]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span> <span class=\"wpb-ext-link-text\">http://example.com</span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span> <span class=\"wpb-ext-link-text\">RFC 1234</span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span> <span class=\"wpb-ext-link-text\">PMID 1234</span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span> <span class=\"wpb-ext-link-text\">ISBN 123456789x</span>]</span></span>"
	},
	{
		"desc": "WTS of magic word text (T109371)",
		"wikitext": "<nowiki>RFC 1234</nowiki>\n\n[http://foo.com RFC 1234]\n\n[[Foo|RFC 1234]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">RFC 1234</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span> <span class=\"wpb-ext-link-text\">RFC 1234</span>]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">RFC 1234</span>]]</span></span>"
	},
	{
		"desc": "Edited Redirect link should emit a non-piped wikitext link",
		"wikitext": "#REDIRECT [[Bar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Bar</span>]]</span></span></span>"
	},
	{
		"desc": "T75121: Infer extension name from typeOf if data-mw is not present",
		"wikitext": "<foo />",
		"print": "<span class=\"wpb-root\">&lt;foo /&gt;</span>"
	},
	{
		"desc": "T88318: p-wrapped dash in table.",
		"wikitext": "{|\n!-\n!- \n|-\n|<nowiki>-</nowiki>\n|<nowiki>- </nowiki>\n|-\n|<small>-</small>\n|<br />\n-\n|<br />-\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">-</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">- </span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">-</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">- </span>&lt;/nowiki&gt;</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;small&gt;</span>-<span class=\"wpb-html\">&lt;/small&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>\n-</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>-</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T149209: WTS: Handle newlines in table cells properly",
		"wikitext": "{|\n|a\nb\n|c\n|-\n|x\n{{!}}y\n|}\n{|\n!a\nb\n!c\n|-\n!x\n!y\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a\nb</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">c</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td-inner\">y</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">a\nb</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">c</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">x</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">y</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T149209: Selser: Handle newlines in table cells properly",
		"wikitext": "{|\n! id=\"h1\" |edit-me!!1\n|-\n! id=\"h2\" |edit-me||2\n|-\n| id=\"c1\" |edit-me||3\n|-\n| id=\"c2\" |edit-me||4\n|-\n| id=\"c3\" |edit-me||p||q||r\n|-\n| id=\"c4\" |edit-me||p||q||r\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">h1</span>\"</span> </span>|<span class=\"wpb-td-inner\">edit-me</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">h2</span>\"</span> </span>|<span class=\"wpb-td-inner\">edit-me</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">2</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">c1</span>\"</span> </span>|<span class=\"wpb-td-inner\">edit-me</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">3</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">c2</span>\"</span> </span>|<span class=\"wpb-td-inner\">edit-me</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">4</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">c3</span>\"</span> </span>|<span class=\"wpb-td-inner\">edit-me</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">p</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">q</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">r</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">c4</span>\"</span> </span>|<span class=\"wpb-td-inner\">edit-me</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">p</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">q</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">r</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "HTML id attribute with Parsoid-like element ids should not be serialized to wikitext",
		"wikitext": "{|\n|foo\n| id=\"serialize-this\" |bar\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">serialize-this</span>\"</span> </span>|<span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Parsoid-like element ids should not be serialized to wikitext unless shadowed",
		"wikitext": "<div id=\"hello\">ok</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">hello</span>\"</span></span>&gt;</span>ok<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Testing serialization after deletion of table cells",
		"wikitext": "{|\n!h1 !!h2 !!h3\n| id=\"x\" |c1 {{!}}{{!}}{{!}}c2 |||c3\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">h1 </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">h2 </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">h3</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span> </span>|<span class=\"wpb-td-inner\">c1 </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span>{{!}}<span class=\"wpb-td-inner\">c2 </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span>|<span class=\"wpb-td-inner\">c3</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Testing selser after addition of new row before first row (T125419)",
		"wikitext": "{|\n|a\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Serialize new table rows in a HTML table using HTML tags",
		"wikitext": "<table><tr><td>a</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>a<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Serialize new table cells in a HTML row using HTML tags",
		"wikitext": "<table><tr><td>a</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>a<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Serialize wikitext list items as HTML list items when embedded in a HTML list",
		"wikitext": "<ul>\n<li>a</li>\n<li>b</li>\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>a<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>b<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "Wikitext lists can be nested inside HTML lists",
		"wikitext": "<ul>\n<li>a\n* b\n</li>\n</ul>\n\n<ul>\n<li>x\n* y\n</li>\n</ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>a\n<span class=\"wpb-list\">* </span>b\n<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span>\n\n<span class=\"wpb-html\">&lt;ul&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>x\n<span class=\"wpb-list\">* </span>y\n<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "WTS change modes",
		"wikitext": "<span id=\"xyz\">hello</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">xyz</span>\"</span></span>&gt;</span>hello<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Never serialize a-tag as html, regardless of what data-parsoid has to say",
		"wikitext": "[[Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span>"
	},
	{
		"desc": "Never serialize a-tag as html, no matter what attributes it has",
		"wikitext": "[http://boo.org http://boohoo.org]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://boo.org</span> <span class=\"wpb-ext-link-text\">http://boohoo.org</span>]</span></span>"
	},
	{
		"desc": "Strip span tags added to mark misnested links",
		"wikitext": "[http://test.com][[one]] two three",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://test.com</span>]</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">one</span>]]</span> two three</span>"
	},
	{
		"desc": "Catch regression when unpacking misnested links",
		"wikitext": "{{1x|hi}}[http://example.com [[ho]]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">ho</span>]]</span></span>]</span></span>"
	},
	{
		"desc": "Use data-parsoid.firstWikitextNode to compute newline constraints for template content",
		"wikitext": "{{1x|a}}\n{|{{1x|c\n{{!}}d\n}}\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>}}</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">c\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>d\n</span></span>}}</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "data-parsoid.firstWikitextNode should be computed properly in the presence of fostered content",
		"wikitext": "<div id=\"x\">foo</div>\n{|\n{{1x|<div>boo</div>\n{{!}}b}}\n|c\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>boo<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>b</span></span>}}</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">c</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Serialize multi-line indent-pre starting with wikitext syntax",
		"wikitext": " * 1\n ** 2\n * 3",
		"print": "<span class=\"wpb-root\"> * 1\n ** 2\n * 3</span>"
	},
	{
		"desc": "1. Categories should always be serialized on their own line",
		"wikitext": "foo\n[[Category:Foo]]\nbar",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\nbar</span>"
	},
	{
		"desc": "2. Categories that are part of templates should not introduce a line break",
		"wikitext": "foo {{1x|<span>bar</span> [[Category:baz]]}} bar",
		"print": "<span class=\"wpb-root\">foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;span&gt;</span>bar<span class=\"wpb-html\">&lt;/span&gt;</span> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:baz</span>]]</span></span></span>}}</span> bar</span>"
	},
	{
		"desc": "RTL (\\u200f) and LTR (\\u200e) markers around category tags should be stripped",
		"wikitext": "[[◊ß◊ò◊í◊ï◊®◊ô◊î:◊ò◊ß◊°◊ô◊ù]]\n[[◊ß◊ò◊í◊ï◊®◊ô◊î: ◊©◊ô◊ò◊ï◊™ ◊û◊©◊§◊ò]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">◊ß◊ò◊í◊ï◊®◊ô◊î:◊ò◊ß◊°◊ô◊ù</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">◊ß◊ò◊í◊ï◊®◊ô◊î: ◊©◊ô◊ò◊ï◊™ ◊û◊©◊§◊ò</span>]]</span></span>"
	},
	{
		"desc": "RTL (\\u200f) and LTR (\\u200e) markers should not be stripped if followed by a text node",
		"wikitext": "[[◊ß◊ò◊í◊ï◊®◊ô◊î:◊ò◊ß◊°◊ô◊ù]]\n‚Äèy",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">◊ß◊ò◊í◊ï◊®◊ô◊î:◊ò◊ß◊°◊ô◊ù</span>]]</span>\n‚Äèy</span>"
	},
	{
		"desc": "Lists: Add space after bullets",
		"wikitext": "* foo\n* bar\n* <span> baz</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>foo\n<span class=\"wpb-list\">* </span>bar\n<span class=\"wpb-list\">* </span><span class=\"wpb-html\">&lt;span&gt;</span> baz<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "1. Headings: Add space before/after == (T53744)",
		"wikitext": "== foo ==\n\n== bar ==\n\n== baz ==\n\n== <span> baz</span> ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> foo </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> bar </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> baz </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> <span class=\"wpb-html\">&lt;span&gt;</span> baz<span class=\"wpb-html\">&lt;/span&gt;</span> </span>==</span></span>"
	},
	{
		"desc": "2. Headings: Add space before/after == even after hoisted content",
		"wikitext": "[[Category:A2]]\n\n== ok ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:A2</span>]]</span>\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> ok </span>==</span></span>"
	},
	{
		"desc": "2. Headings: suppress empty headings on edits",
		"wikitext": "==<span id=\"x\">foo</span>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Headings: Replace <br/> with a single whitespace char",
		"wikitext": "== foo bar ==\n\n== foo <span> bar</span> baz ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> foo bar </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> foo <span class=\"wpb-html\">&lt;span&gt;</span> bar<span class=\"wpb-html\">&lt;/span&gt;</span> baz </span>==</span></span>"
	},
	{
		"desc": "2. WT Quote Tags: suppress empty style tags on edits",
		"wikitext": "'''<span id=\"x\">foo</span>'''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "2. Anchors: suppress empty anchors on edits",
		"wikitext": "[[Test|<span id=\"x\">foo</span>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>|<span class=\"wpb-link-text\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "3a. Anchors: do not suppress numbered extlinks",
		"wikitext": "[http://foo.com]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span>]</span></span>"
	},
	{
		"desc": "3b. Anchors: do not suppress numbered extlinks",
		"wikitext": "[http://foo.com <span id=\"x\">foo</span>]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://foo.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>]</span></span>"
	},
	{
		"desc": "Normalizations should be restricted to edited content",
		"wikitext": "a\n= =\nb",
		"print": "<span class=\"wpb-root\">a\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> </span>=</span>\nb</span>"
	},
	{
		"desc": "1. Multiple normalizations (html2wt)",
		"wikitext": "[[foo]]\nx",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">foo</span>]]</span>\nx</span>"
	},
	{
		"desc": "2. Multiple normalizations (selser)",
		"wikitext": "<div id=\"x\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "1. Indent Pre Nowiki: suppress whitespace at the start of new paragraph",
		"wikitext": "hi\n\nhello",
		"print": "<span class=\"wpb-root\">hi\n\nhello</span>"
	},
	{
		"desc": "2. Indent Pre Nowiki: suppress whitespace after newlines in new paragraph or table cell",
		"wikitext": "Foo\nbar\nbaz\n\n{|\n|Foo\nbar\nbaz bang\n|}\n\n<!--boo-->foo\nbar\n\nfoo\nbar<span>boo</span>",
		"print": "<span class=\"wpb-root\">Foo\nbar\nbaz\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Foo\nbar\nbaz bang</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-comment\">&lt;!--boo--&gt;</span>foo\nbar\n\nfoo\nbar<span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "3. Indent Pre Nowiki: suppress leading whitespace in edited paragraphs",
		"wikitext": "xyz",
		"print": "<span class=\"wpb-root\">xyz</span>"
	},
	{
		"desc": "New links that end in spaces",
		"wikitext": "[[Berlin]] is the capital of Germany.\n\n[[Foo]] '''bar'''\n\n[[Boston]] is a city.",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Berlin</span>]]</span> is the capital of Germany.\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span> <span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Boston</span>]]</span> is a city.</span>"
	},
	{
		"desc": "1. Table cells with escapable prefixes",
		"wikitext": "{|\n|a\n|-\n| -\n|-\n| +\n|-\n| }\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> -</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> +</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> }</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2a. Table cells with escapable prefixes after edits",
		"wikitext": "{|\n|a||-\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">-</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2b. Table cells with escapable prefixes after edits",
		"wikitext": "{|\n|pqr\n|<span id=\"x\">foo</span>+\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">pqr</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span>+</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "3a. Table cells without escapable prefixes after edits",
		"wikitext": "{|\n| id=\"x\" |abcd\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span> </span>|<span class=\"wpb-td-inner\">abcd</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "3b. Table cells without escapable prefixes after edits",
		"wikitext": "{|\n|a||b\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">b</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "3c. Table cells without escapable prefixes after edits",
		"wikitext": "{|\n|-\n<!--foo--> |a||-\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-comment\">&lt;!--foo--&gt;</span> |</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">-</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "3d. Table cells without escapable prefixes after edits",
		"wikitext": "<table>\n<tr><td>a</td></tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>a<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "4. font tags without attributes should be dropped",
		"wikitext": "foo\nbar\n<font class=\"x\">boo</font>",
		"print": "<span class=\"wpb-root\">foo\nbar\n<span class=\"wpb-html\">&lt;font<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>boo<span class=\"wpb-html\">&lt;/font&gt;</span></span>"
	},
	{
		"desc": "Normalize empty paragraphs to HTML form that html2wt expects",
		"wikitext": "<div>1</div>\na\n\n\nb\n<div>2</div>\na\n\n\nb\n<div>3</div>\na\n\n\n\n\n\nb\n<div>4</div>\na\n\n<div>foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>1<span class=\"wpb-html\">&lt;/div&gt;</span>\na\n\n\nb\n<span class=\"wpb-html\">&lt;div&gt;</span>2<span class=\"wpb-html\">&lt;/div&gt;</span>\na\n\n\nb\n<span class=\"wpb-html\">&lt;div&gt;</span>3<span class=\"wpb-html\">&lt;/div&gt;</span>\na\n\n\n\n\n\nb\n<span class=\"wpb-html\">&lt;div&gt;</span>4<span class=\"wpb-html\">&lt;/div&gt;</span>\na\n\n<span class=\"wpb-html\">&lt;div&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Templated content should be skipped over by normalization",
		"wikitext": "{{SomeTemplate1|boo}}{{SomeTemplate2|booboo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">SomeTemplate1</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">boo</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">SomeTemplate2</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">booboo</span></span>}}</span></span>"
	},
	{
		"desc": "Escape DOM elements",
		"wikitext": "&lt;nowiki&gt;''foo''&lt;/nowiki&gt;\n&lt;noinclude&gt;''foo''&lt;/noinclude&gt;\n&lt;includeonly&gt;''foo''&lt;/includeonly&gt;",
		"print": "<span class=\"wpb-root\">&amp;lt;nowiki&amp;gt;<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>&amp;lt;/nowiki&amp;gt;\n&amp;lt;noinclude&amp;gt;<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>&amp;lt;/noinclude&amp;gt;\n&amp;lt;includeonly&amp;gt;<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>&amp;lt;/includeonly&amp;gt;</span>"
	},
	{
		"desc": "Don't escape pre elements that fail to parse as extension tags",
		"wikitext": "<pre>closed is extension tag, so everything is <span>text</span></pre>\n<pre>unclosed is not, so these are <span>tags</span>",
		"html": "<pre>closed is extension tag, so everything is &lt;span&gt;text&lt;/span&gt;</pre>\n<pre>unclosed is not, so these are <span>tags</span></pre>",
		"render": "<pre >closed is extension tag, so everything is &lt;span&gt;text&lt;/span&gt;</pre>\n<pre >unclosed is not, so these are <span >tags</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">closed is extension tag, so everything is &lt;span&gt;text&lt;/span&gt;</span>&lt;/pre&gt;</span>\n<span class=\"wpb-html\">&lt;pre&gt;</span>unclosed is not, so these are <span class=\"wpb-html\">&lt;span&gt;</span>tags<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "New list is serialized on newlines",
		"wikitext": "The quick brown fox jumps over the lazy dog.\n\n* Yesterday\n* Today\n* Tomorrow\n\nThe quick onyx goblin jumps over the lazy dwarf.",
		"print": "<span class=\"wpb-root\">The quick brown fox jumps over the lazy dog.\n\n<span class=\"wpb-list\">* </span>Yesterday\n<span class=\"wpb-list\">* </span>Today\n<span class=\"wpb-list\">* </span>Tomorrow\n\nThe quick onyx goblin jumps over the lazy dwarf.</span>"
	},
	{
		"desc": "New lists in formatting elements serialized w/o newlines",
		"wikitext": "<small>\n* 123\n</small>\n\n<small>\n* hi\n</small>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;small&gt;</span>\n<span class=\"wpb-list\">* </span>123\n<span class=\"wpb-html\">&lt;/small&gt;</span>\n\n<span class=\"wpb-html\">&lt;small&gt;</span>\n<span class=\"wpb-list\">* </span>hi\n<span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "New list in table doesn't need newlines",
		"wikitext": "{|\n|\n* test\n* 123\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n<span class=\"wpb-list\">* </span>test\n<span class=\"wpb-list\">* </span>123</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Newly inserted noinclude tags do not need newlines before/after",
		"wikitext": "a<noinclude>b</noinclude>c",
		"print": "<span class=\"wpb-root\">a<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>b<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>c</span>"
	},
	{
		"desc": "Bare inline nodes not wrapped inside p-tags should be treated as p-wrapped",
		"wikitext": "a\n\nb\n\n'''c'''\n\nd\n{|\n|a\nb\n|'''c'''\nd\n|}",
		"print": "<span class=\"wpb-root\">a\n\nb\n\n<span class=\"wpb-quote\">'''</span>c<span class=\"wpb-quote\">'''</span>\n\nd\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a\nb</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">'''</span>c<span class=\"wpb-quote\">'''</span>\nd</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Anchor without href scenarios",
		"wikitext": "dice\n<span name=\"foo\"></span>",
		"print": "<span class=\"wpb-root\">dice\n<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "New transclusion added after a list should be serialized after the list",
		"wikitext": "* a\n{{1x|foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>a\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Only html p-tag is strong indent pre suppressing",
		"wikitext": "test2<span>\ntest3\n</span>",
		"print": "<span class=\"wpb-root\">test2<span class=\"wpb-html\">&lt;span&gt;</span>\ntest3\n<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "T238721: New transclusion without the \"i\" property for a template part should be handled properly",
		"wikitext": "{{1x}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>}}</span></span>"
	},
	{
		"desc": "Selser: New comments should not be lost",
		"wikitext": "<span id=\"a\">a</span>\n\n<span id=\"b\">b</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;</span>a<span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;</span>b<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "Selser: Check for validity of DSR before using it",
		"wikitext": "<span id=\"a\">a</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;</span>a<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "DOMDiff: Edits to content nested in elements with templated attributes should not be lost (T139388)",
		"wikitext": "<div style=\"{{1x|color:red;}}%\">foo</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">color:red;</span></span>}}</span>%</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Empty LI (T49673)",
		"wikitext": "*a\n* \n*\n*b",
		"html": "<ul><li>a</li>\n<li class=\"mw-empty-elt\"></li>\n<li class=\"mw-empty-elt\"></li>\n<li>b</li></ul>",
		"render": "<ul><li>a</li>\n<li></li>\n<li></li>\n<li>b</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">* </span>\n<span class=\"wpb-list\">*</span>\n<span class=\"wpb-list\">*</span>b</span>"
	},
	{
		"desc": "unclosed internal link XSS (T137264)",
		"wikitext": "[[#%3Cscript%3Ealert(1)%3C/script%3E|",
		"html": "<p>[[#&lt;script&gt;alert(1)&lt;/script&gt;|\n</p>",
		"render": "<p>[[#%3Cscript%3Ealert(1)%3C/script%3E|\n</p>",
		"print": "<span class=\"wpb-root\">[[#%3Cscript%3Ealert(1)%3C/script%3E|</span>"
	},
	{
		"desc": "Validating that <style> isn't eaten by tidy (T167349)",
		"wikitext": "<div class=\"foo\">\n<style>.foo::before { content: \"<foo>\"; }</style>\n<style data-mw-foobar=\"baz\">.foo::after { content: \"<bar>\"; }</style>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;</span>\n&lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt;\n&lt;style data-mw-foobar=\"baz\"&gt;.foo::after { content: \"&lt;bar&gt;\"; }&lt;/style&gt;\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Validating that <style> isn't wrapped in a paragraph (T186965)",
		"wikitext": "A style tag, by itself or with other style/link tags, shouldn't be wrapped in a paragraph\n\n<style>.foo::before { content: \"<foo>\"; }</style>\n\n<style>.foo::before { content: \"<foo>\"; }</style> <link rel=\"foo\" href=\"bar\"/><style>.foo::before { content: \"<foo>\"; }</style>\n\nBut if it's on a line with other content, let it be wrapped.\n\n<style>.foo::before { content: \"<foo>\"; }</style> bar\n\nfoo <style>.foo::before { content: \"<foo>\"; }</style>\n\nfoo <style>.foo::before { content: \"<foo>\"; }</style> bar\n\nAnd the same if we have non-paragraph-breaking whitespace\n\nfoo\n<style>.foo::before { content: \"<foo>\"; }</style>\nbar",
		"print": "<span class=\"wpb-root\">A style tag, by itself or with other style/link tags, shouldn't be wrapped in a paragraph\n\n&lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt;\n\n&lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt; &lt;link rel=\"foo\" href=\"bar\"/&gt;&lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt;\n\nBut if it's on a line with other content, let it be wrapped.\n\n&lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt; bar\n\nfoo &lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt;\n\nfoo &lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt; bar\n\nAnd the same if we have non-paragraph-breaking whitespace\n\nfoo\n&lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt;\nbar</span>"
	},
	{
		"desc": "Validating that <link> isn't wrapped in a paragraph (T186965)",
		"wikitext": "A link tag, by itself or with other style/link tags, shouldn't be wrapped in a paragraph\n\n<link rel=\"foo\" href=\"bar\"/>\n\n<link rel=\"foo\" href=\"bar\"/> <style>.foo::before { content: \"<foo>\"; }</style><link rel=\"foo\" href=\"bar\"/>\n\nBut if it's on a line with other content, let it be wrapped.\n\n<link rel=\"foo\" href=\"bar\"/> bar\n\nfoo <link rel=\"foo\" href=\"bar\"/>\n\nfoo <link rel=\"foo\" href=\"bar\"/> bar\n\nAnd the same if we have non-paragraph-breaking whitespace\n\nfoo\n<link rel=\"foo\" href=\"bar\"/>\nbar",
		"print": "<span class=\"wpb-root\">A link tag, by itself or with other style/link tags, shouldn't be wrapped in a paragraph\n\n&lt;link rel=\"foo\" href=\"bar\"/&gt;\n\n&lt;link rel=\"foo\" href=\"bar\"/&gt; &lt;style&gt;.foo::before { content: \"&lt;foo&gt;\"; }&lt;/style&gt;&lt;link rel=\"foo\" href=\"bar\"/&gt;\n\nBut if it's on a line with other content, let it be wrapped.\n\n&lt;link rel=\"foo\" href=\"bar\"/&gt; bar\n\nfoo &lt;link rel=\"foo\" href=\"bar\"/&gt;\n\nfoo &lt;link rel=\"foo\" href=\"bar\"/&gt; bar\n\nAnd the same if we have non-paragraph-breaking whitespace\n\nfoo\n&lt;link rel=\"foo\" href=\"bar\"/&gt;\nbar</span>"
	},
	{
		"desc": "Extension returning multiple nodes starting with a style tag roundtrips",
		"wikitext": "<table>\n{{1x|<html><style>.hi { color: red; }</style>\n</html>}}\n<tr><td class=\"hi\">ho</td></tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">&lt;html&gt;&lt;style&gt;.hi { color: red; }&lt;/style&gt;\n&lt;/html&gt;</span></span>}}</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">hi</span>\"</span></span>&gt;</span>ho<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Decoding of HTML entities in embedded HTML tags",
		"wikitext": "<table class=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\"><tr><td>x</td></tr></table>",
		"html": "<table class=\"1&amp;2&amp;3&amp;amp;4&amp;amp;amp;5\"><tbody><tr><td>x</td></tr></tbody></table>",
		"render": "<table class=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\"><tr ><td >x</td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">1&amp;2&amp;amp;3&amp;amp;amp;4&amp;amp;amp;amp;5</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>x<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "T51672: Test for brackets in attributes of elements in external link texts",
		"wikitext": "[http://example.com/ link <span title=\"title with [brackets]\">span</span>]\n[http://example.com/ link <span title=\"title with &#91;brackets&#93;\">span</span>]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/\">link <span title=\"title with &#91;brackets&#93;\">span</span></a>\n<a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/\">link <span title=\"title with &#91;brackets&#93;\">span</span></a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">link <span title=\"title with [brackets]\">span</span></a>\n<a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">link <span title=\"title with &#91;brackets&#93;\">span</span></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/</span> <span class=\"wpb-ext-link-text\">link <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">title with [brackets]</span>\"</span></span>&gt;</span>span<span class=\"wpb-html\">&lt;/span&gt;</span></span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/</span> <span class=\"wpb-ext-link-text\">link <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">title with &amp;#91;brackets&amp;#93;</span>\"</span></span>&gt;</span>span<span class=\"wpb-html\">&lt;/span&gt;</span></span>]</span></span>"
	},
	{
		"desc": "T72875: Test for brackets in attributes of elements in internal link texts",
		"wikitext": "[[Foo|link <span title=\"title with [[double brackets]]\">span</span>]]\n[[Foo|link <span title=\"title with &#91;&#91;double brackets&#93;&#93;\">span</span>]]",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">link <span title=\"title with &#91;&#91;double brackets&#93;&#93;\">span</span></a>\n<a href=\"/wiki/Foo\" title=\"Foo\">link <span title=\"title with &#91;&#91;double brackets&#93;&#93;\">span</span></a>\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">link <span title=\"title with [[double brackets]]\">span</span></a>\n<a href=\"/wiki/Foo\" title=\"Foo\">link <span title=\"title with &#91;&#91;double brackets&#93;&#93;\">span</span></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">link <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">title with [[double brackets]]</span>\"</span></span>&gt;</span>span<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">link <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">title with &amp;#91;&amp;#91;double brackets&amp;#93;&amp;#93;</span>\"</span></span>&gt;</span>span<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "T199926: html arrow wt: Parsoid sometimes trips up on verticalbar chars in hrefs",
		"wikitext": "[https://stats.wikimedia.org/v2/#/fr.wikipedia.org/reading/page-views-by-country/normal|map|2-Year~2016060100~2018071100|~total 9]\n[[stats:v2/#/fr.wikipedia.org/reading/page-views-by-country/normal%7Cmap%7C2-Year~2016060100~2018071100%7C~total|10]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://stats.wikimedia.org/v2/#/fr.wikipedia.org/reading/page-views-by-country/normal|map|2-Year~2016060100~2018071100|~total</span> <span class=\"wpb-ext-link-text\">9</span>]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">stats:v2/#/fr.wikipedia.org/reading/page-views-by-country/normal%7Cmap%7C2-Year~2016060100~2018071100%7C~total</span>|<span class=\"wpb-link-text\">10</span>]]</span></span>"
	},
	{
		"desc": "T199926: Hash only interwiki link",
		"wikitext": "[[meatball:Test#1/2]]\n[[gerrit:#/q/project:mediawiki/services/parsoid|Gerrit]]",
		"html": "<p><a href=\"http://www.usemod.com/cgi-bin/mb.pl?Test#1.2F2\" class=\"extiw\" title=\"meatball:Test\">meatball:Test#1/2</a>\n<a href=\"https://gerrit.wikimedia.org/#/q/project:mediawiki/services/parsoid\" class=\"extiw\" title=\"gerrit:\">Gerrit</a>\n</p>",
		"render": "<p><a href=\"/wiki/Meatball%3ATest#1%2F2\" title=\"Meatball:Test\">meatball:Test#1/2</a>\n<a href=\"/wiki/Gerrit%3A#%2Fq%2Fproject%3Amediawiki%2Fservices%2Fparsoid\" title=\"Gerrit:\">Gerrit</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">meatball:Test#1/2</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">gerrit:#/q/project:mediawiki/services/parsoid</span>|<span class=\"wpb-link-text\">Gerrit</span>]]</span></span>"
	},
	{
		"desc": "T179544: {{anchorencode:}} output should be always usable in links",
		"wikitext": "<span id=\"{{anchorencode:[foo]}}\"></span>[[#{{anchorencode:[foo]}}]]",
		"html": "<p><span id=\"&#91;foo&#93;\"></span><a href=\"#[foo]\">#&#91;foo&#93;</a>\n</p>",
		"render": "<p><span id=\"\"></span><a href=\"#%7B%7Banchorencode%3A%5Bfoo%5D%7D%7D\">#{{anchorencode:[foo]}}</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[foo]</span></span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[foo]</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Trim whitespace in wikitext headings, list items, table captions, headings, and cells",
		"wikitext": "__NOTOC__\n==    <!--c1-->  <!--c2--> Spaces   <!--c3--> <!--c4-->  ==\n==\t\t<!--c1-->\t<!--c2--> Tabs\t\t<!--c3--><!--c4-->\t==\n== <!--Headings with fallback ids--> –õ–∏—á–Ω–∞—è –∂–∏–∑–Ω—å ==\n*     <!--c1-->   <!--c2-->  List item <!--c3--> <!--c4-->\n; <!--term to define--> term : <!--term's definition--> definition\n{|\n|+ <!--c1--> <!--c2--> Table Caption <!--c3--> <!--c4-->\n|-\n!  <!--c1--> <!--c2--> Table Heading 1 <!--c3--> <!--c4--> !!   Table Heading 2 <!--c5-->\n|-\n| <!--c1--> <!--c2--> Table Cell 1 <!--c3--> <!--c4--> ||   Table Cell 2 <!--c5-->\n|-\n| class=\"foo\" || <!--c1--> <!--c2--> Table Cell 3 <!--c3--> <!--c4-->\n|-\n| <!--c1--> testing [[one|two]] <!--c2--> | <!--c3--> some content\n|}\n: {|\n  |  <!--c1--> <!--c2--> Table Cell 1 <!--c3--> <!--c4--> ||   Table Cell 2 <!--c5-->\n  |} foo   <!--c1-->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">    <span class=\"wpb-comment\">&lt;!--c1--&gt;</span>  <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Spaces   <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span>  </span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">\t\t<span class=\"wpb-comment\">&lt;!--c1--&gt;</span>\t<span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Tabs\t\t<span class=\"wpb-comment\">&lt;!--c3--&gt;</span><span class=\"wpb-comment\">&lt;!--c4--&gt;</span>\t</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> <span class=\"wpb-comment\">&lt;!--Headings with fallback ids--&gt;</span> –õ–∏—á–Ω–∞—è –∂–∏–∑–Ω—å </span>==</span>\n<span class=\"wpb-list\">*     </span><span class=\"wpb-comment\">&lt;!--c1--&gt;</span>   <span class=\"wpb-comment\">&lt;!--c2--&gt;</span>  List item <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span>\n<span class=\"wpb-list\">; </span><span class=\"wpb-comment\">&lt;!--term to define--&gt;</span> term <span class=\"wpb-dd\">:</span> <span class=\"wpb-comment\">&lt;!--term's definition--&gt;</span> definition\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-td-inner\"> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Caption <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">  <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Heading 1 <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">   Table Heading 2 <span class=\"wpb-comment\">&lt;!--c5--&gt;</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Cell 1 <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">   Table Cell 2 <span class=\"wpb-comment\">&lt;!--c5--&gt;</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> class=\"foo\" </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Cell 3 <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> testing <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">one</span>|<span class=\"wpb-link-text\">two</span>]]</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> | <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> some content</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-dd\">:</span> <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n  |</span><span class=\"wpb-td-inner\">  <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Cell 1 <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">   Table Cell 2 <span class=\"wpb-comment\">&lt;!--c5--&gt;</span></span></span><span class=\"wpb-table-syntax\">\n  |}</span></span> foo   <span class=\"wpb-comment\">&lt;!--c1--&gt;</span></span>"
	},
	{
		"desc": "Do not trim whitespace in HTML headings, list items, table captions, headings, and cells",
		"wikitext": "__NOTOC__\n<h2>    <!--c1-->   <!--c2--> Heading    <!--c3--> <!--c4-->  </h2>\n<ul><li>     <!--c1-->   <!--c2-->  List item <!--c3--> <!--c4-->  </li></ul>\n<table>\n<tr><th> <!--c1--> <!--c2--> Table Heading <!--c3--> <!--c4--> <th></tr>\n<tr><td> <!--c1--> <!--c2--> Table Cell <!--c3--> <!--c4--> <th></tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span>\n<span class=\"wpb-html\">&lt;h2&gt;</span>    <span class=\"wpb-comment\">&lt;!--c1--&gt;</span>   <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Heading    <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span>  <span class=\"wpb-html\">&lt;/h2&gt;</span>\n<span class=\"wpb-html\">&lt;ul&gt;</span><span class=\"wpb-html\">&lt;li&gt;</span>     <span class=\"wpb-comment\">&lt;!--c1--&gt;</span>   <span class=\"wpb-comment\">&lt;!--c2--&gt;</span>  List item <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span>  <span class=\"wpb-html\">&lt;/li&gt;</span><span class=\"wpb-html\">&lt;/ul&gt;</span>\n<span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;th&gt;</span> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Heading <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span> <span class=\"wpb-html\">&lt;th&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span> Table Cell <span class=\"wpb-comment\">&lt;!--c3--&gt;</span> <span class=\"wpb-comment\">&lt;!--c4--&gt;</span> <span class=\"wpb-html\">&lt;th&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Do not trim whitespace in links and quotes",
		"wikitext": "foo ''  <!--c1--> italic <!--c2-->   '' and '''  <!--c3-->  bold  <!--c4-->  '''\n[[Foo|  some text  ]]",
		"print": "<span class=\"wpb-root\">foo <span class=\"wpb-quote\">''</span>  <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> italic <span class=\"wpb-comment\">&lt;!--c2--&gt;</span>   <span class=\"wpb-quote\">''</span> and <span class=\"wpb-quote\">'''</span>  <span class=\"wpb-comment\">&lt;!--c3--&gt;</span>  bold  <span class=\"wpb-comment\">&lt;!--c4--&gt;</span>  <span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">  some text  </span>]]</span></span>"
	},
	{
		"desc": "Remove p tags surrounding a single element in a figcaption",
		"wikitext": "[[File:Foobar.jpg|right|200x200px|Caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200x200</span>px</span>|<span class=\"wpb-image-caption\">Caption</span>]]</span></span>"
	},
	{
		"desc": "Selser preserves lack of newline before list and allows newline after the list",
		"wikitext": "header\n*foo\n*bar",
		"print": "<span class=\"wpb-root\">header\n<span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">*</span>bar</span>"
	},
	{
		"desc": "Selser does not introduce newlines between unedited paragraph preceding the list",
		"wikitext": "{|\n|\nheader\n*foo\n*bar\nfooter\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\nheader\n<span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">*</span>bar\nfooter</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Selser does not introduce newlines between unedited paragraph following the list",
		"wikitext": "{|\n|\nheader\n*foo\n*bar\nfooter\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\nheader\n<span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">*</span>bar\nfooter</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Remove a list item but do not insert newline above list",
		"wikitext": "header\n*foo\n*bar\nfooter",
		"print": "<span class=\"wpb-root\">header\n<span class=\"wpb-list\">*</span>foo\n<span class=\"wpb-list\">*</span>bar\nfooter</span>"
	},
	{
		"desc": "Spaced heading with element",
		"wikitext": "=== hi <span id=\"x\">hi</span> hi ho ===",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> hi <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>hi<span class=\"wpb-html\">&lt;/span&gt;</span> hi ho </span>===</span></span>"
	},
	{
		"desc": "Allow tabindex 0",
		"wikitext": "<div tabindex=\"0\">A</div>",
		"html": "<div tabindex=\"0\">A</div>",
		"render": "<div tabindex=\"0\">A</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">tabindex</span>=\"<span class=\"wpb-attr-value\">0</span>\"</span></span>&gt;</span>A<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Don't allow tabindex -1",
		"wikitext": "<div tabindex=\"-1\">A</div>",
		"html": "<div>A</div>",
		"render": "<div >A</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">tabindex</span>=\"<span class=\"wpb-attr-value\">-1</span>\"</span></span>&gt;</span>A<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Don't Allow tabindex > 0",
		"wikitext": "<div tabindex=\"3\">A</div>",
		"html": "<div>A</div>",
		"render": "<div >A</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">tabindex</span>=\"<span class=\"wpb-attr-value\">3</span>\"</span></span>&gt;</span>A<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "aside tag is not allowed directly in wikitext (T278565)",
		"wikitext": "<aside>This aside tag in wikitext should be escaped</aside>",
		"html": "<p>&lt;aside&gt;This aside tag in wikitext should be escaped&lt;/aside&gt;\n</p>",
		"render": "<p>&lt;aside&gt;This aside tag in wikitext should be escaped&lt;/aside&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;aside&gt;This aside tag in wikitext should be escaped&lt;/aside&gt;</span>"
	},
	{
		"desc": "Stripped tag in list",
		"wikitext": ":<i>hi</i></b>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;i&gt;</span>hi<span class=\"wpb-html\">&lt;/i&gt;</span><span class=\"wpb-html\">&lt;/b&gt;</span></span>"
	},
	{
		"desc": "Misnested link nested in span",
		"wikitext": ": [http://google.com <span>[[Lala]]:</span>ok]-hi",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">: </span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://google.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Lala</span>]]</span>:<span class=\"wpb-html\">&lt;/span&gt;</span>ok</span>]</span>-hi</span>"
	},
	{
		"desc": "Preserve the order invalid attributes",
		"wikitext": "<div width=\"95%\" style=\"border: 3px solid darkblue\">hi",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">width</span>=\"<span class=\"wpb-attr-value\">95%</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">border: 3px solid darkblue</span>\"</span></span>&gt;</span>hi</span>"
	},
	{
		"desc": "badCharacters"
	},
	{
		"desc": "External links: invalid character NUL (stripped)",
		"wikitext": "[http://www.example.com\u0000 test]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">test</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">test</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">test</span>]</span></span>"
	},
	{
		"desc": "External links: invalid character backspace (preserved)",
		"wikitext": "[http://www.example.com\b test]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com\">http://www.example.com</a>\b test]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com</a>\b test]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-free-ext-link\">http://www.example.com</span>\b test]</span>"
	},
	{
		"desc": "Magic link: invalid character NUL (stripped)",
		"wikitext": "http://www.example.com\u0000 test",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com\">http://www.example.com</a> test\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com</a> test\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com</span> test</span>"
	},
	{
		"desc": "Magic link: invalid character backspace (preserved)",
		"wikitext": "http://www.example.com\b test",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com\">http://www.example.com</a>\b test\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com</a>\b test\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com</span>\b test</span>"
	},
	{
		"desc": "External links: tab character",
		"wikitext": "[http://www.example.com Alice in\tWonderland]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">Alice in\tWonderland</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">Alice in\tWonderland</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">Alice in\tWonderland</span>]</span></span>"
	},
	{
		"desc": "Stray carriage return in text",
		"wikitext": "hiho",
		"html": "<p>hiho\n</p>",
		"render": "<p>hiho\n</p>",
		"print": "<span class=\"wpb-root\">hiho</span>"
	},
	{
		"desc": "bookReferencing"
	},
	{
		"desc": "Book Referencing attribute rejected by default",
		"wikitext": "<ref name=\"parent\">[foo]</ref>\n<ref extends=\"parent\">[bar]</ref>",
		"html": "<p><sup id=\"cite_ref-parent_1-0\" class=\"reference\"><a href=\"#cite_note-parent-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;ref&gt;</code> tag</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-parent-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-parent_1-0\">‚Üë</a></span> <span class=\"reference-text\">[foo]</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">parent</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[foo]</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">parent</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[bar]</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Book Referencing attribute allowed with feature flag set",
		"wikitext": "<ref name=\"parent\">[foo]</ref>\n<ref extends=\"parent\">[bar]</ref>",
		"html": "<p><sup id=\"cite_ref-parent_1-0\" class=\"reference\"><a href=\"#cite_note-parent-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-parent-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-parent_1-0\">‚Üë</a></span> <span class=\"reference-text\">[foo]</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">[bar]</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">parent</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[foo]</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">parent</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[bar]</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T240424 - Subreference reused as normal ref before its full definition",
		"wikitext": "<ref name=\"b\" />\n<ref name=\"b\" extends=\"a\">page 2</ref>\n<ref name=\"a\">book</ref>",
		"html": "<p><sup id=\"cite_ref-b_1-0\" class=\"reference\"><a href=\"#cite_note-b-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"b\" defined multiple times with different content</span>\n<sup id=\"cite_ref-a_2-0\" class=\"reference\"><a href=\"#cite_note-a-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-b-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_1-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>b</code></span></li>\n<li id=\"cite_note-a-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_2-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T240424 - Extended reference reused before defined in the <references> section",
		"wikitext": "<ref name=\"a\" />\n<ref name=\"b\" />\n<references>\n<ref name=\"b\" extends=\"a\">page 2</ref>\n<ref name=\"a\">book</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>b</code></span></li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"b\" defined multiple times with different content</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T367749 - Turning a top-level ref into a subref is forbidden, even if the content is the same",
		"wikitext": "<ref name=p20>page 20</ref>\n<ref extends=book name=p20>page 20</ref>\n<references>\n<ref name=book>book</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-p20_1-0\" class=\"reference\"><a href=\"#cite_note-p20-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"p20\" defined multiple times with different content</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-p20-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-p20_1-0\">‚Üë</a></span> <span class=\"reference-text\">page 20</span>\n</li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"book\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">p20</span></span></span>&gt;<span class=\"wpb-ext-inner\">page 20</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=<span class=\"wpb-attr-value\">book</span></span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">p20</span></span></span>&gt;<span class=\"wpb-ext-inner\">page 20</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">book</span></span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T367749 - Turning a top-level ref into a subref is forbidden, especially when the content conflicts",
		"wikitext": "<ref name=p20>page 20</ref>\n<ref extends=book name=p20>different content</ref>\n<references>\n<ref name=book>book</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-p20_1-0\" class=\"reference\"><a href=\"#cite_note-p20-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"p20\" defined multiple times with different content</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-p20-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-p20_1-0\">‚Üë</a></span> <span class=\"reference-text\">page 20</span>\n</li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"book\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">p20</span></span></span>&gt;<span class=\"wpb-ext-inner\">page 20</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=<span class=\"wpb-attr-value\">book</span></span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">p20</span></span></span>&gt;<span class=\"wpb-ext-inner\">different content</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">book</span></span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T367749 - Turning a top-level ref into a subref is fine when the content is an empty string",
		"wikitext": "<ref name=p20></ref>\n<ref extends=book name=p20>page 20</ref>\n<references>\n<ref name=book>book</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-p20_1-0\" class=\"reference\"><a href=\"#cite_note-p20-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"p20\" defined multiple times with different content</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-p20-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-p20_1-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>p20</code></span></li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"book\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">p20</span></span></span>&gt;&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=<span class=\"wpb-attr-value\">book</span></span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">p20</span></span></span>&gt;<span class=\"wpb-ext-inner\">page 20</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=<span class=\"wpb-attr-value\">book</span></span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T236256 - Naming book references is fine",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref extends=\"a\" name=\"b\">page 2</ref>\n<ref extends=\"a\" name=\"c\">page 3</ref>\n<ref name=\"b\" />\n<ref name=\"c\" />\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-c_3-0\" class=\"reference\"><a href=\"#cite_note-c-3\">&#91;1.2&#93;</a></sup>\n<sup id=\"cite_ref-b_2-1\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-c_3-1\" class=\"reference\"><a href=\"#cite_note-c-3\">&#91;1.2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-b_2-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-b_2-1\">1.1.1</a></sup></span> <span class=\"reference-text\">page 2</span>\n</li>\n<li id=\"cite_note-c-3\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-c_3-0\">1.2.0</a></sup> <sup><a href=\"#cite_ref-c_3-1\">1.2.1</a></sup></span> <span class=\"reference-text\">page 3</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 3</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Extending a reference that doesn't exist #1",
		"wikitext": "<ref extends=\"a\">page 1</ref>",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>a</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">page 1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 1</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T236256 - Extending a reference that doesn't exist #2",
		"wikitext": "<ref>book</ref>\n<ref extends=\"a\">page 1</ref>",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>a</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page 1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 1</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T236256 - Reference with the same name defined twice",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref name=\"a\">magazine</ref>\n<ref extends=\"a\">page 1</ref>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">book <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page 1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">magazine</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 1</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T236256 - Can't reuse a name for two book references",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref extends=\"a\" name=\"b\">page 2</ref>\n<ref extends=\"a\" name=\"b\">page 3</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-1\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-b_2-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-b_2-1\">1.1.1</a></sup></span> <span class=\"reference-text\">page 2 <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"b\" defined multiple times with different content</span></span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 3</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Can't extend a book reference (no nesting)",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref extends=\"a\" name=\"b\">page 2</ref>\n<ref extends=\"b\">section 3</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;1.1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Extending <code>&lt;ref&gt;</code> tags more than one level deep is not allowed</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">page 2</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">section 3</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Can't extend a book reference (no nesting), specified in reverse order",
		"wikitext": "<ref extends=\"b\">section 3</ref>\n<ref extends=\"a\" name=\"b\">page 2</ref>\n<ref name=\"a\">book</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1.1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"b\" defined multiple times with different content</span>\n<sup id=\"cite_ref-a_2-0\" class=\"reference\"><a href=\"#cite_note-a-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>b</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">section 3</span>\n</li>\n</ol></li>\n<li id=\"cite_note-a-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_2-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">section 3</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Named reference without text",
		"wikitext": "<ref name=\"a\" />\n<ref extends=\"a\">page 1</ref>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>a</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page 1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 1</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T236256 - No text for a book reference",
		"wikitext": "<ref name=\"foo\">book</ref>\n<ref extends=\"foo\" />",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: The opening <code>&lt;ref&gt;</code> tag is malformed or has a bad name</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Empty text for a book reference",
		"wikitext": "<ref name=\"foo\">book</ref>\n<ref extends=\"foo\"></ref>",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; refs with no name must have content</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T236256 - De-facto empty text for a book reference",
		"wikitext": "<ref name=\"foo\">book</ref>\n<ref extends=\"foo\"> </ref>",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; refs with no name must have content</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T236256 - Everything in the same group",
		"wikitext": "<ref group=\"g1\" name=\"a\">book</ref>\n<ref group=\"g1\" extends=\"a\" name=\"b\">page</ref>\n<ref group=\"g1\" name=\"b\" />\n<references group=\"g1\"/>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;g1 1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;g1 1.1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-1\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;g1 1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-b_2-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-b_2-1\">1.1.1</a></sup></span> <span class=\"reference-text\">page</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span></span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Base and book reference in different groups don't collide",
		"wikitext": "<ref group=\"g1\" name=\"a\">book</ref>\n<ref group=\"g2\" extends=\"a\">page</ref>\n<references group=\"g1\"/>\n<references group=\"g2\"/>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;g1 1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;g2 1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>a</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g2</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span></span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g2</span>\"</span></span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Extending in the unnamed default group doesn't collide with refs from other groups",
		"wikitext": "<ref group=\"g1\" name=\"a\">book</ref>\n<ref extends=\"a\">page</ref>\n<references group=\"g1\"/>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;g1 1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>a</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span></span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Extends in named group doesn't conflict with default group",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref group=\"g1\" extends=\"a\">page</ref>\n<references group=\"g1\"/>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;g1 1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>a</code></span><ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page</span>\n</li>\n</ol></li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g1</span>\"</span></span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Extending a multi-part ref should be fine",
		"wikitext": "<ref name=\"a\">part 1</ref>\n<ref follow=\"a\">part 2</ref>\n<ref extends=\"a\">ok</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">part 1 part 2</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">ok</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">part 1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">part 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">ok</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Dont allow splitting a book reference for now",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref extends=\"a\" name=\"b\">page 2</ref>\n<ref follow=\"b\">and page 3 the same time?</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">page 2 and page 3 the same time?</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">and page 3 the same time?</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Can't be a follow up and a book reference the same time",
		"wikitext": "<ref name=\"a\">book 1</ref>\n<ref follow=\"a\" extends=\"a\">huh?</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: A <code>&lt;ref follow=\"‚Ä¶\"&gt;</code> tag that is the continuation of a previous one can neither be named individually nor extended</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book 1</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book 1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">huh?</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T236256 - Can't be a follow up and a book reference the same time, even when referencing 2 different bases",
		"wikitext": "<ref name=\"a\">book 1</ref>\n<ref name=\"b\">book 2</ref>\n<ref follow=\"a\" extends=\"b\">huh?</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: A <code>&lt;ref follow=\"‚Ä¶\"&gt;</code> tag that is the continuation of a previous one can neither be named individually nor extended</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book 1</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">book 2</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book 1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">huh?</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Extending a <ref> that doesn't appear in the text, but in <references>",
		"wikitext": "<ref extends=\"a\">Page 2</ref>\n<references>\n<ref name=\"a\">Book</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">Book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Page 2</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Book</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T239810: Extending a <ref> that doesn't appear in the text, but in {{#tag:references}}",
		"wikitext": "<ref extends=\"a\">Page 2</ref>\n{{#tag:references|\n<ref name=\"a\">Book</ref>\n}}",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">Book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Page 2</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Page 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Book</span>&lt;/ref&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "Extends <ref> defined in <references> called with #tag",
		"wikitext": "<ref name=\"foo\">BAR</ref>\n<ref name=\"footwo\" />\n{{#tag:references|\n<ref name=\"footwo\" extends=\"foo\">p. 10</ref>\n}}",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-footwo_2-0\" class=\"reference\"><a href=\"#cite_note-footwo-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">BAR</span>\n</li>\n<li id=\"cite_note-footwo-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-footwo_2-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>footwo</code></span></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">BAR</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">footwo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">footwo</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">p. 10</span>&lt;/ref&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "Extends parent <ref> defined in <references> called with #tag",
		"wikitext": "<ref>BAR</ref>\n<ref name=\"footwo\" extends=\"foo\">page 7</ref>\n<ref name=\"foo\" />\n{{#tag:references|\n<ref name=\"foo\">book name</ref>\n}}",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-footwo_2-0\" class=\"reference\"><a href=\"#cite_note-footwo-2\">&#91;2.1&#93;</a></sup>\n<sup id=\"cite_ref-foo_3-0\" class=\"reference\"><a href=\"#cite_note-foo-3\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">BAR</span>\n</li>\n<li id=\"cite_note-foo-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_3-0\">‚Üë</a></span> <span class=\"reference-text\">book name</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-footwo-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-footwo_2-0\">‚Üë</a></span> <span class=\"reference-text\">page 7</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">BAR</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">footwo</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 7</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book name</span>&lt;/ref&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "Interleaved extends groups",
		"wikitext": "<ref name=\"a\">text-a</ref>\n<ref name=\"c\">text-c</ref>\n\n<ref extends=\"a\">page b</ref>\n<ref extends=\"c\">page d</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-c_2-0\" class=\"reference\"><a href=\"#cite_note-c-2\">&#91;2&#93;</a></sup>\n</p><p><sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-4\" class=\"reference\"><a href=\"#cite_note-4\">&#91;2.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">text-a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-3\">‚Üë</a></span> <span class=\"reference-text\">page b</span>\n</li>\n</ol></li>\n<li id=\"cite_note-c-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-c_2-0\">‚Üë</a></span> <span class=\"reference-text\">text-c</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-4\">‚Üë</a></span> <span class=\"reference-text\">page d</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-a</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-c</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page b</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page d</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple groups with extends",
		"wikitext": "<ref name=\"a\">text-a</ref>\n<ref extends=\"a\">page b</ref>\n<references />\n\n<ref name=\"c\">text-c</ref>\n<ref extends=\"c\">page d</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">text-a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page b</span>\n</li>\n</ol></li>\n</ol></div>\n<p><sup id=\"cite_ref-c_3-0\" class=\"reference\"><a href=\"#cite_note-c-3\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-4\" class=\"reference\"><a href=\"#cite_note-4\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-c-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-c_3-0\">‚Üë</a></span> <span class=\"reference-text\">text-c</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-4\">‚Üë</a></span> <span class=\"reference-text\">page d</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-a</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page b</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-c</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page d</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple groups with extends, duplicated names across groups",
		"wikitext": "<ref name=\"a\">text-a</ref>\n<ref extends=\"a\">page b</ref>\n<references />\n\n<ref name=\"a\">text-c</ref>\n<ref extends=\"a\">page d</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">text-a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page b</span>\n</li>\n</ol></li>\n</ol></div>\n<p><sup id=\"cite_ref-a_3-0\" class=\"reference\"><a href=\"#cite_note-a-3\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-4\" class=\"reference\"><a href=\"#cite_note-4\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_3-0\">‚Üë</a></span> <span class=\"reference-text\">text-c</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-4\">‚Üë</a></span> <span class=\"reference-text\">page d</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-a</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page b</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-c</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page d</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Intervening ref before extends",
		"wikitext": "<ref name=\"a\">book</ref>\n<ref>another</ref>\n<ref extends=\"a\">page 2</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup>\n<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">book</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-3\">‚Üë</a></span> <span class=\"reference-text\">page 2</span>\n</li>\n</ol></li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">another</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">book</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">another</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page 2</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Normal refs after extends",
		"wikitext": "<ref name=\"a\">text-a</ref>\n<ref extends=\"a\">page b</ref>\n\n<ref name=\"c\">text-c</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1.1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-c_3-0\" class=\"reference\"><a href=\"#cite_note-c-3\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">text-a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">page b</span>\n</li>\n</ol></li>\n<li id=\"cite_note-c-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-c_3-0\">‚Üë</a></span> <span class=\"reference-text\">text-c</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-a</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">page b</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text-c</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T242110: Copy-pasted, named sub-references should be merged and not mess with the numbering",
		"wikitext": "<ref name=\"a1\" extends=\"a\">a1</ref>\n<ref name=\"a1\" extends=\"a\">a1</ref>\n<references>\n<ref name=\"a\">a</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a1_1-0\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-a1_1-1\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-a1-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a1_1-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-a1_1-1\">1.1.1</a></sup></span> <span class=\"reference-text\">a1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T242110: Reused sub-references should be merged and not mess with the numbering",
		"wikitext": "<ref name=\"a1\" extends=\"a\">a1</ref>\n<ref name=\"a1\" extends=\"a\" />\n<references>\n<ref name=\"a\">a</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a1_1-0\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-a1_1-1\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-a1-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a1_1-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-a1_1-1\">1.1.1</a></sup></span> <span class=\"reference-text\">a1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "Reused sub-references can be rolled back without messing up numbering",
		"wikitext": "<ref name=\"a1\" extends=\"a\" />\n<ref group=\"g\" name=\"a1\" extends=\"a\" />\n{{#tag:references|\n<ref name=\"a\">a in group</ref>\n<ref name=\"a1\" extends=\"a\">a1 in group</ref>\n|group=g}}\n<ref name=\"a1\" extends=\"a\">a1</ref>\n<references>\n<ref name=\"a\">a</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a1_1-0\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-a1_2-0\" class=\"reference\"><a href=\"#cite_note-a1-2\">&#91;g 1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a in group</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-a1-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a1_2-0\">‚Üë</a></span> <span class=\"reference-text\">a1 in group</span>\n</li>\n</ol></li>\n</ol></div>\n<p><sup id=\"cite_ref-a1_1-1\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a in group <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-a1-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a1_1-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-a1_1-1\">1.1.1</a></sup></span> <span class=\"reference-text\">a1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a in group</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1 in group</span>&lt;/ref&gt;</span>\n</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">group=g</span></span>}}</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T242110: Bad extends attributes on reused sub-references should report an error",
		"wikitext": "<ref name=\"a1\" extends=\"a\">a1</ref>\n<ref name=\"a1\" extends=\"unknown\" />\n<references>\n<ref name=\"a\">a</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a1_1-0\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-a1_1-1\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-a1-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a1_1-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-a1_1-1\">1.1.1</a></sup></span> <span class=\"reference-text\">a1 <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a1\" defined multiple times with different content</span></span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">unknown</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T242110: Copy-pasted, named sub-references should appear in proper order",
		"wikitext": "<ref name=\"a1\" extends=\"a\">a1</ref>\n<ref name=\"a1\" extends=\"a\">a1</ref>\n<ref name=\"b1\" extends=\"b\">b1</ref>\n<ref name=\"b1\" extends=\"b\" />\n<ref name=\"c1\" extends=\"c\">c1</ref>\n<ref name=\"c1\" />\n<references>\n<ref name=\"a\">a</ref>\n<ref name=\"b\">a</ref>\n<ref name=\"c\">a</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a1_1-0\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-a1_1-1\" class=\"reference\"><a href=\"#cite_note-a1-1\">&#91;1.1&#93;</a></sup>\n<sup id=\"cite_ref-b1_2-0\" class=\"reference\"><a href=\"#cite_note-b1-2\">&#91;2.1&#93;</a></sup>\n<sup id=\"cite_ref-b1_2-1\" class=\"reference\"><a href=\"#cite_note-b1-2\">&#91;2.1&#93;</a></sup>\n<sup id=\"cite_ref-c1_3-0\" class=\"reference\"><a href=\"#cite_note-c1-3\">&#91;3.1&#93;</a></sup>\n<sup id=\"cite_ref-c1_3-1\" class=\"reference\"><a href=\"#cite_note-c1-3\">&#91;3.1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-a1-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a1_1-0\">1.1.0</a></sup> <sup><a href=\"#cite_ref-a1_1-1\">1.1.1</a></sup></span> <span class=\"reference-text\">a1</span>\n</li>\n</ol></li>\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-b1-2\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-b1_2-0\">2.1.0</a></sup> <sup><a href=\"#cite_ref-b1_2-1\">2.1.1</a></sup></span> <span class=\"reference-text\">b1</span>\n</li>\n</ol></li>\n<li id=\"\"><span class=\"mw-cite-backlink\">‚Üë </span> <span class=\"reference-text\">a</span>\n<ol class=\"mw-extended-references\"><li id=\"cite_note-c1-3\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-c1_3-0\">3.1.0</a></sup> <sup><a href=\"#cite_ref-c1_3-1\">3.1.1</a></sup></span> <span class=\"reference-text\">c1</span>\n</li>\n</ol></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">b1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">extends</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">c1</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c1</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "citeParserTests"
	},
	{
		"desc": "Simple <ref>, no <references/>",
		"wikitext": "Wikipedia rocks!<ref>Proceeds of Rockology, vol. XXI</ref>",
		"html": "<p>Wikipedia rocks!<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Proceeds of Rockology, vol. XXI</span>\n</li>\n</ol></div>",
		"render": "<p>Wikipedia rocks!\n</p>",
		"print": "<span class=\"wpb-root\">Wikipedia rocks!<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Proceeds of Rockology, vol. XXI</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Simple <ref>, no <references/>, page ends in a list",
		"wikitext": "blah<ref>foo</ref> --Matma Rex 17:35, 31 March 2020 (UTC)\n* bleh --Matma Rex 17:35, 31 March 2020 (UTC)",
		"html": "<p>blah<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup> --Matma Rex 17:35, 31 March 2020 (UTC)\n</p>\n<ul><li>bleh --Matma Rex 17:35, 31 March 2020 (UTC)</li></ul>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>",
		"render": "<p>blah --Matma Rex 17:35, 31 March 2020 (UTC)\n</p>\n<ul><li>bleh --Matma Rex 17:35, 31 March 2020 (UTC)</li></ul>",
		"print": "<span class=\"wpb-root\">blah<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span> --Matma Rex 17:35, 31 March 2020 (UTC)\n<span class=\"wpb-list\">* </span>bleh --Matma Rex 17:35, 31 March 2020 (UTC)</span>"
	},
	{
		"desc": "Simple <ref>, with <references/>",
		"wikitext": "Wikipedia rocks!<ref>Proceeds of Rockology, vol. XXI</ref>\n\n<references />",
		"html": "<p>Wikipedia rocks!<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Proceeds of Rockology, vol. XXI</span>\n</li>\n</ol></div>",
		"render": "<p>Wikipedia rocks!\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Wikipedia rocks!<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Proceeds of Rockology, vol. XXI</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> with a simple template",
		"wikitext": "Templating<ref>{{simple template}}</ref>\n\n<references />",
		"html": "<p>Templating<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">A <i>simple</i> template.</span>\n</li>\n</ol></div>",
		"render": "<p>Templating\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Templating<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">simple template</span>}}</span></span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> with a <nowiki>",
		"wikitext": "Templating<ref><nowiki>{{simple template}}</nowiki></ref>\n\n<references />",
		"html": "<p>Templating<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">{{simple template}}</span>\n</li>\n</ol></div>",
		"render": "<p>Templating\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Templating<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">{{simple template}}</span>&lt;/nowiki&gt;</span></span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> in a <nowiki>",
		"wikitext": "Templating<nowiki><ref>{{simple template}}</ref></nowiki>\n\n<references />",
		"html": "<p>Templating&lt;ref&gt;{{simple template}}&lt;/ref&gt;\n</p><p><br />\n</p>",
		"render": "<p>Templating&lt;ref&gt;{{simple template}}&lt;/ref&gt;\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Templating<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;ref&gt;{{simple template}}&lt;/ref&gt;</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> in a <!--comment-->",
		"wikitext": "Templating<!--<ref>{{simple template}}</ref>-->\n\n<references />",
		"html": "<p>Templating\n</p><p><br />\n</p>",
		"render": "<p>Templating\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Templating<span class=\"wpb-comment\">&lt;!--&lt;ref&gt;{{simple template}}&lt;/ref&gt;--&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<!--comment--> in a <ref> (T7384)",
		"wikitext": "Templating<ref>Text<!--comment--></ref>\n\n<references />",
		"html": "<p>Templating<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Text</span>\n</li>\n</ol></div>",
		"render": "<p>Templating\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Templating<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Text<span class=\"wpb-comment\">&lt;!--comment--&gt;</span></span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> in an ignored caption (T235656)",
		"wikitext": "[[File:Foobar.jpg|frameless|ignored caption with a ref<ref>boo</ref>]]\n\n<references />",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"ignored caption with a ref[1]\"><img alt=\"ignored caption with a ref[1]\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a></span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">boo</span>\n</li>\n</ol></div>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"ignored caption with a ref\"><img alt=\"ignored caption with a ref\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-caption\">ignored caption with a ref<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">boo</span>&lt;/ref&gt;</span></span>]]</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> in expanded attributes of tags (legitimate or otherwise)",
		"wikitext": "{|\n|- <ref>boo</ref>\n|x\n|}\n<references />",
		"html": "<table>\n\n<tbody><tr id=\"cite_ref-1\" class=\"reference\">\n<td>x\n</td></tr></tbody></table>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">boo</span>\n</li>\n</ol></div>",
		"render": "<table >\n<tbody><tr >\n<td >x\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">boo</span>&lt;/ref&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<references> after <gallery> (bug 6164)",
		"wikitext": "<ref>one</ref>\n\n<gallery>Image:Foobar.jpg</gallery>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">one</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">one</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">Image:Foobar.jpg</span></span></span>&lt;/gallery&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "{{REVISIONID}} on page with <ref> (bug 6299)",
		"wikitext": "{{REVISIONID}}<ref>elite</ref>",
		"html": "<p>1337<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">elite</span>\n</li>\n</ol></div>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>}}</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">elite</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "{{REVISIONID}} on page without <ref> (bug 6299 sanity check)",
		"wikitext": "{{REVISIONID}}",
		"html": "<p>1337\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>}}</span></span>"
	},
	{
		"desc": "Ref with content followed by blank ref",
		"wikitext": "<ref name=\"blank\">content</ref>\n\n<ref name=\"blank\" />\n\n<references />",
		"html": "<p><sup id=\"cite_ref-blank_1-0\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-blank_1-1\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-blank-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-blank_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-blank_1-1\">1.1</a></sup></span> <span class=\"reference-text\">content</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">content</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Blank ref followed by ref with content",
		"wikitext": "<ref name=\"blank\" />\n\n<ref name=\"blank\">content</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-blank_1-0\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-blank_1-1\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-blank-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-blank_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-blank_1-1\">1.1</a></sup></span> <span class=\"reference-text\">content</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">content</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Regression: non-blank ref \"0\" followed by ref with content",
		"wikitext": "<ref name=\"blank\">0</ref>\n\n<ref name=\"blank\">content</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-blank_1-0\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-blank_1-1\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-blank-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-blank_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-blank_1-1\">1.1</a></sup></span> <span class=\"reference-text\">0 <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"blank\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">0</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">content</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Regression sanity check: non-blank ref \"1\" followed by ref with content",
		"wikitext": "<ref name=\"blank\">1</ref>\n\n<ref name=\"blank\">content</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-blank_1-0\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-blank_1-1\" class=\"reference\"><a href=\"#cite_note-blank-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-blank-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-blank_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-blank_1-1\">1.1</a></sup></span> <span class=\"reference-text\">1 <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"blank\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blank</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">content</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref names containing a number",
		"wikitext": "<ref name=\"test123test\">One</ref>\n<ref name=\"123test\">Two</ref>\n<ref name=\"test123\">Three</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-test123test_1-0\" class=\"reference\"><a href=\"#cite_note-test123test-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-123test_2-0\" class=\"reference\"><a href=\"#cite_note-123test-2\">&#91;2&#93;</a></sup>\n<sup id=\"cite_ref-test123_3-0\" class=\"reference\"><a href=\"#cite_note-test123-3\">&#91;3&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-test123test-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-test123test_1-0\">‚Üë</a></span> <span class=\"reference-text\">One</span>\n</li>\n<li id=\"cite_note-123test-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-123test_2-0\">‚Üë</a></span> <span class=\"reference-text\">Two</span>\n</li>\n<li id=\"cite_note-test123-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-test123_3-0\">‚Üë</a></span> <span class=\"reference-text\">Three</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test123test</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">One</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">123test</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Two</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test123</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Three</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T184912: Consistent normalization of consecutive underscores",
		"wikitext": "<ref name=\"test_123\">example</ref>\n<ref name=\"test__123\">example</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-test_123_1-0\" class=\"reference\"><a href=\"#cite_note-test_123-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-test_123_2-0\" class=\"reference\"><a href=\"#cite_note-test_123-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-test_123-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-test_123_1-0\">‚Üë</a></span> <span class=\"reference-text\">example</span>\n</li>\n<li id=\"cite_note-test_123-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-test_123_2-0\">‚Üë</a></span> <span class=\"reference-text\">example</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test_123</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">example</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test__123</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">example</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Erroneous refs",
		"wikitext": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />\n\n<references />",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name cannot be a simple integer. Use a descriptive title</span>\n</p><p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p><p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: The opening <code>&lt;ref&gt;</code> tag is malformed or has a bad name</span>\n</p><p><sup id=\"cite_ref-bar_2-0\" class=\"reference\"><a href=\"#cite_note-bar-2\">&#91;2&#93;</a></sup>\n</p><p><sup id=\"cite_ref-blankwithnoreference_3-0\" class=\"reference\"><a href=\"#cite_note-blankwithnoreference-3\">&#91;3&#93;</a></sup>\n</p><p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;references&gt;</code> tag</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Also zero, but differently! (Normal ref)</span>\n</li>\n<li id=\"cite_note-bar-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-bar_2-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>bar</code></span></li>\n<li id=\"cite_note-blankwithnoreference-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-blankwithnoreference_3-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>blankwithnoreference</code></span></li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">0</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Zero</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Also zero, but differently! (Normal ref)</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">blankwithnoreference</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">quasit</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Can't have name=\"‚Ä¶\" and follow=\"‚Ä¶\" the same time",
		"wikitext": "<ref name=\"theName\" follow=\"theFollows\">theValue</ref>\n<references />",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: A <code>&lt;ref follow=\"‚Ä¶\"&gt;</code> tag that is the continuation of a previous one can neither be named individually nor extended</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theFollows</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Conflicting name=\"‚Ä¶\" and follow=\"‚Ä¶\" together with another invalid parameter",
		"wikitext": "<ref name=\"theName\" follow=\"theFollows\" dummy=\"dummy\">theValue</ref>\n<references />",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;ref&gt;</code> tag</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theFollows</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dummy</span>=\"<span class=\"wpb-attr-value\">dummy</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "It's not possible to follow=\"‚Ä¶\" a <ref> defined in the <references> section",
		"wikitext": "<ref follow=\"theName\">theFollows</ref>\n<references>\n<ref name=\"theName\">theValue</ref>\n</references>",
		"html": "<div class=\"mw-references-wrap\"><ol class=\"references\">\n<p id=\"cite_note-theName\"><span class=\"reference-text\">theFollows</span>\n</p>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"theName\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theFollows</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "A follow=\"‚Ä¶\" before its parent is not merged",
		"wikitext": "<ref follow=\"theName\">''theFollows''</ref>\n<ref name=\"theName\">''theValue''</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-theName_2-0\" class=\"reference\"><a href=\"#cite_note-theName-2\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<p id=\"cite_note-theName\"><span class=\"reference-text\"><i>theFollows</i></span>\n</p>\n<li id=\"cite_note-theName-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-theName_2-0\">‚Üë</a></span> <span class=\"reference-text\"><i>theValue</i></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-quote\">''</span>theFollows<span class=\"wpb-quote\">''</span></span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-quote\">''</span>theValue<span class=\"wpb-quote\">''</span></span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "\"follow\" after a named ref but before its parent",
		"wikitext": "<ref name=\"first\">First</ref>\n<ref follow=\"third\">Second</ref>\n<ref name=\"third\">Third</ref>\n<hr />\n<references />",
		"html": "<p><sup id=\"cite_ref-first_1-0\" class=\"reference\"><a href=\"#cite_note-first-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-third_3-0\" class=\"reference\"><a href=\"#cite_note-third-3\">&#91;2&#93;</a></sup>\n</p>\n<hr />\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<p id=\"cite_note-third\"><span class=\"reference-text\">Second</span>\n</p>\n<li id=\"cite_note-first-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-first_1-0\">‚Üë</a></span> <span class=\"reference-text\">First</span>\n</li>\n<li id=\"cite_note-third-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-third_3-0\">‚Üë</a></span> <span class=\"reference-text\">Third</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>\n<hr >",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">first</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">First</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">third</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Second</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">third</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Third</span>&lt;/ref&gt;</span>\n<span class=\"wpb-html\">&lt;hr<span class=\"wpb-html-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "\"follow\" after an anonymous ref but before its parent",
		"wikitext": "<ref>First</ref>\n<ref follow=\"third\">Second</ref>\n<ref name=\"third\">Third</ref>\n<hr />\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-third_3-0\" class=\"reference\"><a href=\"#cite_note-third-3\">&#91;2&#93;</a></sup>\n</p>\n<hr />\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<p id=\"cite_note-third\"><span class=\"reference-text\">Second</span>\n</p>\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">First</span>\n</li>\n<li id=\"cite_note-third-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-third_3-0\">‚Üë</a></span> <span class=\"reference-text\">Third</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>\n<hr >",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">First</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">third</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Second</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">third</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Third</span>&lt;/ref&gt;</span>\n<span class=\"wpb-html\">&lt;hr<span class=\"wpb-html-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Valid follow=\"‚Ä¶\" after it's parent",
		"wikitext": "<ref name=\"theName\">theValue</ref>\n<ref follow=\"theName\">theFollows</ref>\n<ref>Should be 2</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-theName_1-0\" class=\"reference\"><a href=\"#cite_note-theName-1\">&#91;1&#93;</a></sup>\n</p><p><sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-theName-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-theName_1-0\">‚Üë</a></span> <span class=\"reference-text\">theValue theFollows</span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">Should be 2</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theFollows</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Should be 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Forward-referenced ref with follow",
		"wikitext": "<ref name=\"theName\" />\n<ref follow=\"theName\">theFollows</ref>\n<references>\n<ref name=\"theName\">theValue</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-theName_1-0\" class=\"reference\"><a href=\"#cite_note-theName-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-theName-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-theName_1-0\">‚Üë</a></span> <span class=\"reference-text\"> theFollows <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"theName\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theFollows</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "Follow following a named ref with multiple definitions",
		"wikitext": "<ref name=\"test\">123</ref>\n<ref name=\"test\">234</ref>\n<ref follow=\"test\">345</ref>\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">123</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">234</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">test</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">345</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple follow after refs without content and trailing ref with content in references section",
		"wikitext": "ADD<ref name=\"theName\" />\nSUB<ref name=\"theName\"></ref>\nMUL<ref follow=\"theName\">theFollowValue</ref>\nMOD<ref follow=\"theName\">anotherFollowValue</ref>\n<references>\n<ref name=\"theName\"> theValue</ref>\n</references>",
		"html": "<p>ADD<sup id=\"cite_ref-theName_1-0\" class=\"reference\"><a href=\"#cite_note-theName-1\">&#91;1&#93;</a></sup>\nSUB<sup id=\"cite_ref-theName_1-1\" class=\"reference\"><a href=\"#cite_note-theName-1\">&#91;1&#93;</a></sup>\nMUL\nMOD\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-theName-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-theName_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-theName_1-1\">1.1</a></sup></span> <span class=\"reference-text\"> theFollowValue anotherFollowValue <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"theName\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p>ADD\nSUB\nMUL\nMOD\n</p>",
		"print": "<span class=\"wpb-root\">ADD<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span> </span>/&gt;</span>\nSUB<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;&lt;/ref&gt;</span>\nMUL<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theFollowValue</span>&lt;/ref&gt;</span>\nMOD<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">anotherFollowValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> theValue</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "Report bad attributes in ref tags",
		"wikitext": "<ref name=\"theName\" group=\"theGroup\" dummy=\"dummy\">theValue</ref>\n<references group=\"theGroup\" />",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;ref&gt;</code> tag</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dummy</span>=\"<span class=\"wpb-attr-value\">dummy</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Simple <ref>, with <references/> in group",
		"wikitext": "Wikipedia rocks!<ref>Proceeds of Rockology, vol. XXI</ref>\nWikipedia rocks!<ref group=\"note\">Proceeds of Rockology, vol. XXI</ref>\n\n<references />\n<references group=\"note\" />",
		"html": "<p>Wikipedia rocks!<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\nWikipedia rocks!<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;note 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Proceeds of Rockology, vol. XXI</span>\n</li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">Proceeds of Rockology, vol. XXI</span>\n</li>\n</ol></div>",
		"render": "<p>Wikipedia rocks!\nWikipedia rocks!\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Wikipedia rocks!<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Proceeds of Rockology, vol. XXI</span>&lt;/ref&gt;</span>\nWikipedia rocks!<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">note</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Proceeds of Rockology, vol. XXI</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">note</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Simple <ref>, with <references/> in group, with groupname in Chinese",
		"wikitext": "AAA<ref group=\"ÂèÇ\">ref a</ref>BBB<ref group=\"Ê≥®\">note b</ref>CCC<ref group=\"ÂèÇ\">ref c</ref>\n\n;refs\n<references group=\"ÂèÇ\" />\n\n;notes\n<references group=\"Ê≥®\" />",
		"html": "<p>AAA<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;ÂèÇ 1&#93;</a></sup>BBB<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;Ê≥® 1&#93;</a></sup>CCC<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;ÂèÇ 2&#93;</a></sup>\n</p>\n<dl><dt>refs</dt></dl>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">ref a</span>\n</li>\n<li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-3\">‚Üë</a></span> <span class=\"reference-text\">ref c</span>\n</li>\n</ol></div>\n<dl><dt>notes</dt></dl>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">note b</span>\n</li>\n</ol></div>",
		"render": "<p>AAABBBCCC\n</p>\n<dl><dt>refs</dt></dl>\n<p><br>\n</p>\n<dl><dt>notes</dt></dl>",
		"print": "<span class=\"wpb-root\">AAA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">ÂèÇ</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">ref a</span>&lt;/ref&gt;</span>BBB<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">Ê≥®</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">note b</span>&lt;/ref&gt;</span>CCC<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">ÂèÇ</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">ref c</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-list\">;</span>refs\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">ÂèÇ</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-list\">;</span>notes\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">Ê≥®</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Attributes are trimmed by the parser, see Sanitizer::decodeTagAttributes()",
		"wikitext": "<ref group=\"g\" name=\"n1\">in group g</ref>\n<ref group=\" g \" name=\" n2 \">in group \" g \"</ref>\n<references group=\"g\" />\n<references group=\" g \" />",
		"html": "<p><sup id=\"cite_ref-n1_1-0\" class=\"reference\"><a href=\"#cite_note-n1-1\">&#91;g 1&#93;</a></sup>\n<sup id=\"cite_ref-n2_2-0\" class=\"reference\"><a href=\"#cite_note-n2-2\">&#91;g 2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-n1-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-n1_1-0\">‚Üë</a></span> <span class=\"reference-text\">in group g</span>\n</li>\n<li id=\"cite_note-n2-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-n2_2-0\">‚Üë</a></span> <span class=\"reference-text\">in group \" g \"</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">n1</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">in group g</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\"> g </span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\"> n2 </span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">in group \" g \"</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\"> g </span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> defined in <references>",
		"wikitext": "<ref name=\"foo\" />\n\n<references>\n<ref name=\"foo\">BAR</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">BAR</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">BAR</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "<ref> defined in <references> called with #tag",
		"wikitext": "<ref name=\"foo\" />\n\n{{#tag:references|\n<Ref name=\"foo\">BAR</ref>\n}}",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">BAR</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;Ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">BAR</span>&lt;/ref&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "T242437 - Nested references edge case, outer tag function with LDR",
		"wikitext": "<ref name=\"foo\" />\n{{#tag:references|\n  <ref name=\"foo\">bar</ref>\n\n  <References />\n}}",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Closing tag missing for <code>&lt;references&gt;</code></span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n  <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\n\n  <span class=\"wpb-ext\">&lt;References<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "T242437 - Nested references edge case, outer tag function, inner LDR",
		"wikitext": "<ref name=\"foo\" />\n{{#tag:references|\n  <references>\n    <ref name=\"foo\">bar</ref>\n  </references>\n}}",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Closing tag missing for <code>&lt;references&gt;</code></span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n  <span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n    </span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n  </span></span>&lt;/references&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "T242437 - Nested references edge case, inner tag function with LDR",
		"wikitext": "<ref name=\"foo\" />\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"reference-text\">bar</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n  {{#tag:references|\n    </span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n  }}\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "<ref> defined in <references> error conditions",
		"wikitext": "<ref name=\"foo\" group=\"2\" />\n\n<references group=\"2\">\n<ref name=\"foo\" />\n<ref name=\"unused\">BAR</ref>\n<ref name=\"foo\" group=\"1\">bad group</ref>\n<ref name=\"bar\" group=\"1\" />\n<ref>BAR BAR</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;2 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>foo</code></span></li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"foo\" defined in <code>&lt;references&gt;</code> group \"2\" has no content.</span><br />\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"unused\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span><br />\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag in <code>&lt;references&gt;</code> has conflicting group attribute \"1\".</span><br />\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag defined in <code>&lt;references&gt;</code> has no name attribute.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">2</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">2</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">unused</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">BAR</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bad group</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span> </span>/&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">BAR BAR</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "<ref> ungrouped and grouped refs with and without content defined",
		"wikitext": "ONE<ref name=\"foo\" />\n<references />\nTWO<ref group=\"NOTES\" name=\"foo\" />\nTHREE<ref group=\"NOTES\" name=\"bar\">CONTENT</ref>\n<references group=\"NOTES\" />",
		"html": "<p>ONE<sup id=\"cite_ref-foo_1-0\" class=\"reference\"><a href=\"#cite_note-foo-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_1-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>foo</code></span></li>\n</ol></div>\n<p>TWO<sup id=\"cite_ref-foo_2-0\" class=\"reference\"><a href=\"#cite_note-foo-2\">&#91;NOTES 1&#93;</a></sup>\nTHREE<sup id=\"cite_ref-bar_3-0\" class=\"reference\"><a href=\"#cite_note-bar-3\">&#91;NOTES 2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-foo-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-foo_2-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>foo</code></span></li>\n<li id=\"cite_note-bar-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-bar_3-0\">‚Üë</a></span> <span class=\"reference-text\">CONTENT</span>\n</li>\n</ol></div>",
		"render": "<p>ONE\n</p><p>TWO\nTHREE\n</p>",
		"print": "<span class=\"wpb-root\">ONE<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\nTWO<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\nTHREE<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">CONTENT</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Error conditions on non-visible content",
		"wikitext": "<ref name=\"a\">x</ref>\n<ref name=\"b\"> </ref>\n<ref name=\"c\" />\n<references>\n<ref name=\"a\" />\n<ref name=\"b\" />\n<ref name=\"c\"> </ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n<sup id=\"cite_ref-c_3-0\" class=\"reference\"><a href=\"#cite_note-c-3\">&#91;3&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">x</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>b</code></span></li>\n<li id=\"cite_note-c-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-c_3-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>c</code></span></li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"a\" defined in <code>&lt;references&gt;</code> group \"\" has no content.</span><br />\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"b\" defined in <code>&lt;references&gt;</code> group \"\" has no content.</span><br />\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"c\" defined in <code>&lt;references&gt;</code> group \"\" has no content.</span>\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">x</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "<ref> with custom group link with number names in Klingon",
		"wikitext": "Wikipedia rocks!<ref group=\"klingon\">Proceeds of Rockology, vol. XXI</ref>\n\n<references group=\"klingon\" />",
		"html": "<p>Wikipedia rocks!<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;wa&#39;&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Proceeds of Rockology, vol. XXI</span>\n</li>\n</ol></div>",
		"render": "<p>Wikipedia rocks!\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">Wikipedia rocks!<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">klingon</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Proceeds of Rockology, vol. XXI</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">klingon</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Consecutive whitespace in custom link label message should not create empty []",
		"wikitext": "<ref group=\"klingon\">1st</ref>\n<ref group=\"klingon\">2nd</ref>\n<references group=\"klingon\" />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;wa&#39;&#93;</a></sup>\n<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;cha&#39;&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">1st</span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">2nd</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">klingon</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">1st</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">klingon</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">2nd</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">klingon</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Bug 31374 regression check: nested strip items",
		"wikitext": "{{#tag:ref|note<ref>reference</ref>|group=Note}}\n<references group=\"Note\" />\n<references />",
		"html": "<p><sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;Note 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">note<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup></span>\n</li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">reference</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ref</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">note<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">reference</span>&lt;/ref&gt;</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">group=Note</span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">Note</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Bug 13073 regression check: wrapped <references>",
		"wikitext": "<ref>\nfoo\n</ref>\n<div><references /></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">\nfoo\n</span>&lt;/ref&gt;</span>\n<span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "<ref> with no name and no content.",
		"wikitext": "Bla.<ref></ref>\nfoo.<ref />\nzero{{1x|<ref />}}\n<references />",
		"html": "<p>Bla.<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; refs with no name must have content</span>\nfoo.<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: The opening <code>&lt;ref&gt;</code> tag is malformed or has a bad name</span>\nzero<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: The opening <code>&lt;ref&gt;</code> tag is malformed or has a bad name</span>\n</p>",
		"render": "<p>Bla.\nfoo.\nzero\n</p>",
		"print": "<span class=\"wpb-root\">Bla.<span class=\"wpb-ext\">&lt;ref&gt;&lt;/ref&gt;</span>\nfoo.<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\nzero<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> with an empty-string name parameter and no content.",
		"wikitext": "Bla.<ref name=\"\"> </ref>\n<references />",
		"html": "<p>Bla.<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; refs with no name must have content</span>\n</p>",
		"render": "<p>Bla.\n</p>",
		"print": "<span class=\"wpb-root\">Bla.<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> with whitespace only name parameter and no content.",
		"wikitext": "Hi <ref name=\" \"> </ref>\nHo <ref name=\" \" />",
		"html": "<p>Hi <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; refs with no name must have content</span>\nHo <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: The opening <code>&lt;ref&gt;</code> tag is malformed or has a bad name</span>\n</p>",
		"render": "<p>Hi \nHo \n</p>",
		"print": "<span class=\"wpb-root\">Hi <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\"> </span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span>\nHo <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\"> </span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> with a non-empty name parameter and no content.",
		"wikitext": "Bla.<ref name=\"void\"> </ref>\n<references />",
		"html": "<p>Bla.<sup id=\"cite_ref-void_1-0\" class=\"reference\"><a href=\"#cite_note-void-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-void-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-void_1-0\">‚Üë</a></span> <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; no text was provided for refs named <code>void</code></span></li>\n</ol></div>",
		"render": "<p>Bla.\n</p>",
		"print": "<span class=\"wpb-root\">Bla.<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">void</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Whitespace only doesn't set content for named ref",
		"wikitext": "Hi <ref name=\"ho\"> </ref>\nHi <ref name=\"ho\">Off to work we go!</ref>\n<references />",
		"html": "<p>Hi <sup id=\"cite_ref-ho_1-0\" class=\"reference\"><a href=\"#cite_note-ho-1\">&#91;1&#93;</a></sup>\nHi <sup id=\"cite_ref-ho_1-1\" class=\"reference\"><a href=\"#cite_note-ho-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-ho-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-ho_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-ho_1-1\">1.1</a></sup></span> <span class=\"reference-text\">Off to work we go!</span>\n</li>\n</ol></div>",
		"render": "<p>Hi \nHi \n</p>",
		"print": "<span class=\"wpb-root\">Hi <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">ho</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> </span>&lt;/ref&gt;</span>\nHi <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">ho</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Off to work we go!</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple definition (outside <references/>)",
		"wikitext": "<ref name=\"a\">abc</ref>\n<ref name=\"a\">def</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">def</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple definition (inside <references/>)",
		"wikitext": "<ref name=\"a\" />\n<references>\n<ref name=\"a\">abc</ref>\n<ref name=\"a\">def</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">def</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "Multiple definition (mixed outside/inside)",
		"wikitext": "<ref name=\"a\">abc</ref>\n<references>\n<ref name=\"a\">def</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">def</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T202593: Conflicting dir attributes",
		"wikitext": "<ref name=\"a\" dir=\"ltr\" />\n<ref name=\"a\" dir=\"rtl\">abc</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\" class=\"mw-cite-dir-rtl\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: One of the <code>&lt;ref&gt;</code> tags with the name \"a\" does have a conflicting dir attribute.</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">ltr</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T202593: Conflicting dir attributes with the full ref first",
		"wikitext": "<ref name=\"a\" dir=\"ltr\">abc</ref>\n<ref name=\"a\" dir=\"rtl\" />\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\" class=\"mw-cite-dir-ltr\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: One of the <code>&lt;ref&gt;</code> tags with the name \"a\" does have a conflicting dir attribute.</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">ltr</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T202593: Identical dir attributes are pointless, but should not generate an error",
		"wikitext": "<ref name=\"a\" dir=\"RTL\" />\n<ref name=\"a\" dir=\"rtl\">abc</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\" class=\"mw-cite-dir-rtl\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">abc</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">RTL</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple definition (inside {{#tag:references}})",
		"wikitext": "<ref name=\"a\" />\n{{#tag:references|\n<ref name=\"a\">abc</ref>\n<ref name=\"a\">def</ref>\n}}\n<references />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">abc</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">def</span>&lt;/ref&gt;</span>\n</span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T29694 - [] in reference names in HTML5 fragment mode",
		"wikitext": "<ref name=\"[#foo] {bar} <baz>\">[bar]</ref>",
		"html": "<p><sup id=\"cite_ref-&#91;#foo&#93;_&#123;bar&#125;_&lt;baz_1-0\" class=\"reference\"><a href=\"#cite_note-[#foo]_{bar}_&lt;baz-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-&#91;#foo&#93;_&#123;bar&#125;_&lt;baz-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-[#foo]_{bar}_&lt;baz_1-0\">‚Üë</a></span> <span class=\"reference-text\">\"&gt;[bar]</span>\n</li>\n</ol></div>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">[#foo] {bar} &lt;baz</span></span></span>&gt;<span class=\"wpb-ext-inner\">\"&gt;[bar]</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "T29694 - [] in reference names in HTML5 fragment mode (tidied)",
		"wikitext": "<ref name=\"[#foo] {bar} <baz&gt;\">[bar]</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-&#91;#foo&#93;_&#123;bar&#125;_&lt;baz&gt;_1-0\" class=\"reference\"><a href=\"#cite_note-[#foo]_{bar}_&lt;baz&gt;-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-&#91;#foo&#93;_&#123;bar&#125;_&lt;baz&gt;-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-[#foo]_{bar}_&lt;baz&gt;_1-0\">‚Üë</a></span> <span class=\"reference-text\">[bar]</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">[#foo] {bar} &lt;baz&amp;gt;</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[bar]</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 1. ref-location should be replaced with an index span",
		"wikitext": "A <ref>foo</ref>\nB <ref name=\"x\">foo</ref>\nC <ref name=\"y\" />\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\nC <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">y</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 2. ref-tags with identical names should all get the same index",
		"wikitext": "A <ref name=\"x\">foo</ref>\nB <ref name=\"x\" />\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 3. spaces in ref-names should be ignored",
		"wikitext": "A <ref name=\"x\">foo</ref>\nB <ref name=\" x \" />\nC <ref name= x  />\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\"> x </span>\"</span> </span>/&gt;</span>\nC <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>= <span class=\"wpb-attr-value\">x</span></span>  </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 4. 'constructor' should be accepted as a valid ref-name",
		"wikitext": "A <ref name=\"constructor\">foo</ref>\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">constructor</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 5. body should accept generic wikitext",
		"wikitext": "A <ref>\n This is a '''[[bolded link]]''' and this is a {{1x|transclusion}}\n</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">\n This is a <span class=\"wpb-quote\">'''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">bolded link</span>]]</span><span class=\"wpb-quote\">'''</span> and this is a <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">transclusion</span></span>}}</span>\n</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 6. indent-pres should not be output in ref-body",
		"wikitext": "A <ref>\n foo\n bar\n baz\n</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">\n foo\n bar\n baz\n</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 7. No p-wrapping in ref-body",
		"wikitext": "A <ref>\nfoo\n\nbar\n\n\nbaz\n\n\n\nbooz\n</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">\nfoo\n\nbar\n\n\nbaz\n\n\n\nbooz\n</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 8. transclusion wikitext has lower precedence",
		"wikitext": "A <ref> foo {{1x|</ref> B C}}\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"> foo {{1x|</span>&lt;/ref&gt;</span> B C}}\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 9. unclosed comments should not leak out of ref-body",
		"wikitext": "A <ref> foo <!--</ref> B C\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"> foo <span class=\"wpb-comment\">&lt;!--</span></span>&lt;/ref&gt;</span> B C\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 10. Unclosed HTML tags should not leak out of ref-body",
		"wikitext": "A <ref> <b> foo </ref> B C\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"> <span class=\"wpb-html\">&lt;b&gt;</span> foo </span>&lt;/ref&gt;</span> B C\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 11. ref-tags acts like an inline element wrt P-wrapping",
		"wikitext": "A <ref>foo</ref> B\nC <ref>bar</ref> D\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span> B\nC <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span> D\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 12. ref-tags act as trailing newline migration barrier",
		"wikitext": "<!--the newline at the end of this line moves out of the p tag-->a\n\nb<!--the newline at the end of this line stays inside the p tag--> <ref>foo</ref>\n<ref>bar</ref>\n\nc\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--the newline at the end of this line moves out of the p tag--&gt;</span>a\n\nb<span class=\"wpb-comment\">&lt;!--the newline at the end of this line stays inside the p tag--&gt;</span> <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\n\nc\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 13. ref-tags are not SOL-transparent and block indent-pres",
		"wikitext": "<ref>foo</ref> A\n<ref>bar\n</ref> B\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span> A\n<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">bar\n</span>&lt;/ref&gt;</span> B\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 14. A nested ref-tag should be emitted as plain text",
		"wikitext": "<ref>foo <ref>bar</ref> baz</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo &lt;ref&gt;bar</span>&lt;/ref&gt;</span> baz&lt;/ref&gt;\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 15. ref-tags with identical names should get identical indexes",
		"wikitext": "A1 <ref name=\"a\">foo</ref> A2 <ref name=\"a\" />\nB1 <ref name=\"b\" /> B2 <ref name=\"b\">bar</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\">A1 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span> A2 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\nB1 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span> B2 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 16. Tokenizer should accept non-standard whitespace in <ref> and </ref> tags",
		"wikitext": "A <ref >foo</ref >\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> </span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref &gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 17. Generate valid HTML5 id/about attributes",
		"wikitext": "<ref name=\"a b\">foo</ref>\n<ref name=\":0\">ve-created name</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">:0</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">ve-created name</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 18. T58916: Extension attributes should be parsed as plain text",
		"wikitext": "<ref name=\"{{1x|a}}\">foo</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-&#123;&#123;1x&#124;a&#125;&#125;_1-0\" class=\"reference\"><a href=\"#cite_note-{{1x|a}}-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-&#123;&#123;1x&#124;a&#125;&#125;-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-{{1x|a}}_1-0\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">{{1x|a}}</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 19. ref-tags with identical name encodings should get identical indexes",
		"wikitext": "1 <ref name=\"a & b\">foo</ref> 2 <ref name=\"a &amp; b\" />\n\n<references />",
		"html": "<p>1 <sup id=\"cite_ref-a_&amp;_b_1-0\" class=\"reference\"><a href=\"#cite_note-a_&amp;_b-1\">&#91;1&#93;</a></sup> 2 <sup id=\"cite_ref-a_&amp;_b_1-1\" class=\"reference\"><a href=\"#cite_note-a_&amp;_b-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a_&amp;_b-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_&amp;_b_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_&amp;_b_1-1\">1.1</a></sup></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>",
		"render": "<p>1  2 \n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">1 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a &amp; b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span> 2 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a &amp;amp; b</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref: 20. ref-tags with identical names but different content should keep it",
		"wikitext": "A <ref name=\"foo\">Foo one</ref>\nB <ref name=\"foo\">Foo two</ref>\nC <ref name=\"foo\" />\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Foo one</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Foo two</span>&lt;/ref&gt;</span>\nC <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Verify invalid use of a numeric character in a ref name",
		"wikitext": "PRE <ref>preValue</ref>\nTHEVALUE <ref name=\"1\">theValue</ref>\nPOST <ref>postValue</ref>\n<references />",
		"html": "<p>PRE <sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\nTHEVALUE <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name cannot be a simple integer. Use a descriptive title</span>\nPOST <sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">preValue</span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">postValue</span>\n</li>\n</ol></div>",
		"render": "<p>PRE \nTHEVALUE \nPOST \n</p>",
		"print": "<span class=\"wpb-root\">PRE <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">preValue</span>&lt;/ref&gt;</span>\nTHEVALUE <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\nPOST <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">postValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Verify invalid use of a numeric character in a ref name and follow",
		"wikitext": "<ref name=\"1\">theValue</ref>\n<ref follow=\"1\">theFollow</ref>\n<references />",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name cannot be a simple integer. Use a descriptive title</span>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name cannot be a simple integer. Use a descriptive title</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theFollow</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 1a. references tag without any refs should be handled properly",
		"wikitext": "<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 1b. references tag without any refs should be handled properly",
		"wikitext": "<references></references>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;references&gt;&lt;/references&gt;</span></span>"
	},
	{
		"desc": "References: 2. references tag with group only outputs references from that group",
		"wikitext": "A <ref group=\"a\">foo</ref>\nB <ref group=\"b\">bar</ref>\nC <ref>baz</ref>\n\n<references group=\"a\" />\n<references />\n<references group=\"b\" />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\nC <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">baz</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 3. ref list should be cleared after processing references",
		"wikitext": "A <ref>foo</ref>\n\n<references />\n\nB <ref>bar</ref>\n\n<references />",
		"html": "<p>A <sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>\n<p>B <sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">bar</span>\n</li>\n</ol></div>",
		"render": "<p>A \n</p><p><br>\n</p><p>B \n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n\nB <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Counters should be cleared after processing named <references group=\"‚Ä¶\">",
		"wikitext": "A <ref group=\"g\">foo</ref>\n\n<references group=\"g\" />\n\nB <ref group=\"g\">bar</ref>\n\n<references group=\"g\" />",
		"html": "<p>A <sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;g 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>\n<p>B <sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;g 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">bar</span>\n</li>\n</ol></div>",
		"render": "<p>A \n</p><p><br>\n</p><p>B \n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> </span>/&gt;</span>\n\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 4. only referenced group should be cleared after processing references",
		"wikitext": "A <ref group=\"a\">afoo</ref>\nB <ref>bfoo</ref>\n\n<references group=\"a\" />\n\nC <ref>cfoo</ref>\n\n<references />",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">afoo</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">bfoo</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n\nC <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">cfoo</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 5. ref tags in references should be processed while ignoring all other content",
		"wikitext": "A <ref name=\"a\" />\nB <ref name=\"b\">bar</ref>\n\n<references>\n<ref name=\"a\">foo</ref>\nThis should just get lost.\n</references>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\nThis should just get lost.\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "References: 6. <references /> from a transclusion",
		"wikitext": "<ref>Foo</ref> {{1x|<references />}}",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup> </p><div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Foo</span>\n</li>\n</ol></div>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Foo</span>&lt;/ref&gt;</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "References: 7. Multiple references tags (one without and one with nested refs) should be correctly handled",
		"wikitext": "A <ref>foo bar for a</ref>\nB <ref group=\"X\" name=\"b\" />\n\n<references />\n\n<references group=\"X\">\n<ref name=\"b\">foo</ref>\n</references>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo bar for a</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">X</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">X</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "References: 7b. Multiple references tags some with errors should be correctly handled",
		"wikitext": "ALPHA<ref name=\"foo\" />\nBETA<ref name=\"foo\" />\nONE<ref group=\"NOTES\" name=\"foo\" />\nTWO<ref group=\"NOTES\" name=\"foo\">food</ref>\n<references group=\"NOTES\" />\n<references />\nTHREE<ref group=\"NOTES\" name=\"bar\">CONTENT</ref>\nFOUR<ref group=\"NOTES\" name=\"foo\" />\nFIVE<ref group=\"NOTES\" name=\"foo\" />\nSIX<ref name=\"foo\" />\n<references group=\"NOTES\" />\n<references>\n<ref name=\"foo\">NOGROUPCONTENT</ref>\n</references>\nSEVEN<ref group=\"NOTES\" name=\"bar\" />\nEIGHT<ref group=\"NOTES\" name=\"foo\" />\n<references group=\"NOTES\" />\nNINE<ref group=\"NOTES\" name=\"bar\">NINECONTENT</ref>\nTEN<ref group=\"NOTES\" name=\"foo\">TENCONTENT</ref>\n<references group=\"NOTES\" />",
		"print": "<span class=\"wpb-root\">ALPHA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\nBETA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\nONE<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\nTWO<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">food</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\nTHREE<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">CONTENT</span>&lt;/ref&gt;</span>\nFOUR<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\nFIVE<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\nSIX<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">NOGROUPCONTENT</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span>\nSEVEN<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span> </span>/&gt;</span>\nEIGHT<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> </span>/&gt;</span>\nNINE<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">NINECONTENT</span>&lt;/ref&gt;</span>\nTEN<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">TENCONTENT</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">NOTES</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 8. T88019: Remove <meta>s from templates inside <ref> that's itself inside a template",
		"wikitext": "X{{1x|<ref>foo {{1x|<b>bar</b>}} and {{1x|baz}} boo</ref>}}\n<references />",
		"print": "<span class=\"wpb-root\">X<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;b&gt;</span>bar<span class=\"wpb-html\">&lt;/b&gt;</span></span></span>}}</span> and <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">baz</span></span>}}</span> boo</span>&lt;/ref&gt;</span></span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "References: 9. Generate missing references list at the end",
		"wikitext": "A <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">inexistent</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "References: 10.1. New <references/> shouldn't be added for unrelated edits.",
		"wikitext": "Unrelated text<span id=\"x\"> that's going to disappear</span>.\nA <ref>foo</ref>",
		"print": "<span class=\"wpb-root\">Unrelated text<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span> that's going to disappear<span class=\"wpb-html\">&lt;/span&gt;</span>.\nA <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "References: 10.2. New <references/> shouldn't be added for unrelated edits.",
		"wikitext": "Unrelated text<span id=\"x\"> that's going to disappear</span>.\nA <ref>foo</ref>",
		"print": "<span class=\"wpb-root\">Unrelated text<span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span> that's going to disappear<span class=\"wpb-html\">&lt;/span&gt;</span>.\nA <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Grouped references with follow rendered in mixed order",
		"wikitext": "AA<ref group=\"a\" name=\"name_a\">group_a_name_a</ref>\nBA<ref group=\"b\" name=\"name_a\">group_b_name_a</ref>\nCA<ref group=\"c\" name=\"name_a\">group_c_name_a</ref>\nBB<ref group=\"b\" name=\"name_b\">group_b_name_b</ref>\nFBA<ref group=\"b\" follow=\"name_a\">group_b_follow_a</ref>\nFAA<ref group=\"a\" follow=\"name_a\">group_a_follow_a</ref>\nFBB<ref group=\"b\" follow=\"name_b\">group_b_follow_b</ref>\nFCA<ref group=\"c\" follow=\"name_a\">group_c_follow_a</ref>\n<references group=\"b\" />\n<references group=\"c\" />\n<references group=\"a\" />",
		"html": "<p>AA<sup id=\"cite_ref-name_a_1-0\" class=\"reference\"><a href=\"#cite_note-name_a-1\">&#91;a 1&#93;</a></sup>\nBA<sup id=\"cite_ref-name_a_2-0\" class=\"reference\"><a href=\"#cite_note-name_a-2\">&#91;b 1&#93;</a></sup>\nCA<sup id=\"cite_ref-name_a_3-0\" class=\"reference\"><a href=\"#cite_note-name_a-3\">&#91;c 1&#93;</a></sup>\nBB<sup id=\"cite_ref-name_b_4-0\" class=\"reference\"><a href=\"#cite_note-name_b-4\">&#91;b 2&#93;</a></sup>\nFBA\nFAA\nFBB\nFCA\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-name_a-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-name_a_2-0\">‚Üë</a></span> <span class=\"reference-text\">group_b_name_a group_b_follow_a</span>\n</li>\n<li id=\"cite_note-name_b-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-name_b_4-0\">‚Üë</a></span> <span class=\"reference-text\">group_b_name_b group_b_follow_b</span>\n</li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-name_a-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-name_a_3-0\">‚Üë</a></span> <span class=\"reference-text\">group_c_name_a group_c_follow_a</span>\n</li>\n</ol></div>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-name_a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-name_a_1-0\">‚Üë</a></span> <span class=\"reference-text\">group_a_name_a group_a_follow_a</span>\n</li>\n</ol></div>",
		"render": "<p>AA\nBA\nCA\nBB\nFBA\nFAA\nFBB\nFCA\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">AA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">name_a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_a_name_a</span>&lt;/ref&gt;</span>\nBA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">name_a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_b_name_a</span>&lt;/ref&gt;</span>\nCA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">name_a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_c_name_a</span>&lt;/ref&gt;</span>\nBB<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">name_b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_b_name_b</span>&lt;/ref&gt;</span>\nFBA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">name_a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_b_follow_a</span>&lt;/ref&gt;</span>\nFAA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">name_a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_a_follow_a</span>&lt;/ref&gt;</span>\nFBB<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">name_b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_b_follow_b</span>&lt;/ref&gt;</span>\nFCA<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">name_a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">group_c_follow_a</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Grouped references with automatic group references generating errors",
		"wikitext": "GROUP <ref group=\"theGroup\" name=\"theName\">theValue</ref>\nGROUP3 <ref group=\"theGroup3\" name=\"theName3\">theValue3</ref>\nGROUP2 <ref group=\"theGroup2\" name=\"theName2\">theValue2</ref>\naDifferentNameGROUP3 <ref group=\"theGroup3\" name=\"theName\">anotherValue3differentName</ref>\naDifferentNameGROUP2 <ref group=\"theGroup2\" name=\"anotherName2\">anotherValue2DifferentName</ref>\nanotherGROUP3 <ref group=\"theGroup3\" name=\"theName3\">anotherValue3</ref>\naDifferentNameGROUP <ref group=\"theGroup\" name=\"anotherName2\">anotherValueDifferentName</ref>\n<references group=\"theGroup3\" />",
		"html": "<p>GROUP <sup id=\"cite_ref-theName_1-0\" class=\"reference\"><a href=\"#cite_note-theName-1\">&#91;theGroup 1&#93;</a></sup>\nGROUP3 <sup id=\"cite_ref-theName3_2-0\" class=\"reference\"><a href=\"#cite_note-theName3-2\">&#91;theGroup3 1&#93;</a></sup>\nGROUP2 <sup id=\"cite_ref-theName2_3-0\" class=\"reference\"><a href=\"#cite_note-theName2-3\">&#91;theGroup2 1&#93;</a></sup>\naDifferentNameGROUP3 <sup id=\"cite_ref-theName_4-0\" class=\"reference\"><a href=\"#cite_note-theName-4\">&#91;theGroup3 2&#93;</a></sup>\naDifferentNameGROUP2 <sup id=\"cite_ref-anotherName2_5-0\" class=\"reference\"><a href=\"#cite_note-anotherName2-5\">&#91;theGroup2 2&#93;</a></sup>\nanotherGROUP3 <sup id=\"cite_ref-theName3_2-1\" class=\"reference\"><a href=\"#cite_note-theName3-2\">&#91;theGroup3 1&#93;</a></sup>\naDifferentNameGROUP <sup id=\"cite_ref-anotherName2_6-0\" class=\"reference\"><a href=\"#cite_note-anotherName2-6\">&#91;theGroup 2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-theName3-2\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-theName3_2-0\">1.0</a></sup> <sup><a href=\"#cite_ref-theName3_2-1\">1.1</a></sup></span> <span class=\"reference-text\">theValue3 <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"theName3\" defined multiple times with different content</span></span>\n</li>\n<li id=\"cite_note-theName-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-theName_4-0\">‚Üë</a></span> <span class=\"reference-text\">anotherValue3differentName</span>\n</li>\n</ol></div>\n<p><br /><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tags exist for a group named \"theGroup\", but no corresponding <code>&lt;references group=\"theGroup\"/&gt;</code> tag was found</span><br /><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tags exist for a group named \"theGroup2\", but no corresponding <code>&lt;references group=\"theGroup2\"/&gt;</code> tag was found</span>\n</p>",
		"render": "<p>GROUP \nGROUP3 \nGROUP2 \naDifferentNameGROUP3 \naDifferentNameGROUP2 \nanotherGROUP3 \naDifferentNameGROUP \n</p>",
		"print": "<span class=\"wpb-root\">GROUP <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue</span>&lt;/ref&gt;</span>\nGROUP3 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup3</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName3</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue3</span>&lt;/ref&gt;</span>\nGROUP2 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup2</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName2</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theValue2</span>&lt;/ref&gt;</span>\naDifferentNameGROUP3 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup3</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">anotherValue3differentName</span>&lt;/ref&gt;</span>\naDifferentNameGROUP2 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup2</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">anotherName2</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">anotherValue2DifferentName</span>&lt;/ref&gt;</span>\nanotherGROUP3 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup3</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName3</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">anotherValue3</span>&lt;/ref&gt;</span>\naDifferentNameGROUP <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">anotherName2</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">anotherValueDifferentName</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup3</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Entities in ref name",
		"wikitext": "<ref name=\"test &amp; me {{1x|foo}}\">hi</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-test_&amp;_me_&#123;&#123;1x&#124;foo&#125;&#125;_1-0\" class=\"reference\"><a href=\"#cite_note-test_&amp;_me_{{1x|foo}}-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-test_&amp;_me_&#123;&#123;1x&#124;foo&#125;&#125;-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-test_&amp;_me_{{1x|foo}}_1-0\">‚Üë</a></span> <span class=\"reference-text\">hi</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">test &amp;amp; me {{1x|foo}}</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">hi</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Generate references for unclosed references tag",
		"wikitext": "a<ref>foo</ref>\n\n<references>",
		"print": "<span class=\"wpb-root\">a<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n\n&lt;references&gt;</span>"
	},
	{
		"desc": "New reference serializes on its own line",
		"wikitext": "foo\n<references />",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref in ref: nested in top level ref",
		"wikitext": "test <ref>hi {{refinref|ho}}</ref>\n<references />",
		"html": "<p>test <sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">hi </span>\n</li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag defined in <code>&lt;references&gt;</code> has no name attribute.</span>\n</p>",
		"render": "<p>test \n</p>",
		"print": "<span class=\"wpb-root\">test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">hi <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">refinref</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ho</span></span>}}</span></span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref in ref: top level ref nested in transclusion",
		"wikitext": "test {{refinref|456<ref>123</ref>}}\n<references />",
		"html": "<p>test <sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">{{{1}}}</span>\n</li>\n</ol></div>",
		"render": "<p>test <a href=\"/wiki/Template%3ARefinref?action=edit&redlink=1\" class=\"new\" title=\"Template:Refinref (page does not exist)\">Template:Refinref</a>\n</p>",
		"print": "<span class=\"wpb-root\">test <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">refinref</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">456<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">123</span>&lt;/ref&gt;</span></span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref in ref: top level ref nested in parser function",
		"wikitext": "test {{#tag:ref|456<ref>123</ref>}}\n<references />",
		"html": "<p>test <sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">123</span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">456<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup></span>\n</li>\n</ol></div>",
		"render": "<p>test \n</p>",
		"print": "<span class=\"wpb-root\">test <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ref</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">456<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">123</span>&lt;/ref&gt;</span></span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref in ref: Multiple levels of nesting in parser function",
		"wikitext": "one{{#tag:ref|two{{#tag:ref|three<ref>four</ref>}}}}",
		"html": "<p>one<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;3&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">four</span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">‚Üë</a></span> <span class=\"reference-text\">three<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup></span>\n</li>\n<li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-3\">‚Üë</a></span> <span class=\"reference-text\">two<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup></span>\n</li>\n</ol></div>",
		"render": "<p>one\n</p>",
		"print": "<span class=\"wpb-root\">one<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ref</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">two<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ref</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">three<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">four</span>&lt;/ref&gt;</span></span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Ref in ref: self-referential",
		"wikitext": "{{#tag:ref|<ref name=\"x\" />|name=x}}",
		"html": "<p><sup id=\"cite_ref-x_1-1\" class=\"reference\"><a href=\"#cite_note-x-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-x-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-x_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-x_1-1\">1.1</a></sup></span> <span class=\"reference-text\"><sup id=\"cite_ref-x_1-0\" class=\"reference\"><a href=\"#cite_note-x-1\">&#91;1&#93;</a></sup></span>\n</li>\n</ol></div>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ref</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span> </span>/&gt;</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">name=x</span></span>}}</span></span>"
	},
	{
		"desc": "Nested ref with forward slash",
		"wikitext": "test {{nestedrefslash}}\n<references />",
		"print": "<span class=\"wpb-root\">test <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">nestedrefslash</span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: disabled, autogenerated",
		"wikitext": "Test <ref>1</ref><ref>2</ref>",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Responsive references: enabled, autogenerated",
		"wikitext": "Test <ref>1</ref><ref>2</ref>",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Responsive references: enabled, autogenerated, exceed",
		"wikitext": "Test <ref>1</ref><ref>2</ref>",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Responsive references: disabled",
		"wikitext": "Test <ref>1</ref><ref>2</ref>\n<references />",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: enabled",
		"wikitext": "Test <ref>1</ref><ref>2</ref>\n<references />",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: enabled, exceed",
		"wikitext": "Test <ref>1</ref><ref>2</ref>\n<references />",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: disabled, explicit",
		"wikitext": "Test <ref>1</ref><ref>2</ref>\n<references responsive=\"\" />",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">responsive</span>=\"\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: disabled, explicit, exceed",
		"wikitext": "Test <ref>1</ref><ref>2</ref>\n<references responsive=\"\" />",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">responsive</span>=\"\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: enabled, explicit off",
		"wikitext": "Test <ref>1</ref><ref>2</ref>\n<references responsive=\"0\" />",
		"print": "<span class=\"wpb-root\">Test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">responsive</span>=\"<span class=\"wpb-attr-value\">0</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Responsive references: roundtrip templates",
		"wikitext": "test <ref>123</ref>\n\n{{1x|haha<references/>}}",
		"print": "<span class=\"wpb-root\">test <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">123</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">haha<span class=\"wpb-ext\">&lt;references/&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "CircularRef",
		"wikitext": "<ref>Hi {{CircularRef}}</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">Hi </span>\n</li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag defined in <code>&lt;references&gt;</code> has no name attribute.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">Hi <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">CircularRef</span>}}</span></span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T15673: <ref> with direction \"rtl\"",
		"wikitext": "<ref dir=\"rtl\">TEST</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\" class=\"mw-cite-dir-rtl\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">TEST</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">TEST</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T15673: <ref> with direction \"ltr\"",
		"wikitext": "<ref dir=\"ltr\">TEST</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\" class=\"mw-cite-dir-ltr\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">TEST</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">ltr</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">TEST</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T15673: <ref> with direction \"LTR\", keeps upper case",
		"wikitext": "<ref dir=\"LTR\">TEST</ref>\n\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\" class=\"mw-cite-dir-ltr\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">TEST</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">LTR</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">TEST</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T15673: <ref> with direction \"nonsense\" and \"\" (empty), strip invalid dir attribute and shows error",
		"wikitext": "<ref dir=\"nonsense\">NONSENSE_DIR_TEST</ref>\n<ref dir=\"\">EMPTY_DIR_TEST</ref>\n<references />",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>dir=\"nonsense\"</code>, must be <code>ltr</code> or <code>rtl</code></span>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>dir=\"\"</code>, must be <code>ltr</code> or <code>rtl</code></span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">nonsense</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">NONSENSE_DIR_TEST</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"\"</span></span>&gt;<span class=\"wpb-ext-inner\">EMPTY_DIR_TEST</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T15673: Direction is supported when specifying name and group",
		"wikitext": "<ref dir=\"ltr\" name=\"a\" group=\"note\">TEST</ref>\n\n<references group=\"note\" />",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;note 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\" class=\"mw-cite-dir-ltr\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">TEST</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">ltr</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">note</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">TEST</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">note</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Ref with block content in formatting tag",
		"wikitext": "''hi<ref><div>ho</div></ref>''\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>hi<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-html\">&lt;div&gt;</span>ho<span class=\"wpb-html\">&lt;/div&gt;</span></span>&lt;/ref&gt;</span><span class=\"wpb-quote\">''</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T196827: Use the dir parameter only from the full definition of a named ref tag",
		"wikitext": "abc<ref name=\"r1\" />def\n\nghi<ref name=\"r1\" dir=\"rtl\">jkl</ref>mno\n\n<references />",
		"html": "<p>abc<sup id=\"cite_ref-r1_1-0\" class=\"reference\"><a href=\"#cite_note-r1-1\">&#91;1&#93;</a></sup>def\n</p><p>ghi<sup id=\"cite_ref-r1_1-1\" class=\"reference\"><a href=\"#cite_note-r1-1\">&#91;1&#93;</a></sup>mno\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-r1-1\" class=\"mw-cite-dir-rtl\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-r1_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-r1_1-1\">1.1</a></sup></span> <span class=\"reference-text\">jkl</span>\n</li>\n</ol></div>",
		"render": "<p>abcdef\n</p><p>ghimno\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">abc<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">r1</span>\"</span> </span>/&gt;</span>def\n\nghi<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">r1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">jkl</span>&lt;/ref&gt;</span>mno\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T196827: Ignore the dir parameter from the first use, which is not a full definition, and use the dir value from the full definition of a named ref tag",
		"wikitext": "abc<ref name=\"r1\" dir=\"rtl\" />def\n\nghi<ref name=\"r1\">jkl</ref>mno\n\n<references />",
		"html": "<p>abc<sup id=\"cite_ref-r1_1-0\" class=\"reference\"><a href=\"#cite_note-r1-1\">&#91;1&#93;</a></sup>def\n</p><p>ghi<sup id=\"cite_ref-r1_1-1\" class=\"reference\"><a href=\"#cite_note-r1-1\">&#91;1&#93;</a></sup>mno\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-r1-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-r1_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-r1_1-1\">1.1</a></sup></span> <span class=\"reference-text\">jkl</span>\n</li>\n</ol></div>",
		"render": "<p>abcdef\n</p><p>ghimno\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">abc<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">r1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span> </span>/&gt;</span>def\n\nghi<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">r1</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">jkl</span>&lt;/ref&gt;</span>mno\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Similarly named refs with identical bodies",
		"wikitext": "1 <ref name=\"one\">1</ref> 2 <ref name=\"one\">1</ref>\n\n<references />",
		"html": "<p>1 <sup id=\"cite_ref-one_1-0\" class=\"reference\"><a href=\"#cite_note-one-1\">&#91;1&#93;</a></sup> 2 <sup id=\"cite_ref-one_1-1\" class=\"reference\"><a href=\"#cite_note-one-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-one-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-one_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-one_1-1\">1.1</a></sup></span> <span class=\"reference-text\">1</span>\n</li>\n</ol></div>",
		"render": "<p>1  2 \n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">1 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">one</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span> 2 <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">one</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">1</span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T220196 - Reference names with high-bit characters, html5 mode",
		"wikitext": "<ref name=\"f√ºllen\">[bar]</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-f√ºllen_1-0\" class=\"reference\"><a href=\"#cite_note-f√ºllen-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-f√ºllen-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-f√ºllen_1-0\">‚Üë</a></span> <span class=\"reference-text\">[bar]</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">f√ºllen</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[bar]</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T220196 - Reference names with high-bit characters, legacy mode",
		"wikitext": "<ref name=\"f√ºllen\">[bar]</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-f.C3.BCllen_1-0\" class=\"reference\"><a href=\"#cite_note-f.C3.BCllen-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-f.C3.BCllen-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-f.C3.BCllen_1-0\">‚Üë</a></span> <span class=\"reference-text\">[bar]</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">f√ºllen</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">[bar]</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Transclusion parameter spacing is lost without data-parsoid",
		"wikitext": "<ref>{{1x|\nHi ho\n}}</ref>\n\n<!-- Traverse with an encapsulation where the root isn't a native extension -->\n{{1x|<div><references /></div>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\nHi ho\n</span></span>}}</span></span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-comment\">&lt;!-- Traverse with an encapsulation where the root isn't a native extension --&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "T269531: Generic error message when a list-defined reference is not used in the text",
		"wikitext": "<references>\n<ref name=\"foo\">foo</ref>\n</references>",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"foo\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T269531: Special case when a named group is entirely unused in the text",
		"wikitext": "<references group=\"g\">\n<ref name=\"a\" group=\"g\">a</ref>\n</references>",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag with name \"a\" defined in <code>&lt;references&gt;</code> is not used in prior text.</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T242437 - Blank ref name in #tag regression",
		"wikitext": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}",
		"html": "<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag defined in <code>&lt;references&gt;</code> has no name attribute.</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "T48140 - Make sure rollback/redo does not consume numbers",
		"wikitext": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_2-0\" class=\"reference\"><a href=\"#cite_note-a-2\">&#91;g 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_2-0\">‚Üë</a></span> <span class=\"reference-text\">a</span>\n</li>\n</ol></div>\n<p><sup id=\"cite_ref-4\" class=\"reference\"><a href=\"#cite_note-4\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">should be [1]</span>\n</li>\n<li id=\"cite_note-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-4\">‚Üë</a></span> <span class=\"reference-text\">should be [2]</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">should be [1]</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span>\n</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">group=g</span></span>}}</span>\n<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">should be [2]</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Numbers in the default group need to start with 1, independent from other groups",
		"wikitext": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;g 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">a</span>\n</li>\n</ol></div>\n<p><sup id=\"cite_ref-c_3-0\" class=\"reference\"><a href=\"#cite_note-c-3\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-c-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-c_3-0\">‚Üë</a></span> <span class=\"reference-text\">c</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">references</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">a</span>&lt;/ref&gt;</span>\n</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">group=g</span></span>}}</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">c</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Serialize reference tags by themselves on a line",
		"wikitext": "hi <ref>ho</ref>\n<references />\nhi ho",
		"print": "<span class=\"wpb-root\">hi <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">ho</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\nhi ho</span>"
	},
	{
		"desc": "T93580: 1. Templated <ref> inside block images",
		"wikitext": "[[File:Foobar.jpg|thumb|Caption with templated ref: {{1x|<ref>foo</ref>}}]]\n\n<references />",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>Caption with templated ref: <sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup></figcaption></figure>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption with templated ref: </figcaption></figure>\n<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">Caption with templated ref: <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span></span></span>}}</span></span>]]</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T93580: 2. <ref> inside inline images",
		"wikitext": "[[File:Foobar.jpg|Undisplayed caption in inline image with ref: <ref>foo</ref>]]\n\n<references />",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Undisplayed caption in inline image with ref: [1]\"><img alt=\"Undisplayed caption in inline image with ref: [1]\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Undisplayed caption in inline image with ref:\"><img alt=\"Undisplayed caption in inline image with ref:\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">Undisplayed caption in inline image with ref: <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span></span>]]</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T93580: 3. Templated <ref> inside inline images",
		"wikitext": "[[File:Foobar.jpg|Undisplayed caption in inline image with ref: {{1x|<ref>{{1x|foo}}</ref>}}]]\n\n<references />",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Undisplayed caption in inline image with ref: [1]\"><img alt=\"Undisplayed caption in inline image with ref: [1]\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">foo</span>\n</li>\n</ol></div>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Undisplayed caption in inline image with ref:\"><img alt=\"Undisplayed caption in inline image with ref:\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">Undisplayed caption in inline image with ref: <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>&lt;/ref&gt;</span></span></span>}}</span></span>]]</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Report bad attributes in reference tags",
		"wikitext": "<ref>noGroupOrNameValue</ref>\n<references badattrib=\"invalidAttribute\" />\n<ref name=\"theName\">theNameValue</ref>\n<references name=\"theName\" badattrib=\"invalidNameAttribute\" />\n<ref group=\"theGroup\">theGroupValue</ref>\n<references group=\"theGroup\" badattrib=\"invalidGroupAttribute\" />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;references&gt;</code> tag</span>\n<sup id=\"cite_ref-theName_2-0\" class=\"reference\"><a href=\"#cite_note-theName-2\">&#91;2&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;references&gt;</code> tag</span>\n<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;theGroup 1&#93;</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid parameter in <code>&lt;references&gt;</code> tag</span>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">noGroupOrNameValue</span>\n</li>\n<li id=\"cite_note-theName-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-theName_2-0\">‚Üë</a></span> <span class=\"reference-text\">theNameValue</span>\n</li>\n</ol></div><p><br /><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tags exist for a group named \"theGroup\", but no corresponding <code>&lt;references group=\"theGroup\"/&gt;</code> tag was found</span></p>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">noGroupOrNameValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">badattrib</span>=\"<span class=\"wpb-attr-value\">invalidAttribute</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theNameValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">theName</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">badattrib</span>=\"<span class=\"wpb-attr-value\">invalidNameAttribute</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">theGroupValue</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">theGroup</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">badattrib</span>=\"<span class=\"wpb-attr-value\">invalidGroupAttribute</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Check Cite handing of different types of whitespace in reference names",
		"wikitext": "test space<ref name=\"a b\">testSpaceRef</ref>\nblah space<ref name=\"a b\" />\n\ntest underbar<ref name=\"a_b\">testUnderbarRef</ref>\nblah underbar<ref name=\"a_b\" />\n\ntest unicode u2028 whitespace<ref name=\"ab\">testUnicodeWhitespaceRef</ref>\nblah unicode u2028 whitespace<ref name=\"ab\" />\n<references />",
		"html": "<p>test space<sup id=\"cite_ref-a_b_1-0\" class=\"reference\"><a href=\"#cite_note-a_b-1\">&#91;1&#93;</a></sup>\nblah space<sup id=\"cite_ref-a_b_1-1\" class=\"reference\"><a href=\"#cite_note-a_b-1\">&#91;1&#93;</a></sup>\n</p><p>test underbar<sup id=\"cite_ref-a_b_2-0\" class=\"reference\"><a href=\"#cite_note-a_b-2\">&#91;2&#93;</a></sup>\nblah underbar<sup id=\"cite_ref-a_b_2-1\" class=\"reference\"><a href=\"#cite_note-a_b-2\">&#91;2&#93;</a></sup>\n</p><p>test unicode u2028 whitespace<sup id=\"cite_ref-a_b_3-0\" class=\"reference\"><a href=\"#cite_note-a_b-3\">&#91;3&#93;</a></sup>\nblah unicode u2028 whitespace<sup id=\"cite_ref-a_b_3-1\" class=\"reference\"><a href=\"#cite_note-a_b-3\">&#91;3&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a_b-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_b_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_b_1-1\">1.1</a></sup></span> <span class=\"reference-text\">testSpaceRef</span>\n</li>\n<li id=\"cite_note-a_b-2\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_b_2-0\">2.0</a></sup> <sup><a href=\"#cite_ref-a_b_2-1\">2.1</a></sup></span> <span class=\"reference-text\">testUnderbarRef</span>\n</li>\n<li id=\"cite_note-a_b-3\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_b_3-0\">3.0</a></sup> <sup><a href=\"#cite_ref-a_b_3-1\">3.1</a></sup></span> <span class=\"reference-text\">testUnicodeWhitespaceRef</span>\n</li>\n</ol></div>",
		"render": "<p>test space\nblah space\n</p><p>test underbar\nblah underbar\n</p><p>test unicode u2028 whitespace\nblah unicode u2028 whitespace\n</p>",
		"print": "<span class=\"wpb-root\">test space<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">testSpaceRef</span>&lt;/ref&gt;</span>\nblah space<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a b</span>\"</span> </span>/&gt;</span>\n\ntest underbar<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a_b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">testUnderbarRef</span>&lt;/ref&gt;</span>\nblah underbar<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a_b</span>\"</span> </span>/&gt;</span>\n\ntest unicode u2028 whitespace<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">ab</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">testUnicodeWhitespaceRef</span>&lt;/ref&gt;</span>\nblah unicode u2028 whitespace<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">ab</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Check Cite handing of linefeed whitespace in reference names",
		"wikitext": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n<references />",
		"html": "<p>test linefeed<sup id=\"cite_ref-a_b_1-0\" class=\"reference\"><a href=\"#cite_note-a_b-1\">&#91;1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a_b-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_b_1-0\">‚Üë</a></span> <span class=\"reference-text\">testLinefeedRef</span>\n</li>\n</ol></div>",
		"render": "<p>test linefeed\n</p>",
		"print": "<span class=\"wpb-root\">test linefeed<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a\nb</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">testLinefeedRef</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "<ref> in a link should hoist the link outside the link (T301293)",
		"wikitext": "[[Foo|''x<ref>y</ref>z'']]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-quote\">''</span>x<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">y</span>&lt;/ref&gt;</span>z<span class=\"wpb-quote\">''</span></span>]]</span></span>"
	},
	{
		"desc": "Hoisting a reference should not break template continuity",
		"wikitext": "{{1x|hello [[Foo|''x<ref>y</ref>z'']] world}}\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hello <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-quote\">''</span>x<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">y</span>&lt;/ref&gt;</span>z<span class=\"wpb-quote\">''</span></span>]]</span> world</span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Hoisting multiple references should keep references in order",
		"wikitext": "[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">hello <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">note 1</span>&lt;/ref&gt;</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">note 2</span>&lt;/ref&gt;</span></span>]]</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">note 3</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Red links in templated references",
		"wikitext": "<ref>[[Not_existing_article]]</ref>\n\n{{1x|<references />}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Not_existing_article</span>]]</span></span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Broken wikitext making a ref as extended attribute and a duplicated fragment",
		"wikitext": "<i <ref>y</ref>>\n\nz\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;i<span class=\"wpb-html-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">y</span>&lt;/ref&gt;</span></span></span>&gt;</span>\n\nz\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Broken wikitext making a ref as extended attribute and a duplicated fragment (with 2wt tests)",
		"wikitext": "<i title=\"<ref>y</ref>\">a\n\nz\n<references />",
		"html": "<p><i title=\"&lt;sup id=\" class=\"reference\">a\n</i></p><p><i title=\"&lt;sup id=\" class=\"reference\">z\n</i></p><i title=\"&lt;sup id=\" class=\"reference\"><div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">y</span>\n</li>\n</ol></div></i>",
		"render": "<p><i title=\"\">a\n</p><p>z\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;i<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">y</span>&lt;/ref&gt;</span></span>\"</span></span>&gt;</span>a\n\nz\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Templates: Wiki Tables: 7. Fosterable <ref>s should get fostered",
		"wikitext": "{{PartialTable}}<ref>foo</ref>\n|}\n\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">PartialTable</span>}}</span><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/ref&gt;</span>\n|}\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Template nested in extension tag in template",
		"wikitext": "{{1x|hi<ref>[[ho|{{1x|hi}}]]</ref>}}\n{{1x|hi<ref>[http://test.com?q={{1x|ho}}]</ref>}}\n{{1x|hi<ref>-{ho|{{1x|hi}}}-</ref>}}\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">ho</span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span></span>]]</span></span>&lt;/ref&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://test.com?q=</span><span class=\"wpb-ext-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ho</span></span>}}</span></span>]</span></span>&lt;/ref&gt;</span></span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">ho</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span></span></span>}-</span></span>&lt;/ref&gt;</span></span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Headings: Category in ref isn't hoisted",
		"wikitext": "== foo <ref>bar \n[[Category:Baz]] </ref> ==\n\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> foo <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">bar \n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Baz</span>]]</span> </span>&lt;/ref&gt;</span> </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Testing serialization after deletion in references",
		"wikitext": "hi <ref><div id=\"x\">ho</div></ref>\n\n<references />",
		"print": "<span class=\"wpb-root\">hi <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>ho<span class=\"wpb-html\">&lt;/div&gt;</span></span>&lt;/ref&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Catch regression when unpacking with trailing content",
		"wikitext": "{{1x|Foo <references/> bar}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo <span class=\"wpb-ext\">&lt;references/&gt;</span> bar</span></span>}}</span></span>"
	},
	{
		"desc": "1. DOMDiff: Changes to <ref> content should be looked up using id",
		"wikitext": "X <ref><span id=\"X\">foo</span></ref>\nY <ref name=\"a\" />\n<references>\n<ref name=\"a\"><span id=\"Y\">foo</span></ref>\n</references>",
		"print": "<span class=\"wpb-root\">X <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">X</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>&lt;/ref&gt;</span>\nY <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">Y</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "2. DOMDiff: Changes to <ref> content should be looked up using id",
		"wikitext": "A <ref>foo bar for a</ref>\nB <ref group=\"X\" name=\"b\" />\n\n<references />\n\n<references group=\"X\">\n<ref name=\"b\"><span id=\"Z\">foo</span></ref>\n</references>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">foo bar for a</span>&lt;/ref&gt;</span>\nB <span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">X</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>\n\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">X</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">Z</span>\"</span></span>&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span></span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "T107652: <ref>s in templates that also generate table cell attributes should be rendered properly",
		"wikitext": "{|\n|{{table_attribs_7}}\n|}\n<references />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_7</span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "Handle extension content in section headers properly",
		"wikitext": "==c<ref>d</ref>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c<span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">d</span>&lt;/ref&gt;</span></span>==</span></span>"
	},
	{
		"desc": "citeSmokeTests"
	},
	{
		"desc": "Smoke test for duplicated references with the same text",
		"wikitext": "<ref name=\"a\">text</ref>\n<ref name=\"a\">text</ref>\n<ref name=\"b\">other</ref>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">text</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">other</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">other</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Smoke test for duplicated references with conflicting text",
		"wikitext": "<ref name=\"a\">text</ref>\n<ref name=\"a\">bad</ref>\n<ref name=\"b\">other</ref>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">text <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code>&lt;ref&gt;</code> tag; name \"a\" defined multiple times with different content</span></span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">other</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bad</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">other</span>&lt;/ref&gt;</span></span>"
	},
	{
		"desc": "Smoke test for references that are reused *before* defined in <references>",
		"wikitext": "<ref name=\"a\" />\n<ref name=\"a\" />\n<ref name=\"b\">other</ref>\n<references>\n<ref name=\"a\">text</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-a_1-1\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\">‚Üë <sup><a href=\"#cite_ref-a_1-0\">1.0</a></sup> <sup><a href=\"#cite_ref-a_1-1\">1.1</a></sup></span> <span class=\"reference-text\">text</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">other</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">other</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">text</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "It should be impossible to roll back a follow=\"‚Ä¶\", because it can't have a name",
		"wikitext": "<ref name=\"a\" />\n<ref name=\"b\">should be 2</ref>\n<references>\n<ref name=\"a\">should be 1</ref>\n<ref name=\"c\" follow=\"other page\">is invalid</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">should be 1</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">should be 2</span>\n</li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: A <code>&lt;ref follow=\"‚Ä¶\"&gt;</code> tag that is the continuation of a previous one can neither be named individually nor extended</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">should be 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">should be 1</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">c</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">other page</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">is invalid</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "It should be impossible to roll back a follow=\"‚Ä¶\", because it must have a name",
		"wikitext": "<ref name=\"a\" />\n<ref name=\"b\">should be 2</ref>\n<references>\n<ref name=\"a\">should be 1</ref>\n<ref follow=\"other page\">is invalid</ref>\n</references>",
		"html": "<p><sup id=\"cite_ref-a_1-0\" class=\"reference\"><a href=\"#cite_note-a-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-b_2-0\" class=\"reference\"><a href=\"#cite_note-b-2\">&#91;2&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_1-0\">‚Üë</a></span> <span class=\"reference-text\">should be 1</span>\n</li>\n<li id=\"cite_note-b-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-b_2-0\">‚Üë</a></span> <span class=\"reference-text\">should be 2</span>\n</li>\n</ol></div>\n<p><span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code>&lt;ref&gt;</code> tag defined in <code>&lt;references&gt;</code> has no name attribute.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">should be 2</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">should be 1</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">follow</span>=\"<span class=\"wpb-attr-value\">other page</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">is invalid</span>&lt;/ref&gt;</span><span class=\"wpb-noinclude\">\n</span></span>&lt;/references&gt;</span></span>"
	},
	{
		"desc": "comments"
	},
	{
		"desc": "Comments and Indent-Pre",
		"wikitext": "<!-- comment 1 --> asdf\n\n<!-- comment 1 --> asdf\n<!-- comment 2 -->\n\n<!-- comment 1 --> asdf\n<!-- comment 2 -->xyz\n\n<!-- comment 1 --> asdf\n<!-- comment 2 --> xyz",
		"html": "<pre>asdf\n</pre>\n<pre>asdf\n</pre>\n<pre>asdf\n</pre>\n<p>xyz\n</p>\n<pre>asdf\nxyz\n</pre>",
		"render": "<pre>asdf\n</pre>\n<pre>asdf\n</pre>\n<pre>asdf\n</pre>\n<p>xyz\n</p>\n<pre>asdf\nxyz\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span> asdf\n\n<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span> asdf\n<span class=\"wpb-comment\">&lt;!-- comment 2 --&gt;</span>\n\n<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span> asdf\n<span class=\"wpb-comment\">&lt;!-- comment 2 --&gt;</span>xyz\n\n<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span> asdf\n<span class=\"wpb-comment\">&lt;!-- comment 2 --&gt;</span> xyz</span>"
	},
	{
		"desc": "Comment test 2a",
		"wikitext": "asdf\n<!-- comment 1 -->\njkl",
		"html": "<p>asdf\njkl\n</p>",
		"render": "<p>asdf\njkl\n</p>",
		"print": "<span class=\"wpb-root\">asdf\n<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span>\njkl</span>"
	},
	{
		"desc": "Comment test 2b",
		"wikitext": "asdf\n<!-- comment 1 -->\n\njkl",
		"html": "<p>asdf\n</p><p>jkl\n</p>",
		"render": "<p>asdf\n</p><p>jkl\n</p>",
		"print": "<span class=\"wpb-root\">asdf\n<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span>\n\njkl</span>"
	},
	{
		"desc": "Comment test 3",
		"wikitext": "asdf\n<!-- comment 1 -->\n<!-- comment 2 -->\njkl",
		"html": "<p>asdf\njkl\n</p>",
		"render": "<p>asdf\njkl\n</p>",
		"print": "<span class=\"wpb-root\">asdf\n<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span>\n<span class=\"wpb-comment\">&lt;!-- comment 2 --&gt;</span>\njkl</span>"
	},
	{
		"desc": "Comment test 4",
		"wikitext": "asdf<!-- comment 1 -->jkl",
		"html": "<p>asdfjkl\n</p>",
		"render": "<p>asdfjkl\n</p>",
		"print": "<span class=\"wpb-root\">asdf<span class=\"wpb-comment\">&lt;!-- comment 1 --&gt;</span>jkl</span>"
	},
	{
		"desc": "Comment spacing",
		"wikitext": "a\n <!-- foo --> b <!-- bar -->\nc",
		"html": "<p>a\n</p>\n<pre> b \n</pre>\n<p>c\n</p>",
		"render": "<p>a\n</p>\n<pre> b \n</pre>\n<p>c\n</p>",
		"print": "<span class=\"wpb-root\">a\n <span class=\"wpb-comment\">&lt;!-- foo --&gt;</span> b <span class=\"wpb-comment\">&lt;!-- bar --&gt;</span>\nc</span>"
	},
	{
		"desc": "Comment whitespace",
		"wikitext": "<!-- returns a single newline, not nothing, since the newline after > is not stripped -->",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- returns a single newline, not nothing, since the newline after &gt; is not stripped --&gt;</span></span>"
	},
	{
		"desc": "Comment semantics and delimiters",
		"wikitext": "<!-- --><!----><!-----><!------>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- --&gt;</span><span class=\"wpb-comment\">&lt;!----&gt;</span><span class=\"wpb-comment\">&lt;!-----&gt;</span><span class=\"wpb-comment\">&lt;!------&gt;</span></span>"
	},
	{
		"desc": "Comment semantics and delimiters, redux",
		"wikitext": "<!-- In SGML every \"foo\" here would actually show up in the text -- foo -- bar\n-- foo -- funky huh? ... -->",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- In SGML every \"foo\" here would actually show up in the text -- foo -- bar\n-- foo -- funky huh? ... --&gt;</span></span>"
	},
	{
		"desc": "Comment semantics and delimiters: directors cut",
		"wikitext": "<!-- ... However we like to keep things simple and somewhat XML-ish so we eat\neverything starting with < followed by !-- until the first -- and > we see,\nthat wouldn't be valid XML however, since in XML -- has to terminate a comment\n-->-->",
		"html": "<p>--&gt;\n</p>",
		"render": "<p>--&gt;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- ... However we like to keep things simple and somewhat XML-ish so we eat\neverything starting with &lt; followed by !-- until the first -- and &gt; we see,\nthat wouldn't be valid XML however, since in XML -- has to terminate a comment\n--&gt;</span>--&gt;</span>"
	},
	{
		"desc": "Comment semantics: nesting",
		"wikitext": "<!--<!-- no, we're not going to do anything fancy here -->-->",
		"html": "<p>--&gt;\n</p>",
		"render": "<p>--&gt;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--&lt;!-- no, we're not going to do anything fancy here --&gt;</span>--&gt;</span>"
	},
	{
		"desc": "Comment semantics: unclosed comment at end",
		"wikitext": "<!--This comment will run out to the end of the document",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--This comment will run out to the end of the document</span></span>"
	},
	{
		"desc": "Comment semantics: normalize comments to play nice with XML and browsers",
		"wikitext": "<!-- Browsers --!> think this is closed -->\n<!--> This would normally be text -->\n<!---> As would this -->\n<!-- XML doesn't like trailing dashes -------->\n<!-- Nor doubled hyphens -- anywhere in the data -->\nBut this is not a comment.",
		"html": "<p>But this is not a comment.\n</p>",
		"render": "<p>But this is not a comment.\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- Browsers --!&gt; think this is closed --&gt;</span>\n<span class=\"wpb-comment\">&lt;!--&gt; This would normally be text --&gt;</span>\n<span class=\"wpb-comment\">&lt;!---&gt; As would this --&gt;</span>\n<span class=\"wpb-comment\">&lt;!-- XML doesn't like trailing dashes --------&gt;</span>\n<span class=\"wpb-comment\">&lt;!-- Nor doubled hyphens -- anywhere in the data --&gt;</span>\nBut this is not a comment.</span>"
	},
	{
		"desc": "Comment semantics: round-trip even text which contains encoded -->",
		"wikitext": "<!-- hello & goodbye - > --&gt; --&amp;gt; --&xx -->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- hello &amp; goodbye - &gt; --&amp;gt; --&amp;amp;gt; --&amp;xx --&gt;</span></span>"
	},
	{
		"desc": "Comment in template title",
		"wikitext": "{{f<!---->oo}}",
		"html": "<p>FOO\n</p>",
		"render": "<p>FOO\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">f<span class=\"wpb-comment\">&lt;!----&gt;</span>oo</span>}}</span></span>"
	},
	{
		"desc": "Comment on its own line post-expand",
		"wikitext": "a\n{{blank}}<!---->\nb",
		"html": "<p>a\n</p><p>b\n</p>",
		"render": "<p>a\n</p><p>b\n</p>",
		"print": "<span class=\"wpb-root\">a\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">blank</span>}}</span><span class=\"wpb-comment\">&lt;!----&gt;</span>\nb</span>"
	},
	{
		"desc": "Comment on its own line post-expand with non-significant whitespace",
		"wikitext": "a\n {{blank}} <!----> \nb",
		"html": "<p>a\n</p><p>b\n</p>",
		"render": "<p>a\n</p><p>b\n</p>",
		"print": "<span class=\"wpb-root\">a\n <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">blank</span>}}</span> <span class=\"wpb-comment\">&lt;!----&gt;</span> \nb</span>"
	},
	{
		"desc": "Multiple comments should still parse as SOL-transparent",
		"wikitext": "<!--c1-->*a\n<!--c2--><!--c3--><!--c4-->*b",
		"html": "<ul><li>a</li>\n<li>b</li></ul>",
		"render": "<ul><li>a</li>\n<li>b</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--c1--&gt;</span><span class=\"wpb-list\">*</span>a\n<span class=\"wpb-comment\">&lt;!--c2--&gt;</span><span class=\"wpb-comment\">&lt;!--c3--&gt;</span><span class=\"wpb-comment\">&lt;!--c4--&gt;</span><span class=\"wpb-list\">*</span>b</span>"
	},
	{
		"desc": "IE conditional comments",
		"wikitext": "<!--[if lt IE 9]>\n\t<script>alert('hi');</script>\n<![endif]-->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--[if lt IE 9]&gt;\n\t&lt;script&gt;alert('hi');&lt;/script&gt;\n&lt;![endif]--&gt;</span></span>"
	},
	{
		"desc": "Comment with valid json",
		"wikitext": "hi <!--{\"hi\":\"ho\"}--> ho",
		"html": "<p>hi  ho\n</p>",
		"render": "<p>hi  ho\n</p>",
		"print": "<span class=\"wpb-root\">hi <span class=\"wpb-comment\">&lt;!--{\"hi\":\"ho\"}--&gt;</span> ho</span>"
	},
	{
		"desc": "definitionLists"
	},
	{
		"desc": "Simple definition",
		"wikitext": ";name :Definition",
		"html": "<dl><dt>name</dt>\n<dd>Definition</dd></dl>",
		"render": "<dl><dt>name</dt>\n<dd>Definition</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>name <span class=\"wpb-dd\">:</span>Definition</span>"
	},
	{
		"desc": "Definition list for indentation only",
		"wikitext": ":Indented text",
		"html": "<dl><dd>Indented text</dd></dl>",
		"render": "<dl><dd>Indented text</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span>Indented text</span>"
	},
	{
		"desc": "Definition list with no space",
		"wikitext": ";name:Definition",
		"html": "<dl><dt>name</dt>\n<dd>Definition</dd></dl>",
		"render": "<dl><dt>name</dt>\n<dd>Definition</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>name<span class=\"wpb-dd\">:</span>Definition</span>"
	},
	{
		"desc": "Definition list with URL link",
		"wikitext": ";http://example.com/ :definition",
		"html": "<dl><dt><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a></dt>\n<dd>definition</dd></dl>",
		"render": "<dl><dt><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a></dt>\n<dd>definition</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-free-ext-link\">http://example.com/</span> <span class=\"wpb-dd\">:</span>definition</span>"
	},
	{
		"desc": "Definition list with bracketed URL link",
		"wikitext": ";[http://www.example.com/ Example]:Something about it",
		"html": "<dl><dt><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/\">Example</a></dt>\n<dd>Something about it</dd></dl>",
		"render": "<dl><dt><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">Example</a></dt>\n<dd>Something about it</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/</span> <span class=\"wpb-ext-link-text\">Example</span>]</span><span class=\"wpb-dd\">:</span>Something about it</span>"
	},
	{
		"desc": "Definition list with wikilink containing colon",
		"wikitext": ";[[Help:FAQ]]:The least-read page on Wikipedia",
		"html": "<dl><dt><a href=\"/wiki/Help:FAQ\" title=\"Help:FAQ\">Help:FAQ</a></dt>\n<dd>The least-read page on Wikipedia</dd></dl>",
		"render": "<dl><dt><a href=\"/wiki/Help%3AFAQ\" title=\"Help:FAQ\">Help:FAQ</a></dt>\n<dd>The least-read page on Wikipedia</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Help:FAQ</span>]]</span><span class=\"wpb-dd\">:</span>The least-read page on Wikipedia</span>"
	},
	{
		"desc": "Definition list with news link containing colon",
		"wikitext": ";news:alt.wikipedia.rox :This isn't even a real newsgroup!",
		"html": "<dl><dt><a rel=\"nofollow\" class=\"external free\" href=\"news:alt.wikipedia.rox\">news:alt.wikipedia.rox</a></dt>\n<dd>This isn't even a real newsgroup!</dd></dl>",
		"render": "<dl><dt><a rel=\"nofollow\" class=\"external free\" href=\"news:alt.wikipedia.rox\">news:alt.wikipedia.rox</a></dt>\n<dd>This isn't even a real newsgroup!</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-free-ext-link\">news:alt.wikipedia.rox</span> <span class=\"wpb-dd\">:</span>This isn't even a real newsgroup!</span>"
	},
	{
		"desc": "Malformed definition list with colon",
		"wikitext": ";news:alt.wikipedia.rox -- don't crash or enter an infinite loop",
		"html": "<dl><dt><a rel=\"nofollow\" class=\"external free\" href=\"news:alt.wikipedia.rox\">news:alt.wikipedia.rox</a> -- don't crash or enter an infinite loop</dt></dl>",
		"render": "<dl><dt><a rel=\"nofollow\" class=\"external free\" href=\"news:alt.wikipedia.rox\">news:alt.wikipedia.rox</a> -- don't crash or enter an infinite loop</dt></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-free-ext-link\">news:alt.wikipedia.rox</span> -- don't crash or enter an infinite loop</span>"
	},
	{
		"desc": "Definition lists: colon in external link text",
		"wikitext": ";[http://www.wikipedia2.org/ Wikipedia :The Next Generation] :OK, I made that up",
		"html": "<dl><dt><a rel=\"nofollow\" class=\"external text\" href=\"http://www.wikipedia2.org/\">Wikipedia :The Next Generation</a></dt>\n<dd>OK, I made that up</dd></dl>",
		"render": "<dl><dt><a rel=\"nofollow\" class=\"external\" href=\"http://www.wikipedia2.org/\">Wikipedia :The Next Generation</a></dt>\n<dd>OK, I made that up</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.wikipedia2.org/</span> <span class=\"wpb-ext-link-text\">Wikipedia :The Next Generation</span>]</span> <span class=\"wpb-dd\">:</span>OK, I made that up</span>"
	},
	{
		"desc": "Definition lists: colon in HTML attribute",
		"wikitext": ";<b style=\"display: inline\">bold</b>",
		"html": "<dl><dt><b style=\"display: inline\">bold</b></dt></dl>",
		"render": "<dl><dt><b style=\"display: inline\">bold</b></dt></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-html\">&lt;b<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">display: inline</span>\"</span></span>&gt;</span>bold<span class=\"wpb-html\">&lt;/b&gt;</span></span>"
	},
	{
		"desc": "Definition lists: self-closed tag",
		"wikitext": ";one<br/>two :two-line fun",
		"html": "<dl><dt>one<br />two</dt>\n<dd>two-line fun</dd></dl>",
		"render": "<dl><dt>one<br >two</dt>\n<dd>two-line fun</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>one<span class=\"wpb-html\">&lt;br/&gt;</span>two <span class=\"wpb-dd\">:</span>two-line fun</span>"
	},
	{
		"desc": "Definition lists: ignore colons inside tags",
		"wikitext": ";one <b>two : tag <i>fun:</i>:</b>:def",
		"html": "<dl><dt>one <b>two&#160;: tag <i>fun:</i>:</b></dt>\n<dd>def</dd></dl>",
		"render": "<dl><dt>one <b >two : tag <i >fun:</i>:</b></dt>\n<dd>def</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>one <span class=\"wpb-html\">&lt;b&gt;</span>two : tag <span class=\"wpb-html\">&lt;i&gt;</span>fun:<span class=\"wpb-html\">&lt;/i&gt;</span>:<span class=\"wpb-html\">&lt;/b&gt;</span><span class=\"wpb-dd\">:</span>def</span>"
	},
	{
		"desc": "Definition lists: excess closed tags",
		"wikitext": ";one</b>two :bad tag fun",
		"html": "<dl><dt>onetwo</dt>\n<dd>bad tag fun</dd></dl>",
		"render": "<dl><dt>one</b>two</dt>\n<dd>bad tag fun</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>one<span class=\"wpb-html\">&lt;/b&gt;</span>two <span class=\"wpb-dd\">:</span>bad tag fun</span>"
	},
	{
		"desc": "T13748: Literal closing tags",
		"wikitext": "<dl>\n<dt>test 1</dt>\n<dd>test test test test test</dd>\n<dt>test 2</dt>\n<dd>test test test test test</dd>\n</dl>",
		"html": "<dl>\n<dt>test 1</dt>\n<dd>test test test test test</dd>\n<dt>test 2</dt>\n<dd>test test test test test</dd>\n</dl>",
		"render": "<dl >\n<dt >test 1</dt>\n<dd >test test test test test</dd>\n<dt >test 2</dt>\n<dd >test test test test test</dd>\n</dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;dl&gt;</span>\n<span class=\"wpb-html\">&lt;dt&gt;</span>test 1<span class=\"wpb-html\">&lt;/dt&gt;</span>\n<span class=\"wpb-html\">&lt;dd&gt;</span>test test test test test<span class=\"wpb-html\">&lt;/dd&gt;</span>\n<span class=\"wpb-html\">&lt;dt&gt;</span>test 2<span class=\"wpb-html\">&lt;/dt&gt;</span>\n<span class=\"wpb-html\">&lt;dd&gt;</span>test test test test test<span class=\"wpb-html\">&lt;/dd&gt;</span>\n<span class=\"wpb-html\">&lt;/dl&gt;</span></span>"
	},
	{
		"desc": "Definition and unordered list using wiki syntax nested in unordered list using html tags.",
		"wikitext": "<ul><li>\n;term :description\n*unordered\n</li></ul>",
		"html": "<ul><li>\n<dl><dt>term</dt>\n<dd>description</dd></dl>\n<ul><li>unordered</li></ul>\n</li></ul>",
		"render": "<ul ><li >\n<dl><dt>term</dt>\n<dd>description</dd></dl>\n<ul><li>unordered</li></ul>\n</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ul&gt;</span><span class=\"wpb-html\">&lt;li&gt;</span>\n<span class=\"wpb-list\">;</span>term <span class=\"wpb-dd\">:</span>description\n<span class=\"wpb-list\">*</span>unordered\n<span class=\"wpb-html\">&lt;/li&gt;</span><span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "Definition list with empty definition and following paragraph",
		"wikitext": ";term:\n\nParagraph text",
		"html": "<dl><dt>term</dt>\n<dd></dd></dl>\n<p>Paragraph text\n</p>",
		"render": "<dl><dt>term</dt>\n<dd></dd></dl>\n<p>Paragraph text\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>term<span class=\"wpb-dd\">:</span>\n\nParagraph text</span>"
	},
	{
		"desc": "Nested definition lists using html syntax",
		"wikitext": "<dl><dt>x</dt>\n<dd>a</dd>\n<dd>b</dd></dl>",
		"html": "<dl><dt>x</dt>\n<dd>a</dd>\n<dd>b</dd></dl>",
		"render": "<dl ><dt >x</dt>\n<dd >a</dd>\n<dd >b</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;dl&gt;</span><span class=\"wpb-html\">&lt;dt&gt;</span>x<span class=\"wpb-html\">&lt;/dt&gt;</span>\n<span class=\"wpb-html\">&lt;dd&gt;</span>a<span class=\"wpb-html\">&lt;/dd&gt;</span>\n<span class=\"wpb-html\">&lt;dd&gt;</span>b<span class=\"wpb-html\">&lt;/dd&gt;</span><span class=\"wpb-html\">&lt;/dl&gt;</span></span>"
	},
	{
		"desc": "Definition Lists: No nesting: Multiple dd's",
		"wikitext": ";x\n:a\n:b",
		"html": "<dl><dt>x</dt>\n<dd>a</dd>\n<dd>b</dd></dl>",
		"render": "<dl><dt>x</dt>\n<dd>a</dd>\n<dd>b</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>x\n<span class=\"wpb-list\">:</span>a\n<span class=\"wpb-list\">:</span>b</span>"
	},
	{
		"desc": "Definition Lists: Indentation: Regular",
		"wikitext": ":i1\n::i2\n:::i3",
		"html": "<dl><dd>i1\n<dl><dd>i2\n<dl><dd>i3</dd></dl></dd></dl></dd></dl>",
		"render": "<dl><dd>i1\n<dl><dd>i2\n<dl><dd>i3</dd></dl></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span>i1\n<span class=\"wpb-list\">::</span>i2\n<span class=\"wpb-list\">:::</span>i3</span>"
	},
	{
		"desc": "Definition Lists: Indentation: Missing 1st level",
		"wikitext": "::i2\n:::i3",
		"html": "<dl><dd><dl><dd>i2\n<dl><dd>i3</dd></dl></dd></dl></dd></dl>",
		"render": "<dl><dd><dl><dd>i2\n<dl><dd>i3</dd></dl></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">::</span>i2\n<span class=\"wpb-list\">:::</span>i3</span>"
	},
	{
		"desc": "Definition Lists: Indentation: Multi-level indent",
		"wikitext": ":::i3",
		"html": "<dl><dd><dl><dd><dl><dd>i3</dd></dl></dd></dl></dd></dl>",
		"render": "<dl><dd><dl><dd><dl><dd>i3</dd></dl></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:::</span>i3</span>"
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables",
		"wikitext": "::{|\n|foo\n|bar\n|}\nthis text\nshould be left alone",
		"html": "<dl><dd><dl><dd><table>\n<tbody><tr>\n<td>foo\n</td>\n<td>bar\n</td></tr></tbody></table></dd></dl></dd></dl>\n<p>this text\nshould be left alone\n</p>",
		"render": "<dl><dd><dl><dd><table >\n<tbody><tr>\n<td >foo\n</td>\n<td >bar\n</td></tr></tbody></table></dd></dl></dd></dl>\n<p>this text\nshould be left alone\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">::</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\nthis text\nshould be left alone</span>"
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables (with content following table)",
		"wikitext": ":{|\n|foo\n|bar\n|} <!--c1--> this text should be part of the dl",
		"html": "<dl><dd><table>\n<tbody><tr>\n<td>foo\n</td>\n<td>bar\n</td></tr></tbody></table>  this text should be part of the dl</dd></dl>",
		"render": "<dl><dd><table >\n<tbody><tr>\n<td >foo\n</td>\n<td >bar\n</td></tr></tbody></table>  this text should be part of the dl</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span> <span class=\"wpb-comment\">&lt;!--c1--&gt;</span> this text should be part of the dl</span>"
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables, with comments (T65979)",
		"wikitext": "<!-- foo -->\n::{|\n|foo\n|bar\n|}<!-- bar -->\nthis text\nshould be left alone",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- foo --&gt;</span>\n<span class=\"wpb-dd\">::</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span><span class=\"wpb-comment\">&lt;!-- bar --&gt;</span>\nthis text\nshould be left alone</span>"
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables, with comment before table",
		"wikitext": "::<!-- foo -->{|\n|foo\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">::</span><span class=\"wpb-comment\">&lt;!-- foo --&gt;</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Definition Lists: Hack use to indent tables, in a nested list context (T262943)",
		"wikitext": "This is a discussion thread.\n\n:Parent comment.\n::Child comment\n::{|\n|With a\n|Table!\n|}",
		"html": "<p>This is a discussion thread.\n</p>\n<dl><dd>Parent comment.\n<dl><dd>Child comment</dd></dl></dd></dl>\n<dl><dd><dl><dd><table>\n<tbody><tr>\n<td>With a\n</td>\n<td>Table!\n</td></tr></tbody></table></dd></dl></dd></dl>",
		"render": "<p>This is a discussion thread.\n</p>\n<dl><dd>Parent comment.\n<dl><dd>Child comment</dd></dl></dd></dl>\n<dl><dd><dl><dd><table >\n<tbody><tr>\n<td >With a\n</td>\n<td >Table!\n</td></tr></tbody></table></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\">This is a discussion thread.\n\n<span class=\"wpb-list\">:</span>Parent comment.\n<span class=\"wpb-list\">::</span>Child comment\n<span class=\"wpb-dd\">::</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">With a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Table!</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables (WS-insensitive)",
		"wikitext": ":{|\n|a\n|}",
		"html": "<dl><dd><table>\n<tbody><tr>\n<td>a\n</td></tr></tbody></table></dd></dl>",
		"render": "<dl><dd><table >\n<tbody><tr>\n<td >a\n</td></tr></tbody></table></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables (nl-insensitive)",
		"wikitext": ":{|\n\n\n|a\n|}",
		"html": "<dl><dd><table>\n\n\n<tbody><tr>\n<td>a\n</td></tr></tbody></table></dd></dl>",
		"render": "<dl><dd><table >\n<tbody><tr>\n<td >a\n</td></tr></tbody></table></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n\n</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table / list interaction: indented table with lists in table contents",
		"wikitext": ":{|\n|-\n|a\n\n*b\n|-\n|c\n\n*d\n|}",
		"html": "<dl><dd><table>\n\n<tbody><tr>\n<td>a\n<ul><li>b</li></ul>\n</td></tr>\n<tr>\n<td>c\n<ul><li>d</li></ul>\n</td></tr></tbody></table></dd></dl>",
		"render": "<dl><dd><table >\n<tbody><tr >\n<td >a\n<ul><li>b</li></ul>\n</td></tr><tr >\n<td >c\n<ul><li>d</li></ul>\n</td></tr></tbody></table></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a\n\n<span class=\"wpb-list\">*</span>b</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">c\n\n<span class=\"wpb-list\">*</span>d</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table / list interaction: lists nested in tables nested in indented lists",
		"wikitext": ":{|\n|\n:a\n:b\n|\n*c\n*d\n|}\n\n*e\n*f",
		"html": "<dl><dd><table>\n<tbody><tr>\n<td>\n<dl><dd>a</dd>\n<dd>b</dd></dl>\n</td>\n<td>\n<ul><li>c</li>\n<li>d</li></ul>\n</td></tr></tbody></table></dd></dl>\n<ul><li>e</li>\n<li>f</li></ul>",
		"render": "<dl><dd><table >\n<tbody><tr>\n<td >\n<dl><dd>a</dd>\n<dd>b</dd></dl>\n</td>\n<td >\n<ul><li>c</li>\n<li>d</li></ul>\n</td></tr></tbody></table></dd></dl>\n<ul><li>e</li>\n<li>f</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n<span class=\"wpb-list\">:</span>a\n<span class=\"wpb-list\">:</span>b</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n<span class=\"wpb-list\">*</span>c\n<span class=\"wpb-list\">*</span>d</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-list\">*</span>e\n<span class=\"wpb-list\">*</span>f</span>"
	},
	{
		"desc": "Definition Lists: Nesting: Multi-level (Parsoid only)",
		"wikitext": ";t1:d1\n;;t2::d2\n;;;t3:::d3",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>t1<span class=\"wpb-dd\">:</span>d1\n<span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span>t2<span class=\"wpb-dd\">::</span>d2\n<span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span>t3<span class=\"wpb-dd\">::</span>:d3</span>"
	},
	{
		"desc": "Definition Lists: Nesting: Test 2",
		"wikitext": ";t1\n::d2",
		"html": "<dl><dt>t1</dt>\n<dd>\n<dl><dd>d2</dd></dl></dd></dl>",
		"render": "<dl><dt>t1</dt>\n<dd>\n<dl><dd>d2</dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>t1\n<span class=\"wpb-list\">::</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Nesting: Test 3",
		"wikitext": ":;t1\n::::d2",
		"html": "<dl><dd><dl><dt>t1</dt>\n<dd>\n<dl><dd><dl><dd>d2</dd></dl></dd></dl></dd></dl></dd></dl>",
		"render": "<dl><dd><dl><dt>t1</dt>\n<dd>\n<dl><dd><dl><dd>d2</dd></dl></dd></dl></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span><span class=\"wpb-list\">;</span>t1\n<span class=\"wpb-list\">::::</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Nesting: Test 4",
		"wikitext": "::;t3\n:::d3",
		"html": "<dl><dd><dl><dd><dl><dt>t3</dt>\n<dd>d3</dd></dl></dd></dl></dd></dl>",
		"render": "<dl><dd><dl><dd><dl><dt>t3</dt>\n<dd>d3</dd></dl></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">::</span><span class=\"wpb-list\">;</span>t3\n<span class=\"wpb-list\">:::</span>d3</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 1",
		"wikitext": ":;*foo\n::*bar\n:;baz",
		"html": "<dl><dd><dl><dt><ul><li>foo</li>\n<li>bar</li></ul></dt></dl>\n<dl><dt>baz</dt></dl></dd></dl>",
		"render": "<dl><dd><dl><dt><ul><li>foo</li>\n<li>bar</li></ul></dt>\n<dt>baz</dt></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:</span><span class=\"wpb-list\">;*</span>foo\n<span class=\"wpb-list\">::*</span>bar\n<span class=\"wpb-list\">:</span><span class=\"wpb-list\">;</span>baz</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 2",
		"wikitext": "*:d1\n*:d2",
		"html": "<ul><li><dl><dd>d1</dd>\n<dd>d2</dd></dl></li></ul>",
		"render": "<ul><li><dl><dd>d1</dd>\n<dd>d2</dd></dl></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*:</span>d1\n<span class=\"wpb-list\">*:</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 3",
		"wikitext": "*:::d1\n*:::d2",
		"html": "<ul><li><dl><dd><dl><dd><dl><dd>d1</dd>\n<dd>d2</dd></dl></dd></dl></dd></dl></li></ul>",
		"render": "<ul><li><dl><dd><dl><dd><dl><dd>d1</dd>\n<dd>d2</dd></dl></dd></dl></dd></dl></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*:::</span>d1\n<span class=\"wpb-list\">*:::</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 4",
		"wikitext": "*;d1 :d2\n*;d3 :d4",
		"html": "<ul><li><dl><dt>d1</dt>\n<dd>d2</dd>\n<dt>d3</dt>\n<dd>d4</dd></dl></li></ul>",
		"render": "<ul><li><dl><dt>d1</dt>\n<dd>d2</dd></dl></li>\n<li><dl><dt>d3</dt>\n<dd>d4</dd></dl></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-list\">;</span>d1 <span class=\"wpb-dd\">:</span>d2\n<span class=\"wpb-list\">*</span><span class=\"wpb-list\">;</span>d3 <span class=\"wpb-dd\">:</span>d4</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 5",
		"wikitext": "*:d1\n*::d2",
		"html": "<ul><li><dl><dd>d1\n<dl><dd>d2</dd></dl></dd></dl></li></ul>",
		"render": "<ul><li><dl><dd>d1\n<dl><dd>d2</dd></dl></dd></dl></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*:</span>d1\n<span class=\"wpb-list\">*::</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 6",
		"wikitext": "#*:d1\n#*:::d3",
		"html": "<ol><li><ul><li><dl><dd>d1\n<dl><dd><dl><dd>d3</dd></dl></dd></dl></dd></dl></li></ul></li></ol>",
		"render": "<ol><li><ul><li><dl><dd>d1\n<dl><dd><dl><dd>d3</dd></dl></dd></dl></dd></dl></li></ul></li></ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#*:</span>d1\n<span class=\"wpb-list\">#*:::</span>d3</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 7",
		"wikitext": ":*d1\n:*d2",
		"html": "<dl><dd><ul><li>d1</li>\n<li>d2</li></ul></dd></dl>",
		"render": "<dl><dd><ul><li>d1</li>\n<li>d2</li></ul></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:*</span>d1\n<span class=\"wpb-list\">:*</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 8",
		"wikitext": ":*d1\n::*d2",
		"html": "<dl><dd><ul><li>d1</li></ul>\n<dl><dd><ul><li>d2</li></ul></dd></dl></dd></dl>",
		"render": "<dl><dd><ul><li>d1</li></ul>\n<dl><dd><ul><li>d2</li></ul></dd></dl></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">:*</span>d1\n<span class=\"wpb-list\">::*</span>d2</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 9",
		"wikitext": "*;foo :bar",
		"html": "<ul><li><dl><dt>foo</dt>\n<dd>bar</dd></dl></li></ul>",
		"render": "<ul><li><dl><dt>foo</dt>\n<dd>bar</dd></dl></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-list\">;</span>foo <span class=\"wpb-dd\">:</span>bar</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 10",
		"wikitext": "*#;foo :bar",
		"html": "<ul><li><ol><li><dl><dt>foo</dt>\n<dd>bar</dd></dl></li></ol></li></ul>",
		"render": "<ul><li><ol><li><dl><dt>foo</dt>\n<dd>bar</dd></dl></li></ol></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*#</span><span class=\"wpb-list\">;</span>foo <span class=\"wpb-dd\">:</span>bar</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 11",
		"wikitext": ";a\n:*b",
		"html": "<dl><dt>a</dt>\n<dd>\n<ul><li>b</li></ul></dd></dl>",
		"render": "<dl><dt>a</dt>\n<dd>\n<ul><li>b</li></ul></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>a\n<span class=\"wpb-list\">:*</span>b</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 12",
		"wikitext": "*#*#;*;;foo :bar\n*#*#;boo :baz",
		"html": "<ul><li><ol><li><ul><li><ol><li><dl><dt>foo</dt>\n<dd><ul><li><dl><dt><dl><dt>bar</dt></dl></dt></dl></li></ul></dd></dl></li></ol></li></ul>\n<dl><dt>boo</dt>\n<dd>baz</dd></dl></li></ol></li></ul>",
		"render": "<ul><li><ol><li><ul><li><ol><li><dl><dt><ul><li><dl><dt><dl><dt>foo</dt>\n<dd>bar</dd></dl></dt></dl></li></ul></dt></dl></li>\n<li><dl><dt>boo</dt>\n<dd>baz</dd></dl></li></ol></li></ul></li></ol></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*#*#</span><span class=\"wpb-list\">;*</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span>foo <span class=\"wpb-dd\">:</span>bar\n<span class=\"wpb-list\">*#*#</span><span class=\"wpb-list\">;</span>boo <span class=\"wpb-dd\">:</span>baz</span>"
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 13",
		"wikitext": "*#*#;*;;foo : bar\n*#*#;boo : baz",
		"html": "<ul><li><ol><li><ul><li><ol><li><dl><dt>foo</dt>\n<dd><ul><li><dl><dt><dl><dt>bar</dt></dl></dt></dl></li></ul></dd></dl></li></ol></li></ul>\n<dl><dt>boo</dt>\n<dd>baz</dd></dl></li></ol></li></ul>",
		"render": "<ul><li><ol><li><ul><li><ol><li><dl><dt><ul><li><dl><dt><dl><dt>foo</dt>\n<dd>bar</dd></dl></dt></dl></li></ul></dt></dl></li>\n<li><dl><dt>boo</dt>\n<dd>baz</dd></dl></li></ol></li></ul></li></ol></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*#*#</span><span class=\"wpb-list\">;*</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span>foo <span class=\"wpb-dd\">:</span> bar\n<span class=\"wpb-list\">*#*#</span><span class=\"wpb-list\">;</span>boo <span class=\"wpb-dd\">:</span> baz</span>"
	},
	{
		"desc": "Definition Lists: Weird Ones: Test 1",
		"wikitext": "*#;*::;;foo :bar (who uses this?)",
		"html": "<ul><li><ol><li><dl><dt>foo</dt>\n<dd><ul><li><dl><dd><dl><dd><dl><dt><dl><dt>bar (who uses this?)</dt></dl></dt></dl></dd></dl></dd></dl></li></ul></dd></dl></li></ol></li></ul>",
		"render": "<ul><li><ol><li><dl><dt><ul><li><dl><dd><dl><dd><dl><dt><dl><dt>foo</dt>\n<dd>bar (who uses this?)</dd></dl></dt></dl></dd></dl></dd></dl></li></ul></dt></dl></li></ol></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*#</span><span class=\"wpb-list\">;*::</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span>foo <span class=\"wpb-dd\">:</span>bar (who uses this?)</span>"
	},
	{
		"desc": "Definition Lists: colons occurring in tags",
		"wikitext": ";a:b\n;'''a:b'''\n;<i>a:b</i>\n;<span>a:b</span>\n;<div>a:b</div>\n;<div>a\n:b</div>\n;{{1x|a:b}}\n;{{1x|''a:b''}}\n;;;''a:b''",
		"html": "<dl><dt>a</dt>\n<dd>b</dd>\n<dt><b>a:b</b></dt>\n<dt><i>a:b</i></dt>\n<dt><span>a:b</span></dt>\n<dt><div>a:b</div></dt>\n<dt><div>a</div></dt>\n<dd>b</dd>\n<dt>a</dt>\n<dd>b</dd>\n<dt><i>a:b</i></dt></dl>\n<dl><dt><dl><dt><dl><dt><i>a:b</i></dt></dl></dt></dl></dt></dl>",
		"render": "<dl><dt>a</dt>\n<dd>b</dd>\n<dt><b>a:b</b></dt>\n<dt><i >a:b</i></dt>\n<dt><span >a:b</span></dt>\n<dt><div >a:b</div></dt>\n<dt><div >a</dt>\n<dd>b</div></dd>\n<dt>a</dt>\n<dd>b</dd>\n<dt><i>a:b</i>\n<dl><dt><dl><dt><i>a:b</i></dt></dl></dt></dl></dt></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span>a<span class=\"wpb-dd\">:</span>b\n<span class=\"wpb-list\">;</span><span class=\"wpb-quote\">'''</span>a:b<span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-html\">&lt;i&gt;</span>a:b<span class=\"wpb-html\">&lt;/i&gt;</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-html\">&lt;span&gt;</span>a:b<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-html\">&lt;div&gt;</span>a:b<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-html\">&lt;div&gt;</span>a\n<span class=\"wpb-list\">:</span>b<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a:b</span></span>}}</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>a:b<span class=\"wpb-quote\">''</span></span></span>}}</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span><span class=\"wpb-list\">;</span><span class=\"wpb-quote\">''</span>a:b<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Definition Lists: colons and tables 1",
		"wikitext": ":{|\n|x\n|}\n:{|\n|y\n|}",
		"html": "<dl><dd><table>\n<tbody><tr>\n<td>x\n</td></tr></tbody></table></dd></dl>\n<dl><dd><table>\n<tbody><tr>\n<td>y\n</td></tr></tbody></table></dd></dl>",
		"render": "<dl><dd><table >\n<tbody><tr>\n<td >x\n</td></tr></tbody></table></dd></dl>\n<dl><dd><table >\n<tbody><tr>\n<td >y\n</td></tr></tbody></table></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">y</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Definition Lists: template interaction",
		"wikitext": "::{{definition_list}}\n\n:one\n::{{definition_list}}\n:::two\n:::three\n::four",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">::</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">definition_list</span>}}</span>\n\n<span class=\"wpb-list\">:</span>one\n<span class=\"wpb-list\">::</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">definition_list</span>}}</span>\n<span class=\"wpb-list\">:::</span>two\n<span class=\"wpb-list\">:::</span>three\n<span class=\"wpb-list\">::</span>four</span>"
	},
	{
		"desc": "extLinks"
	},
	{
		"desc": "External links: non-bracketed",
		"wikitext": "Non-bracketed: http://example.com",
		"html": "<p>Non-bracketed: <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>\n</p>",
		"render": "<p>Non-bracketed: <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>\n</p>",
		"print": "<span class=\"wpb-root\">Non-bracketed: <span class=\"wpb-free-ext-link\">http://example.com</span></span>"
	},
	{
		"desc": "External links: numbered",
		"wikitext": "Numbered: [http://example.com]\nNumbered: [http://example.net]\nNumbered: [http://example.com]",
		"html": "<p>Numbered: <a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com\">[1]</a>\nNumbered: <a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.net\">[2]</a>\nNumbered: <a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com\">[3]</a>\n</p>",
		"render": "<p>Numbered: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">[1]</a>\nNumbered: <a rel=\"nofollow\" class=\"external\" href=\"http://example.net/\">[2]</a>\nNumbered: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">[3]</a>\n</p>",
		"print": "<span class=\"wpb-root\">Numbered: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span>]</span>\nNumbered: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.net</span>]</span>\nNumbered: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span>]</span></span>"
	},
	{
		"desc": "External links: specified text",
		"wikitext": "Specified text: [http://example.com link]",
		"html": "<p>Specified text: <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">link</a>\n</p>",
		"render": "<p>Specified text: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\">Specified text: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">link</span>]</span></span>"
	},
	{
		"desc": "External links: trail",
		"wikitext": "Linktrails should not work for external links: [http://example.com link]s",
		"html": "<p>Linktrails should not work for external links: <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">link</a>s\n</p>",
		"render": "<p>Linktrails should not work for external links: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">link</a>s\n</p>",
		"print": "<span class=\"wpb-root\">Linktrails should not work for external links: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">link</span>]</span>s</span>"
	},
	{
		"desc": "External links: dollar sign in URL",
		"wikitext": "http://example.com/1$2345",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/1$2345\">http://example.com/1$2345</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/1$2345\">http://example.com/1$2345</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com/1$2345</span></span>"
	},
	{
		"desc": "External links: dollar sign in URL (autonumber)",
		"wikitext": "[http://example.com/1$2345]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com/1$2345\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/1$2345\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/1$2345</span>]</span></span>"
	},
	{
		"desc": "External links: open square bracket forbidden in URL (T6377)",
		"wikitext": "http://example.com/1[2345",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/1\">http://example.com/1</a>[2345\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/1\">http://example.com/1</a>[2345\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com/1</span>[2345</span>"
	},
	{
		"desc": "External links: open square bracket forbidden in URL (named) (T6377)",
		"wikitext": "[http://example.com/1[2345]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/1\">[2345</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/1\">[2345</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/1</span><span class=\"wpb-ext-link-text\">[2345</span>]</span></span>"
	},
	{
		"desc": "External links: open square bracket forbidden in URL (named) (T6377)\nParsoid variant.",
		"wikitext": "[http://example.com/1 [2345]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/1\">[2345</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/1\">[2345</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/1</span> <span class=\"wpb-ext-link-text\">[2345</span>]</span></span>"
	},
	{
		"desc": "External links: nowiki in URL link text (T8230)",
		"wikitext": "[http://example.com/ <nowiki>''example site''</nowiki>]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/\">''example site''</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">''example site''</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''example site''</span>&lt;/nowiki&gt;</span></span>]</span></span>"
	},
	{
		"desc": "External links: newline forbidden in text (T8230 regression check)",
		"wikitext": "[http://example.com/ first\nsecond]",
		"html": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a> first\nsecond]\n</p>",
		"render": "<p>[<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a> first\nsecond]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-free-ext-link\">http://example.com/</span> first\nsecond]</span>"
	},
	{
		"desc": "External links: Pipe char between url and text",
		"wikitext": "[http://example.com | link]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">| link</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">| link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">| link</span>]</span></span>"
	},
	{
		"desc": "External links: protocol-relative URL in brackets",
		"wikitext": "[//example.com/ Test]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"//example.com/\">Test</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://example.com/\">Test</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//example.com/</span> <span class=\"wpb-ext-link-text\">Test</span>]</span></span>"
	},
	{
		"desc": "External links: protocol-relative URL in brackets without text",
		"wikitext": "[//example.com]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"//example.com\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://example.com/\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//example.com</span>]</span></span>"
	},
	{
		"desc": "External links: protocol-relative URL in free text is left alone",
		"wikitext": "//example.com/Foo",
		"html": "<p>//example.com/Foo\n</p>",
		"render": "<p>//example.com/Foo\n</p>",
		"print": "<span class=\"wpb-root\">//example.com/Foo</span>"
	},
	{
		"desc": "External links: protocol-relative URL in the middle of a word is left alone (T32269)",
		"wikitext": "foo//example.com/Foo",
		"html": "<p>foo//example.com/Foo\n</p>",
		"render": "<p>foo//example.com/Foo\n</p>",
		"print": "<span class=\"wpb-root\">foo//example.com/Foo</span>"
	},
	{
		"desc": "External links: with no contents",
		"wikitext": "[http://en.wikipedia.org/wiki/Foo]\n\n[[wikipedia:Foo|Bar]]\n\n[[wikipedia:Foo|<span>Bar</span>]]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://en.wikipedia.org/wiki/Foo\">[1]</a>\n</p><p><a href=\"http://en.wikipedia.org/wiki/Foo\" class=\"extiw\" title=\"wikipedia:Foo\">Bar</a>\n</p><p><a href=\"http://en.wikipedia.org/wiki/Foo\" class=\"extiw\" title=\"wikipedia:Foo\"><span>Bar</span></a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://en.wikipedia.org/wiki/Foo\">[1]</a>\n</p><p><a href=\"/wiki/Project%3AFoo\" title=\"Project:Foo\">Bar</a>\n</p><p><a href=\"/wiki/Project%3AFoo\" title=\"Project:Foo\"><span >Bar</span></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://en.wikipedia.org/wiki/Foo</span>]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">wikipedia:Foo</span>|<span class=\"wpb-link-text\">Bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">wikipedia:Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-html\">&lt;span&gt;</span>Bar<span class=\"wpb-html\">&lt;/span&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "External links: Free with trailing punctuation",
		"wikitext": "http://example.com,\nhttp://example.com;\nhttp://example.com\\\nhttp://example.com.\nhttp://example.com:\nhttp://example.com!\nhttp://example.com?\nhttp://example.com)\nhttp://example.com/url_with_(brackets)\n(http://example.com/url_without_brackets)\nhttp://example.com/url_with_entity&amp;\nhttp://example.com/url_with_entity&#x26;\nhttp://example.com/url_with_entity&#038;\nhttp://example.com/url_with_entity&nbsp;\nhttp://example.com/url_with_entity&#xA0;\nhttp://example.com/url_with_entity&#160;\nhttp://example.com/url_with_entity&lt;\nhttp://example.com/url_with_entity&#x3C;\nhttp://example.com/url_with_entity&#60;",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>,\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>\\\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>.\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>:\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>!\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>?\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>)\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_(brackets)\">http://example.com/url_with_(brackets)</a>\n(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_without_brackets\">http://example.com/url_without_brackets</a>)\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&amp;\">http://example.com/url_with_entity&amp;</a>\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&amp;\">http://example.com/url_with_entity&amp;</a>\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&amp;\">http://example.com/url_with_entity&amp;</a>\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#160;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#xa0;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#160;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&lt;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#x3c;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#60;\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>,\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>\\\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>.\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>:\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>!\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>?\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>)\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_(brackets)\">http://example.com/url_with_(brackets)</a>\n(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_without_brackets\">http://example.com/url_without_brackets</a>)\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&amp;\">http://example.com/url_with_entity&amp;</a>\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&\">http://example.com/url_with_entity&#x26;</a>\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&\">http://example.com/url_with_entity&#038;</a>\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&nbsp;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#xA0;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#160;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&lt;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#x3C;\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity\">http://example.com/url_with_entity</a>&#60;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span>,\n<span class=\"wpb-free-ext-link\">http://example.com</span>;\n<span class=\"wpb-free-ext-link\">http://example.com</span>\\\n<span class=\"wpb-free-ext-link\">http://example.com</span>.\n<span class=\"wpb-free-ext-link\">http://example.com</span>:\n<span class=\"wpb-free-ext-link\">http://example.com</span>!\n<span class=\"wpb-free-ext-link\">http://example.com</span>?\n<span class=\"wpb-free-ext-link\">http://example.com</span>)\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_(brackets)</span>\n(<span class=\"wpb-free-ext-link\">http://example.com/url_without_brackets</span>)\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity&amp;amp;</span>\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity&amp;#x26;</span>\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity&amp;#038;</span>\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity</span>&amp;nbsp;\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity</span>&amp;#xA0;\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity</span>&amp;#160;\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity</span>&amp;lt;\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity</span>&amp;#x3C;\n<span class=\"wpb-free-ext-link\">http://example.com/url_with_entity</span>&amp;#60;</span>"
	},
	{
		"desc": "External links: tricky Parsoid html2html case",
		"wikitext": "http://example.com/url_with_entity&amp;amp;",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&amp;amp\">http://example.com/url_with_entity&amp;amp</a>;\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/url_with_entity&amp;amp\">http://example.com/url_with_entity&amp;amp</a>;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com/url_with_entity&amp;amp;amp</span>;</span>"
	},
	{
		"desc": "External links: html2html with trailing dot (T263203)",
		"wikitext": "test [http://example.com/test. http://example.com/test.] test\n\ntest http://example.com/test. test",
		"html": "<p>test <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/test.\">http://example.com/test.</a> test\n</p><p>test <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/test\">http://example.com/test</a>. test\n</p>",
		"render": "<p>test <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/test.\">http://example.com/test.</a> test\n</p><p>test <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/test\">http://example.com/test</a>. test\n</p>",
		"print": "<span class=\"wpb-root\">test <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/test.</span> <span class=\"wpb-ext-link-text\">http://example.com/test.</span>]</span> test\n\ntest <span class=\"wpb-free-ext-link\">http://example.com/test</span>. test</span>"
	},
	{
		"desc": "External links: Free with trailing quotes (T113666)",
		"wikitext": "'''News:''' Stuff here\n\nnews:'a'b''c''d e",
		"html": "<p><b>News:</b> Stuff here\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"news:&#39;a&#39;b\">news:&#39;a&#39;b</a><i>c</i>d e\n</p>",
		"render": "<p><b>News:</b> Stuff here\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"news:'a'b\">news:'a'b</a><i>c</i>d e\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>News:<span class=\"wpb-quote\">'''</span> Stuff here\n\n<span class=\"wpb-free-ext-link\">news:'a'b</span><span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span>d e</span>"
	},
	{
		"desc": "External links: with entity",
		"wikitext": "[http://&#x20;www.librarieswithoutborders.org Libraries without borders]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://+www.librarieswithoutborders.org\">Libraries without borders</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\">Libraries without borders</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://&amp;#x20;www.librarieswithoutborders.org</span> <span class=\"wpb-ext-link-text\">Libraries without borders</span>]</span></span>"
	},
	{
		"desc": "External links: Lone protocols are never linked (T105697)",
		"wikitext": "http://\nhttp://;\n(http://)\nbitcoin:\nbitcoin:;\n(bitcoin:)",
		"html": "<p>http://\nhttp://;\n(http://)\nbitcoin:\nbitcoin:;\n(bitcoin:)\n</p>",
		"render": "<p>http://\nhttp://;\n(http://)\nbitcoin:\nbitcoin:;\n(bitcoin:)\n</p>",
		"print": "<span class=\"wpb-root\">http://\nhttp://;\n(http://)\nbitcoin:\nbitcoin:;\n(bitcoin:)</span>"
	},
	{
		"desc": "External links: No preceding word characters allowed (T67278)",
		"wikitext": "NOPEhttp://example.com\nN0http://example.com\nok:http://example.com\nok-http://example.com",
		"html": "<p>NOPEhttp://example.com\nN0http://example.com\nok:<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>\nok-<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>\n</p>",
		"render": "<p>NOPEhttp://example.com\nN0http://example.com\nok:<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>\nok-<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>\n</p>",
		"print": "<span class=\"wpb-root\">NOPEhttp://example.com\nN0http://example.com\nok:<span class=\"wpb-free-ext-link\">http://example.com</span>\nok-<span class=\"wpb-free-ext-link\">http://example.com</span></span>"
	},
	{
		"desc": "External links: nofollow domain exception",
		"wikitext": "A [https://no-nofollow.org/foobar link], and another [https://example.org link].",
		"html": "<p>A <a class=\"external text\" href=\"https://no-nofollow.org/foobar\">link</a>, and another <a rel=\"nofollow\" class=\"external text\" href=\"https://example.org\">link</a>.\n</p>",
		"render": "<p>A <a rel=\"nofollow\" class=\"external\" href=\"https://no-nofollow.org/foobar\">link</a>, and another <a rel=\"nofollow\" class=\"external\" href=\"https://example.org/\">link</a>.\n</p>",
		"print": "<span class=\"wpb-root\">A <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://no-nofollow.org/foobar</span> <span class=\"wpb-ext-link-text\">link</span>]</span>, and another <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://example.org</span> <span class=\"wpb-ext-link-text\">link</span>]</span>.</span>"
	},
	{
		"desc": "External image",
		"wikitext": "External image: http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
		"html": "<p>External image: <img src=\"http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png\" alt=\"Ncwikicol.png\" />\n</p>",
		"render": "<p>External image: <a rel=\"nofollow\" class=\"external free\" href=\"http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png\">http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</a>\n</p>",
		"print": "<span class=\"wpb-root\">External image: <span class=\"wpb-free-ext-link\">http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</span></span>"
	},
	{
		"desc": "External image from https",
		"wikitext": "External image from https: https://meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
		"html": "<p>External image from https: <img src=\"https://meta.wikimedia.org/upload/f/f1/Ncwikicol.png\" alt=\"Ncwikicol.png\" />\n</p>",
		"render": "<p>External image from https: <a rel=\"nofollow\" class=\"external free\" href=\"https://meta.wikimedia.org/upload/f/f1/Ncwikicol.png\">https://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</a>\n</p>",
		"print": "<span class=\"wpb-root\">External image from https: <span class=\"wpb-free-ext-link\">https://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</span></span>"
	},
	{
		"desc": "External image (when not allowed)",
		"wikitext": "External image: http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
		"print": "<span class=\"wpb-root\">External image: <span class=\"wpb-free-ext-link\">http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</span></span>"
	},
	{
		"desc": "Link to non-http image, no img tag",
		"wikitext": "Link to non-http image, no img tag: ftp://example.com/test.jpg",
		"html": "<p>Link to non-http image, no img tag: <a rel=\"nofollow\" class=\"external free\" href=\"ftp://example.com/test.jpg\">ftp://example.com/test.jpg</a>\n</p>",
		"render": "<p>Link to non-http image, no img tag: <a rel=\"nofollow\" class=\"external free\" href=\"ftp://example.com/test.jpg\">ftp://example.com/test.jpg</a>\n</p>",
		"print": "<span class=\"wpb-root\">Link to non-http image, no img tag: <span class=\"wpb-free-ext-link\">ftp://example.com/test.jpg</span></span>"
	},
	{
		"desc": "External links: terminating separator",
		"wikitext": "Terminating separator: http://example.com/thing,",
		"html": "<p>Terminating separator: <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/thing\">http://example.com/thing</a>,\n</p>",
		"render": "<p>Terminating separator: <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/thing\">http://example.com/thing</a>,\n</p>",
		"print": "<span class=\"wpb-root\">Terminating separator: <span class=\"wpb-free-ext-link\">http://example.com/thing</span>,</span>"
	},
	{
		"desc": "External links: intervening separator",
		"wikitext": "Intervening separator: http://example.com/1,2,3",
		"html": "<p>Intervening separator: <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/1,2,3\">http://example.com/1,2,3</a>\n</p>",
		"render": "<p>Intervening separator: <a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/1,2,3\">http://example.com/1,2,3</a>\n</p>",
		"print": "<span class=\"wpb-root\">Intervening separator: <span class=\"wpb-free-ext-link\">http://example.com/1,2,3</span></span>"
	},
	{
		"desc": "External links: old bug with URL in query",
		"wikitext": "Old bug with URL in query: [http://example.com/thing?url=http://example.com link]",
		"html": "<p>Old bug with URL in query: <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/thing?url=http://example.com\">link</a>\n</p>",
		"render": "<p>Old bug with URL in query: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/thing?url=http://example.com\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\">Old bug with URL in query: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/thing?url=http://example.com</span> <span class=\"wpb-ext-link-text\">link</span>]</span></span>"
	},
	{
		"desc": "External links: old URL-in-URL bug, mixed protocols",
		"wikitext": "And again with mixed protocols: [ftp://example.com?url=http://example.com link]",
		"html": "<p>And again with mixed protocols: <a rel=\"nofollow\" class=\"external text\" href=\"ftp://example.com?url=http://example.com\">link</a>\n</p>",
		"render": "<p>And again with mixed protocols: <a rel=\"nofollow\" class=\"external\" href=\"ftp://example.com/?url=http://example.com\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\">And again with mixed protocols: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">ftp://example.com?url=http://example.com</span> <span class=\"wpb-ext-link-text\">link</span>]</span></span>"
	},
	{
		"desc": "External links: URL in text",
		"wikitext": "URL in text: [http://example.com http://example.com]",
		"html": "<p>URL in text: <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">http://example.com</a>\n</p>",
		"render": "<p>URL in text: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">http://example.com</a>\n</p>",
		"print": "<span class=\"wpb-root\">URL in text: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">http://example.com</span>]</span></span>"
	},
	{
		"desc": "External links: Clickable images",
		"wikitext": "ja-style clickable images: [http://example.com http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png]",
		"html": "<p>ja-style clickable images: <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\"><img src=\"http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png\" alt=\"Ncwikicol.png\" /></a>\n</p>",
		"render": "<p>ja-style clickable images: <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</a>\n</p>",
		"print": "<span class=\"wpb-root\">ja-style clickable images: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png</span>]</span></span>"
	},
	{
		"desc": "External links: raw ampersand",
		"wikitext": "Old &amp; use: http://x&y",
		"html": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external free\" href=\"http://x&amp;y\">http://x&amp;y</a>\n</p>",
		"render": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external free\" href=\"http://x&y/\">http://x&y</a>\n</p>",
		"print": "<span class=\"wpb-root\">Old &amp;amp; use: <span class=\"wpb-free-ext-link\">http://x&amp;y</span></span>"
	},
	{
		"desc": "External links: encoded ampersand",
		"wikitext": "Old &amp; use: http://x&amp;y",
		"html": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external free\" href=\"http://x&amp;y\">http://x&amp;y</a>\n</p>",
		"render": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external free\" href=\"http://x&amp;y/\">http://x&amp;y</a>\n</p>",
		"print": "<span class=\"wpb-root\">Old &amp;amp; use: <span class=\"wpb-free-ext-link\">http://x&amp;amp;y</span></span>"
	},
	{
		"desc": "External links: encoded equals (T8102)",
		"wikitext": "http://example.com/?foo&#61;bar",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/?foo=bar\">http://example.com/?foo=bar</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/?foo=bar\">http://example.com/?foo&#61;bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com/?foo&amp;#61;bar</span></span>"
	},
	{
		"desc": "External links: [raw ampersand]",
		"wikitext": "Old &amp; use: [http://x&y]",
		"html": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external autonumber\" href=\"http://x&amp;y\">[1]</a>\n</p>",
		"render": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external\" href=\"http://x&y/\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\">Old &amp;amp; use: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://x&amp;y</span>]</span></span>"
	},
	{
		"desc": "External links: [encoded ampersand]",
		"wikitext": "Old &amp; use: [http://x&amp;y]",
		"html": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external autonumber\" href=\"http://x&amp;y\">[1]</a>\n</p>",
		"render": "<p>Old &amp; use: <a rel=\"nofollow\" class=\"external\" href=\"http://x&amp;y/\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\">Old &amp;amp; use: <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://x&amp;amp;y</span>]</span></span>"
	},
	{
		"desc": "External links: [raw equals]",
		"wikitext": "[http://example.com/?foo=bar]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com/?foo=bar\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/?foo=bar\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/?foo=bar</span>]</span></span>"
	},
	{
		"desc": "External links: [encoded equals] (T8102)",
		"wikitext": "[http://example.com/?foo&#61;bar]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com/?foo=bar\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/?foo=bar\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/?foo&amp;#61;bar</span>]</span></span>"
	},
	{
		"desc": "External links: [IDN ignored character reference in hostname; strip it right off]",
		"wikitext": "[http://e&zwnj;xample.com/]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://example.com/\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://e&zwnj;xample.com/\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://e&amp;zwnj;xample.com/</span>]</span></span>"
	},
	{
		"desc": "External links: IDN ignored character reference in hostname; strip it right off",
		"wikitext": "http://e&zwnj;xample.com/",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com/</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://e&zwnj;xample.com/\">http://e&zwnj;xample.com/</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://e&amp;zwnj;xample.com/</span></span>"
	},
	{
		"desc": "External links: www.jpeg.org (T2554)",
		"wikitext": "http://www.jpeg.org",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.jpeg.org\">http://www.jpeg.org</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.jpeg.org/\">http://www.jpeg.org</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.jpeg.org</span></span>"
	},
	{
		"desc": "External links: URL within URL (T2002)",
		"wikitext": "[http://www.unausa.org/newindex.asp?place=http://www.unausa.org/programs/mun.asp]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://www.unausa.org/newindex.asp?place=http://www.unausa.org/programs/mun.asp\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.unausa.org/newindex.asp?place=http://www.unausa.org/programs/mun.asp\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.unausa.org/newindex.asp?place=http://www.unausa.org/programs/mun.asp</span>]</span></span>"
	},
	{
		"desc": "T2361: URL inside bracketed URL",
		"wikitext": "[http://www.example.com/foo http://www.example.com/bar]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/foo\">http://www.example.com/bar</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/foo\">http://www.example.com/bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/foo</span> <span class=\"wpb-ext-link-text\">http://www.example.com/bar</span>]</span></span>"
	},
	{
		"desc": "T2361: URL within URL, not bracketed",
		"wikitext": "http://www.example.com/foo?=http://www.example.com/bar",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/foo?=http://www.example.com/bar\">http://www.example.com/foo?=http://www.example.com/bar</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/foo?=http://www.example.com/bar\">http://www.example.com/foo?=http://www.example.com/bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/foo?=http://www.example.com/bar</span></span>"
	},
	{
		"desc": "T2289: \">\"-token in URL-tail",
		"wikitext": "http://www.example.com/<hello>",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com/</a>&lt;hello&gt;\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com/</a>&lt;hello&gt;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/</span>&lt;hello&gt;</span>"
	},
	{
		"desc": "T2289: literal \">\"-token in URL-tail",
		"wikitext": "http://www.example.com/<b>html</b>",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com/</a><b>html</b>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com/</a><b >html</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/</span><span class=\"wpb-html\">&lt;b&gt;</span>html<span class=\"wpb-html\">&lt;/b&gt;</span></span>"
	},
	{
		"desc": "T2289: \">\"-token in bracketed URL",
		"wikitext": "[http://www.example.com/<hello> stuff]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/\">&lt;hello&gt; stuff</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">&lt;hello&gt; stuff</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/</span><span class=\"wpb-ext-link-text\">&lt;hello&gt; stuff</span>]</span></span>"
	},
	{
		"desc": "T2289: literal \">\"-token in bracketed URL",
		"wikitext": "[http://www.example.com/<b>html</b> stuff]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/\"><b>html</b> stuff</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\"><b >html</b> stuff</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/</span><span class=\"wpb-ext-link-text\"><span class=\"wpb-html\">&lt;b&gt;</span>html<span class=\"wpb-html\">&lt;/b&gt;</span> stuff</span>]</span></span>"
	},
	{
		"desc": "T2289: literal double quote at end of URL",
		"wikitext": "http://www.example.com/\"hello\"",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com/</a>\"hello\"\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/\">http://www.example.com/</a>\"hello\"\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/</span>\"hello\"</span>"
	},
	{
		"desc": "T2289: literal double quote in bracketed URL",
		"wikitext": "[http://www.example.com/\"hello\" stuff]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/\">\"hello\" stuff</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">\"hello\" stuff</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/</span><span class=\"wpb-ext-link-text\">\"hello\" stuff</span>]</span></span>"
	},
	{
		"desc": "External links: multiple legal whitespace is fine, Magnus. Don't break it please. (T7081)",
		"wikitext": "[http://www.example.com  test]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">test</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">test</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span>  <span class=\"wpb-ext-link-text\">test</span>]</span></span>"
	},
	{
		"desc": "External links: link text with spaces",
		"wikitext": "[http://www.example.com a b c]\n[http://www.example.com ''a'' ''b'']",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\">a b c</a>\n<a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com\"><i>a</i> <i>b</i></a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\">a b c</a>\n<a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/\"><i>a</i> <i>b</i></a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\">a b c</span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-quote\">''</span>a<span class=\"wpb-quote\">''</span> <span class=\"wpb-quote\">''</span>b<span class=\"wpb-quote\">''</span></span>]</span></span>"
	},
	{
		"desc": "External links: wiki links within external link (T5695)",
		"wikitext": "[http://example.com [[wikilink]] embedded in ext link]\n\n[http://example.com test [[wikilink]] embedded in ext link]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\"></a><a href=\"/wiki/Wikilink\" title=\"Wikilink\">wikilink</a> embedded in ext link\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">test </a><a href=\"/wiki/Wikilink\" title=\"Wikilink\">wikilink</a> embedded in ext link\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"></a><a href=\"/wiki/Wikilink\" title=\"Wikilink\">wikilink</a> embedded in ext link\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">test </a><a href=\"/wiki/Wikilink\" title=\"Wikilink\">wikilink</a> embedded in ext link\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">wikilink</span>]]</span> embedded in ext link</span>]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">test <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">wikilink</span>]]</span> embedded in ext link</span>]</span></span>"
	},
	{
		"desc": "T2787: Links with one slash after the url protocol are invalid",
		"wikitext": "http:/example.com\n\n[http:/example.com title]",
		"html": "<p>http:/example.com\n</p><p>[http:/example.com title]\n</p>",
		"render": "<p>http:/example.com\n</p><p>[http:/example.com title]\n</p>",
		"print": "<span class=\"wpb-root\">http:/example.com\n\n[http:/example.com title]</span>"
	},
	{
		"desc": "Bracketed external links with template-generated invalid target",
		"wikitext": "[{{1x|http:/example.com}} title]",
		"html": "<p>[http:/example.com title]\n</p>",
		"render": "<p>[http:/example.com title]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">http:/example.com</span></span>}}</span> title]</span>"
	},
	{
		"desc": "T6781: %26 in URL",
		"wikitext": "http://www.example.com/?title=AT%26T",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/?title=AT%26T\">http://www.example.com/?title=AT%26T</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/?title=AT%26T\">http://www.example.com/?title=AT%26T</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/?title=AT%26T</span></span>"
	},
	{
		"desc": "T6781, T7267: %25 in URL",
		"wikitext": "http://www.example.com/?title=100%25_Bran",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/?title=100%25_Bran\">http://www.example.com/?title=100%25_Bran</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/?title=100%25_Bran\">http://www.example.com/?title=100%25_Bran</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/?title=100%25_Bran</span></span>"
	},
	{
		"desc": "T6781, T7267: %28, %29 in URL",
		"wikitext": "http://www.example.com/?title=Ben-Hur_%281959_film%29",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/?title=Ben-Hur_%281959_film%29\">http://www.example.com/?title=Ben-Hur_%281959_film%29</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://www.example.com/?title=Ben-Hur_%281959_film%29\">http://www.example.com/?title=Ben-Hur_%281959_film%29</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://www.example.com/?title=Ben-Hur_%281959_film%29</span></span>"
	},
	{
		"desc": "T6781: %26 in autonumber URL",
		"wikitext": "[http://www.example.com/?title=AT%26T]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://www.example.com/?title=AT%26T\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?title=AT%26T\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?title=AT%26T</span>]</span></span>"
	},
	{
		"desc": "T6781, T7267: %26 in autonumber URL",
		"wikitext": "[http://www.example.com/?title=100%25_Bran]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://www.example.com/?title=100%25_Bran\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?title=100%25_Bran\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?title=100%25_Bran</span>]</span></span>"
	},
	{
		"desc": "T6781, T7267: %28, %29 in autonumber URL",
		"wikitext": "[http://www.example.com/?title=Ben-Hur_%281959_film%29]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"http://www.example.com/?title=Ben-Hur_%281959_film%29\">[1]</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?title=Ben-Hur_%281959_film%29\">[1]</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?title=Ben-Hur_%281959_film%29</span>]</span></span>"
	},
	{
		"desc": "T6781: %26 in bracketed URL",
		"wikitext": "[http://www.example.com/?title=AT%26T link]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/?title=AT%26T\">link</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?title=AT%26T\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?title=AT%26T</span> <span class=\"wpb-ext-link-text\">link</span>]</span></span>"
	},
	{
		"desc": "T6781, T7267: %25 in bracketed URL",
		"wikitext": "[http://www.example.com/?title=100%25_Bran link]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/?title=100%25_Bran\">link</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?title=100%25_Bran\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?title=100%25_Bran</span> <span class=\"wpb-ext-link-text\">link</span>]</span></span>"
	},
	{
		"desc": "T6781, T7267: %28, %29 in bracketed URL",
		"wikitext": "[http://www.example.com/?title=Ben-Hur_%281959_film%29 link]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.example.com/?title=Ben-Hur_%281959_film%29\">link</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.example.com/?title=Ben-Hur_%281959_film%29\">link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.example.com/?title=Ben-Hur_%281959_film%29</span> <span class=\"wpb-ext-link-text\">link</span>]</span></span>"
	},
	{
		"desc": "External link containing a period in the anchor. (T65947)",
		"wikitext": "[//foo.org/bar#baz. bang]\n\n[//foo.org/bar. bang]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"//foo.org/bar#baz.\">bang</a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"//foo.org/bar.\">bang</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://foo.org/bar#baz.\">bang</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"https://foo.org/bar.\">bang</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//foo.org/bar#baz.</span> <span class=\"wpb-ext-link-text\">bang</span>]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//foo.org/bar.</span> <span class=\"wpb-ext-link-text\">bang</span>]</span></span>"
	},
	{
		"desc": "External link containing a single quote. (T65947)",
		"wikitext": "[//foo.org/bar'baz]\n\n[//foo.org/bar'baz bang]",
		"html": "<p><a rel=\"nofollow\" class=\"external autonumber\" href=\"//foo.org/bar&#39;baz\">[1]</a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"//foo.org/bar&#39;baz\">bang</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://foo.org/bar'baz\">[1]</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"https://foo.org/bar'baz\">bang</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//foo.org/bar'baz</span>]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">//foo.org/bar'baz</span> <span class=\"wpb-ext-link-text\">bang</span>]</span></span>"
	},
	{
		"desc": "External link containing double-single-quotes in text '' (T6598 check)",
		"wikitext": "Some [http://example.com/ pretty ''italics'' and stuff]!",
		"html": "<p>Some <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/\">pretty <i>italics</i> and stuff</a>!\n</p>",
		"render": "<p>Some <a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">pretty <i>italics</i> and stuff</a>!\n</p>",
		"print": "<span class=\"wpb-root\">Some <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/</span> <span class=\"wpb-ext-link-text\">pretty <span class=\"wpb-quote\">''</span>italics<span class=\"wpb-quote\">''</span> and stuff</span>]</span>!</span>"
	},
	{
		"desc": "External link containing double-single-quotes in text embedded in italics (T6598 check)",
		"wikitext": "''Some [http://example.com/ pretty ''italics'' and stuff]!''",
		"html": "<p><i>Some <a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/\">pretty </a></i><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/\">italics<i> and stuff</i></a><i>!</i>\n</p>",
		"render": "<p><i>Some </i><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\"><i>pretty </i>italics<i> and stuff</i></a><i>!</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>Some <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/</span> <span class=\"wpb-ext-link-text\">pretty <span class=\"wpb-quote\">''</span>italics<span class=\"wpb-quote\">''</span> and stuff</span>]</span>!<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "External link containing double-single-quotes with no space separating the url from text in italics",
		"wikitext": "[http://www.musee-picasso.fr/pages/page_id18528_u1l2.htm''La muerte de Casagemas'' (1901) en el sitio de [[Museo Picasso (Par√≠s)|Museo Picasso]].]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.musee-picasso.fr/pages/page_id18528_u1l2.htm\"><i>La muerte de Casagemas</i> (1901) en el sitio de </a><a href=\"/wiki/Museo_Picasso_(Par%C3%ADs)\" title=\"Museo Picasso (Par√≠s)\">Museo Picasso</a>.\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.musee-picasso.fr/pages/page_id18528_u1l2.htm\"><i>La muerte de Casagemas</i> (1901) en el sitio de </a><a href=\"/wiki/Museo_Picasso_(Par%C3%ADs)\" title=\"Museo Picasso (Par√≠s)\">Museo Picasso</a>.\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.musee-picasso.fr/pages/page_id18528_u1l2.htm</span><span class=\"wpb-ext-link-text\"><span class=\"wpb-quote\">''</span>La muerte de Casagemas<span class=\"wpb-quote\">''</span> (1901) en el sitio de <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Museo Picasso (Par√≠s)</span>|<span class=\"wpb-link-text\">Museo Picasso</span>]]</span>.</span>]</span></span>"
	},
	{
		"desc": "External link with comments in link text",
		"wikitext": "[http://www.google.com Google <!-- comment -->]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://www.google.com\">Google </a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://www.google.com/\">Google </a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.google.com</span> <span class=\"wpb-ext-link-text\">Google <span class=\"wpb-comment\">&lt;!-- comment --&gt;</span></span>]</span></span>"
	},
	{
		"desc": "External link to bare IPv4 address",
		"wikitext": "[http://192.168.0.1 Link]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://192.168.0.1\">Link</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://192.168.0.1/\">Link</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://192.168.0.1</span> <span class=\"wpb-ext-link-text\">Link</span>]</span></span>"
	},
	{
		"desc": "URL-encoding in URL functions (single parameter)",
		"wikitext": "{{localurl:Some page|amp=&}}",
		"html": "<p>/index.php?title=Some_page&amp;amp=&amp;\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">localurl</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Some page</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">amp=&amp;</span></span>}}</span></span>"
	},
	{
		"desc": "URL-encoding in URL functions (multiple parameters)",
		"wikitext": "{{localurl:Some page|q=?&amp=&}}",
		"html": "<p>/index.php?title=Some_page&amp;q=?&amp;amp=&amp;\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">localurl</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Some page</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">q=?&amp;amp=&amp;</span></span>}}</span></span>"
	},
	{
		"desc": "Brackets in urls",
		"wikitext": "http://example.com/index.php?foozoid%5B%5D=bar\n\nhttp://example.com/index.php?foozoid&#x5B;&#x5D;=bar",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/index.php?foozoid%5B%5D=bar\">http://example.com/index.php?foozoid%5B%5D=bar</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/index.php?foozoid%5B%5D=bar\">http://example.com/index.php?foozoid%5B%5D=bar</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/index.php?foozoid%5B%5D=bar\">http://example.com/index.php?foozoid%5B%5D=bar</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/index.php?foozoid[]=bar\">http://example.com/index.php?foozoid&#x5B;&#x5D;=bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com/index.php?foozoid%5B%5D=bar</span>\n\n<span class=\"wpb-free-ext-link\">http://example.com/index.php?foozoid&amp;#x5B;&amp;#x5D;=bar</span></span>"
	},
	{
		"desc": "IPv6 urls, autolink format (T23261)",
		"wikitext": "http://[2404:130:0:1000::187:2]/index.php\n\nExamples from RFC 2373, section 2.2:\n\n*http://[1080::8:800:200C:417A]/unicast\n*http://[FF01::101]/multicast\n*http://[::1]/loopback\n*http://[::]/unspecified\n*http://[::13.1.68.3]/ipv4compat\n*http://[::FFFF:129.144.52.38]/ipv4compat\n\nExamples from RFC 2732, section 2:\n\n*http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html\n*http://[1080:0:0:0:8:800:200C:417A]/index.html\n*http://[3ffe:2a00:100:7031::1]\n*http://[1080::8:800:200C:417A]/foo\n*http://[::192.9.5.5]/ipng\n*http://[::FFFF:129.144.52.38]:80/index.html\n*http://[2010:836B:4179::836B:4179]",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://[2404:130:0:1000::187:2]/index.php\">http://[2404:130:0:1000::187:2]/index.php</a>\n</p><p>Examples from <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc2373\">RFC 2373</a>, section 2.2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"http://[1080::8:800:200C:417A]/unicast\">http://[1080::8:800:200C:417A]/unicast</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[FF01::101]/multicast\">http://[FF01::101]/multicast</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::1]/loopback\">http://[::1]/loopback</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::]/unspecified\">http://[::]/unspecified</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::13.1.68.3]/ipv4compat\">http://[::13.1.68.3]/ipv4compat</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::FFFF:129.144.52.38]/ipv4compat\">http://[::FFFF:129.144.52.38]/ipv4compat</a></li></ul>\n<p>Examples from <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc2732\">RFC 2732</a>, section 2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html\">http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[1080:0:0:0:8:800:200C:417A]/index.html\">http://[1080:0:0:0:8:800:200C:417A]/index.html</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[3ffe:2a00:100:7031::1]\">http://[3ffe:2a00:100:7031::1]</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[1080::8:800:200C:417A]/foo\">http://[1080::8:800:200C:417A]/foo</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::192.9.5.5]/ipng\">http://[::192.9.5.5]/ipng</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::FFFF:129.144.52.38]:80/index.html\">http://[::FFFF:129.144.52.38]:80/index.html</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[2010:836B:4179::836B:4179]\">http://[2010:836B:4179::836B:4179]</a></li></ul>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://[2404:130:0:1000::187:2]/index.php\">http://[2404:130:0:1000::187:2]/index.php</a>\n</p><p>Examples from <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc2373\">RFC 2373</a>, section 2.2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"http://[1080::8:800:200c:417a]/unicast\">http://[1080::8:800:200C:417A]/unicast</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[ff01::101]/multicast\">http://[FF01::101]/multicast</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::1]/loopback\">http://[::1]/loopback</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::]/unspecified\">http://[::]/unspecified</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::d01:4403]/ipv4compat\">http://[::13.1.68.3]/ipv4compat</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::ffff:8190:3426]/ipv4compat\">http://[::FFFF:129.144.52.38]/ipv4compat</a></li></ul>\n<p>Examples from <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc2732\">RFC 2732</a>, section 2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external free\" href=\"http://[fedc:ba98:7654:3210:fedc:ba98:7654:3210]/index.html\">http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[1080::8:800:200c:417a]/index.html\">http://[1080:0:0:0:8:800:200C:417A]/index.html</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[3ffe:2a00:100:7031::1]/\">http://[3ffe:2a00:100:7031::1]</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[1080::8:800:200c:417a]/foo\">http://[1080::8:800:200C:417A]/foo</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::c009:505]/ipng\">http://[::192.9.5.5]/ipng</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[::ffff:8190:3426]/index.html\">http://[::FFFF:129.144.52.38]:80/index.html</a></li>\n<li><a rel=\"nofollow\" class=\"external free\" href=\"http://[2010:836b:4179::836b:4179]/\">http://[2010:836B:4179::836B:4179]</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://[2404:130:0:1000::187:2]/index.php</span>\n\nExamples from <span class=\"wpb-magic-link\">RFC 2373</span>, section 2.2:\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[1080::8:800:200C:417A]/unicast</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[FF01::101]/multicast</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[::1]/loopback</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[::]/unspecified</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[::13.1.68.3]/ipv4compat</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[::FFFF:129.144.52.38]/ipv4compat</span>\n\nExamples from <span class=\"wpb-magic-link\">RFC 2732</span>, section 2:\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[1080:0:0:0:8:800:200C:417A]/index.html</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[3ffe:2a00:100:7031::1]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[1080::8:800:200C:417A]/foo</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[::192.9.5.5]/ipng</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[::FFFF:129.144.52.38]:80/index.html</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-free-ext-link\">http://[2010:836B:4179::836B:4179]</span></span>"
	},
	{
		"desc": "Unicode text around autolinks",
		"wikitext": "gr√∂√ühttps://foo.org\n\ngr√∂√ü https://foo.org\n\nÏïÑÎì§ Í≥†Í±¥ ÏÇ¨ÏßÑhttps://foo.org\n\nüí©https://foo.org",
		"html": "<p>gr√∂√ühttps://foo.org\n</p><p>gr√∂√ü <a rel=\"nofollow\" class=\"external free\" href=\"https://foo.org\">https://foo.org</a>\n</p><p>ÏïÑÎì§ Í≥†Í±¥ ÏÇ¨ÏßÑhttps://foo.org\n</p><p>üí©<a rel=\"nofollow\" class=\"external free\" href=\"https://foo.org\">https://foo.org</a>\n</p>",
		"render": "<p>gr√∂√ühttps://foo.org\n</p><p>gr√∂√ü <a rel=\"nofollow\" class=\"external free\" href=\"https://foo.org/\">https://foo.org</a>\n</p><p>ÏïÑÎì§ Í≥†Í±¥ ÏÇ¨ÏßÑhttps://foo.org\n</p><p>üí©<a rel=\"nofollow\" class=\"external free\" href=\"https://foo.org/\">https://foo.org</a>\n</p>",
		"print": "<span class=\"wpb-root\">gr√∂√ühttps://foo.org\n\ngr√∂√ü <span class=\"wpb-free-ext-link\">https://foo.org</span>\n\nÏïÑÎì§ Í≥†Í±¥ ÏÇ¨ÏßÑhttps://foo.org\n\nüí©<span class=\"wpb-free-ext-link\">https://foo.org</span></span>"
	},
	{
		"desc": "IPv6 urls, bracketed format (T23261)",
		"wikitext": "[http://[2404:130:0:1000::187:2]/index.php test]\n\nExamples from RFC 2373, section 2.2:\n\n*[http://[1080::8:800:200C:417A] unicast]\n*[http://[FF01::101] multicast]\n*[http://[::1]/ loopback]\n*[http://[::] unspecified]\n*[http://[::13.1.68.3] ipv4compat]\n*[http://[::FFFF:129.144.52.38] ipv4compat]\n\nExamples from RFC 2732, section 2:\n\n*[http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html 1]\n*[http://[1080:0:0:0:8:800:200C:417A]/index.html 2]\n*[http://[3ffe:2a00:100:7031::1] 3]\n*[http://[1080::8:800:200C:417A]/foo 4]\n*[http://[::192.9.5.5]/ipng 5]\n*[http://[::FFFF:129.144.52.38]:80/index.html 6]\n*[http://[2010:836B:4179::836B:4179] 7]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"http://[2404:130:0:1000::187:2]/index.php\">test</a>\n</p><p>Examples from <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc2373\">RFC 2373</a>, section 2.2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external text\" href=\"http://[1080::8:800:200C:417A]\">unicast</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[FF01::101]\">multicast</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[::1]/\">loopback</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[::]\">unspecified</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[::13.1.68.3]\">ipv4compat</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[::FFFF:129.144.52.38]\">ipv4compat</a></li></ul>\n<p>Examples from <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc2732\">RFC 2732</a>, section 2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external text\" href=\"http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html\">1</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[1080:0:0:0:8:800:200C:417A]/index.html\">2</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[3ffe:2a00:100:7031::1]\">3</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[1080::8:800:200C:417A]/foo\">4</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[::192.9.5.5]/ipng\">5</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[::FFFF:129.144.52.38]:80/index.html\">6</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://[2010:836B:4179::836B:4179]\">7</a></li></ul>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"http://[2404:130:0:1000::187:2]/index.php\">test</a>\n</p><p>Examples from <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc2373\">RFC 2373</a>, section 2.2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external\" href=\"http://[1080::8:800:200c:417a]/\">unicast</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[ff01::101]/\">multicast</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[::1]/\">loopback</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[::]/\">unspecified</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[::d01:4403]/\">ipv4compat</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[::ffff:8190:3426]/\">ipv4compat</a></li></ul>\n<p>Examples from <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc2732\">RFC 2732</a>, section 2:\n</p>\n<ul><li><a rel=\"nofollow\" class=\"external\" href=\"http://[fedc:ba98:7654:3210:fedc:ba98:7654:3210]/index.html\">1</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[1080::8:800:200c:417a]/index.html\">2</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[3ffe:2a00:100:7031::1]/\">3</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[1080::8:800:200c:417a]/foo\">4</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[::c009:505]/ipng\">5</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[::ffff:8190:3426]/index.html\">6</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://[2010:836b:4179::836b:4179]/\">7</a></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[2404:130:0:1000::187:2]/index.php</span> <span class=\"wpb-ext-link-text\">test</span>]</span>\n\nExamples from <span class=\"wpb-magic-link\">RFC 2373</span>, section 2.2:\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[1080::8:800:200C:417A]</span> <span class=\"wpb-ext-link-text\">unicast</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[FF01::101]</span> <span class=\"wpb-ext-link-text\">multicast</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[::1]/</span> <span class=\"wpb-ext-link-text\">loopback</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[::]</span> <span class=\"wpb-ext-link-text\">unspecified</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[::13.1.68.3]</span> <span class=\"wpb-ext-link-text\">ipv4compat</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[::FFFF:129.144.52.38]</span> <span class=\"wpb-ext-link-text\">ipv4compat</span>]</span>\n\nExamples from <span class=\"wpb-magic-link\">RFC 2732</span>, section 2:\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html</span> <span class=\"wpb-ext-link-text\">1</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[1080:0:0:0:8:800:200C:417A]/index.html</span> <span class=\"wpb-ext-link-text\">2</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[3ffe:2a00:100:7031::1]</span> <span class=\"wpb-ext-link-text\">3</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[1080::8:800:200C:417A]/foo</span> <span class=\"wpb-ext-link-text\">4</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[::192.9.5.5]/ipng</span> <span class=\"wpb-ext-link-text\">5</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[::FFFF:129.144.52.38]:80/index.html</span> <span class=\"wpb-ext-link-text\">6</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://[2010:836B:4179::836B:4179]</span> <span class=\"wpb-ext-link-text\">7</span>]</span></span>"
	},
	{
		"desc": "Non-extlinks in brackets",
		"wikitext": "[foo]\n[foo bar]\n[foo ''bar'']\n[fool's] errand\n[fool's errand]\n[{{1x|foo}}]\n[{{1x|foo}} bar]\n[{{1x|foo}} ''bar'']\n[{{1x|foo}}l's] errand\n[{{1x|foo}}l's errand]\n[url={{1x|foo}}]\n[url=http://example.com]\n[http:// bare protocols don't count]",
		"html": "<p>[foo]\n[foo bar]\n[foo <i>bar</i>]\n[fool's] errand\n[fool's errand]\n[foo]\n[foo bar]\n[foo <i>bar</i>]\n[fool's] errand\n[fool's errand]\n[url=foo]\n[url=<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>]\n[http:// bare protocols don't count]\n</p>",
		"render": "<p>[foo]\n[foo bar]\n[foo <i>bar</i>]\n[fool's] errand\n[fool's errand]\n[foo]\n[foo bar]\n[foo <i>bar</i>]\n[fool's] errand\n[fool's errand]\n[url=foo]\n[url=<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>]\n[http:// bare protocols don't count]\n</p>",
		"print": "<span class=\"wpb-root\">[foo]\n[foo bar]\n[foo <span class=\"wpb-quote\">''</span>bar<span class=\"wpb-quote\">''</span>]\n[fool's] errand\n[fool's errand]\n[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>]\n[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span> bar]\n[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span> <span class=\"wpb-quote\">''</span>bar<span class=\"wpb-quote\">''</span>]\n[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>l's] errand\n[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>l's errand]\n[url=<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>]\n[url=<span class=\"wpb-free-ext-link\">http://example.com</span>]\n[http:// bare protocols don't count]</span>"
	},
	{
		"desc": "Percent encoding in external links",
		"wikitext": "[https://github.com/search?l=&q=ResourceLoader+%40wikimedia Search]",
		"html": "<p><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/search?l=&amp;q=ResourceLoader+%40wikimedia\">Search</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://github.com/search?l=&q=ResourceLoader+%40wikimedia\">Search</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://github.com/search?l=&amp;q=ResourceLoader+%40wikimedia</span> <span class=\"wpb-ext-link-text\">Search</span>]</span></span>"
	},
	{
		"desc": "Use url link syntax for links where the content is equal the link target",
		"wikitext": "http://example.com",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span></span>"
	},
	{
		"desc": "Parenthesis in external links, especially URL links",
		"wikitext": "http://example.com)\n\nhttp://example.com/test)\n\nhttp://example.com/(test)\n\nhttp://example.com/((test)\n\n(http://example.com/(test))\n\n(http://example.com/(test)))))\n\nhttp://example.com/a)b\n\n[http://example.com) foo]",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>)\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/test\">http://example.com/test</a>)\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/(test)\">http://example.com/(test)</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/((test)\">http://example.com/((test)</a>\n</p><p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/(test))\">http://example.com/(test))</a>\n</p><p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/(test)))))\">http://example.com/(test)))))</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/a)b\">http://example.com/a)b</a>\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com)\">foo</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>)\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/test\">http://example.com/test</a>)\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/(test)\">http://example.com/(test)</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/((test)\">http://example.com/((test)</a>\n</p><p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/(test))\">http://example.com/(test))</a>\n</p><p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/(test)))))\">http://example.com/(test)))))</a>\n</p><p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/a)b\">http://example.com/a)b</a>\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"http://example.com)/\">foo</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span>)\n\n<span class=\"wpb-free-ext-link\">http://example.com/test</span>)\n\n<span class=\"wpb-free-ext-link\">http://example.com/(test)</span>\n\n<span class=\"wpb-free-ext-link\">http://example.com/((test)</span>\n\n(<span class=\"wpb-free-ext-link\">http://example.com/(test))</span>\n\n(<span class=\"wpb-free-ext-link\">http://example.com/(test)))))</span>\n\n<span class=\"wpb-free-ext-link\">http://example.com/a)b</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com)</span> <span class=\"wpb-ext-link-text\">foo</span>]</span></span>"
	},
	{
		"desc": "Parenthesis in external links, w/ transclusion or comment",
		"wikitext": "(http://example.com/{{1x|hi}})\n\n(http://example.com<!-- hi -->)",
		"html": "<p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/hi\">http://example.com/hi</a>)\n</p><p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a>)\n</p>",
		"render": "<p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/hi\">http://example.com/hi</a>)\n</p><p>(<a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a>)\n</p>",
		"print": "<span class=\"wpb-root\">(<span class=\"wpb-free-ext-link\">http://example.com/</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span>)\n\n(<span class=\"wpb-free-ext-link\">http://example.com<span class=\"wpb-comment\">&lt;!-- hi --&gt;</span></span>)</span>"
	},
	{
		"desc": "mw:ExtLink linking to a interwiki URL can be round-tripped losslessly (T94723)",
		"wikitext": "[http://en.wikipedia.org/wiki/European_Robin European Robin]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://en.wikipedia.org/wiki/European_Robin</span> <span class=\"wpb-ext-link-text\">European Robin</span>]</span></span>"
	},
	{
		"desc": "Parsoid extlink with _blank target",
		"wikitext": "[https://www.example.com]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://www.example.com</span>]</span></span>"
	},
	{
		"desc": "Parsoid extlink with _self target",
		"wikitext": "[https://www.example.com]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://www.example.com</span>]</span></span>"
	},
	{
		"desc": "Extlink in square brackets with entity",
		"wikitext": "[&nbsp;[http://test.com 123]&nbsp;]\n\n[http://test.com [123]",
		"html": "<p>[&#160;<a rel=\"nofollow\" class=\"external text\" href=\"http://test.com\">123</a>&#160;]\n</p><p><a rel=\"nofollow\" class=\"external text\" href=\"http://test.com\">[123</a>\n</p>",
		"render": "<p>[&nbsp;<a rel=\"nofollow\" class=\"external\" href=\"http://test.com/\">123</a>&nbsp;]\n</p><p><a rel=\"nofollow\" class=\"external\" href=\"http://test.com/\">[123</a>\n</p>",
		"print": "<span class=\"wpb-root\">[&amp;nbsp;<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://test.com</span> <span class=\"wpb-ext-link-text\">123</span>]</span>&amp;nbsp;]\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://test.com</span> <span class=\"wpb-ext-link-text\">[123</span>]</span></span>"
	},
	{
		"desc": "fragmentModes"
	},
	{
		"desc": "Legacy fragment encoding",
		"wikitext": "<ref name=\"nature%20phylo\">A</ref>\n<ref name=\"Mininova%2E26%2E11%2E2009\">B</ref>\n<ref name=\"%c8%98tiri_2019\">C</ref>\n<ref name=\"play%21\">D</ref>\n<ref name=\"Terry+O%26rsquo%3BN‚Ä¶</ref\">E</ref>\n<ref name=\"9&nbsp;pm\">F</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-nature.2520phylo_1-0\" class=\"reference\"><a href=\"#cite_note-nature.2520phylo-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-Mininova.252E26.252E11.252E2009_2-0\" class=\"reference\"><a href=\"#cite_note-Mininova.252E26.252E11.252E2009-2\">&#91;2&#93;</a></sup>\n<sup id=\"cite_ref-.25c8.2598tiri_2019_3-0\" class=\"reference\"><a href=\"#cite_note-.25c8.2598tiri_2019-3\">&#91;3&#93;</a></sup>\n<sup id=\"cite_ref-play.2521_4-0\" class=\"reference\"><a href=\"#cite_note-play.2521-4\">&#91;4&#93;</a></sup>\n<sup id=\"cite_ref-Terry.2BO.2526rsquo.253BN.E2.80.A6.3C.2Fref_5-0\" class=\"reference\"><a href=\"#cite_note-Terry.2BO.2526rsquo.253BN.E2.80.A6.3C.2Fref-5\">&#91;5&#93;</a></sup>\n<sup id=\"cite_ref-9_pm_6-0\" class=\"reference\"><a href=\"#cite_note-9_pm-6\">&#91;6&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-nature.2520phylo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-nature.2520phylo_1-0\">‚Üë</a></span> <span class=\"reference-text\">A</span>\n</li>\n<li id=\"cite_note-Mininova.252E26.252E11.252E2009-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-Mininova.252E26.252E11.252E2009_2-0\">‚Üë</a></span> <span class=\"reference-text\">B</span>\n</li>\n<li id=\"cite_note-.25c8.2598tiri_2019-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-.25c8.2598tiri_2019_3-0\">‚Üë</a></span> <span class=\"reference-text\">C</span>\n</li>\n<li id=\"cite_note-play.2521-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-play.2521_4-0\">‚Üë</a></span> <span class=\"reference-text\">D</span>\n</li>\n<li id=\"cite_note-Terry.2BO.2526rsquo.253BN.E2.80.A6.3C.2Fref-5\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-Terry.2BO.2526rsquo.253BN.E2.80.A6.3C.2Fref_5-0\">‚Üë</a></span> <span class=\"reference-text\">E</span>\n</li>\n<li id=\"cite_note-9_pm-6\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-9_pm_6-0\">‚Üë</a></span> <span class=\"reference-text\">F</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">nature%20phylo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">A</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">Mininova%2E26%2E11%2E2009</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">B</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">%c8%98tiri_2019</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">C</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">play%21</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">D</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">Terry+O%26rsquo%3BN‚Ä¶&lt;/ref</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">E</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">9&amp;nbsp;pm</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">F</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "T298278: Collection of test cases in HTML5 mode",
		"wikitext": "<ref name=\"nature%20phylo\">A</ref>\n<ref name=\"Mininova%2E26%2E11%2E2009\">B</ref>\n<ref name=\"%c8%98tiri_2019\">C</ref>\n<ref name=\"play%21\">D</ref>\n<ref name=\"Terry+O%26rsquo%3BN‚Ä¶</ref\">E</ref>\n<ref name=\"9&nbsp;pm\">F</ref>\n<references />",
		"html": "<p><sup id=\"cite_ref-nature%20phylo_1-0\" class=\"reference\"><a href=\"#cite_note-nature%2520phylo-1\">&#91;1&#93;</a></sup>\n<sup id=\"cite_ref-Mininova%2E26%2E11%2E2009_2-0\" class=\"reference\"><a href=\"#cite_note-Mininova%252E26%252E11%252E2009-2\">&#91;2&#93;</a></sup>\n<sup id=\"cite_ref-%c8%98tiri_2019_3-0\" class=\"reference\"><a href=\"#cite_note-%25c8%2598tiri_2019-3\">&#91;3&#93;</a></sup>\n<sup id=\"cite_ref-play%21_4-0\" class=\"reference\"><a href=\"#cite_note-play%2521-4\">&#91;4&#93;</a></sup>\n<sup id=\"cite_ref-Terry+O%26rsquo%3BN‚Ä¶&lt;/ref_5-0\" class=\"reference\"><a href=\"#cite_note-Terry+O%2526rsquo%253BN‚Ä¶&lt;/ref-5\">&#91;5&#93;</a></sup>\n<sup id=\"cite_ref-9_pm_6-0\" class=\"reference\"><a href=\"#cite_note-9_pm-6\">&#91;6&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-nature%20phylo-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-nature%2520phylo_1-0\">‚Üë</a></span> <span class=\"reference-text\">A</span>\n</li>\n<li id=\"cite_note-Mininova%2E26%2E11%2E2009-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-Mininova%252E26%252E11%252E2009_2-0\">‚Üë</a></span> <span class=\"reference-text\">B</span>\n</li>\n<li id=\"cite_note-%c8%98tiri_2019-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-%25c8%2598tiri_2019_3-0\">‚Üë</a></span> <span class=\"reference-text\">C</span>\n</li>\n<li id=\"cite_note-play%21-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-play%2521_4-0\">‚Üë</a></span> <span class=\"reference-text\">D</span>\n</li>\n<li id=\"cite_note-Terry+O%26rsquo%3BN‚Ä¶&lt;/ref-5\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-Terry+O%2526rsquo%253BN‚Ä¶&lt;/ref_5-0\">‚Üë</a></span> <span class=\"reference-text\">E</span>\n</li>\n<li id=\"cite_note-9_pm-6\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-9_pm_6-0\">‚Üë</a></span> <span class=\"reference-text\">F</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">nature%20phylo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">A</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">Mininova%2E26%2E11%2E2009</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">B</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">%c8%98tiri_2019</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">C</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">play%21</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">D</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">Terry+O%26rsquo%3BN‚Ä¶&lt;/ref</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">E</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">9&amp;nbsp;pm</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">F</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "URL encoded strings accidentally copy-pasted in legacy mode",
		"wikitext": "<ref name=\"n%25%32%30n\" group=\"g%25%32%30g\">A</ref>\n<references group=\"g%25%32%30g\" />",
		"html": "<p><sup id=\"cite_ref-n.2525.2532.2530n_1-0\" class=\"reference\"><a href=\"#cite_note-n.2525.2532.2530n-1\">&#91;g%25%32%30g 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-n.2525.2532.2530n-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-n.2525.2532.2530n_1-0\">‚Üë</a></span> <span class=\"reference-text\">A</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">n%25%32%30n</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g%25%32%30g</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">A</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g%25%32%30g</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "T298278: URL encoded strings accidentally copy-pasted in HTML5 mode",
		"wikitext": "<ref name=\"n%25%32%30n\" group=\"g%25%32%30g\">A</ref>\n<references group=\"g%25%32%30g\" />",
		"html": "<p><sup id=\"cite_ref-n%25%32%30n_1-0\" class=\"reference\"><a href=\"#cite_note-n%2525%2532%2530n-1\">&#91;g%25%32%30g 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-n%25%32%30n-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-n%2525%2532%2530n_1-0\">‚Üë</a></span> <span class=\"reference-text\">A</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">n%25%32%30n</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g%25%32%30g</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">A</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">g%25%32%30g</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple, partly encoded spaces in legacy mode",
		"wikitext": "<ref name=\"a_ %20a\" group=\"b_ %20b\">A</ref>\n<references group=\"b_ %20b\" />",
		"html": "<p><sup id=\"cite_ref-a_.2520a_1-0\" class=\"reference\"><a href=\"#cite_note-a_.2520a-1\">&#91;b_ %20b 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a_.2520a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_.2520a_1-0\">‚Üë</a></span> <span class=\"reference-text\">A</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a_ %20a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b_ %20b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">A</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b_ %20b</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Multiple, partly encoded spaces in HTML5 mode",
		"wikitext": "<ref name=\"a_ %20a\" group=\"b_ %20b\">A</ref>\n<references group=\"b_ %20b\" />",
		"html": "<p><sup id=\"cite_ref-a_%20a_1-0\" class=\"reference\"><a href=\"#cite_note-a_%2520a-1\">&#91;b_ %20b 1&#93;</a></sup>\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-a_%20a-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-a_%2520a_1-0\">‚Üë</a></span> <span class=\"reference-text\">A</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">a_ %20a</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b_ %20b</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">A</span>&lt;/ref&gt;</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">group</span>=\"<span class=\"wpb-attr-value\">b_ %20b</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "funcsParserTests"
	},
	{
		"desc": "Input times are UTC, not local time",
		"wikitext": "{{#time:c|15 January 2001}}",
		"html": "<p>2001-01-15T00:00:00+00:00\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">c</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">15 January 2001</span></span>}}</span></span>"
	},
	{
		"desc": "Time test in traditional range...",
		"wikitext": "{{#time:Y|15 January 2001}}",
		"html": "<p>2001\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">15 January 2001</span></span>}}</span></span>"
	},
	{
		"desc": "Time test prior to 1970 Unix creation myth",
		"wikitext": "{{#time:Y|5 April 1967}}",
		"html": "<p>1967\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">5 April 1967</span></span>}}</span></span>"
	},
	{
		"desc": "Time test after the 2038 32-bit Apocalype",
		"wikitext": "{{#time:Y|28 July 2061}}",
		"html": "<p>2061\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">28 July 2061</span></span>}}</span></span>"
	},
	{
		"desc": "Explicitly specified timezone: UTC",
		"wikitext": "{{#time:Y-m-d H:i| 2011-11-12 23:00 UTC }}",
		"html": "<p>2011-11-12 23:00\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Y-m-d H:i</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 2011-11-12 23:00 UTC </span></span>}}</span></span>"
	},
	{
		"desc": "Explicitly specified timezone: Europe/Paris (UTC+1)",
		"wikitext": "{{#time:Y-m-d H:i| 2011-11-12 23:00 Europe/Paris }}",
		"html": "<p>2011-11-12 22:00\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Y-m-d H:i</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 2011-11-12 23:00 Europe/Paris </span></span>}}</span></span>"
	},
	{
		"desc": "Explicitly specified timezone: America/New_York (UTC-5)",
		"wikitext": "{{#time:Y-m-d H:i| 2011-11-12 23:00 America/New_York }}",
		"html": "<p>2011-11-13 04:00\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Y-m-d H:i</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 2011-11-12 23:00 America/New_York </span></span>}}</span></span>"
	},
	{
		"desc": "Explicitely specified output language (Dutch)",
		"wikitext": "{{#time:d F Y|1988-02-28|nl}}",
		"html": "<p>28 februari 1988\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#time</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">d F Y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1988-02-28</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">nl</span></span>}}</span></span>"
	},
	{
		"desc": "#titleparts",
		"wikitext": "{{#titleparts:A/b/c/d}}\n{{#titleparts:A/b/c/d|1}}\n{{#titleparts:A/b/c/d|2}}\n{{#titleparts:A/b/c/d|-3}}\n{{#titleparts:A/b/c/d||1}}\n{{#titleparts:A/b/c/d||2}}\n{{#titleparts:A/b/c/d||-2}}\n{{#titleparts:A/b/c/d|1|1}}\n{{#titleparts:A/b/c/d|1|2}}\n{{#titleparts:A/b/c/d|1|-2}}",
		"html": "<p>A/b/c/d\nA\nA/b\nA\nA/b/c/d\nb/c/d\nc/d\nA\nb\nc\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-3</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>||<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>||<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>||<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-2</span></span>}}</span></span>"
	},
	{
		"desc": "#titleparts stops splitting after 25 parts",
		"wikitext": "{{#titleparts:A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!|24}}\n{{#titleparts:A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!|25}}\n{{#titleparts:A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!|-1}}\n{{#titleparts:A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!||-1}}",
		"html": "<p>A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x\nA/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!\nA/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x\n!/!/!\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">24</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">25</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-1</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#titleparts</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">A/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/!/!/!</span></span>||<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-1</span></span>}}</span></span>"
	},
	{
		"desc": "Zero parameters in #if and such",
		"wikitext": "[{{#ifexpr:}},{{#if:}},{{#ifeq:}},{{#switch:}},{{#ifexist:}}]",
		"html": "<p>[,,,,]\n</p>",
		"render": "<p>[,,,,]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:}}</span>]</span>"
	},
	{
		"desc": "Empty condition in #if and such",
		"wikitext": "Empty ifexpr is {{#ifexpr:|true|false}}\nEmpty if is {{#if:|true|false}}\nEmpty ifeq is {{#ifeq:||equal|not equal}}\nEmpty switch is {{#switch:|=empty|#default=something else}}\nEmpty ifexist is {{#ifexist:|true|false}}",
		"html": "<p>Empty ifexpr is false\nEmpty if is false\nEmpty ifeq is equal\nEmpty switch is empty\nEmpty ifexist is false\n</p>",
		"render": "<p>Empty ifexpr is \nEmpty if is false\nEmpty ifeq is equal\nEmpty switch is empty\nEmpty ifexist is false\n</p>",
		"print": "<span class=\"wpb-root\">Empty ifexpr is <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">true</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">false</span></span>}}</span>\nEmpty if is <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">true</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">false</span></span>}}</span>\nEmpty ifeq is <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:||<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">equal</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">not equal</span></span>}}</span>\nEmpty switch is <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:|<span class=\"wpb-parameter\">=<span class=\"wpb-parameter-value\">empty</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">#default</span>=<span class=\"wpb-parameter-value\">something else</span></span>}}</span>\nEmpty ifexist is <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">true</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">false</span></span>}}</span></span>"
	},
	{
		"desc": "Missing or all-empty outputs",
		"wikitext": "[{{#ifexpr: 1}},{{#ifexpr: 1|}},{{#ifexpr: 1||}}]\n[{{#if: 1}},{{#if: 1|}},{{#if: 1||}}]\n[{{#ifeq: 1|1}},{{#ifeq: 1|1|}},{{#ifeq: 1|1||}}]\n[{{#switch: 1}},{{#switch: 1|}}]\n[{{#ifexist: ParserFunctions page}},{{#ifexist: ParserFunctions page|}},{{#ifexist: ParserFunctions page||}}]",
		"html": "<p>[,,]\n[,,]\n[,,]\n[,]\n[,,]\n</p>",
		"render": "<p>[,,]\n[,,]\n[,,]\n[,]\n[,,]\n</p>",
		"print": "<span class=\"wpb-root\">[<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>|}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>||}}</span>]\n[<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>|}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>||}}</span>]\n[<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>||}}</span>]\n[<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1</span></span>|}}</span>]\n[<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> ParserFunctions page</span></span>}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> ParserFunctions page</span></span>|}}</span>,<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> ParserFunctions page</span></span>||}}</span>]</span>"
	},
	{
		"desc": "Preserve tags in #switch default value",
		"wikitext": "{{#switch:a|b|<div>c</div>}}",
		"html": "<div>c</div>",
		"render": "<div >c</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;div&gt;</span>c<span class=\"wpb-html\">&lt;/div&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Bug 19093: Default values don't fall through in switch",
		"wikitext": "<{{#switch: foo | bar | #default = DEF }}>\n<{{#switch: foo | #default | bar = DEF }}>",
		"html": "<p>&lt;DEF&gt;\n&lt;DEF&gt;\n</p>",
		"render": "<p>&lt;DEF&gt;\n&lt;DEF&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> bar </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> #default </span>=<span class=\"wpb-parameter-value\"> DEF </span></span>}}</span>&gt;\n&lt;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> #default </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> bar </span>=<span class=\"wpb-parameter-value\"> DEF </span></span>}}</span>&gt;</span>"
	},
	{
		"desc": "{{#ifexist}}",
		"wikitext": "{{#ifexist:Media:Foobar.jpg|Found|Not found}}\n{{#ifexist:ParserFunctions page|Found|Not found}}\n{{#ifexist:Missing|Found|Not found}}",
		"html": "<p>Found\nFound\nNot found\n</p>",
		"render": "<p>Found\nFound\nFound\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Media:Foobar.jpg</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ParserFunctions page</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Missing</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span></span>"
	},
	{
		"desc": "{{#ifexist:}} media redirect (bug 32031)",
		"wikitext": "{{#ifexist:Media:Redirect_to_Foobar.jpg|Found|Not found}}\n{{#ifexist:Media:Redirect_to_nowhere.jpg|Found|Not found}}\n{{#ifexist:Media:Missing file.jpg|Found|Not found}}\n{{#ifexist:Media:Dionysos-Brunnen am K√∂lner Dom.jpg|Found|Not found}}",
		"html": "<p>Found\nNot found\nNot found\nNot found\n</p>",
		"render": "<p>Found\nFound\nFound\nFound\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Media:Redirect_to_Foobar.jpg</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Media:Redirect_to_nowhere.jpg</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Media:Missing file.jpg</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexist</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Media:Dionysos-Brunnen am K√∂lner Dom.jpg</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Found</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Not found</span></span>}}</span></span>"
	},
	{
		"desc": "#if",
		"wikitext": "{{#if: | yes | no}}\n{{#if: string | yes | no}}\n{{#if:      | yes | no}}\n{{#if:\n\n\n| yes | no}}\n{{#if: 1==2 | yes | no}}\n{{#if: foo | yes }}\n{{#if: | yes }}(empty)\n{{#if: foo | | no}}(empty)\n{{#if: {{{1}}} | yes | no}}\n{{#if: {{{1|}}} | yes | no}}",
		"html": "<p>no\nyes\nno\nno\nyes\nyes\n(empty)\n(empty)\nyes\nno\n</p>",
		"render": "<p>no\nyes\nno\nno\nyes\nyes\n(empty)\n(empty)\nyes\nno\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> string </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">      </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n\n\n</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1==2 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>}}</span>(empty)\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>(empty)\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">1</span>}}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">1</span>|}}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span></span>"
	},
	{
		"desc": "#ifeq",
		"wikitext": "{{#ifeq: 01 | 1 | yes | no}}\n{{#ifeq: 0 | -0 | yes | no}}\n{{#ifeq: foo | bar | yes | no}}\n{{#ifeq: foo | Foo | yes | no}}\n{{#ifeq: \"01\" | \"1\" | yes | no}}",
		"html": "<p>yes\nyes\nno\nno\nno\n</p>",
		"render": "<p>yes\nyes\nno\nno\nno\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 01 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> -0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> bar </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> Foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> \"01\" </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> \"1\" </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span></span>"
	},
	{
		"desc": "#ifeq entities",
		"wikitext": "{{#ifeq: {{PAGENAME:*foo&bar}} | *foo&bar | yes | no}}\n{{#ifeq: a'b | a&#39;b | yes | no}}\n{{#ifeq: a'b | a&amp;#39;b | yes | no}}\n{{#ifeq: foo | Foo | *yes | *no}}",
		"html": "<p>yes\nyes\nno\n</p>\n<ul><li>no</li></ul>",
		"render": "<p>yes\nno\n</p>\n<ul><li>no</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">*foo&amp;bar</span></span>}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> *foo&amp;bar </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> a'b </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> a&amp;#39;b </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> a'b </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> a&amp;amp;#39;b </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> Foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> *yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> *no</span></span>}}</span></span>"
	},
	{
		"desc": "#iferror",
		"wikitext": "{{#iferror: {{#expr: 1 + 2 }} | error | correct }}\n{{#iferror: {{#expr: 1 + X }} | error | correct }}\n{{#iferror: {{#expr: 1 + 2 }} | error }}\n{{#iferror: {{#expr: 1 + X }} | error }}\n{{#iferror: {{#expr: 1 + 2 }} }}\n{{#iferror: {{#expr: 1 + X }} }}empty",
		"html": "<p>correct\nerror\n3\nerror\n3\nempty\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p><p>empty\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#iferror</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 + 2 </span></span>}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> error </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> correct </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#iferror</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 + X </span></span>}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> error </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> correct </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#iferror</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 + 2 </span></span>}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> error </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#iferror</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 + X </span></span>}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> error </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#iferror</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 + 2 </span></span>}}</span> </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#iferror</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 + X </span></span>}}</span> </span></span>}}</span>empty</span>"
	},
	{
		"desc": "#ifexpr",
		"wikitext": "{{#ifexpr: | yes | no}}\n{{#ifexpr: 1 > 0 | yes }}\n{{#ifexpr: 1 < 0 | yes }}empty\n{{#ifexpr: 1 > 0 | | no}}empty\n{{#ifexpr: 1 < 0 | | no}}\n{{#ifexpr: 1 > 0 }}empty",
		"html": "<p>no\nyes\nempty\nempty\nno\nempty\n</p>",
		"render": "<p><br>\nempty\nempty\n</p><p>empty\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 &gt; 0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 &lt; 0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> yes </span></span>}}</span>empty\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 &gt; 0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>empty\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 &lt; 0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 &gt; 0 </span></span>}}</span>empty</span>"
	},
	{
		"desc": "Bug 22866: #ifexpr should evaluate \"-0\" as false",
		"wikitext": "{{#ifexpr: (-1)*0 | true | false }}",
		"html": "<p>false\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifexpr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> (-1)*0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> true </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> false </span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Parser functions don't strip whitespace from positional parameters",
		"wikitext": "{{#if: {{foo}}\n| no-pre-then\n| no-pre-else\n}}",
		"html": "<p>no-pre-then\n</p>",
		"render": "<p>no-pre-then\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">foo</span>}}</span>\n</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no-pre-then\n</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no-pre-else\n</span></span>}}</span></span>"
	},
	{
		"desc": "#switch",
		"wikitext": "{{#switch:foo&bar|foo&amp;bar=yes|no}}\n{{#switch:foo&bar|fred=1|foo&amp;bar|g=yes|no}}\n{{#switch:foo&bar|fred=1|foo&amp;&#39;bar|g=yes|no}}\n{{#switch:foo|bar|baz=no|*default}}\n{{#switch:none|foo=1|bar=2|#default=no match|baz=3}}\n{{#switch:none|foo=1|bar=2|#default=ignored|baz=3|Second default}}\n{{#switch:|a&amp;#39;b}}",
		"html": "<p>yes\nyes\nno\n</p>\n<ul><li>default</li></ul>\n<p>no match\nSecond default\na&amp;#39;b\n</p>",
		"render": "<p>yes\nyes\nno\n</p>\n<ul><li>default</li></ul>\n<p>no match\nSecond default\na&amp;#39;b\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&amp;bar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">foo&amp;amp;bar</span>=<span class=\"wpb-parameter-value\">yes</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&amp;bar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">fred</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&amp;amp;bar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">g</span>=<span class=\"wpb-parameter-value\">yes</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&amp;bar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">fred</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo&amp;amp;&amp;#39;bar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">g</span>=<span class=\"wpb-parameter-value\">yes</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">baz</span>=<span class=\"wpb-parameter-value\">no</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">*default</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">none</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">foo</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">bar</span>=<span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">#default</span>=<span class=\"wpb-parameter-value\">no match</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">baz</span>=<span class=\"wpb-parameter-value\">3</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">none</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">foo</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">bar</span>=<span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">#default</span>=<span class=\"wpb-parameter-value\">ignored</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">baz</span>=<span class=\"wpb-parameter-value\">3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Second default</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a&amp;amp;#39;b</span></span>}}</span></span>"
	},
	{
		"desc": "#switch #default should match next and not last named parameter",
		"wikitext": "<{{#switch: foo | #default | bar = DEF }}>\n<{{#switch: foo | #default | bar = DEF | baz = GHI }}>",
		"html": "<p>&lt;DEF&gt;\n&lt;DEF&gt;\n</p>",
		"render": "<p>&lt;DEF&gt;\n&lt;DEF&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> #default </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> bar </span>=<span class=\"wpb-parameter-value\"> DEF </span></span>}}</span>&gt;\n&lt;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> #default </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> bar </span>=<span class=\"wpb-parameter-value\"> DEF </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> baz </span>=<span class=\"wpb-parameter-value\"> GHI </span></span>}}</span>&gt;</span>"
	},
	{
		"desc": "#switch should not match #default as a prefix",
		"wikitext": "<{{#switch: foo | #defaultWTF? = This is crazy }}>\n<{{#switch: foo | #defaultWTF? | bar = This is crazy }}>",
		"html": "<p>&lt;&gt;\n&lt;&gt;\n</p>",
		"render": "<p>&lt;&gt;\n&lt;&gt;\n</p>",
		"print": "<span class=\"wpb-root\">&lt;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> #defaultWTF? </span>=<span class=\"wpb-parameter-value\"> This is crazy </span></span>}}</span>&gt;\n&lt;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> #defaultWTF? </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> bar </span>=<span class=\"wpb-parameter-value\"> This is crazy </span></span>}}</span>&gt;</span>"
	},
	{
		"desc": "#switch Test php truthy",
		"wikitext": "{{#switch: 01 | 1 = yes | no}}\n{{#switch: 0 | -0 = yes | no}}\n{{#switch: foo | bar = yes | no}}\n{{#switch: foo | Foo = yes | no}}\n{{#switch: \"01\" | \"1\" = yes | no}}\n{{#switch: 1 | 02 | 01 = yes | no}}\n{{#switch: 1 | \"01\" | \"1\" = yes | no}}",
		"html": "<p>yes\nyes\nno\nno\nno\nyes\nno\n</p>",
		"render": "<p>yes\nyes\nno\nno\nno\nyes\nno\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 01 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> 1 </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 0 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> -0 </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> bar </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> Foo </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> \"01\" </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> \"1\" </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 02 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> 01 </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#switch</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> \"01\" </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\"> \"1\" </span>=<span class=\"wpb-parameter-value\"> yes </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> no</span></span>}}</span></span>"
	},
	{
		"desc": "headings"
	},
	{
		"desc": "Basic test",
		"wikitext": "==h1==\n===h1.1===\n==h2==\n===h2.1===\n====h2.1.1====\n===h2.2===\n====h2.2.1====\n====h2.2.2====\n==h3==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">h1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">h1.1</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">h2</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">h2.1</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">h2.1.1</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">h2.2</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">h2.2.1</span>====</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">h2.2.2</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">h3</span>==</span></span>"
	},
	{
		"desc": "HTML headings should get TOC entries with some empty properties",
		"wikitext": "==a==\n<h2>b</h2>\n<h3>c</h3>\n===d===\n<h2>e</h2>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-html\">&lt;h2&gt;</span>b<span class=\"wpb-html\">&lt;/h2&gt;</span>\n<span class=\"wpb-html\">&lt;h3&gt;</span>c<span class=\"wpb-html\">&lt;/h3&gt;</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">d</span>===</span>\n<span class=\"wpb-html\">&lt;h2&gt;</span>e<span class=\"wpb-html\">&lt;/h2&gt;</span></span>"
	},
	{
		"desc": "Literal html heading from template",
		"wikitext": "{{1x|\n<h2>hi</h2>\nho\n}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-html\">&lt;h2&gt;</span>hi<span class=\"wpb-html\">&lt;/h2&gt;</span>\nho\n</span></span>}}</span></span>"
	},
	{
		"desc": "Duplicate headings should get unique anchors",
		"wikitext": "==a==\n==a==\n==b==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span></span>"
	},
	{
		"desc": "Templated sections (heading from template content)",
		"wikitext": "==a==\n{{Test}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Test</span>}}</span></span>"
	},
	{
		"desc": "Ensure headings with html tags get the right anchors",
		"wikitext": "==<span>x</span>==\n==<strike>y</strike>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span&gt;</span>x<span class=\"wpb-html\">&lt;/span&gt;</span></span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;strike&gt;</span>y<span class=\"wpb-html\">&lt;/strike&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Ensure unallowed tag wrappers in headings get stripped",
		"wikitext": "==<div>b</div>==\n==<font>c</font>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;div&gt;</span>b<span class=\"wpb-html\">&lt;/div&gt;</span></span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;font&gt;</span>c<span class=\"wpb-html\">&lt;/font&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Ensure disallowed attributes are stripped, but dir attribute in a span is left behind",
		"wikitext": "==<span dir='ltr' title='x'>a</span>==\n==<span dir='rtl' title='x'>b</span>==\n==<i dir='rtl' title='ha'>c</i>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>='<span class=\"wpb-attr-value\">ltr</span>'</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>='<span class=\"wpb-attr-value\">x</span>'</span></span>&gt;</span>a<span class=\"wpb-html\">&lt;/span&gt;</span></span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>='<span class=\"wpb-attr-value\">rtl</span>'</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>='<span class=\"wpb-attr-value\">x</span>'</span></span>&gt;</span>b<span class=\"wpb-html\">&lt;/span&gt;</span></span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;i<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>='<span class=\"wpb-attr-value\">rtl</span>'</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>='<span class=\"wpb-attr-value\">ha</span>'</span></span>&gt;</span>c<span class=\"wpb-html\">&lt;/i&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Ensure empty tags are stripped",
		"wikitext": "==<span><div></div></span>x==\n==<span dir='ltr'><i dir='ltr'></i></span>y==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>x</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>='<span class=\"wpb-attr-value\">ltr</span>'</span></span>&gt;</span><span class=\"wpb-html\">&lt;i<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>='<span class=\"wpb-attr-value\">ltr</span>'</span></span>&gt;</span><span class=\"wpb-html\">&lt;/i&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>y</span>==</span></span>"
	},
	{
		"desc": "Ensure comments in toc lines are stripped",
		"wikitext": "==hi<html><!--ho--></html>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">hi&lt;html&gt;<span class=\"wpb-comment\">&lt;!--ho--&gt;</span>&lt;/html&gt;</span>==</span></span>"
	},
	{
		"desc": "Handle links in heading content",
		"wikitext": "==[[Cat]]==\n==[[Dog]]s==\n==[[Cat|I love my ''cat'']]==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Cat</span>]]</span></span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Dog</span>]]</span>s</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Cat</span>|<span class=\"wpb-link-text\">I love my <span class=\"wpb-quote\">''</span>cat<span class=\"wpb-quote\">''</span></span>]]</span></span>==</span></span>"
	},
	{
		"desc": "Ensure headings with special chars get the right anchors",
		"wikitext": "===a=\n=''x''=",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">==a</span>=</span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"><span class=\"wpb-quote\">''</span>x<span class=\"wpb-quote\">''</span></span>=</span></span>"
	},
	{
		"desc": "Templated sections (heading from template arg)",
		"wikitext": "==a==\n{{1x|1=\n==b==\n}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n</span></span>}}</span></span>"
	},
	{
		"desc": "Offsets in toc metadata should be unicode codepoints, not bytes or UCS-2",
		"wikitext": "==One üí©==\n==Two üí©==\n==Three üí©==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">One üí©</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Two üí©</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Three üí©</span>==</span></span>"
	},
	{
		"desc": "Handle multi-part content transclusion blocks",
		"wikitext": "<div>\n{{1x|1=\n==foo==\n</div>\n}}\n==bar==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">foo</span>==</span>\n<span class=\"wpb-html\">&lt;/div&gt;</span>\n</span></span>}}</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">bar</span>==</span></span>"
	},
	{
		"desc": "Handle parser functions generating sections",
		"wikitext": "{{#if:1|<h2>foo</h2>|unused}}\n==bar==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#if</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;h2&gt;</span>foo<span class=\"wpb-html\">&lt;/h2&gt;</span></span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">unused</span></span>}}</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">bar</span>==</span></span>"
	},
	{
		"desc": "Handle top-level template args generating sections",
		"wikitext": "{{{foo|\n==tplarg==\n|abcd}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-arg\">{{{<span class=\"wpb-arg-name\">foo</span>|<span class=\"wpb-arg-default\">\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">tplarg</span>==</span>\n</span>|<span class=\"wpb-hidden\">abcd</span>}}}</span></span>"
	},
	{
		"desc": "Basic section headings",
		"wikitext": "==Headline 1==\nSome text\n\n==Headline 2==\nMore\n===Smaller headline===\nBlah blah",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Headline 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Headline 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>More\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Smaller_headline\">Smaller headline</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Smaller headline\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>Blah blah\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2></div>\n<p>More\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Smaller_headline\">Smaller headline</h3></div>\n<p>Blah blah\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 1</span>==</span>\nSome text\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 2</span>==</span>\nMore\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Smaller headline</span>===</span>\nBlah blah</span>"
	},
	{
		"desc": "Section headings with TOC",
		"wikitext": "==Headline 1==\n===Subheadline 1===\n=====Skipping a level=====\n======Skipping a level======\n\n==Headline 2==\nSome text\n===Another headline===",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Headline_1\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Headline 1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Subheadline_1\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Subheadline 1</span></a>\n<ul>\n<li class=\"toclevel-3 tocsection-3\"><a href=\"#Skipping_a_level\"><span class=\"tocnumber\">1.1.1</span> <span class=\"toctext\">Skipping a level</span></a>\n<ul>\n<li class=\"toclevel-4 tocsection-4\"><a href=\"#Skipping_a_level_2\"><span class=\"tocnumber\">1.1.1.1</span> <span class=\"toctext\">Skipping a level</span></a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#Headline_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Headline 2</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-6\"><a href=\"#Another_headline\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">Another headline</span></a></li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Headline 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Subheadline_1\">Subheadline 1</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Subheadline 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading5\"><h5 id=\"Skipping_a_level\">Skipping a level</h5><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Skipping a level\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"Skipping_a_level_2\">Skipping a level</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: Skipping a level\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: Headline 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Another_headline\">Another headline</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: Another headline\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Subheadline_1\">Subheadline 1</h3></div>\n<div class=\"mw-heading mw-heading5\"><h5 id=\"Skipping_a_level\">Skipping a level</h5></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"Skipping_a_level_2\">Skipping a level</h6></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Another_headline\">Another headline</h3></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Subheadline 1</span>===</span>\n<span class=\"wpb-heading\">=====<span class=\"wpb-heading-title\">Skipping a level</span>=====</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">Skipping a level</span>======<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 2</span>==</span>\nSome text\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Another headline</span>===</span></span>"
	},
	{
		"desc": "Section headings with TOC and language conversion (T295187, T306862)",
		"wikitext": "==Headline 1==\n===Subheadline 1===\n==Headline 2==\nSome text\n===Another headline===",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en-x-piglatin\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Ontentscay</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Headline_1\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Eadlinehay 1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Subheadline_1\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Ubheadlinesay 1</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#Headline_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Eadlinehay 2</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#Another_headline\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">Anotherway eadlinehay</span></a></li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Eadlinehay 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Eadlinehay 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Subheadline_1\">Ubheadlinesay 1</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Ubheadlinesay 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Eadlinehay 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Eadlinehay 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>Omesay exttay\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Another_headline\">Anotherway eadlinehay</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: Anotherway eadlinehay\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Subheadline_1\">Subheadline 1</h3></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Another_headline\">Another headline</h3></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Subheadline 1</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 2</span>==</span>\nSome text\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Another headline</span>===</span></span>"
	},
	{
		"desc": "Section headings with TOC and language conversion disabled (T295187)",
		"wikitext": "==Headline 1==\n===Subheadline 1===\n==Headline 2==\nSome text\n===Another headline===\n__NOCONTENTCONVERT__",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en-x-piglatin\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Ontentscay</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Headline_1\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Headline 1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Subheadline_1\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Subheadline 1</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#Headline_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Headline 2</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#Another_headline\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">Another headline</span></a></li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Headline 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Subheadline_1\">Subheadline 1</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Subheadline 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Headline 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Another_headline\">Another headline</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: Another headline\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_1\">Headline 1</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Subheadline_1\">Subheadline 1</h3></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2></div>\n<p>Some text\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Another_headline\">Another headline</h3></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Subheadline 1</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 2</span>==</span>\nSome text\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Another headline</span>===</span>\n<span class=\"wpb-double-underscore\">__NOCONTENTCONVERT__</span></span>"
	},
	{
		"desc": "Section headings with TOC, language conversion rules, and displaytitle\n(T306862, T331316, T26072)",
		"wikitext": "<!--\n-->-{H|Foo=>en:Boo;Foo=>en-x-piglatin:Bob;}-<!--\n-->-{H|Bar=>en:Bat;Bar=>en-x-piglatin:Ball;}-<!--\n-->-{T|en:Foo;en-x-piglatin:Bar;}-<!--\n-->\nIntroduction.\n-{A|en:Do; en-x-piglatin:Re;}-\n== Foo ==\nFoo Do\n== Bar ==\nBar Re\n== -{Foo Bar}- ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--\n--&gt;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Foo=&gt;en:Boo;Foo=&gt;en-x-piglatin:Bob;</span></span>}-</span><span class=\"wpb-comment\">&lt;!--\n--&gt;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Bar=&gt;en:Bat;Bar=&gt;en-x-piglatin:Ball;</span></span>}-</span><span class=\"wpb-comment\">&lt;!--\n--&gt;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">en:Foo;en-x-piglatin:Bar;</span></span>}-</span><span class=\"wpb-comment\">&lt;!--\n--&gt;</span>\nIntroduction.\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">en:Do; en-x-piglatin:Re;</span></span>}-</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Foo </span>==</span>\nFoo Do\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Bar </span>==</span>\nBar Re\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Foo Bar</span></span>}-</span> </span>==</span></span>"
	},
	{
		"desc": "TOC anchors don't collide",
		"wikitext": "__FORCETOC__\n==Headline 2==\n==Headline==\n==Headline 2==\n==Headline==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Headline_2\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Headline 2</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#Headline\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Headline</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#Headline_2_2\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">Headline 2</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#Headline_3\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">Headline</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Headline 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline\">Headline</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Headline\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2_2\">Headline 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Headline 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_3\">Headline</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: Headline\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2\">Headline 2</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline\">Headline</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_2_2\">Headline 2</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Headline_3\">Headline</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__FORCETOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 2</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline 2</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Headline</span>==</span></span>"
	},
	{
		"desc": "Handling of sections up to level 6 and beyond",
		"wikitext": "=Level 1 Heading=\n==Level 2 Heading==\n===Level 3 Heading===\n====Level 4 Heading====\n=====Level 5 Heading=====\n======Level 6 Heading======\n=======Level 7 Heading=======\n========Level 8 Heading========\n=========Level 9 Heading=========\n==========Level 10 Heading==========",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Level_1_Heading\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Level 1 Heading</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Level_2_Heading\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Level 2 Heading</span></a>\n<ul>\n<li class=\"toclevel-3 tocsection-3\"><a href=\"#Level_3_Heading\"><span class=\"tocnumber\">1.1.1</span> <span class=\"toctext\">Level 3 Heading</span></a>\n<ul>\n<li class=\"toclevel-4 tocsection-4\"><a href=\"#Level_4_Heading\"><span class=\"tocnumber\">1.1.1.1</span> <span class=\"toctext\">Level 4 Heading</span></a>\n<ul>\n<li class=\"toclevel-5 tocsection-5\"><a href=\"#Level_5_Heading\"><span class=\"tocnumber\">1.1.1.1.1</span> <span class=\"toctext\">Level 5 Heading</span></a>\n<ul>\n<li class=\"toclevel-6 tocsection-6\"><a href=\"#Level_6_Heading\"><span class=\"tocnumber\">1.1.1.1.1.1</span> <span class=\"toctext\">Level 6 Heading</span></a></li>\n<li class=\"toclevel-6 tocsection-7\"><a href=\"#.3DLevel_7_Heading.3D\"><span class=\"tocnumber\">1.1.1.1.1.2</span> <span class=\"toctext\">=Level 7 Heading=</span></a></li>\n<li class=\"toclevel-6 tocsection-8\"><a href=\"#.3D.3DLevel_8_Heading.3D.3D\"><span class=\"tocnumber\">1.1.1.1.1.3</span> <span class=\"toctext\">==Level 8 Heading==</span></a></li>\n<li class=\"toclevel-6 tocsection-9\"><a href=\"#.3D.3D.3DLevel_9_Heading.3D.3D.3D\"><span class=\"tocnumber\">1.1.1.1.1.4</span> <span class=\"toctext\">===Level 9 Heading===</span></a></li>\n<li class=\"toclevel-6 tocsection-10\"><a href=\"#.3D.3D.3D.3DLevel_10_Heading.3D.3D.3D.3D\"><span class=\"tocnumber\">1.1.1.1.1.5</span> <span class=\"toctext\">====Level 10 Heading====</span></a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading1\"><h1 id=\"Level_1_Heading\">Level 1 Heading</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Level 1 Heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Level_2_Heading\">Level 2 Heading</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Level 2 Heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Level_3_Heading\">Level 3 Heading</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Level 3 Heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading4\"><h4 id=\"Level_4_Heading\">Level 4 Heading</h4><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: Level 4 Heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading5\"><h5 id=\"Level_5_Heading\">Level 5 Heading</h5><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: Level 5 Heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"Level_6_Heading\">Level 6 Heading</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: Level 6 Heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\".3DLevel_7_Heading.3D\">=Level 7 Heading=</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=7\" title=\"Edit section: =Level 7 Heading=\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\".3D.3DLevel_8_Heading.3D.3D\">==Level 8 Heading==</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=8\" title=\"Edit section: ==Level 8 Heading==\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\".3D.3D.3DLevel_9_Heading.3D.3D.3D\">===Level 9 Heading===</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=9\" title=\"Edit section: ===Level 9 Heading===\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\".3D.3D.3D.3DLevel_10_Heading.3D.3D.3D.3D\">====Level 10 Heading====</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=10\" title=\"Edit section: ====Level 10 Heading====\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading1\"><h1 id=\"Level_1_Heading\">Level 1 Heading</h1></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Level_2_Heading\">Level 2 Heading</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"Level_3_Heading\">Level 3 Heading</h3></div>\n<div class=\"mw-heading mw-heading4\"><h4 id=\"Level_4_Heading\">Level 4 Heading</h4></div>\n<div class=\"mw-heading mw-heading5\"><h5 id=\"Level_5_Heading\">Level 5 Heading</h5></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"Level_6_Heading\">Level 6 Heading</h6></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"=Level_7_Heading=\">=Level 7 Heading=</h6></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"==Level_8_Heading==\">==Level 8 Heading==</h6></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"===Level_9_Heading===\">===Level 9 Heading===</h6></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"====Level_10_Heading====\">====Level 10 Heading====</h6></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">Level 1 Heading</span>=</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Level 2 Heading</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Level 3 Heading</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">Level 4 Heading</span>====</span>\n<span class=\"wpb-heading\">=====<span class=\"wpb-heading-title\">Level 5 Heading</span>=====</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">Level 6 Heading</span>======</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">=Level 7 Heading=</span>======</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">==Level 8 Heading==</span>======</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">===Level 9 Heading===</span>======</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">====Level 10 Heading====</span>======</span></span>"
	},
	{
		"desc": "TOC regression (T11764)",
		"wikitext": "==title 1==\n===title 1.1===\n====title 1.1.1====\n===title 1.2===\n==title 2==\n===title 2.1===",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#title_1\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">title 1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#title_1.1\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">title 1.1</span></a>\n<ul>\n<li class=\"toclevel-3 tocsection-3\"><a href=\"#title_1.1.1\"><span class=\"tocnumber\">1.1.1</span> <span class=\"toctext\">title 1.1.1</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#title_1.2\"><span class=\"tocnumber\">1.2</span> <span class=\"toctext\">title 1.2</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#title_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">title 2</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-6\"><a href=\"#title_2.1\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">title 2.1</span></a></li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"title_1\">title 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: title 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_1.1\">title 1.1</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: title 1.1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading4\"><h4 id=\"title_1.1.1\">title 1.1.1</h4><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: title 1.1.1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_1.2\">title 1.2</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: title 1.2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"title_2\">title 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: title 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_2.1\">title 2.1</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: title 2.1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"title_1\">title 1</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_1.1\">title 1.1</h3></div>\n<div class=\"mw-heading mw-heading4\"><h4 id=\"title_1.1.1\">title 1.1.1</h4></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_1.2\">title 1.2</h3></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"title_2\">title 2</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_2.1\">title 2.1</h3></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">title 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 1.1</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">title 1.1.1</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 1.2</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">title 2</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 2.1</span>===</span></span>"
	},
	{
		"desc": "TOC for heading containing <span id=\"...\"></span> (T96153)",
		"wikitext": "__FORCETOC__\n==<span id=\"old-anchor\"></span>New title==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#New_title\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">New title</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"New_title\"><span id=\"old-anchor\"></span>New title</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: New title\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"New_title\"><span id=\"old-anchor\"></span>New title</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__FORCETOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">old-anchor</span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>New title</span>==</span></span>"
	},
	{
		"desc": "TOC with wgMaxTocLevel=3 (T8204)",
		"wikitext": "==title 1==\n===title 1.1===\n====title 1.1.1====\n===title 1.2===\n==title 2==\n===title 2.1===",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">title 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 1.1</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">title 1.1.1</span>====</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 1.2</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">title 2</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 2.1</span>===</span></span>"
	},
	{
		"desc": "TOC with wgMaxTocLevel=3 and two level four headings (T8204)",
		"wikitext": "==Section 1==\n===Section 1.1===\n====Section 1.1.1====\n====Section 1.1.1.1====\n==Section 2==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Section 1.1</span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">Section 1.1.1</span>====</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\">Section 1.1.1.1</span>====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 2</span>==</span></span>"
	},
	{
		"desc": "Resolving duplicate section names",
		"wikitext": "==Foo bar==\n==Foo bar==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar_2\">Foo bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Foo bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar_2\">Foo bar</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo bar</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo bar</span>==</span></span>"
	},
	{
		"desc": "Resolving duplicate section names with differing case (T12721)",
		"wikitext": "==Foo bar==\n==Foo Bar==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_Bar_2\">Foo Bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Foo Bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_Bar_2\">Foo Bar</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo bar</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo Bar</span>==</span></span>"
	},
	{
		"desc": "Template with sections, __NOTOC__",
		"wikitext": "__NOTOC__\n==Section 0==\n{{sections}}\n==Section 4==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 0</span>==</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">sections</span>}}</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 4</span>==</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: no sections, but __FORCETOC__",
		"wikitext": "__FORCETOC__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__FORCETOC__</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: no sections, but __TOC__",
		"wikitext": "__TOC__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: no sections, and __NOTOC__",
		"wikitext": "__NOTOC__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: not \"enough\" sections",
		"wikitext": "== One ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span></span>"
	},
	{
		"desc": "T352467: synthetic sections shouldn't count towards \"enough\" sections",
		"wikitext": "<div>\n==a==\n==b==\n</div>\n==c==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">b</span>==</span>\n<span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">c</span>==</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: not \"enough\" sections, but __FORCETOC__",
		"wikitext": "__FORCETOC__\n== One ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__FORCETOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: not \"enough\" sections, but __TOC__",
		"wikitext": "== One ==\n__TOC__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span>\n<span class=\"wpb-double-underscore\">__TOC__</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: not \"enough\" sections, and __NOTOC__",
		"wikitext": "__NOTOC__\n== One ==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: \"enough\" sections",
		"wikitext": "== One ==\n=== Two ===\n== Three ==\n=== Four ===",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> Two </span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Three </span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> Four </span>===</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: \"enough\" sections and __FORCETOC__",
		"wikitext": "__FORCETOC__\n== One ==\n=== Two ===\n== Three ==\n=== Four ===",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__FORCETOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> Two </span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Three </span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> Four </span>===</span></span>"
	},
	{
		"desc": "T307691: show-toc flag: \"enough\" sections and __NOTOC__",
		"wikitext": "__NOTOC__\n== One ==\n=== Two ===\n== Three ==\n=== Four ===",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> One </span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> Two </span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Three </span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> Four </span>===</span></span>"
	},
	{
		"desc": "__NOEDITSECTION__ keyword",
		"wikitext": "__NOEDITSECTION__\n==Section 1==\n==Section 2==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_1\">Section 1</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_2\">Section 2</h2></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_1\">Section 1</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_2\">Section 2</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOEDITSECTION__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 1</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 2</span>==</span></span>"
	},
	{
		"desc": "Link inside a section heading",
		"wikitext": "==Section with a [[Main Page|link]] in it==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_with_a_link_in_it\">Section with a <a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a> in it</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Section with a link in it\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_with_a_link_in_it\">Section with a <a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a> in it</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section with a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">link</span>]]</span> in it</span>==</span></span>"
	},
	{
		"desc": "TOC regression (T14077)",
		"wikitext": "__TOC__\n==title 1==\n===title 1.1===\n==title 2==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#title_1\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">title 1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#title_1.1\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">title 1.1</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#title_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">title 2</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"title_1\">title 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: title 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_1.1\">title 1.1</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: title 1.1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"title_2\">title 2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: title 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"title_1\">title 1</h2></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"title_1.1\">title 1.1</h3></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"title_2\">title 2</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">title 1</span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">title 1.1</span>===</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">title 2</span>==</span></span>"
	},
	{
		"desc": "__FORCETOC__ override",
		"wikitext": "__NEWSECTIONLINK__\n__FORCETOC__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NEWSECTIONLINK__</span>\n<span class=\"wpb-double-underscore\">__FORCETOC__</span></span>"
	},
	{
		"desc": "T28375: TOC with italics",
		"wikitext": "__TOC__\n==''Lost'' episodes==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Lost_episodes\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><i>Lost</i> episodes</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Lost_episodes\"><i>Lost</i> episodes</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Main_Page&amp;action=edit&amp;section=1\" title=\"Edit section: Lost episodes\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Lost_episodes\"><i>Lost</i> episodes</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-quote\">''</span>Lost<span class=\"wpb-quote\">''</span> episodes</span>==</span></span>"
	},
	{
		"desc": "T28375: TOC with bold",
		"wikitext": "__TOC__\n=='''should be bold''' then normal text==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#should_be_bold_then_normal_text\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><b>should be bold</b> then normal text</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"should_be_bold_then_normal_text\"><b>should be bold</b> then normal text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Main_Page&amp;action=edit&amp;section=1\" title=\"Edit section: should be bold then normal text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"should_be_bold_then_normal_text\"><b>should be bold</b> then normal text</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-quote\">'''</span>should be bold<span class=\"wpb-quote\">'''</span> then normal text</span>==</span></span>"
	},
	{
		"desc": "T35845: Headings become cursive in TOC when they contain an image",
		"wikitext": "__TOC__\n==Image [[Image:foobar.jpg]]==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Image\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Image</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Image\">Image <span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Main_Page&amp;action=edit&amp;section=1\" title=\"Edit section: Image\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Image\">Image <span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Image <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>]]</span></span>==</span></span>"
	},
	{
		"desc": "T35845 (2): Headings become bold in TOC when they contain a blockquote",
		"wikitext": "__TOC__\n==<blockquote>Quote</blockquote>==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Quote\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Quote</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Quote\"><blockquote><p>Quote</p></blockquote></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Main_Page&amp;action=edit&amp;section=1\" title=\"Edit section: Quote\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Quote\"><blockquote >Quote</blockquote></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>Quote<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Unclosed tags in TOC",
		"wikitext": "__TOC__\n==Proof: 2 < 3==\n<small>Hanc marginis exiguitas non caperet.</small>\nQED",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Proof:_2_&lt;_3\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Proof: 2 &lt; 3</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Proof:_2_&lt;_3\"><span id=\"Proof:_2_.3C_3\"></span>Proof: 2 &lt; 3</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Main_Page&amp;action=edit&amp;section=1\" title=\"Edit section: Proof: 2 &lt; 3\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><small>Hanc marginis exiguitas non caperet.</small>\nQED\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Proof:_2_<_3\">Proof: 2 &lt; 3</h2></div>\n<p><small >Hanc marginis exiguitas non caperet.</small>\nQED\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Proof: 2 &lt; 3</span>==</span>\n<span class=\"wpb-html\">&lt;small&gt;</span>Hanc marginis exiguitas non caperet.<span class=\"wpb-html\">&lt;/small&gt;</span>\nQED</span>"
	},
	{
		"desc": "Multiple tags in TOC",
		"wikitext": "__TOC__\n==<i>Foo</i> <b>Bar</b>==\n\n==<i>Foo</i> <blockquote>Bar</blockquote>==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Foo_Bar\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><i>Foo</i> <b>Bar</b></span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#Foo_Bar_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\"><i>Foo</i> Bar</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_Bar\"><i>Foo</i> <b>Bar</b></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo Bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_Bar_2\"><i>Foo</i> <blockquote><p>Bar</p></blockquote></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Foo Bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_Bar\"><i >Foo</i> <b >Bar</b></h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_Bar_2\"><i >Foo</i> <blockquote >Bar</blockquote></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;i&gt;</span>Foo<span class=\"wpb-html\">&lt;/i&gt;</span> <span class=\"wpb-html\">&lt;b&gt;</span>Bar<span class=\"wpb-html\">&lt;/b&gt;</span></span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;i&gt;</span>Foo<span class=\"wpb-html\">&lt;/i&gt;</span> <span class=\"wpb-html\">&lt;blockquote&gt;</span>Bar<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Tags with parameters in TOC",
		"wikitext": "__TOC__\n==<sup class=\"in-h2\">Hello</sup>==\n\n==<sup class=\"a > b\">Evilbye</sup>==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Hello\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><sup>Hello</sup></span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#b.22.3EEvilbye\"><span class=\"tocnumber\">2</span> <span class=\"toctext\"><sup> b\"&gt;Evilbye</sup></span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hello\"><sup class=\"in-h2\">Hello</sup></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Hello\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"b.22.3EEvilbye\"><sup class=\"a\"> b\"&gt;Evilbye</sup></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: b&quot;&gt;Evilbye\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Hello\"><sup class=\"in-h2\">Hello</sup></h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"b&quot;>Evilbye\"><sup class=\"a\"> b\"&gt;Evilbye</sup></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;sup<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">in-h2</span>\"</span></span>&gt;</span>Hello<span class=\"wpb-html\">&lt;/sup&gt;</span></span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;sup<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">a </span></span></span>&gt;</span> b\"&gt;Evilbye<span class=\"wpb-html\">&lt;/sup&gt;</span></span>==</span></span>"
	},
	{
		"desc": "span tags with directionality in TOC",
		"wikitext": "__TOC__\n==<span dir=\"ltr\">C++</span>==\n\n==<span dir=\"rtl\">◊ñ◊ë◊†◊í!</span>==\n\n==<span style=\"font-style: italic\" dir=\"ltr\" title=\"hello\">Attributes other than dir</span>==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#C.2B.2B\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><span dir=\"ltr\">C++</span></span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#.D7.96.D7.91.D7.A0.D7.92.21\"><span class=\"tocnumber\">2</span> <span class=\"toctext\"><span dir=\"rtl\">◊ñ◊ë◊†◊í!</span></span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#Attributes_other_than_dir\"><span class=\"tocnumber\">3</span> <span class=\"toctext\"><span dir=\"ltr\">Attributes other than dir</span></span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"C.2B.2B\"><span dir=\"ltr\">C++</span></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: C++\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\".D7.96.D7.91.D7.A0.D7.92.21\"><span dir=\"rtl\">◊ñ◊ë◊†◊í!</span></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: ◊ñ◊ë◊†◊í!\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Attributes_other_than_dir\"><span style=\"font-style: italic\" dir=\"ltr\" title=\"hello\">Attributes other than dir</span></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Attributes other than dir\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"C++\"><span dir=\"ltr\">C++</span></h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"◊ñ◊ë◊†◊í!\"><span dir=\"rtl\">◊ñ◊ë◊†◊í!</span></h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Attributes_other_than_dir\"><span style=\"font-style: italic\" dir=\"ltr\" title=\"hello\">Attributes other than dir</span></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">ltr</span>\"</span></span>&gt;</span>C++<span class=\"wpb-html\">&lt;/span&gt;</span></span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">rtl</span>\"</span></span>&gt;</span>◊ñ◊ë◊†◊í!<span class=\"wpb-html\">&lt;/span&gt;</span></span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">font-style: italic</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">dir</span>=\"<span class=\"wpb-attr-value\">ltr</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">hello</span>\"</span></span>&gt;</span>Attributes other than dir<span class=\"wpb-html\">&lt;/span&gt;</span></span>==</span></span>"
	},
	{
		"desc": "T74884: bdi element in ToC",
		"wikitext": "__TOC__\n==<bdi>test</bdi>==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#test\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><bdi>test</bdi></span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"test\"><bdi>test</bdi></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: test\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"test\"><bdi >test</bdi></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;bdi&gt;</span>test<span class=\"wpb-html\">&lt;/bdi&gt;</span></span>==</span></span>"
	},
	{
		"desc": "T35715: s/strike element in ToC",
		"wikitext": "__TOC__\n==<s>test</s> test <strike>test</strike>==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#test_test_test\"><span class=\"tocnumber\">1</span> <span class=\"toctext\"><s>test</s> test <strike>test</strike></span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"test_test_test\"><s>test</s> test <strike>test</strike></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: test test test\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"test_test_test\"><s >test</s> test <strike >test</strike></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-html\">&lt;s&gt;</span>test<span class=\"wpb-html\">&lt;/s&gt;</span> test <span class=\"wpb-html\">&lt;strike&gt;</span>test<span class=\"wpb-html\">&lt;/strike&gt;</span></span>==</span></span>"
	},
	{
		"desc": "T198618: style element in ToC",
		"wikitext": "__TOC__\n==<style>.foo {}</style>Style<style>.bar {}</style>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">&lt;style&gt;.foo {}&lt;/style&gt;Style&lt;style&gt;.bar {}&lt;/style&gt;</span>==</span></span>"
	},
	{
		"desc": "T198618: script element in ToC",
		"wikitext": "__TOC__\n==<html><script>alert(1);</script></html>Script<html><script>alert(1);</script></html>==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">&lt;html&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/html&gt;Script&lt;html&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/html&gt;</span>==</span></span>"
	},
	{
		"desc": "Empty <p> tag in TOC, removed by Sanitizer (T92892)",
		"wikitext": "__TOC__\n==x==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#x\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">x</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"x\">x</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: x\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"x\">x</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">x</span>==</span></span>"
	},
	{
		"desc": "Disable TOC",
		"wikitext": "Lead\n==Section 1==\n==Section 2==\n==Section 3==\n==Section 4==\n==Section 5==",
		"print": "<span class=\"wpb-root\">Lead\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 1</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 2</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 3</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 4</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 5</span>==</span></span>"
	},
	{
		"desc": "Short headings with trailing space should match behavior of Parser::doHeadings (T21910)",
		"wikitext": "=== \nThe line above must have a trailing space!\n=== <!--\n--> <!-- -->\nBut just in case it doesn't...",
		"html": "<div class=\"mw-heading mw-heading1\"><h1 id=\".3D\">=</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: =\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>The line above must have a trailing space!\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\".3D_2\">=</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: =\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>But just in case it doesn't...\n</p>",
		"render": "<div class=\"mw-heading mw-heading1\"><h1 id=\"=\">=</h1></div>\n<p>The line above must have a trailing space!\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"=_2\">=</h1></div>\n<p>But just in case it doesn't...\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=</span>=<span class=\"wpb-heading-trail\"> </span></span>\nThe line above must have a trailing space!\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=</span>=<span class=\"wpb-heading-trail\"> <span class=\"wpb-comment\">&lt;!--\n--&gt;</span> <span class=\"wpb-comment\">&lt;!-- --&gt;</span></span></span>\nBut just in case it doesn't...</span>"
	},
	{
		"desc": "Header with special characters (T27462)",
		"wikitext": "The tooltips shall not show entities to the user (ie. be double escaped)\n\n==text > text==\nsection 1\n\n==text < text==\nsection 2\n\n==text & text==\nsection 3\n\n==text ' text==\nsection 4\n\n==text \" text==\nsection 5",
		"html": "<p>The tooltips shall not show entities to the user (ie. be double escaped)\n</p>\n<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#text_.3E_text\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">text &gt; text</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#text_.3C_text\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">text &lt; text</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#text_.26_text\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">text &amp; text</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#text_.27_text\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">text ' text</span></a></li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#text_.22_text\"><span class=\"tocnumber\">5</span> <span class=\"toctext\">text \" text</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_.3E_text\">text &gt; text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: text &gt; text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 1\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_.3C_text\">text &lt; text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: text &lt; text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 2\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_.26_text\">text &amp; text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: text &amp; text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 3\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_.27_text\">text ' text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: text &#039; text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 4\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_.22_text\">text \" text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: text &quot; text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 5\n</p>",
		"render": "<p>The tooltips shall not show entities to the user (ie. be double escaped)\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_>_text\">text &gt; text</h2></div>\n<p>section 1\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_<_text\">text &lt; text</h2></div>\n<p>section 2\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_&amp;_text\">text & text</h2></div>\n<p>section 3\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_'_text\">text ' text</h2></div>\n<p>section 4\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"text_&quot;_text\">text \" text</h2></div>\n<p>section 5\n</p>",
		"print": "<span class=\"wpb-root\">The tooltips shall not show entities to the user (ie. be double escaped)\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">text &gt; text</span>==</span>\nsection 1\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">text &lt; text</span>==</span>\nsection 2\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">text &amp; text</span>==</span>\nsection 3\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">text ' text</span>==</span>\nsection 4\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">text \" text</span>==</span>\nsection 5</span>"
	},
	{
		"desc": "Header with space, plus and underscore as entity",
		"wikitext": "Id should not contain + for spaces\n\n==Space between Text==\nsection 1\n\n==Space-Entity&#32;between&#32;Text==\nsection 2\n\n==Plus+between+Text==\nsection 3\n\n==Plus-Entity&#43;between&#43;Text==\nsection 4\n\n==Underscore_between_Text==\nsection 5\n\n==Underscore-Entity&#95;between&#95;Text==\nsection 6\n\n[[#Space between Text]]\n[[#Space-Entity&#32;between&#32;Text]]\n[[#Plus+between+Text]]\n[[#Plus-Entity&#43;between&#43;Text]]\n[[#Underscore_between_Text]]\n[[#Underscore-Entity&#95;between&#95;Text]]",
		"html": "<p>Id should not contain + for spaces\n</p>\n<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Space_between_Text\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Space between Text</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#Space-Entity_between_Text\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Space-Entity between Text</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#Plus.2Bbetween.2BText\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">Plus+between+Text</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#Plus-Entity.2Bbetween.2BText\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">Plus-Entity+between+Text</span></a></li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#Underscore_between_Text\"><span class=\"tocnumber\">5</span> <span class=\"toctext\">Underscore_between_Text</span></a></li>\n<li class=\"toclevel-1 tocsection-6\"><a href=\"#Underscore-Entity_between_Text\"><span class=\"tocnumber\">6</span> <span class=\"toctext\">Underscore-Entity_between_Text</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Space_between_Text\">Space between Text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Space between Text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 1\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Space-Entity_between_Text\">Space-Entity&#32;between&#32;Text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: Space-Entity between Text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 2\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Plus.2Bbetween.2BText\">Plus+between+Text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: Plus+between+Text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 3\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Plus-Entity.2Bbetween.2BText\">Plus-Entity&#43;between&#43;Text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: Plus-Entity+between+Text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 4\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Underscore_between_Text\">Underscore_between_Text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: Underscore_between_Text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 5\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Underscore-Entity_between_Text\">Underscore-Entity&#95;between&#95;Text</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: Underscore-Entity_between_Text\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p>section 6\n</p><p><a href=\"#Space_between_Text\">#Space between Text</a>\n<a href=\"#Space-Entity_between_Text\">#Space-Entity&#32;between&#32;Text</a>\n<a href=\"#Plus.2Bbetween.2BText\">#Plus+between+Text</a>\n<a href=\"#Plus-Entity.2Bbetween.2BText\">#Plus-Entity&#43;between&#43;Text</a>\n<a href=\"#Underscore_between_Text\">#Underscore_between_Text</a>\n<a href=\"#Underscore-Entity_between_Text\">#Underscore-Entity&#95;between&#95;Text</a>\n</p>",
		"render": "<p>Id should not contain + for spaces\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Space_between_Text\">Space between Text</h2></div>\n<p>section 1\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Space-Entity_between_Text\">Space-Entity&#32;between&#32;Text</h2></div>\n<p>section 2\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Plus+between+Text\">Plus+between+Text</h2></div>\n<p>section 3\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Plus-Entity+between+Text\">Plus-Entity&#43;between&#43;Text</h2></div>\n<p>section 4\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Underscore_between_Text\">Underscore_between_Text</h2></div>\n<p>section 5\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Underscore-Entity_between_Text\">Underscore-Entity&#95;between&#95;Text</h2></div>\n<p>section 6\n</p><p><a href=\"#Space_between_Text\">#Space between Text</a>\n<a href=\"#Space-Entity_between_Text\">#Space-Entity&#32;between&#32;Text</a>\n<a href=\"#Plus%2Bbetween%2BText\">#Plus+between+Text</a>\n<a href=\"#Plus-Entity%2Bbetween%2BText\">#Plus-Entity&#43;between&#43;Text</a>\n<a href=\"#Underscore_between_Text\">#Underscore_between_Text</a>\n<a href=\"#Underscore-Entity_between_Text\">#Underscore-Entity&#95;between&#95;Text</a>\n</p>",
		"print": "<span class=\"wpb-root\">Id should not contain + for spaces\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Space between Text</span>==</span>\nsection 1\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Space-Entity&amp;#32;between&amp;#32;Text</span>==</span>\nsection 2\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Plus+between+Text</span>==</span>\nsection 3\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Plus-Entity&amp;#43;between&amp;#43;Text</span>==</span>\nsection 4\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Underscore_between_Text</span>==</span>\nsection 5\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Underscore-Entity&amp;#95;between&amp;#95;Text</span>==</span>\nsection 6\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Space between Text</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Space-Entity&amp;#32;between&amp;#32;Text</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Plus+between+Text</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Plus-Entity&amp;#43;between&amp;#43;Text</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Underscore_between_Text</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Underscore-Entity&amp;#95;between&amp;#95;Text</span>]]</span></span>"
	},
	{
		"desc": "Headers with excess '=' characters\n(Are similar tests necessary beyond the 1st level?)",
		"wikitext": "=foo==\n==foo=\n=''italic'' heading==\n==''italic'' heading=",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#foo.3D\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">foo=</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#.3Dfoo\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">=foo</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#italic_heading.3D\"><span class=\"tocnumber\">3</span> <span class=\"toctext\"><i>italic</i> heading=</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#.3Ditalic_heading\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">=<i>italic</i> heading</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading1\"><h1 id=\"foo.3D\">foo=</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: foo=\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\".3Dfoo\">=foo</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: =foo\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"italic_heading.3D\"><i>italic</i> heading=</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: italic heading=\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\".3Ditalic_heading\">=<i>italic</i> heading</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: =italic heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading1\"><h1 id=\"foo=\">foo=</h1></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"=foo\">=foo</h1></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"italic_heading=\"><i>italic</i> heading=</h1></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"=italic_heading\">=<i>italic</i> heading</h1></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">foo=</span>=</span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=foo</span>=</span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"><span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span> heading=</span>=</span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span> heading</span>=</span></span>"
	},
	{
		"desc": "HTML headers vs TOC (T25393)\n(__NOEDITSECTION__ for clearer output, doesn't matter here)",
		"wikitext": "<h1>Header 1</h1>\n==Header 1.1==\n==Header 1.2==\n\n<h1>Header 2\n</h1>\n==Header 2.1==\n==Header 2.2==\n__NOEDITSECTION__",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1\"><a href=\"#Header_1\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Header 1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-1\"><a href=\"#Header_1.1\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Header 1.1</span></a></li>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Header_1.2\"><span class=\"tocnumber\">1.2</span> <span class=\"toctext\">Header 1.2</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1\"><a href=\"#Header_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Header 2</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#Header_2.1\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">Header 2.1</span></a></li>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#Header_2.2\"><span class=\"tocnumber\">2.2</span> <span class=\"toctext\">Header 2.2</span></a></li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading1\"><h1 id=\"Header_1\">Header 1</h1></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_1.1\">Header 1.1</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_1.2\">Header 1.2</h2></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"Header_2\">Header 2\n</h1></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_2.1\">Header 2.1</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_2.2\">Header 2.2</h2></div>",
		"render": "<h1 >Header 1</h1>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_1.1\">Header 1.1</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_1.2\">Header 1.2</h2></div>\n<h1 >Header 2\n</h1>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_2.1\">Header 2.1</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Header_2.2\">Header 2.2</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;h1&gt;</span>Header 1<span class=\"wpb-html\">&lt;/h1&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Header 1.1</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Header 1.2</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-html\">&lt;h1&gt;</span>Header 2\n<span class=\"wpb-html\">&lt;/h1&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Header 2.1</span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Header 2.2</span>==</span>\n<span class=\"wpb-double-underscore\">__NOEDITSECTION__</span></span>"
	},
	{
		"desc": "Out-of-order TOC heading levels",
		"wikitext": "==2==\n======6======\n===3===\n=1=\n=====5=====\n==2==",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#2\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">2</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#6\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">6</span></a></li>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#3\"><span class=\"tocnumber\">1.2</span> <span class=\"toctext\">3</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#1\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">1</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-5\"><a href=\"#5\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">5</span></a></li>\n<li class=\"toclevel-2 tocsection-6\"><a href=\"#2_2\"><span class=\"tocnumber\">2.2</span> <span class=\"toctext\">2</span></a></li>\n</ul>\n</li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"2\">2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"6\">6</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: 6\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"3\">3</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: 3\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"1\">1</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading5\"><h5 id=\"5\">5</h5><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: 5\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"2_2\">2</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: 2\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"2\">2</h2></div>\n<div class=\"mw-heading mw-heading6\"><h6 id=\"6\">6</h6></div>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"3\">3</h3></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"1\">1</h1></div>\n<div class=\"mw-heading mw-heading5\"><h5 id=\"5\">5</h5></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"2_2\">2</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">2</span>==</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">6</span>======</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">3</span>===</span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">1</span>=</span>\n<span class=\"wpb-heading\">=====<span class=\"wpb-heading-title\">5</span>=====</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">2</span>==</span></span>"
	},
	{
		"desc": "TOC with HTML entities which are not wikitext entities (T355386)",
		"wikitext": "__TOC__\n== F&GT ==\nTest",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> F&amp;GT </span>==</span>\nTest</span>"
	},
	{
		"desc": "TOC with french spacing (T324763)",
		"wikitext": "__TOC__\n== Renommer la page ¬´ Informatique durable ¬ª en ¬´ Num√©rique responsable ¬ª ? ==\nOui.",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> Renommer la page ¬´ Informatique durable ¬ª en ¬´ Num√©rique responsable ¬ª ? </span>==</span>\nOui.</span>"
	},
	{
		"desc": "TOC data when heading content is equal to an id already set on the page",
		"wikitext": "<span id=\"hiho\">hiho</span>\n=== hiho ===",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">hiho</span>\"</span></span>&gt;</span>hiho<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> hiho </span>===</span></span>"
	},
	{
		"desc": "TOC data when heading already has an id",
		"wikitext": "<h3 id=\"asdf\">odd</h3>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;h3<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">asdf</span>\"</span></span>&gt;</span>odd<span class=\"wpb-html\">&lt;/h3&gt;</span></span>"
	},
	{
		"desc": "Extra newlines followed by heading",
		"wikitext": "a\n\n\n=b=\n[[a]]\n\n\n=b=",
		"html": "<p>a\n</p><p><br />\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"b\">b</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: b\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"/wiki/A\" title=\"A\">a</a>\n</p><p><br />\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"b_2\">b</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: b\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<p>a\n</p><p><br>\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"b\">b</h1></div>\n<p><a href=\"/wiki/A\" title=\"A\">a</a>\n</p><p><br>\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"b_2\">b</h1></div>",
		"print": "<span class=\"wpb-root\">a\n\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">b</span>=</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">a</span>]]</span>\n\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">b</span>=</span></span>"
	},
	{
		"desc": "Extra newlines between heading and content are swallowed (Parsoid does not)",
		"wikitext": "=b=\n\n\n\n[[a]]",
		"html": "<div class=\"mw-heading mw-heading1\"><h1 id=\"b\">b</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: b\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"/wiki/A\" title=\"A\">a</a>\n</p>",
		"render": "<div class=\"mw-heading mw-heading1\"><h1 id=\"b\">b</h1></div>\n<p><a href=\"/wiki/A\" title=\"A\">a</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">b</span>=<span class=\"wpb-heading-trail\">\n\n\n</span></span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">a</span>]]</span></span>"
	},
	{
		"desc": "Heading with line break in nowiki",
		"wikitext": "==A <nowiki>B\nC</nowiki>==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"A_B_C\"><span id=\"A_B.0AC\"></span>A B\nC</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: A B&#10;C\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"A_B_C\">A B&#10;C</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">A <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">B\nC</span>&lt;/nowiki&gt;</span></span>==</span></span>"
	},
	{
		"desc": "Heading with nonbreaking space in prefix/suffix (T235684)",
		"wikitext": "== &nbsp; A &nbsp; B &nbsp; ==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"_A_B\">&#160; A &#160; B &#160;</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: ¬† A ¬† B ¬†\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"_A_B\">&nbsp; A &nbsp; B &nbsp;</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> &amp;nbsp; A &amp;nbsp; B &amp;nbsp; </span>==</span></span>"
	},
	{
		"desc": "Heading with literal wikitext - the wikitext is not parsed in section edit link tooltip",
		"wikitext": "== <nowiki>{{PAGENAME}}</nowiki> ==\n== &#123;&#123;PAGENAME}} ==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"{{PAGENAME}}\">{{PAGENAME}}</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: {{PAGENAME}}\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"{{PAGENAME}}_2\">&#123;&#123;PAGENAME}}</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: {{PAGENAME}}\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"{{PAGENAME}}\">{{PAGENAME}}</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"{{PAGENAME}}_2\">&#123;&#123;PAGENAME}}</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">{{PAGENAME}}</span>&lt;/nowiki&gt;</span> </span>==</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> &amp;#123;&amp;#123;PAGENAME}} </span>==</span></span>"
	},
	{
		"desc": "T8563: Edit link generation for section shown by <includeonly>",
		"wikitext": "{{includeonly section}}",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Includeonly_section\">Includeonly section</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Template:Includeonly_section&amp;action=edit&amp;section=T-1\" title=\"Edit section: Includeonly section\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_T-1\">Section T-1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Template:Includeonly_section&amp;action=edit&amp;section=T-2\" title=\"Edit section: Section T-1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<p><a href=\"/wiki/Template%3AIncludeonly_section?action=edit&redlink=1\" class=\"new\" title=\"Template:Includeonly_section (page does not exist)\">Template:Includeonly_section</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">includeonly section</span>}}</span></span>"
	},
	{
		"desc": "T8563: Edit link generation for section suppressed by <includeonly>",
		"wikitext": "<includeonly>\n==Includeonly section==\n</includeonly>\n==Section 1==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_1\">Section 1</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Section 1\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Section_1\">Section 1</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-include\">&lt;includeonly&gt;\n==Includeonly section==\n&lt;/includeonly&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Section 1</span>==</span></span>"
	},
	{
		"desc": "Fuzz testing: Parser14",
		"wikitext": "==onmouseover===\nhttp://__TOC__",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"onmouseover.3D\">onmouseover=</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: onmouseover=\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div><p>\nhttp://</p><div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#onmouseover.3D\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">onmouseover=</span></a></li>\n</ul>\n</div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"onmouseover=\">onmouseover=</h2></div>\n<p>http://\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">onmouseover=</span>==</span>\nhttp://<span class=\"wpb-double-underscore\">__TOC__</span></span>"
	},
	{
		"desc": "Fuzz testing: Parser14-table",
		"wikitext": "==a==\n{| STYLE=__TOC__",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"a\">a</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: a\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<table style=\"&#95;_TOC&#95;_\">\n<tbody><tr><td></td></tr>\n</tbody></table>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"a\">a</h2></div>\n<table style=\"__TOC__\">\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">a</span>==</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">STYLE</span>=<span class=\"wpb-attr-value\">__TOC__</span></span></span></span></span>"
	},
	{
		"desc": "Inclusion of !userCanEdit() content",
		"wikitext": "{{MediaWiki:Fake}}",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"header\">header</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=MediaWiki:Fake&amp;action=edit&amp;section=T-1\" title=\"Edit section: header\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"header\">header</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">MediaWiki:Fake</span>}}</span></span>"
	},
	{
		"desc": "Morwen/13: Unclosed link followed by heading",
		"wikitext": "[[link\n==heading==",
		"html": "<p>[[link\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"heading\">heading</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<p>[[link\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"heading\">heading</h2></div>",
		"print": "<span class=\"wpb-root\">[[link\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">heading</span>==</span></span>"
	},
	{
		"desc": "HHP2.1: Heuristics for headings in preprocessor parenthetical structures",
		"wikitext": "{{foo|\n=heading=",
		"html": "<p>{{foo|\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"heading\">heading</h1></div>",
		"render": "<p>{{foo|\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"heading\">heading</h1></div>",
		"print": "<span class=\"wpb-root\">{{foo|\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">heading</span>=</span></span>"
	},
	{
		"desc": "HHP2.2: Heuristics for headings in preprocessor parenthetical structures",
		"wikitext": "{{foo|\n==heading==",
		"html": "<p>{{foo|\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"heading\">heading</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: heading\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<p>{{foo|\n</p>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"heading\">heading</h2></div>",
		"print": "<span class=\"wpb-root\">{{foo|\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">heading</span>==</span></span>"
	},
	{
		"desc": "nowiki inside link inside heading (T20295)",
		"wikitext": "==[[foo|x<nowiki>y</nowiki>z]]==",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"xyz\"><a href=\"/wiki/Foo\" title=\"Foo\">xyz</a></h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: xyz\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"xyz\"><a href=\"/wiki/Foo\" title=\"Foo\">xyz</a></h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">foo</span>|<span class=\"wpb-link-text\">x<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">y</span>&lt;/nowiki&gt;</span>z</span>]]</span></span>==</span></span>"
	},
	{
		"desc": "Decoding of HTML entities in headings and links for IDs and link fragments (T103714)",
		"wikitext": "==A&B&amp;C&amp;amp;D&amp;amp;amp;E==\n[[#A&B&amp;C&amp;amp;D&amp;amp;amp;E]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">A&amp;B&amp;amp;C&amp;amp;amp;D&amp;amp;amp;amp;E</span>==</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#A&amp;B&amp;amp;C&amp;amp;amp;D&amp;amp;amp;amp;E</span>]]</span></span>"
	},
	{
		"desc": "Decoding of HTML entities in headings and links for IDs and link fragments (T103714) (legacy)",
		"wikitext": "==A&B&amp;C&amp;amp;D&amp;amp;amp;E==\n[[#A&B&amp;C&amp;amp;D&amp;amp;amp;E]]",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"A.26B.26C.26amp.3BD.26amp.3Bamp.3BE\">A&amp;B&amp;C&amp;amp;D&amp;amp;amp;E</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: A&amp;B&amp;C&amp;amp;D&amp;amp;amp;E\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"#A.26B.26C.26amp.3BD.26amp.3Bamp.3BE\">#A&amp;B&amp;C&amp;amp;D&amp;amp;amp;E</a>\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"A&amp;B&amp;C&amp;amp;D&amp;amp;amp;E\">A&B&amp;C&amp;amp;D&amp;amp;amp;E</h2></div>\n<p><a href=\"#A%26B%26C%26amp%3BD%26amp%3Bamp%3BE\">#A&B&amp;C&amp;amp;D&amp;amp;amp;E</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">A&amp;B&amp;amp;C&amp;amp;amp;D&amp;amp;amp;amp;E</span>==</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#A&amp;B&amp;amp;C&amp;amp;amp;D&amp;amp;amp;amp;E</span>]]</span></span>"
	},
	{
		"desc": "HTML5 ids: fallback to legacy",
		"wikitext": "==Foo bar==\n\n==foo Bar==\n\n==–¢–µ—Å—Ç==\n\n==–¢–µ—Å—Ç==\n\n==—Ç–µ—Å—Ç==\n\n==Hey < # \" > % : '==\n[[#Foo bar]] [[#foo Bar]] [[#–¢–µ—Å—Ç]] [[#—Ç–µ—Å—Ç]] [[#Hey < # \" > % : ']]\n\n{{anchorencode:üí©}} <span id=\"{{anchorencode:üí©}}\"></span>\n\n<!-- These two links should produce identical HTML -->\n[[#Âï§ÈÖí]] [[#%E5%95%A4%E9%85%92]]",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Foo_bar\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Foo bar</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#foo_Bar_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">foo Bar</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#–¢–µ—Å—Ç\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">–¢–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#–¢–µ—Å—Ç_2\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">–¢–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#—Ç–µ—Å—Ç\"><span class=\"tocnumber\">5</span> <span class=\"toctext\">—Ç–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-6\"><a href=\"#Hey_&lt;_#_&quot;_&gt;_%_:_&#39;\"><span class=\"tocnumber\">6</span> <span class=\"toctext\">Hey &lt; # \" &gt;&#160;%&#160;: '</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"foo_Bar_2\">foo Bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: foo Bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç\"><span id=\".D0.A2.D0.B5.D1.81.D1.82\"></span>–¢–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: –¢–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç_2\"><span id=\".D0.A2.D0.B5.D1.81.D1.82_2\"></span>–¢–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: –¢–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"—Ç–µ—Å—Ç\"><span id=\".D1.82.D0.B5.D1.81.D1.82\"></span>—Ç–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: —Ç–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hey_&lt;_#_&quot;_&gt;_%_:_'\"><span id=\"Hey_.3C_.23_.22_.3E_.25_:_.27\"></span>Hey &lt; # \" &gt;&#160;%&#160;: '</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: Hey &lt; # &quot; &gt;¬†%¬†: &#039;\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"#Foo_bar\">#Foo bar</a> <a href=\"#foo_Bar\">#foo Bar</a> <a href=\"#–¢–µ—Å—Ç\">#–¢–µ—Å—Ç</a> <a href=\"#—Ç–µ—Å—Ç\">#—Ç–µ—Å—Ç</a> <a href=\"#Hey_&lt;_#_&quot;_&gt;_%_:_&#39;\">#Hey &lt; # \" &gt;&#160;%&#160;: '</a>\n</p><p>üí© <span id=\"üí©\"></span>\n</p><p><a href=\"#Âï§ÈÖí\">#Âï§ÈÖí</a> <a href=\"#Âï§ÈÖí\">#Âï§ÈÖí</a>\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"foo_Bar_2\">foo Bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç\">–¢–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç_2\">–¢–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"—Ç–µ—Å—Ç_2\">—Ç–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hey_<_#_&quot;_>_%_:_'\">Hey &lt; # \" &gt; % : '</h2></div>\n<p><a href=\"#Foo_bar\">#Foo bar</a> <a href=\"#foo_Bar\">#foo Bar</a> <a href=\"#%D0%A2%D0%B5%D1%81%D1%82\">#–¢–µ—Å—Ç</a> <a href=\"#%D1%82%D0%B5%D1%81%D1%82\">#—Ç–µ—Å—Ç</a> <a href=\"#Hey_%3C_%23_%22_%3E_%25_%3A_'\">#Hey &lt; # \" &gt; % : '</a>\n</p>\n<pre><span id=\"\"></span>\n</pre>\n<p><a href=\"#%E5%95%A4%E9%85%92\">#Âï§ÈÖí</a> <a href=\"#%E5%95%A4%E9%85%92\">#Âï§ÈÖí</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo bar</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">foo Bar</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">–¢–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">–¢–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">—Ç–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Hey &lt; # \" &gt; % : '</span>==</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Foo bar</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#foo Bar</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#–¢–µ—Å—Ç</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#—Ç–µ—Å—Ç</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Hey &lt; # \" &gt; % : '</span>]]</span>\n\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">üí©</span></span>}}</span> <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">üí©</span></span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-comment\">&lt;!-- These two links should produce identical HTML --&gt;</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Âï§ÈÖí</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#%E5%95%A4%E9%85%92</span>]]</span></span>"
	},
	{
		"desc": "HTML5 ids: legacy with a fallback to modern",
		"wikitext": "==Foo bar==\n\n==foo Bar==\n\n==–¢–µ—Å—Ç==\n\n==–¢–µ—Å—Ç==\n\n==—Ç–µ—Å—Ç==\n\n==Hey < # \" > % : '==\n[[#Foo bar]] [[#foo Bar]] [[#–¢–µ—Å—Ç]] [[#—Ç–µ—Å—Ç]] [[#Hey < # \" > % : ']]\n\n{{anchorencode:üí©}} <span id=\"{{anchorencode:üí©}}\"></span>\n\n<!-- These two links should produce identical HTML -->\n[[#Âï§ÈÖí]] [[#%E5%95%A4%E9%85%92]]",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Foo_bar\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Foo bar</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#foo_Bar_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">foo Bar</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#.D0.A2.D0.B5.D1.81.D1.82\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">–¢–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#.D0.A2.D0.B5.D1.81.D1.82_2\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">–¢–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#.D1.82.D0.B5.D1.81.D1.82\"><span class=\"tocnumber\">5</span> <span class=\"toctext\">—Ç–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-6\"><a href=\"#Hey_.3C_.23_.22_.3E_.25_:_.27\"><span class=\"tocnumber\">6</span> <span class=\"toctext\">Hey &lt; # \" &gt;&#160;%&#160;: '</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"foo_Bar_2\">foo Bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: foo Bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\".D0.A2.D0.B5.D1.81.D1.82\"><span id=\"–¢–µ—Å—Ç\"></span>–¢–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: –¢–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\".D0.A2.D0.B5.D1.81.D1.82_2\"><span id=\"–¢–µ—Å—Ç_2\"></span>–¢–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: –¢–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\".D1.82.D0.B5.D1.81.D1.82\"><span id=\"—Ç–µ—Å—Ç\"></span>—Ç–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: —Ç–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hey_.3C_.23_.22_.3E_.25_:_.27\"><span id=\"Hey_&lt;_#_&quot;_&gt;_%_:_'\"></span>Hey &lt; # \" &gt;&#160;%&#160;: '</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: Hey &lt; # &quot; &gt;¬†%¬†: &#039;\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"#Foo_bar\">#Foo bar</a> <a href=\"#foo_Bar\">#foo Bar</a> <a href=\"#.D0.A2.D0.B5.D1.81.D1.82\">#–¢–µ—Å—Ç</a> <a href=\"#.D1.82.D0.B5.D1.81.D1.82\">#—Ç–µ—Å—Ç</a> <a href=\"#Hey_.3C_.23_.22_.3E_.25_:_.27\">#Hey &lt; # \" &gt;&#160;%&#160;: '</a>\n</p><p>.F0.9F.92.A9 <span id=\".F0.9F.92.A9\"></span>\n</p><p><a href=\"#.E5.95.A4.E9.85.92\">#Âï§ÈÖí</a> <a href=\"#.E5.95.A4.E9.85.92\">#Âï§ÈÖí</a>\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"foo_Bar_2\">foo Bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç\">–¢–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç_2\">–¢–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"—Ç–µ—Å—Ç_2\">—Ç–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hey_<_#_&quot;_>_%_:_'\">Hey &lt; # \" &gt; % : '</h2></div>\n<p><a href=\"#Foo_bar\">#Foo bar</a> <a href=\"#foo_Bar\">#foo Bar</a> <a href=\"#%D0%A2%D0%B5%D1%81%D1%82\">#–¢–µ—Å—Ç</a> <a href=\"#%D1%82%D0%B5%D1%81%D1%82\">#—Ç–µ—Å—Ç</a> <a href=\"#Hey_%3C_%23_%22_%3E_%25_%3A_'\">#Hey &lt; # \" &gt; % : '</a>\n</p>\n<pre><span id=\"\"></span>\n</pre>\n<p><a href=\"#%E5%95%A4%E9%85%92\">#Âï§ÈÖí</a> <a href=\"#%E5%95%A4%E9%85%92\">#Âï§ÈÖí</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo bar</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">foo Bar</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">–¢–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">–¢–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">—Ç–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Hey &lt; # \" &gt; % : '</span>==</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Foo bar</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#foo Bar</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#–¢–µ—Å—Ç</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#—Ç–µ—Å—Ç</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Hey &lt; # \" &gt; % : '</span>]]</span>\n\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">üí©</span></span>}}</span> <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">üí©</span></span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-comment\">&lt;!-- These two links should produce identical HTML --&gt;</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Âï§ÈÖí</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#%E5%95%A4%E9%85%92</span>]]</span></span>"
	},
	{
		"desc": "HTML5 ids: no legacy",
		"wikitext": "==Foo bar==\n\n==foo Bar==\n\n==–¢–µ—Å—Ç==\n\n==–¢–µ—Å—Ç==\n\n==—Ç–µ—Å—Ç==\n\n==Hey < # \" > % : '==\n[[#Foo bar]] [[#foo Bar]] [[#–¢–µ—Å—Ç]] [[#—Ç–µ—Å—Ç]] [[#Hey < # \" > % : ']]\n\n{{anchorencode:üí©}} <span id=\"{{anchorencode:üí©}}\"></span>\n\n<!-- These two links should produce identical HTML -->\n[[#Âï§ÈÖí]] [[#%E5%95%A4%E9%85%92]]",
		"html": "<div id=\"toc\" class=\"toc\" role=\"navigation\" aria-labelledby=\"mw-toc-heading\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2 id=\"mw-toc-heading\">Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Foo_bar\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Foo bar</span></a></li>\n<li class=\"toclevel-1 tocsection-2\"><a href=\"#foo_Bar_2\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">foo Bar</span></a></li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#–¢–µ—Å—Ç\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">–¢–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#–¢–µ—Å—Ç_2\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">–¢–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#—Ç–µ—Å—Ç\"><span class=\"tocnumber\">5</span> <span class=\"toctext\">—Ç–µ—Å—Ç</span></a></li>\n<li class=\"toclevel-1 tocsection-6\"><a href=\"#Hey_&lt;_#_&quot;_&gt;_%_:_&#39;\"><span class=\"tocnumber\">6</span> <span class=\"toctext\">Hey &lt; # \" &gt;&#160;%&#160;: '</span></a></li>\n</ul>\n</div>\n\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"foo_Bar_2\">foo Bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: foo Bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç\">–¢–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: –¢–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç_2\">–¢–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=4\" title=\"Edit section: –¢–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"—Ç–µ—Å—Ç\">—Ç–µ—Å—Ç</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=5\" title=\"Edit section: —Ç–µ—Å—Ç\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hey_&lt;_#_&quot;_&gt;_%_:_'\">Hey &lt; # \" &gt;&#160;%&#160;: '</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=6\" title=\"Edit section: Hey &lt; # &quot; &gt;¬†%¬†: &#039;\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"#Foo_bar\">#Foo bar</a> <a href=\"#foo_Bar\">#foo Bar</a> <a href=\"#–¢–µ—Å—Ç\">#–¢–µ—Å—Ç</a> <a href=\"#—Ç–µ—Å—Ç\">#—Ç–µ—Å—Ç</a> <a href=\"#Hey_&lt;_#_&quot;_&gt;_%_:_&#39;\">#Hey &lt; # \" &gt;&#160;%&#160;: '</a>\n</p><p>üí© <span id=\"üí©\"></span>\n</p><p><a href=\"#Âï§ÈÖí\">#Âï§ÈÖí</a> <a href=\"#Âï§ÈÖí\">#Âï§ÈÖí</a>\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"foo_Bar_2\">foo Bar</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç\">–¢–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"–¢–µ—Å—Ç_2\">–¢–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"—Ç–µ—Å—Ç_2\">—Ç–µ—Å—Ç</h2></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"Hey_<_#_&quot;_>_%_:_'\">Hey &lt; # \" &gt; % : '</h2></div>\n<p><a href=\"#Foo_bar\">#Foo bar</a> <a href=\"#foo_Bar\">#foo Bar</a> <a href=\"#%D0%A2%D0%B5%D1%81%D1%82\">#–¢–µ—Å—Ç</a> <a href=\"#%D1%82%D0%B5%D1%81%D1%82\">#—Ç–µ—Å—Ç</a> <a href=\"#Hey_%3C_%23_%22_%3E_%25_%3A_'\">#Hey &lt; # \" &gt; % : '</a>\n</p>\n<pre><span id=\"\"></span>\n</pre>\n<p><a href=\"#%E5%95%A4%E9%85%92\">#Âï§ÈÖí</a> <a href=\"#%E5%95%A4%E9%85%92\">#Âï§ÈÖí</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo bar</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">foo Bar</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">–¢–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">–¢–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">—Ç–µ—Å—Ç</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Hey &lt; # \" &gt; % : '</span>==</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Foo bar</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#foo Bar</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#–¢–µ—Å—Ç</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#—Ç–µ—Å—Ç</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Hey &lt; # \" &gt; % : '</span>]]</span>\n\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">üí©</span></span>}}</span> <span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">anchorencode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">üí©</span></span>}}</span></span>\"</span></span>&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-comment\">&lt;!-- These two links should produce identical HTML --&gt;</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Âï§ÈÖí</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#%E5%95%A4%E9%85%92</span>]]</span></span>"
	},
	{
		"desc": "T90902: Normalize weird characters in section IDs",
		"wikitext": "==Foo&nbsp;bar==\n[[#Foo&nbsp;bar]]",
		"html": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo&#160;bar</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Foo¬†bar\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<p><a href=\"#Foo_bar\">#Foo&#160;bar</a>\n</p>",
		"render": "<div class=\"mw-heading mw-heading2\"><h2 id=\"Foo_bar\">Foo&nbsp;bar</h2></div>\n<p><a href=\"#Foo_bar\">#Foo&nbsp;bar</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Foo&amp;nbsp;bar</span>==</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">#Foo&amp;nbsp;bar</span>]]</span></span>"
	},
	{
		"desc": "mw-heading wrapper edge cases",
		"wikitext": "==Normal heading!==\n\n<h2>HTML heading!</h2>\n\n<h2 style=\"border: 1px solid green; background: lightgreen; padding: 5px; font-size: 1.5em;\">HTML heading with attributes!</h2>\n\n<div class=\"mw-heading mw-heading2\">\n==Normal heading with existing wrapper!==\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Normal heading!</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-html\">&lt;h2&gt;</span>HTML heading!<span class=\"wpb-html\">&lt;/h2&gt;</span>\n\n<span class=\"wpb-html\">&lt;h2<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">border: 1px solid green; background: lightgreen; padding: 5px; font-size: 1.5em;</span>\"</span></span>&gt;</span>HTML heading with attributes!<span class=\"wpb-html\">&lt;/h2&gt;</span>\n\n<span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">mw-heading mw-heading2</span>\"</span></span>&gt;</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">Normal heading with existing wrapper!</span>==</span>\n<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "T365413: Headings with dollar signs",
		"wikitext": "==$text==\n\n==$ text==\n\n==text $text==\n\n==\\$text==\n\n==$$text==",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">$text</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">$ text</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">text $text</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">\\$text</span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">$$text</span>==</span></span>"
	},
	{
		"desc": "T368334: Headings from template titles that would need uri encoding",
		"wikitext": "{{With a section?}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">With a section?</span>}}</span></span>"
	},
	{
		"desc": "indentPre"
	},
	{
		"desc": "Preformatted text",
		"wikitext": " This is some\n Preformatted text\n With ''italic''\n And '''bold'''\n And a [[Main Page|link]]",
		"html": "<pre>This is some\nPreformatted text\nWith <i>italic</i>\nAnd <b>bold</b>\nAnd a <a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a>\n</pre>",
		"render": "<pre>This is some\nPreformatted text\nWith <i>italic</i>\nAnd <b>bold</b>\nAnd a <a href=\"/wiki/Main_Page\" title=\"Main Page\">link</a>\n</pre>",
		"print": "<span class=\"wpb-root\"> This is some\n Preformatted text\n With <span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>\n And <span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>\n And a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">link</span>]]</span></span>"
	},
	{
		"desc": "Tabs don't trigger preformatted text",
		"wikitext": "\tThis is not\n\t preformatted text.\n This is preformatted text.\n \tSo is this.",
		"html": "<p>\tThis is not\n\t preformatted text.\n</p>\n<pre>This is preformatted text.\n\tSo is this.\n</pre>",
		"render": "<p>\tThis is not\n\t preformatted text.\n</p>\n<pre>This is preformatted text.\n\tSo is this.\n</pre>",
		"print": "<span class=\"wpb-root\">\tThis is not\n\t preformatted text.\n This is preformatted text.\n \tSo is this.</span>"
	},
	{
		"desc": "Space before tab needs nowiki pre protection",
		"wikitext": "a",
		"print": "<span class=\"wpb-root\">a</span>"
	},
	{
		"desc": "Indent preformatting with inline content",
		"wikitext": " a\n ''b''",
		"html": "<pre>a\n<i>b</i>\n</pre>",
		"render": "<pre>a\n<i>b</i>\n</pre>",
		"print": "<span class=\"wpb-root\"> a\n <span class=\"wpb-quote\">''</span>b<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "<pre> with <nowiki> inside (compatibility with 1.6 and earlier)",
		"wikitext": "<pre><nowiki>\n<b>\n<cite>\n<em>\n</nowiki></pre>",
		"html": "<pre>&lt;b&gt;\n&lt;cite&gt;\n&lt;em&gt;\n</pre>",
		"render": "<pre >&#10;&lt;b&gt;&#10;&lt;cite&gt;&#10;&lt;em&gt;&#10;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">&lt;nowiki&gt;</span>\n&lt;b&gt;\n&lt;cite&gt;\n&lt;em&gt;\n<span class=\"wpb-noinclude\">&lt;/nowiki&gt;</span></span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Regression with preformatted in <center>",
		"wikitext": "<center>\n Blah\n</center>",
		"html": "<center>\n<pre>Blah\n</pre>\n</center>",
		"render": "<center >\n<pre>Blah\n</pre>\n</center>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;center&gt;</span>\n Blah\n<span class=\"wpb-html\">&lt;/center&gt;</span></span>"
	},
	{
		"desc": "T54763: Preformatted in <blockquote>",
		"wikitext": "<blockquote>\n Blah\n{|\n|\n indented cell (no pre-wrapping!)\n|}\n</blockquote>",
		"html": "<blockquote>\n<p> Blah\n</p>\n<table>\n<tbody><tr>\n<td>\n<p> indented cell (no pre-wrapping!)\n</p>\n</td></tr></tbody></table>\n</blockquote>",
		"render": "<blockquote >\n<p> Blah\n</p>\n<table >\n<tbody><tr>\n<td >\n<p> indented cell (no pre-wrapping!)\n</p>\n</td></tr></tbody></table>\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\n Blah\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n indented cell (no pre-wrapping!)</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "Templates: Indent-Pre: 1a. Templates that break a line should suppress <pre>",
		"wikitext": " {{1x|}}",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|}}</span></span>"
	},
	{
		"desc": "Templates: Indent-Pre: 1b. Templates that break a line should suppress <pre>",
		"wikitext": " {{1x|\nfoo}}",
		"html": "<p>foo\n</p>",
		"render": "<p>foo\n</p>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\nfoo</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Indent-Pre: 1c: Wrapping should be based on expanded content",
		"wikitext": " {{1x|a\nb}}",
		"html": "<pre>a\n</pre>\n<p>b\n</p>",
		"render": "<pre>a\n</pre>\n<p>b\n</p>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\nb</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Indent-Pre: 1d: Wrapping should be based on expanded content",
		"wikitext": " {{1x|a\nb\nc\n d\ne\n}}",
		"html": "<pre>a\n</pre>\n<p>b\nc\n</p>\n<pre>d\n</pre>\n<p>e\n</p>",
		"render": "<pre>a\n</pre>\n<p>b\nc\n</p>\n<pre>d\n</pre>\n<p>e\n</p>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\nb\nc\n d\ne\n</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Indent-Pre: 1e. Wrapping should be based on expanded content",
		"wikitext": "{{1x| foo}}\n\n{{1x| foo}}{{1x| bar}}\n\n{{1x| foo}}\n{{1x| bar}}\n\n{{1x|<!--cmt--> foo}}\n\n<!--cmt-->{{1x| foo}}\n\n{{1x|{{1x| }}bar}}",
		"html": "<pre>foo\n</pre>\n<pre>foo bar\n</pre>\n<pre>foo\nbar\n</pre>\n<pre>foo\n</pre>\n<pre>foo\n</pre>\n<pre>bar\n</pre>",
		"render": "<pre>foo\n</pre>\n<pre>foo bar\n</pre>\n<pre>foo\nbar\n</pre>\n<pre>foo\n</pre>\n<pre>foo\n</pre>\n<pre>bar\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo</span></span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> bar</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> bar</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-comment\">&lt;!--cmt--&gt;</span> foo</span></span>}}</span>\n\n<span class=\"wpb-comment\">&lt;!--cmt--&gt;</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> foo</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>}}</span>bar</span></span>}}</span></span>"
	},
	{
		"desc": "Templates: Indent-Pre: 1f: Wrapping should be based on expanded content",
		"wikitext": "{{1x| }}a\n\n{{1x|\n }}a\n\n{{1x|\n b}}\n\n{{1x|a\n }}b\n\n{{1x|a\n}} b",
		"html": "<pre>a\n</pre>\n<p><br />\n</p>\n<pre>a\n</pre>\n<p><br />\n</p>\n<pre>b\n</pre>\n<p>a\n</p>\n<pre>b\n</pre>\n<p>a\n</p>\n<pre>b\n</pre>",
		"render": "<pre>a\n</pre>\n<p><br>\n</p>\n<pre>a\n</pre>\n<p><br>\n</p>\n<pre>b\n</pre>\n<p>a\n</p>\n<pre>b\n</pre>\n<p>a\n</p>\n<pre>b\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> </span></span>}}</span>a\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n </span></span>}}</span>a\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n b</span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\n </span></span>}}</span>b\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a\n</span></span>}}</span> b</span>"
	},
	{
		"desc": "Off-by-1 DSR values: Regression test for indent-pre usages",
		"wikitext": " {{1x|\n}} ''{{1x|\n}} X'' {{1x|<span></span>\n}} Y",
		"html": "<pre><i></i>\nX<i> <span></span></i>\nY\n</pre>",
		"render": "<pre><i></i>\nX<i> </i><span ></span>\nY\n</pre>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n</span></span>}}</span> <span class=\"wpb-quote\">''</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n</span></span>}}</span> X<span class=\"wpb-quote\">''</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n</span></span>}}</span> Y</span>"
	},
	{
		"desc": "Ensure DSR values for mw:DisplaySpace spans are computed correctly",
		"wikitext": " x\n y :)",
		"html": "<pre>x\ny&#160;:)\n</pre>",
		"render": "<pre>x\ny :)\n</pre>",
		"print": "<span class=\"wpb-root\"> x\n y :)</span>"
	},
	{
		"desc": "pwrap test",
		"wikitext": "{{T1}}{{T1}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">T1</span>}}</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">T1</span>}}</span></span>"
	},
	{
		"desc": "1a. Indent-Pre and Comments",
		"wikitext": " a\n<!--a-->\nc",
		"html": "<pre>a\n</pre>\n<p>c\n</p>",
		"render": "<pre>a\n</pre>\n<p>c\n</p>",
		"print": "<span class=\"wpb-root\"> a\n<span class=\"wpb-comment\">&lt;!--a--&gt;</span>\nc</span>"
	},
	{
		"desc": "1b. Indent-Pre and Comments",
		"wikitext": " a\n <!--a-->\nc",
		"html": "<pre>a\n</pre>\n<p>c\n</p>",
		"render": "<pre>a\n</pre>\n<p>c\n</p>",
		"print": "<span class=\"wpb-root\"> a\n <span class=\"wpb-comment\">&lt;!--a--&gt;</span>\nc</span>"
	},
	{
		"desc": "1c. Indent-Pre and Comments",
		"wikitext": "<!--a-->  a\n\n <!--a--> a",
		"html": "<pre> a\n</pre>\n<pre> a\n</pre>",
		"render": "<pre> a\n</pre>\n<pre> a\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--a--&gt;</span>  a\n\n <span class=\"wpb-comment\">&lt;!--a--&gt;</span> a</span>"
	},
	{
		"desc": "1d. Indent-Pre and Comments\n(Pre-handler currently cannot distinguish between comment/ws order and normalizes them to [comment,ws] order)",
		"wikitext": "<!--a--> a\n\n <!--b-->b",
		"html": "<pre>a\n</pre>\n<pre>b\n</pre>",
		"render": "<pre>a\n</pre>\n<pre>b\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--a--&gt;</span> a\n\n <span class=\"wpb-comment\">&lt;!--b--&gt;</span>b</span>"
	},
	{
		"desc": "2a. Indent-Pre and tables",
		"wikitext": " {|\n |-\n !h1!!h2\n |foo||bar\n |}",
		"html": "<table>\n\n<tbody><tr>\n<th>h1</th>\n<th>h2\n</th>\n<td>foo</td>\n<td>bar\n</td></tr></tbody></table>",
		"render": " <table >\n<tbody><tr >\n<th >h1</th>\n<th >h2\n</th>\n<td >foo</td>\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n |-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n !</span><span class=\"wpb-td-inner\">h1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">h2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">bar</span></span></span><span class=\"wpb-table-syntax\">\n |}</span></span></span>"
	},
	{
		"desc": "2b. Indent-Pre and tables",
		"wikitext": "  {|\n |-\n|foo\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "  <table >\n<tbody><tr >\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\">  <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n |-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2c. Indent-Pre and tables (T44252)",
		"wikitext": "{|\n |+foo\n !  |bar\n|}",
		"html": "<table>\n<caption>foo\n</caption>\n<tbody><tr>\n<th>bar\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<caption >foo</caption>\n<th >bar\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |+</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n !</span><span class=\"wpb-table-attrs\">  </span>|<span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2d. Indent-Pre and tables",
		"wikitext": " a\n {|\n |b\n |}",
		"html": "<pre>a\n</pre>\n<table>\n<tbody><tr>\n<td>b\n</td></tr></tbody></table>",
		"render": "<pre>a\n</pre>\n <table >\n<tbody><tr>\n<td >b\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"> a\n <span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">b</span></span><span class=\"wpb-table-syntax\">\n |}</span></span></span>"
	},
	{
		"desc": "2e. Indent-Pre and table-line syntax",
		"wikitext": " a\n | b\n | c",
		"html": "<pre>a\n| b\n| c\n</pre>",
		"render": "<pre>a\n| b\n| c\n</pre>",
		"print": "<span class=\"wpb-root\"> a\n | b\n | c</span>"
	},
	{
		"desc": "2f. Indent-pre started by table-line syntax",
		"wikitext": "a\n | b\n | c",
		"html": "<p>a\n</p>\n<pre>| b\n| c\n</pre>",
		"render": "<p>a\n</p>\n<pre>| b\n| c\n</pre>",
		"print": "<span class=\"wpb-root\">a\n | b\n | c</span>"
	},
	{
		"desc": "2g. Indented table markup mixed with indented pre content (proposed in T8200)",
		"wikitext": " <table>\n <tr>\n <td>\n Text that should be rendered preformatted\n </td>\n </tr>\n </table>",
		"html": "<table>\n <tbody><tr>\n <td>\n<pre>Text that should be rendered preformatted\n</pre>\n </td>\n </tr>\n </tbody></table>",
		"render": " <table >\n <tr >\n <td >\n<pre>Text that should be rendered preformatted\n</pre>\n </td>\n </tr>\n </table>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-html\">&lt;table&gt;</span>\n <span class=\"wpb-html\">&lt;tr&gt;</span>\n <span class=\"wpb-html\">&lt;td&gt;</span>\n Text that should be rendered preformatted\n <span class=\"wpb-html\">&lt;/td&gt;</span>\n <span class=\"wpb-html\">&lt;/tr&gt;</span>\n <span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "2h. Indent pre in tables",
		"wikitext": "{|\n !\n foo\n !\n bar\n |-\n |\n baz\n {{!}}\n bam\n |}",
		"html": "<table>\n<tbody><tr>\n<th>\n<pre>foo\n</pre>\n</th>\n<th>\n<pre>bar\n</pre>\n</th></tr>\n<tr>\n<td>\n<pre>baz\n</pre>\n</td>\n<td>\n<pre>bam\n</pre>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >\n<pre>foo\n</pre>\n</th>\n<th >\n<pre>bar\n</pre>\n</th></tr><tr >\n<td >\n<pre>baz\n</pre>\n</td>\n<td >\n<pre>bam\n</pre>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n !</span><span class=\"wpb-td-inner\">\n foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n !</span><span class=\"wpb-td-inner\">\n bar</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n |-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n |</span><span class=\"wpb-td-inner\">\n baz</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td-inner\">\n bam</span></span></span><span class=\"wpb-table-syntax\">\n |}</span></span></span>"
	},
	{
		"desc": "3a. Indent-Pre and block tags (single-line html)",
		"wikitext": " a <p> foo </p>\n b <div> foo </div>\n c <blockquote> foo </blockquote>\n <span> foo </span>",
		"html": "<p> a </p><p> foo </p><p>\n b </p><div> foo </div><p>\n c </p><blockquote><p> foo </p></blockquote>\n<pre><span> foo </span>\n</pre>",
		"render": " a <p > foo </p>\n b <div > foo </div>\n c <blockquote > foo </blockquote>\n<pre><span > foo </span>\n</pre>",
		"print": "<span class=\"wpb-root\"> a <span class=\"wpb-html\">&lt;p&gt;</span> foo <span class=\"wpb-html\">&lt;/p&gt;</span>\n b <span class=\"wpb-html\">&lt;div&gt;</span> foo <span class=\"wpb-html\">&lt;/div&gt;</span>\n c <span class=\"wpb-html\">&lt;blockquote&gt;</span> foo <span class=\"wpb-html\">&lt;/blockquote&gt;</span>\n <span class=\"wpb-html\">&lt;span&gt;</span> foo <span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "3b. Indent-Pre and block tags (multi-line html)",
		"wikitext": " a <span>foo</span>\n<!-- comment --> b <div> foo </div>",
		"html": "<pre>a <span>foo</span>\n</pre><p>\n b </p><div> foo </div>",
		"render": "<pre>a <span >foo</span>\n</pre>\n b <div > foo </div>",
		"print": "<span class=\"wpb-root\"> a <span class=\"wpb-html\">&lt;span&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-comment\">&lt;!-- comment --&gt;</span> b <span class=\"wpb-html\">&lt;div&gt;</span> foo <span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "3c. Indent-Pre and block tags (pre-content on separate line)",
		"wikitext": "<p>\n foo\n</p>\n\n<div>\n foo\n</div>\n\n<center>\n foo\n</center>\n\n<blockquote>\n foo\n</blockquote>\n\n<blockquote>\n<pre>\nfoo\n</pre>\n</blockquote>\n\n<table><tr><td>\n foo\n</td></tr></table>\n\n<ul><li>\n  foo\n</li></ul>",
		"html": "<p>\n foo\n</p>\n<div>\n<pre>foo\n</pre>\n</div>\n<center>\n<pre>foo\n</pre>\n</center>\n<blockquote>\n<p> foo\n</p>\n</blockquote>\n<blockquote>\n<pre>foo\n</pre>\n</blockquote>\n<table><tbody><tr><td>\n<pre>foo\n</pre>\n</td></tr></tbody></table>\n<ul><li>\n  foo\n</li></ul>",
		"render": "<p >\n foo\n</p>\n<div >\n<pre>foo\n</pre>\n</div>\n<center >\n<pre>foo\n</pre>\n</center>\n<blockquote >\n<p> foo\n</p>\n</blockquote>\n<blockquote >\n<pre >&#10;foo&#10;</pre>\n</blockquote>\n<table ><tr ><td >\n<pre>foo\n</pre>\n</td></tr></table>\n<ul ><li >\n  foo\n</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p&gt;</span>\n foo\n<span class=\"wpb-html\">&lt;/p&gt;</span>\n\n<span class=\"wpb-html\">&lt;div&gt;</span>\n foo\n<span class=\"wpb-html\">&lt;/div&gt;</span>\n\n<span class=\"wpb-html\">&lt;center&gt;</span>\n foo\n<span class=\"wpb-html\">&lt;/center&gt;</span>\n\n<span class=\"wpb-html\">&lt;blockquote&gt;</span>\n foo\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span>\n\n<span class=\"wpb-html\">&lt;blockquote&gt;</span>\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\nfoo\n</span>&lt;/pre&gt;</span>\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span>\n\n<span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>\n foo\n<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span>\n\n<span class=\"wpb-html\">&lt;ul&gt;</span><span class=\"wpb-html\">&lt;li&gt;</span>\n  foo\n<span class=\"wpb-html\">&lt;/li&gt;</span><span class=\"wpb-html\">&lt;/ul&gt;</span></span>"
	},
	{
		"desc": "5. Indent-Pre and html pre",
		"wikitext": " <pre class=\"123\">hi</pre>",
		"html": "<pre class=\"123\">hi</pre>",
		"render": " <pre class=\"123\">hi</pre>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">hi</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Serializing indent pre at sol",
		"wikitext": " hi",
		"html": "<pre>hi\n</pre>",
		"render": "<pre>hi\n</pre>",
		"print": "<span class=\"wpb-root\"> hi</span>"
	},
	{
		"desc": "Render paragraphs when indent-pre is suppressed in blocklevels",
		"wikitext": "<blockquote>\n foo\n\n bar\n</blockquote>",
		"html": "<blockquote>\n<p> foo\n</p><p> bar\n</p>\n</blockquote>",
		"render": "<blockquote >\n<p> foo\n</p><p> bar\n</p>\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\n foo\n\n bar\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "4. Multiple spaces at start-of-line",
		"wikitext": "    <p> foo </p>\n    foo\n\t{|\n|foo\n|}",
		"html": "<p> foo </p>\n<pre>   foo\n</pre>\n<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "    <p > foo </p>\n<pre>   foo\n</pre>\n\t<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\">    <span class=\"wpb-html\">&lt;p&gt;</span> foo <span class=\"wpb-html\">&lt;/p&gt;</span>\n    foo\n\t<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "5a. White-space in indent-pre",
		"wikitext": " a<br />\n \n b",
		"html": "<pre>a<br />\n\nb\n</pre>",
		"render": "<pre>a<br >\n\nb\n</pre>",
		"print": "<span class=\"wpb-root\"> a<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>\n \n b</span>"
	},
	{
		"desc": "5b. White-space in indent-pre",
		"wikitext": " a\n \n b\n \n \n c",
		"html": "<pre>a\n\nb\n\n\nc\n</pre>",
		"render": "<pre>a\n\nb\n\n\nc\n</pre>",
		"print": "<span class=\"wpb-root\"> a\n \n b\n \n \n c</span>"
	},
	{
		"desc": "5c. White-space in indent-pre",
		"wikitext": " ''a''\n  ''b''\n   ''c''",
		"html": "<pre><i>a</i>\n <i>b</i>\n  <i>c</i>\n</pre>",
		"render": "<pre><i>a</i>\n <i>b</i>\n  <i>c</i>\n</pre>",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-quote\">''</span>a<span class=\"wpb-quote\">''</span>\n  <span class=\"wpb-quote\">''</span>b<span class=\"wpb-quote\">''</span>\n   <span class=\"wpb-quote\">''</span>c<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "6. Pre-blocks should extend across lines with leading WS even when there is no wrappable content",
		"wikitext": " a\n \n <!-- continue -->\n b\n\n c\n \nd",
		"html": "<pre>a\n\nb\n</pre>\n<pre>c\n\n</pre>\n<p>d\n</p>",
		"render": "<pre>a\n\nb\n</pre>\n<pre>c\n\n</pre>\n<p>d\n</p>",
		"print": "<span class=\"wpb-root\"> a\n \n <span class=\"wpb-comment\">&lt;!-- continue --&gt;</span>\n b\n\n c\n \nd</span>"
	},
	{
		"desc": "7a. Indent-pre and category links",
		"wikitext": " [[Category:foo]] <!-- No pre-wrapping -->\n{{1x| [[Category:foo]]}} <!-- No pre-wrapping -->",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:foo</span>]]</span> <span class=\"wpb-comment\">&lt;!-- No pre-wrapping --&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:foo</span>]]</span></span></span>}}</span> <span class=\"wpb-comment\">&lt;!-- No pre-wrapping --&gt;</span></span>"
	},
	{
		"desc": "7b. Indent-pre and category links",
		"wikitext": " [[Category:foo]] a\n [[Category:foo]] {{1x|b}}",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:foo</span>]]</span> a\n <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:foo</span>]]</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span></span>"
	},
	{
		"desc": "Indent-Pre: Newlines in comments shouldn't affect sol state",
		"wikitext": "a <!--\nfoo\n--> b",
		"html": "<p>a  b\n</p>",
		"render": "<p>a  b\n</p>",
		"print": "<span class=\"wpb-root\">a <span class=\"wpb-comment\">&lt;!--\nfoo\n--&gt;</span> b</span>"
	},
	{
		"desc": "Indent pre with leading colon",
		"wikitext": " :foo",
		"html": "<pre>:foo\n</pre>",
		"render": "<pre>:foo\n</pre>",
		"print": "<span class=\"wpb-root\"> :foo</span>"
	},
	{
		"desc": "Indent-Pre regression test: Trailing whitespace after sol-transparent content",
		"wikitext": "[[Category:Foo]]   \n[[Category:Bar]]",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>   \n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Bar</span>]]</span></span>"
	},
	{
		"desc": "Preserving leading whitespace in indent-pre suppressing contexts",
		"wikitext": "<ol>\n<li>\n foo\n bar\n</li>\n</ol>",
		"html": "<ol>\n<li>\n foo\n bar\n</li>\n</ol>",
		"render": "<ol >\n<li >\n foo\n bar\n</li>\n</ol>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;ol&gt;</span>\n<span class=\"wpb-html\">&lt;li&gt;</span>\n foo\n bar\n<span class=\"wpb-html\">&lt;/li&gt;</span>\n<span class=\"wpb-html\">&lt;/ol&gt;</span></span>"
	},
	{
		"desc": "indicators"
	},
	{
		"desc": "Page status indicators: Empty name is invalid",
		"wikitext": "<indicator name=\" \"></indicator>\n<indicator></indicator>",
		"html": "<p><span class=\"error\"><strong>Error:</strong> Page status indicators' <code>name</code> attribute must not be empty.</span>\n<span class=\"error\"><strong>Error:</strong> Page status indicators' <code>name</code> attribute must not be empty.</span>\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\"> </span>\"</span></span>&gt;&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator&gt;&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "Page status indicators: Weird syntaxes that are okay",
		"wikitext": "<indicator name=\"empty\" />\n<indicator name=\"name\"></indicator>",
		"html": "<p><br />\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">empty</span>\"</span> </span>/&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">name</span>\"</span></span>&gt;&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "Page status indicators: Stress test",
		"wikitext": "<indicator name=\"01\">hello world</indicator>\n<indicator name=\"02\">[[Main Page]]</indicator>\n<indicator name=\"03\">[[File:Foobar.jpg|25px|link=]]</indicator>\n<indicator name=\"04\">[[File:Foobar.jpg|25px]]</indicator>\n<indicator name=\"05\">*foo\n*bar</indicator>\n<indicator name=\"06\"><nowiki>foo</nowiki></indicator>\n<indicator name=\"07\"> Preformatted</indicator>\n<indicator name=\"08\"><div>Broken tag</indicator>\n<indicator name=\"09\">{| class=wikitable\n|cell\n|}</indicator>\n<indicator name=\"10\">Two\n\nparagraphs</indicator>",
		"html": "<p><br />\n</p><p><br />\n</p><p><br />\n</p><p><br />\n</p><p><br />\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">01</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">hello world</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">02</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">03</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">25</span>px</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>]]</span></span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">04</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">25</span>px</span>]]</span></span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">05</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">*foo\n<span class=\"wpb-list\">*</span>bar</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">06</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/nowiki&gt;</span></span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">07</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"> Preformatted</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">08</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-html\">&lt;div&gt;</span>Broken tag</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">09</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">{| class=wikitable\n|cell\n|}</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">10</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Two\n\nparagraphs</span>&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "Decoding of HTML entities in indicator names for IDs (T104196)",
		"wikitext": "<indicator name=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\">Indicator</indicator>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">1&amp;2&amp;amp;3&amp;amp;amp;4&amp;amp;amp;amp;5</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Indicator</span>&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "Decoding of HTML entities in indicator names for IDs (unambiguous) (T104196)",
		"wikitext": "<indicator name=\"1&2&3&amp;amp;4&amp;amp;amp;5\">Indicator</indicator>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">1&amp;2&amp;3&amp;amp;amp;4&amp;amp;amp;amp;5</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Indicator</span>&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "Indicators with duplicate names: Last one wins",
		"wikitext": "<indicator name=\"x\">foo</indicator>\n<indicator name=\"x\">bar</indicator>",
		"html": "<p><br />\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "Templates where an indicator is the leading content (1)",
		"wikitext": "abcd\n{{1x|<indicator name=\"x\">foo</indicator>}}",
		"html": "<p>abcd\n</p>",
		"render": "<p>abcd\n</p>",
		"print": "<span class=\"wpb-root\">abcd\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/indicator&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates where an indicator is the leading content (2)",
		"wikitext": "abcd\n<indicator name=\"x\">bar</indicator>\n{{1x|<indicator name=\"x\">foo</indicator>}}",
		"html": "<p>abcd\n</p><p><br />\n</p>",
		"render": "<p>abcd\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\">abcd\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/indicator&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates where an indicator is not the leading content (1)",
		"wikitext": "abcd\n{{1x|efgh<indicator name=\"x\">foo</indicator>}}",
		"html": "<p>abcd\nefgh\n</p>",
		"render": "<p>abcd\nefgh\n</p>",
		"print": "<span class=\"wpb-root\">abcd\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">efgh<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/indicator&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Templates where an indicator is not the leading content (2)",
		"wikitext": "abcd\n<indicator name=\"x\">bar</indicator>\n{{1x|efgh<indicator name=\"x\">foo</indicator>}}",
		"html": "<p>abcd\n</p><p>efgh\n</p>",
		"render": "<p>abcd\n</p><p>efgh\n</p>",
		"print": "<span class=\"wpb-root\">abcd\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">bar</span>&lt;/indicator&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">efgh<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/indicator&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Indicator in fosterable position should not dirty-diff in selser mode",
		"wikitext": "{|\n<indicator name='x'>foo</indicator>\n|x\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>='<span class=\"wpb-attr-value\">x</span>'</span></span>&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/indicator&gt;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Indicator with comments should not be <p>-wrapped",
		"wikitext": "<indicator name=\"x\"><!-- hello -->\n<span>some stuff</span>\n<!-- second comment--></indicator>",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;indicator<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">name</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-comment\">&lt;!-- hello --&gt;</span>\n<span class=\"wpb-html\">&lt;span&gt;</span>some stuff<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-comment\">&lt;!-- second comment--&gt;</span></span>&lt;/indicator&gt;</span></span>"
	},
	{
		"desc": "langParserTests"
	},
	{
		"desc": "Language converter: output gets cut off unexpectedly (T7757)",
		"wikitext": "this bit is safe: }-\n\nbut if we add a conversion instance: -{zh-cn:xxx;zh-tw:yyy}-\n\nthen we get cut off here: }-\n\nall additional text is vanished",
		"print": "<span class=\"wpb-root\">this bit is safe: }-\n\nbut if we add a conversion instance: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">xxx</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">yyy</span></span>}-</span>\n\nthen we get cut off here: }-\n\nall additional text is vanished</span>"
	},
	{
		"desc": "Don't convert blue categorylinks to another variant (T35210)",
		"wikitext": "[[A]][[Category:ÂàÜÁ±ª]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">A</span>]]</span><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:ÂàÜÁ±ª</span>]]</span></span>"
	},
	{
		"desc": "Explicit definition of language variant alternatives",
		"wikitext": "-{zh:China;zh-tw:Taiwan}-, not China",
		"html": "<p>Taiwan, not China\n</p>",
		"render": "<p>China, not China\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>, not China</span>"
	},
	{
		"desc": "Explicit definition of language variant alternatives (BCP 47 codes)",
		"wikitext": "-{zh:China;zh-Hant-TW:Taiwan}-, not China",
		"html": "<p>Taiwan, not China\n</p>",
		"render": "<p>China;zh-Hant-TW:Taiwan, not China\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China;zh-Hant-TW:Taiwan</span></span>}-</span>, not China</span>"
	},
	{
		"desc": "Filter syntax for language variants",
		"wikitext": "foo-{zh;zh-hans;zh-hant|blog, WEBJOURNAL, WEBLOG}-quux",
		"html": "<p>fooblog, WEBJOURNAL, WEBLOGquux\n</p>",
		"render": "<p>fooblog, WEBJOURNAL, WEBLOGquux\n</p>",
		"print": "<span class=\"wpb-root\">foo<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">zh</span>;<span class=\"wpb-converter-flag\">zh-hans</span>;<span class=\"wpb-converter-flag\">zh-hant</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">blog, WEBJOURNAL, WEBLOG</span></span>}-</span>quux</span>"
	},
	{
		"desc": "Explicit session-wise two-way language variant mapping (A flag and - flag)",
		"wikitext": "This is -{zh:China; zh-tw:Taiwan}-, but we'll forget that now.\n\nTaiwan is not China.\n\nBut -{A|zh:China; zh-tw:Taiwan}- is China,\n\n(This-{-|zh:China; zh-tw:Taiwan}- should be stripped!)\n\nand -{China}- is China.",
		"html": "<p>This is Taiwan, but we'll forget that now.\n</p><p>Taiwan is not China.\n</p><p>But Taiwan is Taiwan,\n</p><p>(This should be stripped!)\n</p><p>and China is China.\n</p>",
		"render": "<p>This is China, but we'll forget that now.\n</p><p>Taiwan is not China.\n</p><p>But China is China,\n</p><p>(This should be stripped!)\n</p><p>and China is China.\n</p>",
		"print": "<span class=\"wpb-root\">This is <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>, but we'll forget that now.\n\nTaiwan is not China.\n\nBut <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> is China,\n\n(This<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">-</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> should be stripped!)\n\nand <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">China</span></span>}-</span> is China.</span>"
	},
	{
		"desc": "Explicit session-wise one-way language variant mapping (A flag and - flag)",
		"wikitext": "This is -{COUNTRY=>zh:China;COUNTRY=>zh-tw:Taiwan}-, but we'll forget that now.\n\nCOUNTRY is China or Taiwan.\n\nBut -{A|COUNTRY=>zh:China;COUNTRY=>zh-tw:Taiwan}- is COUNTRY,\n\n(This-{-|COUNTRY=>zh:China;COUNTRY=>zh-tw:Taiwan}- should be stripped!)\n\nand -{COUNTRY}- is COUNTRY.",
		"html": "<p>This is Taiwan, but we'll forget that now.\n</p><p>COUNTRY is China or Taiwan.\n</p><p>But Taiwan is Taiwan,\n</p><p>(This should be stripped!)\n</p><p>and COUNTRY is COUNTRY.\n</p>",
		"render": "<p>This is China, but we'll forget that now.\n</p><p>COUNTRY is China or Taiwan.\n</p><p>But China is COUNTRY,\n</p><p>(This should be stripped!)\n</p><p>and COUNTRY is COUNTRY.\n</p>",
		"print": "<span class=\"wpb-root\">This is <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>, but we'll forget that now.\n\nCOUNTRY is China or Taiwan.\n\nBut <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> is COUNTRY,\n\n(This<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">-</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> should be stripped!)\n\nand <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">COUNTRY</span></span>}-</span> is COUNTRY.</span>"
	},
	{
		"desc": "Explicit session-wise two-way language variant mapping (H flag for hide)",
		"wikitext": "(This-{H|zh:China;zh-tw:Taiwan}- should be stripped!)\n\nTaiwan is China.",
		"html": "<p>(This should be stripped!)\n</p><p>Taiwan is Taiwan.\n</p>",
		"render": "<p>(This should be stripped!)\n</p><p>Taiwan is China.\n</p>",
		"print": "<span class=\"wpb-root\">(This<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> should be stripped!)\n\nTaiwan is China.</span>"
	},
	{
		"desc": "Explicit session-wise one-way language variant mapping (H flag for hide)",
		"wikitext": "(This-{H|COUNTRY=>zh:China;COUNTRY=>zh-tw:Taiwan}- should be stripped!)\n\nCOUNTRY is Taiwan or China.",
		"html": "<p>(This should be stripped!)\n</p><p>Taiwan is Taiwan or China.\n</p>",
		"render": "<p>(This should be stripped!)\n</p><p>COUNTRY is Taiwan or China.\n</p>",
		"print": "<span class=\"wpb-root\">(This<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">COUNTRY</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> should be stripped!)\n\nCOUNTRY is Taiwan or China.</span>"
	},
	{
		"desc": "Adding explicit conversion rule for title (T flag)",
		"wikitext": "Should be stripped-{T|zh:China;zh-tw:Taiwan}-!\n\nTaiwan is China.",
		"html": "Taiwan\n<p>Should be stripped!\n</p><p>Taiwan is China.\n</p>",
		"render": "<p>Should be stripped!\n</p><p>Taiwan is China.\n</p>",
		"print": "<span class=\"wpb-root\">Should be stripped<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>!\n\nTaiwan is China.</span>"
	},
	{
		"desc": "Code coverage: T combined with H flag",
		"wikitext": "Should be stripped-{T;H|zh:China; zh-tw:Taiwan}-!\n\nTaiwan is China.",
		"html": "Taiwan\n<p>Should be stripped!\n</p><p>Taiwan is Taiwan.\n</p>",
		"render": "<p>Should be stripped!\n</p><p>Taiwan is China.\n</p>",
		"print": "<span class=\"wpb-root\">Should be stripped<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span>;<span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>!\n\nTaiwan is China.</span>"
	},
	{
		"desc": "Code coverage: T with no variants",
		"wikitext": "-{H|zh:China; zh-tw:Taiwan}-\nTaiwan is China.-{T|Taiwan is China}-",
		"html": "Taiwan is China\n<p>\nTaiwan is Taiwan.\n</p>",
		"render": "<p>Taiwan is China.\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>\nTaiwan is China.<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Taiwan is China</span></span>}-</span></span>"
	},
	{
		"desc": "Code coverage: rules with no variants",
		"wikitext": "-{H|zh:China; zh-tw:Taiwan}-\nTaiwan is China.\n-{H|China}-\nTaiwan is China.",
		"html": "<p>\nTaiwan is Taiwan.\n\nTaiwan is China.\n</p>",
		"render": "<p>Taiwan is China.\n</p><p>Taiwan is China.\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>\nTaiwan is China.\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">China</span></span>}-</span>\nTaiwan is China.</span>"
	},
	{
		"desc": "Code coverage: D flag for conversion rule",
		"wikitext": "-{D|zh-cn:XA; zh-tw:YA}-\n-{A;D|zh-cn:XB; zh-tw:YB}-\n-{D;H|zh-cn:XC; zh-tw:YC}-\n\n-{D;H|FOO=>zh-tw:BAR;FOO=>zh-cn:BAT}-\n\n-{D|0=>zh-tw:1}-\n-{A;D|2=>zh-tw:3}-\n-{D;H|4=>zh-tw:5}-\n\nXA XB XC YA YB YC FOO BAR BAT 012345",
		"html": "<p>Â§ßÈôÜÔºöXAÔºõËá∫ÁÅ£ÔºöYAÔºõ\n\nÂ§ßÈôÜÔºöXCÔºõËá∫ÁÅ£ÔºöYCÔºõ\n</p><p>FOO‚áíËá∫ÁÅ£ÔºöBARÔºõFOO‚áíÂ§ßÈôÜÔºöBATÔºõ\n</p><p>0‚áíËá∫ÁÅ£Ôºö1Ôºõ\n\n4‚áíËá∫ÁÅ£Ôºö5Ôºõ\n</p><p>XA YB YC YA YB YC BAR BAR BAT 013355\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\n</p><p><br>\nXA XB XC YA YB YC FOO BAR BAT 012345\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">XA</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">YA</span></span>}-</span>\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span>;<span class=\"wpb-converter-flag\">D</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">XB</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">YB</span></span>}-</span>\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span>;<span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">XC</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">YC</span></span>}-</span>\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span>;<span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">FOO</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">BAR</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">FOO</span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">BAT</span></span>}-</span>\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">1</span></span>}-</span>\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span>;<span class=\"wpb-converter-flag\">D</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">2</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">3</span></span>}-</span>\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span>;<span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">4</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">5</span></span>}-</span>\n\nXA XB XC YA YB YC FOO BAR BAT 012345</span>"
	},
	{
		"desc": "Code coverage: N flag for conversion rule",
		"wikitext": "-{N|zh-cn}-\n\n-{N|zh-tw}-\n\n-{N|sr-ec}-",
		"html": "<p>Â§ßÈôÜ\n</p><p>Ëá∫ÁÅ£\n</p><p>—Å—Ä–ø—Å–∫–∏ (—õ–∏—Ä–∏–ª–∏—Ü–∞)\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">N</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">zh-cn</span></span>}-</span>\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">N</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">zh-tw</span></span>}-</span>\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">N</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">sr-ec</span></span>}-</span></span>"
	},
	{
		"desc": "Code coverage: N flag for conversion rule (wt2html only)",
		"wikitext": "-{D;N|en}-",
		"html": "<p>English\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span>;<span class=\"wpb-converter-flag\">N</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">en</span></span>}-</span></span>"
	},
	{
		"desc": "Testing that changing the language variant here in the tests actually works",
		"wikitext": "Should be stripped-{T|zh:China; zh-tw:Taiwan}-!",
		"html": "China\n<p>Should be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\">Should be stripped<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>!</span>"
	},
	{
		"desc": "Title with HTML",
		"wikitext": "-{T|zh:Title <i style=\"color:red\">with</i> HTML&amp;Entities}-\nShould be stripped!",
		"html": "Title <i style=\"color:red\">with</i> HTML&amp;Entities\n<p>\nShould be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Title <span class=\"wpb-html\">&lt;i<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red</span>\"</span></span>&gt;</span>with<span class=\"wpb-html\">&lt;/i&gt;</span> HTML&amp;amp;Entities</span></span>}-</span>\nShould be stripped!</span>"
	},
	{
		"desc": "Title with Wiki syntax",
		"wikitext": "-{T|zh:Title ''with'' Wiki's s&uuml;ntax&copy}-\nShould be stripped!",
		"html": "Title <i>with</i> Wiki's s√ºntax&amp;copy\n<p>\nShould be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Title <span class=\"wpb-quote\">''</span>with<span class=\"wpb-quote\">''</span> Wiki's s&amp;uuml;ntax&amp;copy</span></span>}-</span>\nShould be stripped!</span>"
	},
	{
		"desc": "Title with JavaScript injection",
		"wikitext": "-{T|zh:Title <i onclick=\"alert(42)\">click me</i> <script>alert(43)</script>}-\nShould be stripped!",
		"html": "Title <i>click me</i> &lt;script&gt;alert(43)&lt;/script&gt;\n<p>\nShould be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Title <span class=\"wpb-html\">&lt;i<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">onclick</span>=\"<span class=\"wpb-attr-value\">alert(42)</span>\"</span></span>&gt;</span>click me<span class=\"wpb-html\">&lt;/i&gt;</span> &lt;script&gt;alert(43)&lt;/script&gt;</span></span>}-</span>\nShould be stripped!</span>"
	},
	{
		"desc": "Test 1 from T298401/T67747",
		"wikitext": "-{T|zh:Title <script>a</script>&amp;<i>b</i>}-\nShould be stripped!",
		"html": "Title &lt;script&gt;a&lt;/script&gt;&amp;<i>b</i>\n<p>\nShould be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Title &lt;script&gt;a&lt;/script&gt;&amp;amp;<span class=\"wpb-html\">&lt;i&gt;</span>b<span class=\"wpb-html\">&lt;/i&gt;</span></span></span>}-</span>\nShould be stripped!</span>"
	},
	{
		"desc": "Test 2 from T298401/T67747",
		"wikitext": "-{T|zh:Title <code style=\"display:none\">}-\nShould be stripped!",
		"html": "Title <code style=\"display:none\"></code>\n<p>\nShould be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Title <span class=\"wpb-html\">&lt;code<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">display:none</span>\"</span></span>&gt;</span></span></span>}-</span>\nShould be stripped!</span>"
	},
	{
		"desc": "Test 3 from T298401/T67747",
		"wikitext": "-{T|zh:Title <b>Foo bar<b>}-\nShould be stripped!",
		"html": "Title <b>Foo bar<b></b></b>\n<p>\nShould be stripped!\n</p>",
		"render": "<p>Should be stripped!\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Title <span class=\"wpb-html\">&lt;b&gt;</span>Foo bar<span class=\"wpb-html\">&lt;b&gt;</span></span></span>}-</span>\nShould be stripped!</span>"
	},
	{
		"desc": "Recursive conversion of alt and title attrs shouldn't clear converter state",
		"wikitext": "-{H|zh-cn:Exclamation; zh-tw:exclamation}-\nShould be stripped-{T|zh-cn:China; zh-tw:Taiwan}-<span title=\"exclamation\">!</span>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">Exclamation</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">exclamation</span></span>}-</span>\nShould be stripped<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">exclamation</span>\"</span></span>&gt;</span>!<span class=\"wpb-html\">&lt;/span&gt;</span></span>"
	},
	{
		"desc": "T26072: more test on conversion rule for title",
		"wikitext": "This should be stripped-{T|zh:China; zh-tw:Taiwan}-!\n\nThis won't take interferes with the title rule-{H|zh:Beijing; zh-tw:Taipei}-.",
		"html": "Taiwan\n<p>This should be stripped!\n</p><p>This won't take interferes with the title rule.\n</p>",
		"render": "<p>This should be stripped!\n</p><p>This won't take interferes with the title rule.\n</p>",
		"print": "<span class=\"wpb-root\">This should be stripped<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span>!\n\nThis won't take interferes with the title rule<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">Beijing</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taipei</span></span>}-</span>.</span>"
	},
	{
		"desc": "Partly disable title conversion if variant == main language code",
		"wikitext": "-{T|zh-cn:CN;zh-tw:TW}-",
		"html": "<span class=\"mw-page-title-main\">ZH</span>\n<p class=\"mw-empty-elt\">\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">CN</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">TW</span></span>}-</span></span>"
	},
	{
		"desc": "Partly disable title conversion if variant == main language code, more",
		"wikitext": "-{T|TW}-",
		"html": "<span class=\"mw-page-title-main\">ZH</span>\n<p class=\"mw-empty-elt\">\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">T</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">TW</span></span>}-</span></span>"
	},
	{
		"desc": "Raw output of variant escape tags (R flag)",
		"wikitext": "Raw: -{R|zh:China;zh-tw:Taiwan}-",
		"html": "<p>Raw: zh:China;zh-tw:Taiwan\n</p>",
		"render": "<p>Raw: zh:China;zh-tw:Taiwan\n</p>",
		"print": "<span class=\"wpb-root\">Raw: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span></span>"
	},
	{
		"desc": "Raw output of variant escape tags (R flag) (wt2html only)",
		"wikitext": "-{Variant}- -{D|syntax}- -{D;R|options}-",
		"html": "<p>Variant syntax options\n</p>",
		"render": "<p>Variant  options\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Variant</span></span>}-</span> <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">syntax</span></span>}-</span> <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">D</span>;<span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">options</span></span>}-</span></span>"
	},
	{
		"desc": "Nested markup inside raw output of variant escape tags (R flag)",
		"wikitext": "Nested raw: -{R|nested -{zh:China;zh-tw:Taiwan}- nested}-",
		"html": "<p>Nested raw: nested Taiwan nested\n</p>",
		"render": "<p>Nested raw: nested China nested\n</p>",
		"print": "<span class=\"wpb-root\">Nested raw: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">nested <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>}-</span> nested</span></span>}-</span></span>"
	},
	{
		"desc": "Nested markup and spaces inside raw output of variant escape tags (R flag)",
		"wikitext": "X-{ outer -{ inner }- outer }-X",
		"html": "<p>X outer  inner  outer X\n</p>",
		"render": "<p>X outer  inner  outer X\n</p>",
		"print": "<span class=\"wpb-root\">X<span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"> outer <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"> inner </span></span>}-</span> outer </span></span>}-</span>X</span>"
	},
	{
		"desc": "Templates inside raw output of variant escape tags (R flag)",
		"wikitext": "Nested raw: -{R|nested {{1x|hi}} templates}-",
		"html": "<p>Nested raw: nested hi templates\n</p>",
		"render": "<p>Nested raw: nested hi templates\n</p>",
		"print": "<span class=\"wpb-root\">Nested raw: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">nested <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span> templates</span></span>}-</span></span>"
	},
	{
		"desc": "Strings evaluating false shouldn't be ignored by Language converter (T51072)",
		"wikitext": "-{zh-cn:0;zh-sg:1;zh-tw:2;zh-hk:3}-",
		"html": "<p>0\n</p>",
		"render": "<p>0\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">0</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-sg</span>:<span class=\"wpb-converter-rule-to\">1</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">2</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-hk</span>:<span class=\"wpb-converter-rule-to\">3</span></span>}-</span></span>"
	},
	{
		"desc": "Conversion rules from [numeric-only string] to [something else] (T48634)",
		"wikitext": "-{H|0=>zh-cn:B}--{H|0=>zh-cn:C;0=>zh-cn:D}--{H|0=>zh-hans:A}-012345-{A|zh-tw:0;zh-cn:E;}-012345",
		"html": "<p>D12345EE12345\n</p>",
		"render": "<p>0123450012345\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">B</span></span>}-</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">C</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">D</span></span>}-</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-hans</span>:<span class=\"wpb-converter-rule-to\">A</span></span>}-</span>012345<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">0</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">E</span></span>;}-</span>012345</span>"
	},
	{
		"desc": "Two-way converter rule entries with an empty value should be ignored (T53551)",
		"wikitext": "-{H|zh-cn:foo;zh-tw:;}-foobar",
		"html": "<p>foobar\n</p>",
		"render": "<p>foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">foo</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:</span>;}-</span>foobar</span>"
	},
	{
		"desc": "One-way converter rule entries with an empty \"from\" string should be ignored (T53551)",
		"wikitext": "-{H|=>zh-cn:foo;}-foobar",
		"html": "<p>foobar\n</p>",
		"render": "<p>foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\">=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">foo</span></span>;}-</span>foobar</span>"
	},
	{
		"desc": "Empty converter rule entries shouldn't be inserted into the conversion table (T53551)",
		"wikitext": "-{H|}-foobar",
		"html": "<p>foobar\n</p>",
		"render": "<p>foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|}-</span>foobar</span>"
	},
	{
		"desc": "Nested using of manual convert syntax",
		"wikitext": "Nested: -{zh-hans:Hi -{zh-cn:China;zh-sg:Singapore;}-;zh-hant:Hello -{zh-tw:Taiwan;zh-hk:H-{ong}- K-{}-ong;}-;}-!",
		"html": "<p>Nested: Hello Hong Kong!\n</p>",
		"render": "<p>Nested: Hi China!\n</p>",
		"print": "<span class=\"wpb-root\">Nested: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-hans</span>:<span class=\"wpb-converter-rule-to\">Hi <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">China</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-sg</span>:<span class=\"wpb-converter-rule-to\">Singapore</span></span>;}-</span></span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-hant</span>:<span class=\"wpb-converter-rule-to\">Hello <span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">Taiwan</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-hk</span>:<span class=\"wpb-converter-rule-to\">H<span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">ong</span></span>}-</span> K<span class=\"wpb-converter\">-{}-</span>ong</span></span>;}-</span></span></span>;}-</span>!</span>"
	},
	{
		"desc": "HTML markups with conversion syntax in attribs, nested in other conversion blocks",
		"wikitext": "-{zh;zh-hans;zh-hant|<span title=\"-{X}-\">A</span>}-",
		"html": "<p><span title=\"X\">A</span>\n</p>",
		"render": "<p><span title=\"X\">A</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">zh</span>;<span class=\"wpb-converter-flag\">zh-hans</span>;<span class=\"wpb-converter-flag\">zh-hant</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">X</span></span>}-</span></span>\"</span></span>&gt;</span>A<span class=\"wpb-html\">&lt;/span&gt;</span></span></span>}-</span></span>"
	},
	{
		"desc": "HTML markups with conversion syntax in attribs, nested in other conversion blocks (not working yet in PHP parser)",
		"wikitext": "-{<span title=\"-{X}-\">A</span>}-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">X</span></span>}-</span></span>\"</span></span>&gt;</span>A<span class=\"wpb-html\">&lt;/span&gt;</span></span></span>}-</span></span>"
	},
	{
		"desc": "Language converter markup with block content",
		"wikitext": "<span>a-{b<div>c}-d\n\n<span>a-{zh;zh-hans;zh-hant|b<div>c}-d\n\n<span>a-{H|0=>zh-cn:x<span>y;0=>zh-tw:b<div>c}-d",
		"html": "<span>ab<div>cd\n<span>ab<div>cd\n<span>ad</span></div></span></div></span>",
		"render": "<span >ab<div >cd\n<span >ab<div >cd\n<p><span >ad\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span&gt;</span>a<span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">b<span class=\"wpb-html\">&lt;div&gt;</span>c</span></span>}-</span>d\n\n<span class=\"wpb-html\">&lt;span&gt;</span>a<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">zh</span>;<span class=\"wpb-converter-flag\">zh-hans</span>;<span class=\"wpb-converter-flag\">zh-hant</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">b<span class=\"wpb-html\">&lt;div&gt;</span>c</span></span>}-</span>d\n\n<span class=\"wpb-html\">&lt;span&gt;</span>a<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">x<span class=\"wpb-html\">&lt;span&gt;</span>y</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">0</span>=><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">b<span class=\"wpb-html\">&lt;div&gt;</span>c</span></span>}-</span>d</span>"
	},
	{
		"desc": "LanguageConverter selser (1)",
		"wikitext": "-{raw}-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">raw</span></span>}-</span></span>"
	},
	{
		"desc": "LanguageConverter selser (2)",
		"wikitext": "<span class=\"x\">TEXT1</span>\n[http://example.com TEXT2]\n[[Foo|TEXT3]]\n{{1x|TEXT4}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>TEXT1<span class=\"wpb-html\">&lt;/span&gt;</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">TEXT2</span>]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">TEXT3</span>]]</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">TEXT4</span></span>}}</span></span>"
	},
	{
		"desc": "LanguageConverter selser (3)",
		"wikitext": "{|\n|-\n|<span>Foo</span>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;span&gt;</span>Foo<span class=\"wpb-html\">&lt;/span&gt;</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "LanguageConverter selser (4)",
		"wikitext": "{|\n|-\n|<span class=\"x\">Foo</span>-{Bar}-\n||<span class=\"x\">Foo</span>-{Bar}-\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>Foo<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Bar</span></span>}-</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span>|<span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;span<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">x</span>\"</span></span>&gt;</span>Foo<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">Bar</span></span>}-</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T153135: Don't break list handling if language converter markup is in the item.",
		"wikitext": ";-{zh-cn:AAA;zh-tw:BBB}-\n;-{R|foo:bar}-",
		"html": "<dl><dt>AAA</dt>\n<dt>foo:bar</dt></dl>",
		"render": "<dl><dt>AAA</dt>\n<dt>foo:bar</dt></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">AAA</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">BBB</span></span>}-</span>\n<span class=\"wpb-list\">;</span><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">foo:bar</span></span>}-</span></span>"
	},
	{
		"desc": "T153135: Unclosed markup in definition list (code coverage)",
		"wikitext": ";<b>foo:bar\n;-{zh-cn:AAA",
		"html": "<dl><dt><b>foo:bar</b></dt><b>\n<dt>-{zh-cn:AAA</dt></b></dl>",
		"render": "<dl><dt><b >foo:bar</dt>\n<dt>-{zh-cn:AAA</dt></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-html\">&lt;b&gt;</span>foo:bar\n<span class=\"wpb-list\">;</span>-{zh-cn:AAA</span>"
	},
	{
		"desc": "T153135: Nested language converter markup in definition list (code coverage)",
		"wikitext": ";-{|zh-cn:AAA -{zh-hans|foo:bar}- -{R|bat:baz}-}-:def",
		"html": "<dl><dt>AAA foo:bar bat:baz</dt>\n<dd>def</dd></dl>",
		"render": "<dl><dt>AAA foo:bar bat:baz</dt>\n<dd>def</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">;</span><span class=\"wpb-converter\">-{|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">AAA <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">zh-hans</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">foo:bar</span></span>}-</span> <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">bat:baz</span></span>}-</span></span></span>}-</span><span class=\"wpb-dd\">:</span>def</span>"
	},
	{
		"desc": "Language converter tricky html2wt cases (5)",
		"wikitext": "-{H|<nowiki>a:b=>c</nowiki>=>zh-cn:<nowiki>x;foo=>zh-cn:boo</nowiki>;bar=>zh-cn:<nowiki>bat;xyz=>zh-cn:abc</nowiki>}-foobar\n\n-{H|A=><nowiki>bo:g;us</nowiki>:B}-\n\n-{A|zh-tw:xyz; zh-cn:<nowiki>0;zh-tw:bar</nowiki>}-\n\n-{<nowiki>bo:g;us</nowiki>:xyz; zh-cn:abc}-\n\na:b=>c xyz",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">a:b=&gt;c</span>&lt;/nowiki&gt;</span></span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">x;foo=&gt;zh-cn:boo</span>&lt;/nowiki&gt;</span></span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-from\">bar</span>=><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">bat;xyz=&gt;zh-cn:abc</span>&lt;/nowiki&gt;</span></span></span>}-</span>foobar\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">A=&gt;<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">bo:g;us</span>&lt;/nowiki&gt;</span>:B</span></span>}-</span>\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">A</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-tw</span>:<span class=\"wpb-converter-rule-to\">xyz</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-cn</span>:<span class=\"wpb-converter-rule-to\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">0;zh-tw:bar</span>&lt;/nowiki&gt;</span></span></span>}-</span>\n\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">bo:g;us</span>&lt;/nowiki&gt;</span>:xyz; zh-cn:abc</span></span>}-</span>\n\na:b=&gt;c xyz</span>"
	},
	{
		"desc": "T239806: Trailing garbage in language converter rules (1)",
		"wikitext": "-{H|zh-cn:Á∫¶Áø∞¬∑Â°ûÁ∫≥; zh-hk:Ëéä¬∑ÂÖàÊãø; zh-tw:Á¥ÑÁø∞¬∑Â∏åÂçó; ;}-\n-{H|zh-cn:Ê≥∞ÁëûÊñØ¬∑ÂêâÂ∏ÉÊ£Æ; zh-hk:Ê≥∞ÂàóÊñØ¬∑ÂêâÈÅú; zh-tw:Ê≥∞ÁëûÊñØ¬∑ÂêâÂ∏ÉÊ£Æ; ;}-\n-{H|zh-cn:Èáë¬∑Á±≥Â∞îÁ¶èÁâπ; zh-tw:Èáë¬∑Á±≥ÁàæÁ¶èÁâπ; Áúü¬∑Á±≥ÁàæÁ¶èÁâπ;}-",
		"html": "<p class=\"mw-empty-elt\">\n\n\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">Á∫¶Áø∞¬∑Â°ûÁ∫≥</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-hk</span>:<span class=\"wpb-converter-rule-to\">Ëéä¬∑ÂÖàÊãø</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Á¥ÑÁø∞¬∑Â∏åÂçó; </span></span>;}-</span>\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">Ê≥∞ÁëûÊñØ¬∑ÂêâÂ∏ÉÊ£Æ</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-hk</span>:<span class=\"wpb-converter-rule-to\">Ê≥∞ÂàóÊñØ¬∑ÂêâÈÅú</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Ê≥∞ÁëûÊñØ¬∑ÂêâÂ∏ÉÊ£Æ; </span></span>;}-</span>\n<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">Èáë¬∑Á±≥Â∞îÁ¶èÁâπ</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Èáë¬∑Á±≥ÁàæÁ¶èÁâπ; Áúü¬∑Á±≥ÁàæÁ¶èÁâπ</span></span>;}-</span></span>"
	},
	{
		"desc": "T239806: Trailing garbage in language converter rules (2)",
		"wikitext": "-{H|zh-cn:ÁéõÊ†ºÁâπ¬∑ÁΩóÊØî; zh-tw:Áë™Ê†º¬∑ÁæÖÊØî; zh-hk:Áë™Ê≠å¬∑ÁæÖÊØî; zh-sg:ÁéõÊ†º¬∑ÁΩóÊØî; ;}-",
		"html": "<p class=\"mw-empty-elt\">\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">ÁéõÊ†ºÁâπ¬∑ÁΩóÊØî</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-tw</span>:<span class=\"wpb-converter-rule-to\">Áë™Ê†º¬∑ÁæÖÊØî</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-hk</span>:<span class=\"wpb-converter-rule-to\">Áë™Ê≠å¬∑ÁæÖÊØî</span></span>;<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\"> zh-sg</span>:<span class=\"wpb-converter-rule-to\">ÁéõÊ†º¬∑ÁΩóÊØî; </span></span>;}-</span></span>"
	},
	{
		"desc": "Langconvert tag: crh-latn to crh-cyrl",
		"wikitext": "<langconvert from=\"crh-latn\" to=\"crh-cyrl\">test</langconvert>",
		"html": "<p>—Ç–µ—Å—Ç\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">crh-latn</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">crh-cyrl</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">test</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: en to en-x-piglatin",
		"wikitext": "<langconvert from=\"en\" to=\"en-x-piglatin\">test</langconvert>",
		"html": "<p>esttay\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">en</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">en-x-piglatin</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">test</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: gan-hans to gan-hant",
		"wikitext": "<langconvert from=\"gan-hans\" to=\"gan-hant\">Áà±</langconvert>",
		"html": "<p>ÊÑõ\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">gan-hans</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">gan-hant</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Áà±</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: ku-latn to ku-arab",
		"wikitext": "<langconvert from=\"ku-latn\" to=\"ku-arab\">test</langconvert>",
		"html": "<p>ÿ™€ïÿ≥ÿ™\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">ku-latn</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">ku-arab</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">test</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: shi-latn to shi-tfng",
		"wikitext": "<langconvert from=\"shi-latn\" to=\"shi-tfng\">test</langconvert>",
		"html": "<p>‚µú‚¥ª‚µô‚µú\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">shi-latn</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">shi-tfng</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">test</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: sr-latn to sr-cyrl",
		"wikitext": "<langconvert from=\"sr-latn\" to=\"sr-cyrl\">zdravo</langconvert>",
		"html": "<p>–∑–¥—Ä–∞–≤–æ\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">sr-latn</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">sr-cyrl</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">zdravo</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: sr-el to sr-ec (should fail)",
		"wikitext": "<langconvert from=\"sr-el\" to=\"sr-ec\">zdravo</langconvert>",
		"html": "<p><span class=\"error\"><strong>Error:</strong> Langconvert tag's <code>from</code> and <code>to</code> attributes must not be empty and must contain BCP 47 codes for convertible variants of the same language.</span>\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">sr-el</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">sr-ec</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">zdravo</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: tg to tg-latn",
		"wikitext": "<langconvert from=\"tg\" to=\"tg-latn\">—Ç–µ—Å—Ç</langconvert>",
		"html": "<p>test\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">tg</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">tg-latn</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">—Ç–µ—Å—Ç</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: uz-cyrl to uz-latn",
		"wikitext": "<langconvert from=\"uz-cyrl\" to=\"uz-latn\">—Ç–µ—Å—Ç</langconvert>",
		"html": "<p>test\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">uz-cyrl</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">uz-latn</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">—Ç–µ—Å—Ç</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: zh-hans to zh-hant",
		"wikitext": "<langconvert from=\"zh-hans\" to=\"zh-hant\">Áà±</langconvert>",
		"html": "<p>ÊÑõ\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">zh-hans</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">zh-hant</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Áà±</span>&lt;/langconvert&gt;</span></span>"
	},
	{
		"desc": "Langconvert tag: self-closed",
		"wikitext": "x<langconvert from=\"crh-latn\" to=\"crh-cyrl\"/>x",
		"html": "<p>xx\n</p>",
		"render": "<p>xx\n</p>",
		"print": "<span class=\"wpb-root\">x<span class=\"wpb-ext\">&lt;langconvert<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">from</span>=\"<span class=\"wpb-attr-value\">crh-latn</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">to</span>=\"<span class=\"wpb-attr-value\">crh-cyrl</span>\"</span></span>/&gt;</span>x</span>"
	},
	{
		"desc": "T302678: Serialize empty twoway",
		"wikitext": "-{H|}-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">H</span></span>|}-</span></span>"
	},
	{
		"desc": "luaParserTests"
	},
	{
		"desc": "Scribunto: no such module",
		"wikitext": "{{#invoke:foo|bar}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">foo</span>|<span class=\"wpb-invoke-function\">bar</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: no such function",
		"wikitext": "{{#invoke:test|blah}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">blah</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: hello world",
		"wikitext": "{{#invoke:test|hello}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">hello</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: redirect to hello world",
		"wikitext": "{{#invoke:redirected|hello}}\n{{#invoke:redirected \"with\" quotes|hello}}\n{{#invoke:redirected|testIsRedirect|Module:Redirected}}\n{{#invoke:redirected \"with\" quotes|testIsRedirect|Module:Test \"with\" quotes}}\n{{#invoke:redirected \"with\" quotes|testIsRedirect|Module:Redirected \"with\" quotes}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">redirected</span>|<span class=\"wpb-invoke-function\">hello</span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">redirected \"with\" quotes</span>|<span class=\"wpb-invoke-function\">hello</span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">redirected</span>|<span class=\"wpb-invoke-function\">testIsRedirect</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Module:Redirected</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">redirected \"with\" quotes</span>|<span class=\"wpb-invoke-function\">testIsRedirect</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Module:Test \"with\" quotes</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">redirected \"with\" quotes</span>|<span class=\"wpb-invoke-function\">testIsRedirect</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Module:Redirected \"with\" quotes</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: getAllArgs",
		"wikitext": "{{#invoke:test|getAllArgs|x|y|z|a=1|b=2|c=3|7=?}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getAllArgs</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">z</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">a</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">b</span>=<span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">c</span>=<span class=\"wpb-parameter-value\">3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">7</span>=<span class=\"wpb-parameter-value\">?</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: getAllArgs, deprecated style",
		"wikitext": "{{#invoke:test|getAllArgs2|x|y|z|a=1|b=2|c=3|7=?}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getAllArgs2</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">z</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">a</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">b</span>=<span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">c</span>=<span class=\"wpb-parameter-value\">3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">7</span>=<span class=\"wpb-parameter-value\">?</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: getNumericArgs",
		"wikitext": "{{#invoke:test|getNumericArgs|x|y|z|a=1|b=2|c=3|7=?}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getNumericArgs</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">z</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">a</span>=<span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">b</span>=<span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">c</span>=<span class=\"wpb-parameter-value\">3</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">7</span>=<span class=\"wpb-parameter-value\">?</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: named numeric parameters",
		"wikitext": "{{#invoke:test|getArg|2|a|2=b}}\n{{#invoke:test|getArg|2|2=a|b}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getArg</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">a</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">2</span>=<span class=\"wpb-parameter-value\">b</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getArg</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">2</span>=<span class=\"wpb-parameter-value\">a</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: template-style argument trimming",
		"wikitext": "{{#invoke:test|getArgLength|2| x }}\n{{#invoke:test|getArgLength|2|2= x }}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getArgLength</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> x </span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getArgLength</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">2</span>=<span class=\"wpb-parameter-value\"> x </span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: missing argument",
		"wikitext": "{{#invoke:test|getArgType|2}}\n{{#invoke:test|getArgType|blah}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getArgType</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getArgType</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">blah</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: parent frame access",
		"wikitext": "{{Scribunto_all_args|x|y|z|a = 1|b = 2|c = 3}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Scribunto_all_args</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">y</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">z</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">a </span>=<span class=\"wpb-parameter-value\"> 1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">b </span>=<span class=\"wpb-parameter-value\"> 2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">c </span>=<span class=\"wpb-parameter-value\"> 3</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: expandTemplate",
		"wikitext": "{{#invoke:test|testExpandTemplate}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testExpandTemplate</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: expandTemplate with headers",
		"wikitext": "==foo==\n{{#invoke:test|testExpandTemplateWithHeaders}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">foo</span>==</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testExpandTemplateWithHeaders</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: newTemplateParserValue",
		"wikitext": "{{#invoke:test|testNewTemplateParserValue}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testNewTemplateParserValue</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: preprocess",
		"wikitext": "{{#invoke:test|testPreprocess|foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testPreprocess</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: newParserValue",
		"wikitext": "{{#invoke:test|testNewParserValue|foo}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testNewParserValue</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: table return",
		"wikitext": "{{#invoke:test|emptyTable}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">emptyTable</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: require",
		"wikitext": "{{#invoke:test|import}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">import</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: access to a module imported at the chunk level",
		"wikitext": "{{#invoke:test|bitop}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">bitop</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: invoke instance upvalue isolation",
		"wikitext": "{{#invoke:test|isolationTestUpvalue|1}}\n{{#invoke:test|isolationTestUpvalue|2}}\n{{#invoke:test|isolationTestUpvalue|3}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isolationTestUpvalue</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isolationTestUpvalue</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isolationTestUpvalue</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">3</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: invoke instance global isolation",
		"wikitext": "{{#invoke:test|isolationTestGlobal|1}}\n{{#invoke:test|isolationTestGlobal|2}}\n{{#invoke:test|isolationTestGlobal|3}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isolationTestGlobal</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isolationTestGlobal</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isolationTestGlobal</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">3</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: ASCII null",
		"wikitext": "{{#invoke:test|null}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">null</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: isSubsting during PST",
		"wikitext": "{{safesubst:#invoke:test|isSubsting}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{safesubst:<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isSubsting</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: isSubsting during normal parse",
		"wikitext": "{{safesubst:#invoke:test|isSubsting}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{safesubst:<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">isSubsting</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: frame:getTitle",
		"wikitext": "{{#invoke:test|getFrameTitle}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">getFrameTitle</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: Metatable on export table",
		"wikitext": "{{#invoke:Metatables|zero}}\n{{#invoke:Metatables|one}}\n{{#invoke:Metatables|two}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">Metatables</span>|<span class=\"wpb-invoke-function\">zero</span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">Metatables</span>|<span class=\"wpb-invoke-function\">one</span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">Metatables</span>|<span class=\"wpb-invoke-function\">two</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: Correct argument numbering with equals sign in function name",
		"wikitext": "{{#invoke:test|test=InFunctionName|good|bad}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">test=InFunctionName</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">good</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bad</span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: Strip markers in CSS",
		"wikitext": "{{#invoke:test|testStrippedCss|<nowiki>#ff0000</nowiki>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testStrippedCss</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">#ff0000</span>&lt;/nowiki&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "Scribunto: Parser output isn't incorrectly cached across frames",
		"wikitext": "Root: {{#invoke:test|testFrameCaching}} Template: {{Scribunto frame caching}}",
		"print": "<span class=\"wpb-root\">Root: <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">test</span>|<span class=\"wpb-invoke-function\">testFrameCaching</span>}}</span> Template: <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Scribunto frame caching</span>}}</span></span>"
	},
	{
		"desc": "Scribunto: Test unstripNowiki behavior",
		"wikitext": "{{#invoke:EchoTest|echo|<nowiki>foo</nowiki>}}\n{{#invoke:EchoTest|echo|<nowiki>[[Foo]]</nowiki>}}\n\n{{#invoke:UnstripTest|unstrip|<nowiki>foo</nowiki>}}\n{{#invoke:UnstripTest|unstrip|<nowiki>[[Foo]]</nowiki>}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">EchoTest</span>|<span class=\"wpb-invoke-function\">echo</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">EchoTest</span>|<span class=\"wpb-invoke-function\">echo</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[Foo]]</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">UnstripTest</span>|<span class=\"wpb-invoke-function\">unstrip</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/nowiki&gt;</span></span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#invoke</span>:<span class=\"wpb-invoke-module\">UnstripTest</span>|<span class=\"wpb-invoke-function\">unstrip</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[Foo]]</span>&lt;/nowiki&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "magicLinks"
	},
	{
		"desc": "Magic links: internal link to RFC (T2479)",
		"wikitext": "[[RFC 123]]",
		"html": "<p><a href=\"/index.php?title=RFC_123&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"RFC 123 (page does not exist)\">RFC 123</a>\n</p>",
		"render": "<p><a href=\"/wiki/RFC_123\" title=\"RFC 123\">RFC 123</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">RFC 123</span>]]</span></span>"
	},
	{
		"desc": "Magic links: RFC (T2479)",
		"wikitext": "RFC 822",
		"html": "<p><a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc822\">RFC 822</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc822\">RFC 822</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">RFC 822</span></span>"
	},
	{
		"desc": "Magic links: RFC (T67278)",
		"wikitext": "This is RFC 822 but thisRFC 822 is not RFC 822linked.",
		"html": "<p>This is <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc822\">RFC 822</a> but thisRFC 822 is not RFC 822linked.\n</p>",
		"render": "<p>This is <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc822\">RFC 822</a> but thisRFC 822 is not RFC 822linked.\n</p>",
		"print": "<span class=\"wpb-root\">This is <span class=\"wpb-magic-link\">RFC 822</span> but thisRFC 822 is not RFC 822linked.</span>"
	},
	{
		"desc": "Magic links: RFC (w/ non-newline whitespace, T30950/T31025)",
		"wikitext": "RFC &nbsp;&#160;&#0160;&#xA0;&#Xa0; 822\nRFC\n822",
		"html": "<p><a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc822\">RFC 822</a>\nRFC\n822\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc822\">RFC 822</a>\nRFC\n822\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">RFC &amp;nbsp;&amp;#160;&amp;#0160;&amp;#xA0;&amp;#Xa0; 822</span>\nRFC\n822</span>"
	},
	{
		"desc": "Magic links: ISBN (T3937)",
		"wikitext": "ISBN 0-306-40615-2",
		"html": "<p><a href=\"/wiki/Special:BookSources/0306406152\" class=\"internal mw-magiclink-isbn\">ISBN 0-306-40615-2</a>\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F0306406152\">ISBN 0-306-40615-2</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 0-306-40615-2</span></span>"
	},
	{
		"desc": "Magic links: ISBN (T67278)",
		"wikitext": "This is ISBN 978-0-316-09811-3 but thisISBN 978-0-316-09811-3 is not ISBN 978-0-316-09811-3linked.",
		"html": "<p>This is <a href=\"/wiki/Special:BookSources/9780316098113\" class=\"internal mw-magiclink-isbn\">ISBN 978-0-316-09811-3</a> but thisISBN 978-0-316-09811-3 is not ISBN 978-0-316-09811-3linked.\n</p>",
		"render": "<p>This is <a href=\"/wiki/Special%3ABookSources%2F9780316098113\">ISBN 978-0-316-09811-3</a> but thisISBN 978-0-316-09811-3 is not ISBN 978-0-316-09811-3linked.\n</p>",
		"print": "<span class=\"wpb-root\">This is <span class=\"wpb-magic-link\">ISBN 978-0-316-09811-3</span> but thisISBN 978-0-316-09811-3 is not ISBN 978-0-316-09811-3linked.</span>"
	},
	{
		"desc": "Magic links: ISBN (w/ non-newline whitespace, T30950/T31025)",
		"wikitext": "ISBN &nbsp;&#160;&#0160;&#xA0;&#Xa0; 978&nbsp;0&#160;316&#0160;09811&#xA0;3\nISBN\n9780316098113\nISBN 978\n0316098113",
		"html": "<p><a href=\"/wiki/Special:BookSources/9780316098113\" class=\"internal mw-magiclink-isbn\">ISBN 978 0 316 09811 3</a>\nISBN\n9780316098113\nISBN 978\n0316098113\n</p>",
		"render": "<p><a href=\"/wiki/Special%3ABookSources%2F9780316098113\">ISBN 978 0 316 09811 3</a>\nISBN\n9780316098113\nISBN 978\n0316098113\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN &amp;nbsp;&amp;#160;&amp;#0160;&amp;#xA0;&amp;#Xa0; 978&amp;nbsp;0&amp;#160;316&amp;#0160;09811&amp;#xA0;3</span>\nISBN\n9780316098113\nISBN 978\n0316098113</span>"
	},
	{
		"desc": "Magic links: PMID incorrectly converts space to underscore",
		"wikitext": "PMID 1234",
		"html": "<p><a class=\"external mw-magiclink-pmid\" rel=\"nofollow\" href=\"//www.ncbi.nlm.nih.gov/pubmed/1234?dopt=Abstract\">PMID 1234</a>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://pubmed.ncbi.nlm.nih.gov/1234\">PMID 1234</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">PMID 1234</span></span>"
	},
	{
		"desc": "Magic links: PMID (T67278)",
		"wikitext": "This is PMID 1234 but thisPMID 1234 is not PMID 1234linked.",
		"html": "<p>This is <a class=\"external mw-magiclink-pmid\" rel=\"nofollow\" href=\"//www.ncbi.nlm.nih.gov/pubmed/1234?dopt=Abstract\">PMID 1234</a> but thisPMID 1234 is not PMID 1234linked.\n</p>",
		"render": "<p>This is <a rel=\"nofollow\" class=\"external\" href=\"https://pubmed.ncbi.nlm.nih.gov/1234\">PMID 1234</a> but thisPMID 1234 is not PMID 1234linked.\n</p>",
		"print": "<span class=\"wpb-root\">This is <span class=\"wpb-magic-link\">PMID 1234</span> but thisPMID 1234 is not PMID 1234linked.</span>"
	},
	{
		"desc": "Magic links: PMID (w/ non-newline whitespace, T30950/T31025)",
		"wikitext": "PMID &nbsp;&#160;&#0160;&#xA0;&#Xa0; 1234\nPMID\n1234",
		"html": "<p><a class=\"external mw-magiclink-pmid\" rel=\"nofollow\" href=\"//www.ncbi.nlm.nih.gov/pubmed/1234?dopt=Abstract\">PMID 1234</a>\nPMID\n1234\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external\" href=\"https://pubmed.ncbi.nlm.nih.gov/1234\">PMID 1234</a>\nPMID\n1234\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">PMID &amp;nbsp;&amp;#160;&amp;#0160;&amp;#xA0;&amp;#Xa0; 1234</span>\nPMID\n1234</span>"
	},
	{
		"desc": "Magic links: use appropriate serialization for \"almost\" magic links.",
		"wikitext": "X[[Special:BookSources/0978739256|foo]]\n\nX[https://tools.ietf.org/html/rfc1234 foo]",
		"html": "<p>X<a href=\"/wiki/Special:BookSources/0978739256\" title=\"Special:BookSources/0978739256\">foo</a>\n</p><p>X<a rel=\"nofollow\" class=\"external text\" href=\"https://tools.ietf.org/html/rfc1234\">foo</a>\n</p>",
		"render": "<p>X<a href=\"/wiki/Special%3ABookSources%2F0978739256\" title=\"Special:BookSources/0978739256\">foo</a>\n</p><p>X<a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc1234\">foo</a>\n</p>",
		"print": "<span class=\"wpb-root\">X<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Special:BookSources/0978739256</span>|<span class=\"wpb-link-text\">foo</span>]]</span>\n\nX<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://tools.ietf.org/html/rfc1234</span> <span class=\"wpb-ext-link-text\">foo</span>]</span></span>"
	},
	{
		"desc": "Magic links: All disabled (T47942)",
		"wikitext": "ISBN 0-306-40615-2\nPMID 1234\nRFC 4321",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 0-306-40615-2</span>\n<span class=\"wpb-magic-link\">PMID 1234</span>\n<span class=\"wpb-magic-link\">RFC 4321</span></span>"
	},
	{
		"desc": "magicWords"
	},
	{
		"desc": "Magic Word: {{CURRENTDAY}}",
		"wikitext": "{{CURRENTDAY}}",
		"html": "<p>1\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTDAY</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTDAY2}}",
		"wikitext": "{{CURRENTDAY2}}",
		"html": "<p>01\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTDAY2</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTDAYNAME}}",
		"wikitext": "{{CURRENTDAYNAME}}",
		"html": "<p>Thursday\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTDAYNAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTDOW}}",
		"wikitext": "{{CURRENTDOW}}",
		"html": "<p>4\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTDOW</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTMONTH}}",
		"wikitext": "{{CURRENTMONTH}}",
		"html": "<p>01\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTMONTH</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTMONTH1}}",
		"wikitext": "{{CURRENTMONTH1}}",
		"html": "<p>1\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTMONTH1</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTMONTHABBREV}}",
		"wikitext": "{{CURRENTMONTHABBREV}}",
		"html": "<p>Jan\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTMONTHABBREV</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTMONTHNAME}}",
		"wikitext": "{{CURRENTMONTHNAME}}",
		"html": "<p>January\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTMONTHNAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTMONTHNAMEGEN}}",
		"wikitext": "{{CURRENTMONTHNAMEGEN}}",
		"html": "<p>January\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTMONTHNAMEGEN</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTTIME}}",
		"wikitext": "{{CURRENTTIME}}",
		"html": "<p>00:02\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTTIME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTHOUR}}",
		"wikitext": "{{CURRENTHOUR}}",
		"html": "<p>00\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTHOUR</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTWEEK}} (T6594)",
		"wikitext": "{{CURRENTWEEK}}",
		"html": "<p>1\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTWEEK</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTYEAR}}",
		"wikitext": "{{CURRENTYEAR}}",
		"html": "<p>1970\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTYEAR</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{CURRENTTIMESTAMP}}",
		"wikitext": "{{CURRENTTIMESTAMP}}",
		"html": "<p>19700101000203\n</p>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">CURRENTTIMESTAMP</span>}}</span></span>"
	},
	{
		"desc": "Magic Words LOCAL (UTC)",
		"wikitext": "*{{LOCALMONTH}}\n*{{LOCALMONTH1}}\n*{{LOCALMONTHNAME}}\n*{{LOCALMONTHNAMEGEN}}\n*{{LOCALMONTHABBREV}}\n*{{LOCALDAY}}\n*{{LOCALDAY2}}\n*{{LOCALDAYNAME}}\n*{{LOCALYEAR}}\n*{{LOCALTIME}}\n*{{LOCALHOUR}}\n*{{LOCALWEEK}}\n*{{LOCALDOW}}\n*{{LOCALTIMESTAMP}}",
		"html": "<ul><li>01</li>\n<li>1</li>\n<li>January</li>\n<li>January</li>\n<li>Jan</li>\n<li>1</li>\n<li>01</li>\n<li>Thursday</li>\n<li>1970</li>\n<li>00:02</li>\n<li>00</li>\n<li>1</li>\n<li>4</li>\n<li>19700101000203</li></ul>",
		"render": "<ul><li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALMONTH</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALMONTH1</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALMONTHNAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALMONTHNAMEGEN</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALMONTHABBREV</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALDAY</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALDAY2</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALDAYNAME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALYEAR</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALTIME</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALHOUR</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALWEEK</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALDOW</span>}}</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LOCALTIMESTAMP</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{FULLPAGENAME}}",
		"wikitext": "{{FULLPAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">FULLPAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{FULLPAGENAMEE}}",
		"wikitext": "{{FULLPAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">FULLPAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{TALKSPACE}}",
		"wikitext": "{{TALKSPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKSPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{TALKSPACE}}, same namespace",
		"wikitext": "{{TALKSPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKSPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{TALKSPACE}}, main namespace",
		"wikitext": "{{TALKSPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKSPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{TALKSPACEE}}",
		"wikitext": "{{TALKSPACEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKSPACEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBJECTSPACE}}",
		"wikitext": "{{SUBJECTSPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTSPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBJECTSPACE}}, same namespace",
		"wikitext": "{{SUBJECTSPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTSPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBJECTSPACE}}, main namespace",
		"wikitext": "{{SUBJECTSPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTSPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBJECTSPACEE}}",
		"wikitext": "{{SUBJECTSPACEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTSPACEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{NAMESPACE}}",
		"wikitext": "{{NAMESPACE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NAMESPACE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{NAMESPACEE}}",
		"wikitext": "{{NAMESPACEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NAMESPACEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{NAMESPACENUMBER}}",
		"wikitext": "{{NAMESPACENUMBER}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NAMESPACENUMBER</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBPAGENAME}}",
		"wikitext": "{{SUBPAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBPAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBPAGENAMEE}}",
		"wikitext": "{{SUBPAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBPAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{ROOTPAGENAME}}",
		"wikitext": "{{ROOTPAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ROOTPAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{ROOTPAGENAMEE}}",
		"wikitext": "{{ROOTPAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ROOTPAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{BASEPAGENAME}}",
		"wikitext": "{{BASEPAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">BASEPAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{BASEPAGENAMEE}}",
		"wikitext": "{{BASEPAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">BASEPAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{TALKPAGENAME}}",
		"wikitext": "{{TALKPAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKPAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{TALKPAGENAMEE}}",
		"wikitext": "{{TALKPAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">TALKPAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBJECTPAGENAME}}",
		"wikitext": "{{SUBJECTPAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTPAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SUBJECTPAGENAMEE}}",
		"wikitext": "{{SUBJECTPAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SUBJECTPAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{NUMBEROFFILES}}",
		"wikitext": "{{NUMBEROFFILES}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">NUMBEROFFILES</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{PAGENAME}}",
		"wikitext": "{{PAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{PAGENAME}} with metacharacters",
		"wikitext": "''{{PAGENAME}}''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span><span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Magic Word: {{PAGENAME}} with metacharacters (T28781)",
		"wikitext": "{{PAGENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{PAGENAMEE}}",
		"wikitext": "{{PAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{PAGENAMEE}} with metacharacters (T28781)",
		"wikitext": "{{PAGENAMEE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAMEE</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONID}} on latest revision",
		"wikitext": "{{REVISIONID}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONID}} on non-latest revision",
		"wikitext": "{{REVISIONID}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONTIMESTAMP}} on latest revision",
		"wikitext": "{{REVISIONTIMESTAMP}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONTIMESTAMP:{{PAGENAME}}}} on latest revision",
		"wikitext": "{{REVISIONTIMESTAMP:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONTIMESTAMP}} on not-yet-existing current page",
		"wikitext": "{{REVISIONTIMESTAMP}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONTIMESTAMP:{{PAGENAME}}}} on not-yet-existing current page",
		"wikitext": "{{REVISIONTIMESTAMP:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONTIMESTAMP:...}}} on non-existing non-current page",
		"wikitext": "{{REVISIONTIMESTAMP:This page does not exist}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">This page does not exist</span></span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONUSER}} on latest revision",
		"wikitext": "{{REVISIONUSER}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONUSER}} on not-yet-existing current page",
		"wikitext": "{{REVISIONUSER}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONUSER:{{PAGENAME}}}} on not-yet-existing current page",
		"wikitext": "{{REVISIONUSER:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONUSER:...}} on non-existing non-current page",
		"wikitext": "{{REVISIONUSER:This page does not exist}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">This page does not exist</span></span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{REVISIONUSER}} on non-latest revision",
		"wikitext": "{{REVISIONUSER}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONID:{{PAGENAME}}}} on latest revision",
		"wikitext": "{{REVISIONID:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONID:{{PAGENAME}}}} on non-saved revision",
		"wikitext": "{{REVISIONID:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONDAY}} on latest revision",
		"wikitext": "{{REVISIONDAY}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONDAY</span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONDAY:{{PAGENAME}}}} on latest revision",
		"wikitext": "{{REVISIONDAY:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONDAY</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONMONTH}} on latest revision",
		"wikitext": "{{REVISIONMONTH}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONMONTH</span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONMONTH:{{PAGENAME}}}} on latest revision",
		"wikitext": "{{REVISIONMONTH:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONMONTH</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{REVISIONYEAR:{{PAGENAME}}}} on latest revision",
		"wikitext": "{{REVISIONYEAR:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONYEAR</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parser Function: {{PAGESIZE:{{PAGENAME}}}} on latest revision",
		"wikitext": "{{PAGESIZE:{{PAGENAME}}}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGESIZE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGENAME</span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Parser functions with interwiki titles (T355706)",
		"wikitext": "* {{PAGEID:Parser test}} - {{PAGEID:wikipedia:Parser test}}\n* {{PAGESIZE:Parser test}} - {{PAGESIZE:wikipedia:Parser test}}\n* {{REVISIONID:Parser test}} - {{REVISIONID:wikipedia:Parser test}}\n* {{REVISIONDAY:Parser test}} - {{REVISIONDAY:wikipedia:Parser test}}\n* {{REVISIONDAY2:Parser test}} - {{REVISIONDAY2:wikipedia:Parser test}}\n* {{REVISIONMONTH:Parser test}} - {{REVISIONMONTH:wikipedia:Parser test}}\n* {{REVISIONMONTH1:Parser test}} - {{REVISIONMONTH1:wikipedia:Parser test}}\n* {{REVISIONYEAR:Parser test}} - {{REVISIONYEAR:wikipedia:Parser test}}\n* {{REVISIONTIMESTAMP:Parser test}} - {{REVISIONTIMESTAMP:wikipedia:Parser test}}\n* {{REVISIONUSER:Parser test}} - {{REVISIONUSER:wikipedia:Parser test}}",
		"html": "<ul><li>0 - 0</li>\n<li>0 - 0</li>\n<li>-</li>\n<li>1 -</li>\n<li>01 -</li>\n<li>01 -</li>\n<li>1 -</li>\n<li>1970 -</li>\n<li>19700101000203 -</li>\n<li>-</li></ul>",
		"render": "<ul><li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li>\n<li>-</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGEID</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGEID</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGESIZE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGESIZE</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONID</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONDAY</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONDAY</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONDAY2</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONDAY2</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONMONTH</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONMONTH</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONMONTH1</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONMONTH1</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONYEAR</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONYEAR</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONTIMESTAMP</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Parser test</span></span>}}</span> - <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">REVISIONUSER</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">wikipedia:Parser test</span></span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SCRIPTPATH}}",
		"wikitext": "{{SCRIPTPATH}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SCRIPTPATH</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{STYLEPATH}}",
		"wikitext": "{{STYLEPATH}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">STYLEPATH</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SERVER}}",
		"wikitext": "{{SERVER}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SERVER</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SERVERNAME}}",
		"wikitext": "{{SERVERNAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SERVERNAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{SITENAME}}",
		"wikitext": "{{SITENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SITENAME</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: {{PAGELANGUAGE}} on a page with no explicitly set language",
		"wikitext": "{{PAGELANGUAGE}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">PAGELANGUAGE</span>}}</span></span>"
	},
	{
		"desc": "Case-sensitive magic words, when cased differently, should just be template transclusions",
		"wikitext": "{{CurrentMonth}}\n{{currentday}}\n{{cURreNTweEK}}\n{{currentHour}}",
		"html": "<p><a href=\"/index.php?title=Template:CurrentMonth&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:CurrentMonth (page does not exist)\">Template:CurrentMonth</a>\n<a href=\"/index.php?title=Template:Currentday&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:Currentday (page does not exist)\">Template:Currentday</a>\n<a href=\"/index.php?title=Template:CURreNTweEK&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:CURreNTweEK (page does not exist)\">Template:CURreNTweEK</a>\n<a href=\"/index.php?title=Template:CurrentHour&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"Template:CurrentHour (page does not exist)\">Template:CurrentHour</a>\n</p>",
		"render": "<p><a href=\"/wiki/Template%3ACurrentMonth?action=edit&redlink=1\" class=\"new\" title=\"Template:CurrentMonth (page does not exist)\">Template:CurrentMonth</a>\n<a href=\"/wiki/Template%3ACurrentday?action=edit&redlink=1\" class=\"new\" title=\"Template:Currentday (page does not exist)\">Template:Currentday</a>\n<a href=\"/wiki/Template%3ACURreNTweEK?action=edit&redlink=1\" class=\"new\" title=\"Template:CURreNTweEK (page does not exist)\">Template:CURreNTweEK</a>\n<a href=\"/wiki/Template%3ACurrentHour?action=edit&redlink=1\" class=\"new\" title=\"Template:CurrentHour (page does not exist)\">Template:CurrentHour</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">CurrentMonth</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">currentday</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">cURreNTweEK</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">currentHour</span>}}</span></span>"
	},
	{
		"desc": "Case-insensitive magic words should still work with weird casing.",
		"wikitext": "{{sErVeRNaMe}}\n{{LCFirst:AOEU}}\n{{ucFIRST:aoeu}}\n{{SERver}}",
		"html": "<p>example.org\naOEU\nAoeu\n<a rel=\"nofollow\" class=\"external free\" href=\"http://example.org\">http://example.org</a>\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">sErVeRNaMe</span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">LCFirst</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">AOEU</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ucFIRST</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">aoeu</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">SERver</span>}}</span></span>"
	},
	{
		"desc": "Magic Word: prioritize type info over data-parsoid",
		"wikitext": "__FORCETOC__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__FORCETOC__</span></span>"
	},
	{
		"desc": "Magic Word: serialize on separate line (parsoid)",
		"wikitext": "foo\n__NOTOC__\nbar",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-double-underscore\">__NOTOC__</span>\nbar</span>"
	},
	{
		"desc": "Magic Word: case-insensitive (all-lowercase)",
		"wikitext": "foo\n__notoc__\nbar",
		"html": "<p>foo\n</p><p>bar\n</p>",
		"render": "<p>foo\n</p><p>bar\n</p>",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-double-underscore\">__notoc__</span>\nbar</span>"
	},
	{
		"desc": "Magic Word: case-insensitive (mixed case)",
		"wikitext": "foo\n__NOtOC__\nbar",
		"html": "<p>foo\n</p><p>bar\n</p>",
		"render": "<p>foo\n</p><p>bar\n</p>",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-double-underscore\">__NOtOC__</span>\nbar</span>"
	},
	{
		"desc": "Magic words",
		"wikitext": "__TOC__\n__NOTOC__\n__FORCETOC__\n__INDEX__\n__NOINDEX__\n__NOGALLERY__\n__NOEDITSECTION__\n__NOTITLECONVERT__\n__NOCONTENTCONVERT__",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__TOC__</span>\n<span class=\"wpb-double-underscore\">__NOTOC__</span>\n<span class=\"wpb-double-underscore\">__FORCETOC__</span>\n<span class=\"wpb-double-underscore\">__INDEX__</span>\n<span class=\"wpb-double-underscore\">__NOINDEX__</span>\n<span class=\"wpb-double-underscore\">__NOGALLERY__</span>\n<span class=\"wpb-double-underscore\">__NOEDITSECTION__</span>\n<span class=\"wpb-double-underscore\">__NOTITLECONVERT__</span>\n<span class=\"wpb-double-underscore\">__NOCONTENTCONVERT__</span></span>"
	},
	{
		"desc": "media"
	},
	{
		"desc": "Simple image",
		"wikitext": "[[Image:foobar.jpg]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Simple image redirect",
		"wikitext": "[[Image:Redirect to foobar.jpg]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Redirect to foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Serialize simple image with figure-inline wrapper",
		"wikitext": "[[File:Foobar.jpg]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Serialize simple image with mw:Image typeof",
		"wikitext": "[[File:Foobar.jpg]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Simple image (using File: namespace, now canonical)",
		"wikitext": "[[File:Foobar.jpg]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Right-aligned image",
		"wikitext": "[[File:Foobar.jpg|right]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>]]</span></span>"
	},
	{
		"desc": "Image with caption",
		"wikitext": "[[File:Foobar.jpg|right|Caption text]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption text\"><img alt=\"Caption text\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption text</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption text\"><img alt=\"Caption text\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption text</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption text</span>]]</span></span>"
	},
	{
		"desc": "Image with caption, T55312 #1",
		"wikitext": "[[File:Foobar.jpg|right|Caption page stuff]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption page stuff\"><img alt=\"Caption page stuff\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption page stuff</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption page stuff\"><img alt=\"Caption page stuff\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption page stuff</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption page stuff</span>]]</span></span>"
	},
	{
		"desc": "Image with caption, T55312 #2",
		"wikitext": "[[File:Foobar.jpg|right|Caption page=]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption page=\"><img alt=\"Caption page=\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption page=</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption page=\"><img alt=\"Caption page=\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption page=</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption page=</span>]]</span></span>"
	},
	{
		"desc": "Image with caption, T55312 #3",
		"wikitext": "[[File:Foobar.jpg|right|Caption page=stuff]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption page=stuff\"><img alt=\"Caption page=stuff\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption page=stuff</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption page=stuff\"><img alt=\"Caption page=stuff\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption page=stuff</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption page=stuff</span>]]</span></span>"
	},
	{
		"desc": "Image caption with pipe entity",
		"wikitext": "[[File:Foobar.jpg|thumb|one &#x7C; two]]\n[[File:Foobar.jpg|thumb|one ''two'' &#x7C; three]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>one &#x7c; two</figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>one <i>two</i> &#x7c; three</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>one &#x7C; two</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>one <i>two</i> &#x7C; three</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">one &amp;#x7C; two</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">one <span class=\"wpb-quote\">''</span>two<span class=\"wpb-quote\">''</span> &amp;#x7C; three</span>]]</span></span>"
	},
	{
		"desc": "Bad images - basic functionality",
		"wikitext": "[[File:Bad.jpg]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/wiki/File:Bad.jpg\" title=\"File:Bad.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"320\">File:Bad.jpg</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ABad.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ABad.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Bad.jpg</span>]]</span></span>"
	},
	{
		"desc": "Bad images - T18039: text after bad image disappears",
		"wikitext": "Foo bar\n[[File:Bad.jpg]]\nBar foo",
		"html": "<p>Foo bar\n<span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/wiki/File:Bad.jpg\" title=\"File:Bad.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"320\">File:Bad.jpg</span></a></span>\nBar foo\n</p>",
		"render": "<p>Foo bar\n<span><a href=\"/wiki/File%3ABad.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ABad.jpg\" class=\"mw-file-element\"></a></span>\nBar foo\n</p>",
		"print": "<span class=\"wpb-root\">Foo bar\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Bad.jpg</span>]]</span>\nBar foo</span>"
	},
	{
		"desc": "Bad images - manualthumb",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Bad.jpg|Uh oh]]",
		"html": "<figure typeof=\"mw:Error mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">File:Foobar.jpg</span></a><figcaption>Uh oh</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3ABad.jpg\" class=\"mw-file-element\"></a><figcaption>Uh oh</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Bad.jpg</span></span>|<span class=\"wpb-image-caption\">Uh oh</span>]]</span></span>"
	},
	{
		"desc": "Bad images - in gallery",
		"wikitext": "<gallery>\nFile:Bad.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"height: 150px;\"><span typeof=\"mw:Error mw:File\"><a href=\"/wiki/File:Bad.jpg\" title=\"File:Bad.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"120\" data-height=\"120\">File:Bad.jpg</span></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Bad.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Allow empty links in image captions (T62753)",
		"wikitext": "[[File:Foobar.jpg|thumb|Caption [[Link1]]\n[[]]\n[[Link2]]\n]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption>Caption <a href=\"/wiki/Link1\" title=\"Link1\">Link1</a> [[]] <a href=\"/wiki/Link2\" title=\"Link2\">Link2</a> </figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption <a href=\"/wiki/Link1\" title=\"Link1\">Link1</a> [[]] <a href=\"/wiki/Link2\" title=\"Link2\">Link2</a> </figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">Caption <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Link1</span>]]</span>\n[[]]\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Link2</span>]]</span>\n</span>]]</span></span>"
	},
	{
		"desc": "Titles in unlinked images (T23454)",
		"wikitext": "[[File:Foobar.jpg|link=|stuff]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><span title=\"stuff\"><img alt=\"stuff\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></span></span>\n</p>",
		"render": "<p><span><span title=\"stuff\"><img alt=\"stuff\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></span></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>|<span class=\"wpb-image-caption\">stuff</span>]]</span></span>"
	},
	{
		"desc": "Unlinked media in gallery",
		"wikitext": "<gallery>\nFile:Foobar.jpg|link=|stuff\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><span title=\"stuff\"><img alt=\"stuff\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></span></span></div>\n\t\t\t<div class=\"gallerytext\">stuff</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>|<span class=\"wpb-image-caption\">stuff</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Link with empty target",
		"wikitext": "[[]]",
		"html": "<p>[[]]\n</p>",
		"render": "<p>[[]]\n</p>",
		"print": "<span class=\"wpb-root\">[[]]</span>"
	},
	{
		"desc": "Image with link trail",
		"wikitext": "Linktrails should not work for images: [[File:Foobar.jpg]]s",
		"html": "<p>Linktrails should not work for images: <span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>s\n</p>",
		"render": "<p>Linktrails should not work for images: <span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>s\n</p>",
		"print": "<span class=\"wpb-root\">Linktrails should not work for images: <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span>s</span>"
	},
	{
		"desc": "Image with empty attribute",
		"wikitext": "[[File:Foobar.jpg|right||Caption text]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption text\"><img alt=\"Caption text\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption text</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption text\"><img alt=\"Caption text\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption text</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>||<span class=\"wpb-image-caption\">Caption text</span>]]</span></span>"
	},
	{
		"desc": "1. Block image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|thumb|{{1x|137px}}|This is a caption]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/137px-Foobar.jpg\" decoding=\"async\" width=\"137\" height=\"16\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/206px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/274px-Foobar.jpg 2x\" /></a><figcaption>This is a caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"137\"></a><figcaption>This is a caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">137px</span></span>}}</span></span>|<span class=\"wpb-image-caption\">This is a caption</span>]]</span></span>"
	},
	{
		"desc": "2. Block Image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|{{1x|thumb}}|{{1x|137px}}|This is a caption]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/137px-Foobar.jpg\" decoding=\"async\" width=\"137\" height=\"16\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/206px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/274px-Foobar.jpg 2x\" /></a><figcaption>This is a caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"137\"></a><figcaption>This is a caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">thumb</span></span>}}</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">137px</span></span>}}</span></span>|<span class=\"wpb-image-caption\">This is a caption</span>]]</span></span>"
	},
	{
		"desc": "3. Inline image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|{{1x|50px}}]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/50px-Foobar.jpg\" decoding=\"async\" width=\"50\" height=\"6\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/75px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/100px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"50\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">50px</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Image with multiple attributes from the same template",
		"wikitext": "[[File:Foobar.jpg|{{image_attribs}}]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption text\"><img alt=\"Caption text\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption text</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption text\"><img alt=\"Caption text\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption text</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">image_attribs</span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Image with link tails",
		"wikitext": "123[[File:Foobar.jpg]]456\n123[[File:Foobar.jpg|right]]456\n123[[File:Foobar.jpg|thumb]]456",
		"html": "<p>123<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>456\n</p><p>\n123</p><figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure><p>456\n123</p><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure><p>456</p>",
		"render": "<p>123<span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>456\n</p>\n123<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>456\n123<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>456",
		"print": "<span class=\"wpb-root\">123<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span>456\n123<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>]]</span>456\n123<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span>456</span>"
	},
	{
		"desc": "Image with multiple captions -- only last one is accepted",
		"wikitext": "[[File:Foobar.jpg|right|Caption1 - ignored|[[Caption2]] - ignored|Caption3 - accepted]]",
		"html": "<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption3 - accepted\"><img alt=\"Caption3 - accepted\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Caption3 - accepted</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption3 - accepted\"><img alt=\"Caption3 - accepted\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Caption3 - accepted</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption1 - ignored</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Caption2</span>]]</span> - ignored</span>|<span class=\"wpb-image-caption\">Caption3 - accepted</span>]]</span></span>"
	},
	{
		"desc": "Image with multiple widths -- use last",
		"wikitext": "[[File:Foobar.jpg|200px|300px|caption]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg\" decoding=\"async\" width=\"300\" height=\"34\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/450px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/600px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"300\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200</span>px</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">300</span>px</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image with multiple alignments -- use first (T50664)",
		"wikitext": "[[File:Foobar.jpg|thumb|left|right|center|caption]]\n\n[[File:Foobar.jpg|middle|text-top|caption]]",
		"html": "<figure class=\"mw-default-size mw-halign-left\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>\n<p><span class=\"mw-default-size mw-valign-middle\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<figure class=\"mw-halign-left\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-valign-middle\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\">center</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">middle</span>|<span class=\"wpb-image-parameter\">text-top</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image with width attribute at different positions",
		"wikitext": "[[File:Foobar.jpg|200px|right|Caption]]\n[[File:Foobar.jpg|right|200px|Caption]]\n[[File:Foobar.jpg|right|Caption|200px]]",
		"html": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption\"><img alt=\"Caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/200px-Foobar.jpg\" decoding=\"async\" width=\"200\" height=\"23\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/400px-Foobar.jpg 2x\" /></a><figcaption>Caption</figcaption></figure>\n<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption\"><img alt=\"Caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/200px-Foobar.jpg\" decoding=\"async\" width=\"200\" height=\"23\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/400px-Foobar.jpg 2x\" /></a><figcaption>Caption</figcaption></figure>\n<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Caption\"><img alt=\"Caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/200px-Foobar.jpg\" decoding=\"async\" width=\"200\" height=\"23\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/400px-Foobar.jpg 2x\" /></a><figcaption>Caption</figcaption></figure>",
		"render": "<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption\"><img alt=\"Caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"200\"></a><figcaption>Caption</figcaption></figure>\n<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption\"><img alt=\"Caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"200\"></a><figcaption>Caption</figcaption></figure>\n<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Caption\"><img alt=\"Caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"200\"></a><figcaption>Caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200</span>px</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200</span>px</span>|<span class=\"wpb-image-caption\">Caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Caption</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image with size specified with pxpx (T15500, T53628)",
		"wikitext": "[[File:Foobar.jpg|20pxpx]]\n[[File:Foobar.jpg|200x20pxpx]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/20px-Foobar.jpg\" decoding=\"async\" width=\"20\" height=\"2\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/30px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/40px-Foobar.jpg 2x\" /></a></span>\n<span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/177px-Foobar.jpg\" decoding=\"async\" width=\"177\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/265px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/353px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"20\"></a></span>\n<span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"200\" height=\"20\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">20px</span>px</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200x20px</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, wiki target",
		"wikitext": "[[File:Foobar.jpg|link=Main Page]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Main_Page\" title=\"Main Page\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/Main_Page\" title=\"Main Page\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main Page</span></span>]]</span></span>"
	},
	{
		"desc": "File with link to page section",
		"wikitext": "[[Main Page#section]]\n[[File:Foobar.jpg|link=Main Page#section]]",
		"html": "<p><a href=\"/wiki/Main_Page#section\" title=\"Main Page\">Main Page#section</a>\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Main_Page#section\" title=\"Main Page\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><a href=\"/wiki/Main_Page#section\" title=\"Main Page\">Main Page#section</a>\n<span><a href=\"/wiki/Main_Page#section\" title=\"Main Page\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page#section</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main Page#section</span></span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, URL target",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, protocol-less URL target",
		"wikitext": "[[File:Foobar.jpg|link=//example.com/]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"//example.com/\" rel=\"nofollow\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"https://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">//example.com/</span></span>]]</span></span>"
	},
	{
		"desc": "Escaping non-block captions (T107435)",
		"wikitext": "[[Image:Foobar.jpg|alt=123|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">123</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, wgExternalLinkTarget",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"http://example.com/\" target=\"foobar\" rel=\"nofollow noreferrer noopener\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>]]</span></span>"
	},
	{
		"desc": "Thumb with link parameter, wgExternalLinkTarget",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/|thumb]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"http://example.com/\" target=\"foobar\" rel=\"nofollow noreferrer noopener\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, wgNoFollowLinks set to false",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"http://example.com/\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, wgNoFollowDomainExceptions",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"http://example.com/\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter, wgExternalLinkTarget, unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/|Title]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"http://example.com/\" title=\"Title\" target=\"foobar\" rel=\"nofollow noreferrer noopener\"><img alt=\"Title\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"http://example.com/\" title=\"Title\" rel=\"nofollow\"><img alt=\"Title\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Image with empty link parameter",
		"wikitext": "[[File:Foobar.jpg|link=]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><span><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></span></span>\n</p>",
		"render": "<p><span><span><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></span></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter (wiki target) and unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=Main_Page|Title]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Main_Page\" title=\"Title\"><img alt=\"Title\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/Main_Page\" title=\"Title\"><img alt=\"Title\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main_Page</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Image with link parameter (URL target) and unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/|Title]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"http://example.com/\" title=\"Title\" rel=\"nofollow\"><img alt=\"Title\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"http://example.com/\" title=\"Title\" rel=\"nofollow\"><img alt=\"Title\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Thumbnail image with link parameter",
		"wikitext": "[[File:Foobar.jpg|thumb|link=http://example.com/|Title]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"http://example.com/\" rel=\"nofollow\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption>Title</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Title</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com/</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Manually-specified thumbnail image",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|Title]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>Title</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>Title</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Manually-specified thumbnail image (backwards compat)",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|Title]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link to wiki page",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=Main_Page|Title]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/Main_Page\" title=\"Main Page\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>Title</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/Main_Page\" title=\"Main Page\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>Title</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main_Page</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link to url",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=http://example.com|Title]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"http://example.com\" rel=\"nofollow\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>Title</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"http://example.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>Title</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">http://example.com</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Manually-specified thumbnail image with explicit no link",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=|Title]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><span><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></span><figcaption>Title</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><span><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></span><figcaption>Title</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link and alt text",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=Main_Page|alt=alttext|Title]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/Main_Page\" title=\"Main Page\"><img alt=\"alttext\" resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>Title</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/Main_Page\" title=\"Main Page\"><img alt=\"alttext\" src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>Title</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main_Page</span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">alttext</span></span>|<span class=\"wpb-image-caption\">Title</span>]]</span></span>"
	},
	{
		"desc": "Image with frame and link",
		"wikitext": "[[File:Foobar.jpg|frame|left|This is a test image [[Main Page]]]]",
		"html": "<figure class=\"mw-halign-left\" typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>This is a test image <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></figcaption></figure>",
		"render": "<figure class=\"mw-halign-left\" typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>This is a test image <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-caption\">This is a test image <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>]]</span></span>"
	},
	{
		"desc": "Image with frame and link and explicit alt",
		"wikitext": "[[Image:Foobar.jpg|frame|left|This is a test image [[Main Page]]|alt=Altitude]]",
		"html": "<figure class=\"mw-halign-left\" typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"Altitude\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>This is a test image <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></figcaption></figure>",
		"render": "<figure class=\"mw-halign-left\" typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img alt=\"Altitude\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>This is a test image <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-caption\">This is a test image <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">Altitude</span></span>]]</span></span>"
	},
	{
		"desc": "Image with wiki markup in implicit alt",
		"wikitext": "[[Image:Foobar.jpg|testing '''bold''' in alt]]\n\n[[Image:Foobar.jpg|alt=testing '''bold''' in alt]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"testing bold in alt\"><img alt=\"testing bold in alt\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"testing bold in alt\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"testing bold in alt\"><img alt=\"testing bold in alt\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img alt=\"testing bold in alt\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-caption\">testing <span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span> in alt</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">testing <span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span> in alt</span></span>]]</span></span>"
	},
	{
		"desc": "Alt image option should handle most kinds of wikitext without barfing",
		"wikitext": "[[Image:Foobar.jpg|thumb|This is the image caption|alt=This is a [[link]] and a {{1x|''bold template''}}.]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"This is a link and a bold template.\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>This is the image caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img alt=\"This is a link and a bold template.\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>This is the image caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">This is the image caption</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">This is a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">link</span>]]</span> and a <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-quote\">''</span>bold template<span class=\"wpb-quote\">''</span></span></span>}}</span>.</span></span>]]</span></span>"
	},
	{
		"desc": "Ampersand in alt attribute (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=&amp;amp;]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=&amp;amp;\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"&amp;amp;\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"&amp;amp;\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img alt=\"&amp;amp;\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">&amp;amp;amp;</span></span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">&amp;amp;amp;</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Link with encoded pipe in alt option",
		"wikitext": "[[File:Foobar.jpg|alt=http://testing.123?4=5&#x7C;6|caption]]\n\n[[File:Foobar.jpg|alt=http://testing.123?4=5&vert;6|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=http://testing.123?4=5&#x7C;6|caption\nFile:Foobar.jpg|alt=http://testing.123?4=5&vert;6|caption\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"http://testing.123?4=5|6\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"http://testing.123?4=5|6\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"http://testing.123?4=5%7C6%7Ccaption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"http://testing.123?4=5%7C6%7Ccaption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"http://testing.123?4=5&#x7C;6\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"http://testing.123?4=5&vert;6\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">http://testing.123?4=5&amp;#x7C;6</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">http://testing.123?4=5&amp;vert;6</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://testing.123?4=5&amp;#x7C;6|caption</span></span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://testing.123?4=5&amp;vert;6|caption</span></span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Italics markup in alt attribute (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=''x''|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=''x''|caption\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"x\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"x\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">caption</div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"x\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-quote\">''</span>x<span class=\"wpb-quote\">''</span></span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-quote\">''</span>x<span class=\"wpb-quote\">''</span></span></span>|<span class=\"wpb-image-caption\">caption</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Nowiki markup in alt attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=<nowiki>''x''</nowiki>|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=<nowiki>''x''</nowiki>|caption\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"&#39;&#39;x&#39;&#39;\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"&#39;&#39;x&#39;&#39;\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">caption</div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"''x''\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''x''</span>&lt;/nowiki&gt;</span></span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''x''</span>&lt;/nowiki&gt;</span></span></span>|<span class=\"wpb-image-caption\">caption</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Ampersand in link attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|link=Foo_&_bar]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo_&_bar\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Foo_%26_bar\" title=\"Foo &amp; bar\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Foo_%26_bar\" title=\"Foo &amp; bar\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"/wiki/Foo_%26_bar\" title=\"Foo & bar\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Foo_&amp;_bar</span></span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Foo_&amp;_bar</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Italics markup in link attribute (T206940)",
		"wikitext": "[[Foo''s bar''s]]\n\n<!-- Note that \"italics\" are stripped, even though this is a valid page title -->\n[[File:Foobar.jpg|link=Foo''s bar''s|caption1]]\n\n[[File:Foobar.jpg|link=''Main Page''|caption2]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo''s bar''s|caption1\nFile:Foobar.jpg|link=''Main Page''|caption2\n</gallery>",
		"html": "<p><a href=\"/wiki/Foo%27%27s_bar%27%27s\" title=\"Foo&#39;&#39;s bar&#39;&#39;s\">Foo''s bar''s</a>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Foos_bars\" title=\"caption1\"><img alt=\"caption1\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Main_Page\" title=\"caption2\"><img alt=\"caption2\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Foos_bars\" title=\"caption1\"><img alt=\"caption1\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">caption1</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Main_Page\" title=\"caption2\"><img alt=\"caption2\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">caption2</div>\n\t\t</li>\n</ul>",
		"render": "<p><a href=\"/wiki/Foo''s_bar''s\" title=\"Foo''s bar''s\">Foo''s bar''s</a>\n</p><p><span><a href=\"/wiki/Foos_bars\" title=\"caption1\"><img alt=\"caption1\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/Main_Page\" title=\"caption2\"><img alt=\"caption2\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo''s bar''s</span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- Note that \"italics\" are stripped, even though this is a valid page title --&gt;</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Foo<span class=\"wpb-quote\">''</span>s bar<span class=\"wpb-quote\">''</span>s</span></span>|<span class=\"wpb-image-caption\">caption1</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-quote\">''</span>Main Page<span class=\"wpb-quote\">''</span></span></span>|<span class=\"wpb-image-caption\">caption2</span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Foo<span class=\"wpb-quote\">''</span>s bar<span class=\"wpb-quote\">''</span>s</span></span>|<span class=\"wpb-image-caption\">caption1</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-quote\">''</span>Main Page<span class=\"wpb-quote\">''</span></span></span>|<span class=\"wpb-image-caption\">caption2</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Nowiki markup in link attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|link=Foo<nowiki>''s_bar''</nowiki>s|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo<nowiki>''s_bar''</nowiki>s|caption\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Foo%27%27s_bar%27%27s\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Foo%27%27s_bar%27%27s\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">caption</div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=Foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''s_bar''</span>&lt;/nowiki&gt;</span>s</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=Foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''s_bar''</span>&lt;/nowiki&gt;</span>s</span>|<span class=\"wpb-image-caption\">caption</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "HTML entity prefix in link markup (T209236)",
		"wikitext": "[[File:Foobar.jpg|link=https://example.com?foo&params=bar]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=https://example.com?foo&params=bar\n</gallery>",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"https://example.com?foo&amp;params=bar\" rel=\"nofollow\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"https://example.com?foo&amp;params=bar\" rel=\"nofollow\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "<p><span><a href=\"https://example.com/?foo&params=bar\" rel=\"nofollow\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">https://example.com?foo&amp;params=bar</span></span>]]</span>\n\n<span class=\"wpb-comment\">&lt;!-- consistency with gallery extension --&gt;</span>\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">https://example.com?foo&amp;params=bar</span></span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Image with table with attributes in caption",
		"wikitext": "[[File:Foobar.jpg|thumb|\n{| class=\"123\" |\n|- class=\"456\" |\n| ha\n|}\n]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span><span class=\"wpb-attr-dirty\"> |</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">456</span>\"</span><span class=\"wpb-attr-dirty\"> |</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> ha</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n</span>]]</span></span>"
	},
	{
		"desc": "Image with table with rows from templates in caption",
		"wikitext": "[[File:Foobar.jpg|thumb|\n{|\n{{1x|{{!}} hi}}\n|}\n]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span> hi</span></span>}}</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n</span>]]</span></span>"
	},
	{
		"desc": "Image with nested tables in caption",
		"wikitext": "[[File:Foobar.jpg|thumb|Foo<br />\n{|\n|\n{|\n|z\n|}\n|}\n]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">Foo<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">z</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n</span>]]</span></span>"
	},
	{
		"desc": "Image with heading and horizontal rule in caption",
		"wikitext": "[[File:Foobar.jpg|thumb|\n===Testing===\n123\n--------------\n]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption> <div class=\"mw-heading mw-heading3\"><h3 id=\"Testing\">Testing</h3><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: Testing\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div> 123 <hr /> </figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption> <div class=\"mw-heading mw-heading3\"><h3 id=\"Testing\">Testing</h3></div> 123 <hr> </figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">Testing</span>===</span>\n123\n<span class=\"wpb-hr\">--------------</span>\n</span>]]</span></span>"
	},
	{
		"desc": "Image with 'frameless' first.",
		"wikitext": "[[File:Foobar.jpg|frameless|caption]]\n\n[[File:Foobar.jpg|frameless|frame|caption]]\n\n[[File:Foobar.jpg|frameless|thumb|caption]]\n\n[[File:Foobar.jpg|frameless|thumbnail=Thumb.png|caption]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image with 'frame' first.",
		"wikitext": "[[File:Foobar.jpg|frame|caption]]\n[[File:Foobar.jpg|frame|frameless|caption]]\n[[File:Foobar.jpg|frame|thumb|caption]]\n[[File:Foobar.jpg|frame|thumbnail=Thumb.png|caption]]",
		"html": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image with 'thumb' first.",
		"wikitext": "[[File:Foobar.jpg|thumb|caption]]\n[[File:Foobar.jpg|thumb|frameless|caption]]\n[[File:Foobar.jpg|thumb|frame|caption]]\n[[File:Foobar.jpg|thumb|thumbnail=Thumb.png|caption]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image with 'thumbnail=' first.",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|frameless|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|frame|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|thumb|caption]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption>caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image: unspecified format and border enlarge",
		"wikitext": "[[File:Foobar.jpg|2000px]]\n\n[[File:Foobar.jpg|border|2000px]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"2000\" height=\"227\" class=\"mw-file-element\" /></a></span>\n</p><p><span class=\"mw-image-border\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"2000\" height=\"227\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"2000\"></a></span>\n</p><p><span class=\"mw-image-border\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"2000\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">border</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: \"unspecified format\" and border reduce",
		"wikitext": "[[File:Foobar.jpg|1000px]]\n\n[[File:Foobar.jpg|border|1000px]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1000px-Foobar.jpg\" decoding=\"async\" width=\"1000\" height=\"113\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1500px-Foobar.jpg 1.5x, http://example.com/images/3/3a/Foobar.jpg 2x\" /></a></span>\n</p><p><span class=\"mw-image-border\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1000px-Foobar.jpg\" decoding=\"async\" width=\"1000\" height=\"113\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1500px-Foobar.jpg 1.5x, http://example.com/images/3/3a/Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"1000\"></a></span>\n</p><p><span class=\"mw-image-border\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"1000\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">1000</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">border</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">1000</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: thumbs reduce",
		"wikitext": "[[File:Foobar.jpg|thumb|50px]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/50px-Foobar.jpg\" decoding=\"async\" width=\"50\" height=\"6\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/75px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/100px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"50\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: bitmap thumbs can't be enlarged past original size, but vector can.",
		"wikitext": "[[File:Foobar.jpg|thumb|2000px]]\n\n[[File:Foobar.svg|thumb|2000px]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.svg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/f/ff/Foobar.svg/2000px-Foobar.svg.png\" decoding=\"async\" width=\"2000\" height=\"1500\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/3000px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/4000px-Foobar.svg.png 2x\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"2000\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\" width=\"2000\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: frameless can reduce in size",
		"wikitext": "[[File:Foobar.jpg|frameless|50px]]",
		"html": "<p><span typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/50px-Foobar.jpg\" decoding=\"async\" width=\"50\" height=\"6\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/75px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/100px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"50\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: bitmap frameless can't be enlarged past original size, but vector can",
		"wikitext": "[[File:Foobar.jpg|frameless|2000px]]\n\n[[File:Foobar.svg|frameless|2000px]]",
		"html": "<p><span typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p><p><span typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.svg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/f/ff/Foobar.svg/2000px-Foobar.svg.png\" decoding=\"async\" width=\"2000\" height=\"1500\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/3000px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/4000px-Foobar.svg.png 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"2000\"></a></span>\n</p><p><span><a href=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\" width=\"2000\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: framed images are always unscaled.",
		"wikitext": "[[File:Foobar.jpg|frame]]\n\n[[File:Foobar.jpg|frame|50px]]\n\n[[File:Foobar.jpg|frame|50x50px]]\n\n[[File:Foobar.jpg|frame|2000px]]",
		"html": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50x50</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: framed vector images are scaled to their default size AND have srcset",
		"wikitext": "[[File:Foobar.svg|frame]]",
		"html": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File:Foobar.svg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/f/ff/Foobar.svg/240px-Foobar.svg.png\" decoding=\"async\" width=\"240\" height=\"180\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/360px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/480px-Foobar.svg.png 2x\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">frame</span>]]</span></span>"
	},
	{
		"desc": "Image: manualthumb images are always unscaled.",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|50px]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|50x50px]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|2000px]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><img resource=\"/wiki/File:Foobar.jpg\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50x50</span>px</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">2000</span>px</span>]]</span></span>"
	},
	{
		"desc": "Bogus sizes during html2wt",
		"wikitext": "[[File:Foobar.jpg]]\n\n[[File:Foobar.jpg|10x10px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">10x10</span>px</span>]]</span></span>"
	},
	{
		"desc": "Link to image page- image page normally doesn't exist, hence edit link\nAdd test with existing image page\n#<p><a href=\"/wiki/File:Test\" title=\"Image:Test\">Image:test</a>",
		"wikitext": "[[:Image:test]]",
		"html": "<p><a href=\"/index.php?title=File:Test&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"File:Test (page does not exist)\">Image:test</a>\n</p>",
		"render": "<p><a href=\"/wiki/File%3ATest\" title=\"File:Test\">Image:test</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Image:test</span>]]</span></span>"
	},
	{
		"desc": "T20784  Link to non-existent image page with caption should use caption as link text",
		"wikitext": "[[:Image:test|caption]]",
		"html": "<p><a href=\"/index.php?title=File:Test&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"File:Test (page does not exist)\">caption</a>\n</p>",
		"render": "<p><a href=\"/wiki/File%3ATest\" title=\"File:Test\">caption</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Image:test</span>|<span class=\"wpb-link-text\">caption</span>]]</span></span>"
	},
	{
		"desc": "Frameless image caption with a free URL",
		"wikitext": "[[File:Foobar.jpg|http://example.com]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"http://example.com\"><img alt=\"http://example.com\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"http://example.com\"><img alt=\"http://example.com\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://example.com</span></span>]]</span></span>"
	},
	{
		"desc": "Thumbnail image caption with a free URL",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://example.com</span></span>]]</span></span>"
	},
	{
		"desc": "Thumbnail image caption with a free URL and explicit alt",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com|alt=Alteration]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"Alteration\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img alt=\"Alteration\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://example.com</span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">Alteration</span></span>]]</span></span>"
	},
	{
		"desc": "SVG thumbnails with no language set",
		"wikitext": "[[File:Foobar.svg|thumb|caption]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.svg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/f/ff/Foobar.svg/180px-Foobar.svg.png\" decoding=\"async\" width=\"180\" height=\"135\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/270px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/360px-Foobar.svg.png 2x\" /></a><figcaption>caption</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "SVG thumbnails with language de",
		"wikitext": "[[File:Foobar.svg|lang=de|thumb|caption]]\n\n<gallery>\nFile:Foobar.svg|lang=de|caption\n</gallery>",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/index.php?title=File:Foobar.svg&amp;lang=de\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/f/ff/Foobar.svg/langde-180px-Foobar.svg.png\" decoding=\"async\" width=\"180\" height=\"135\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/langde-270px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/langde-360px-Foobar.svg.png 2x\" /></a><figcaption>caption</figcaption></figure>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/index.php?title=File:Foobar.svg&amp;lang=de\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/f/ff/Foobar.svg/langde-120px-Foobar.svg.png\" decoding=\"async\" width=\"120\" height=\"90\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/langde-180px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/langde-240px-Foobar.svg.png 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">caption</div>\n\t\t</li>\n</ul>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.svg?lang=de\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">lang=<span class=\"wpb-image-caption\">de</span></span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">lang=<span class=\"wpb-image-caption\">de</span></span>|<span class=\"wpb-image-caption\">caption</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "SVG thumbnails with invalid language code",
		"wikitext": "[[File:Foobar.svg|thumb|caption|lang=invalid:language:code]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.svg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/f/ff/Foobar.svg/180px-Foobar.svg.png\" decoding=\"async\" width=\"180\" height=\"135\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/270px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/360px-Foobar.svg.png 2x\" /></a><figcaption>lang=invalid:language:code</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\"></a><figcaption>lang=invalid:language:code</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>|<span class=\"wpb-image-caption\">lang=invalid:language:code</span>]]</span></span>"
	},
	{
		"desc": "T3887: A ISBN with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|ISBN 1235467890]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption><a href=\"/wiki/Special:BookSources/1235467890\" class=\"internal mw-magiclink-isbn\">ISBN 1235467890</a></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a href=\"/wiki/Special%3ABookSources%2F1235467890\">ISBN 1235467890</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-magic-link\">ISBN 1235467890</span></span>]]</span></span>"
	},
	{
		"desc": "T3887: A RFC with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|This is RFC 12354]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>This is <a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc12354\">RFC 12354</a></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>This is <a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc12354\">RFC 12354</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">This is <span class=\"wpb-magic-link\">RFC 12354</span></span>]]</span></span>"
	},
	{
		"desc": "T3887: A mailto link with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|Please mailto:nobody@example.com]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>Please <a rel=\"nofollow\" class=\"external free\" href=\"mailto:nobody@example.com\">mailto:nobody@example.com</a></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Please <a rel=\"nofollow\" class=\"external free\" href=\"mailto:nobody@example.com\">mailto:nobody@example.com</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">Please <span class=\"wpb-free-ext-link\">mailto:nobody@example.com</span></span>]]</span></span>"
	},
	{
		"desc": "T2648: Frameless image caption with a link",
		"wikitext": "[[File:Foobar.jpg|text with a [[link]] in it]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"text with a link in it\"><img alt=\"text with a link in it\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"text with a link in it\"><img alt=\"text with a link in it\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">text with a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">link</span>]]</span> in it</span>]]</span></span>"
	},
	{
		"desc": "T2648: Frameless image caption with a link (suffix)",
		"wikitext": "[[File:Foobar.jpg|text with a [[link]]foo in it]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"text with a linkfoo in it\"><img alt=\"text with a linkfoo in it\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"text with a linkfoo in it\"><img alt=\"text with a linkfoo in it\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">text with a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">link</span>]]</span>foo in it</span>]]</span></span>"
	},
	{
		"desc": "T2648: Frameless image caption with an interwiki link",
		"wikitext": "[[File:Foobar.jpg|text with a [[MeatBall:Link]] in it]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"text with a MeatBall:Link in it\"><img alt=\"text with a MeatBall:Link in it\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"text with a MeatBall:Link in it\"><img alt=\"text with a MeatBall:Link in it\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">text with a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">MeatBall:Link</span>]]</span> in it</span>]]</span></span>"
	},
	{
		"desc": "T2648: Frameless image caption with a piped interwiki link",
		"wikitext": "[[File:Foobar.jpg|text with a [[MeatBall:Link|link]] in it]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"text with a link in it\"><img alt=\"text with a link in it\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"text with a link in it\"><img alt=\"text with a link in it\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">text with a <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">MeatBall:Link</span>|<span class=\"wpb-link-text\">link</span>]]</span> in it</span>]]</span></span>"
	},
	{
		"desc": "T107474: Frameless image caption with <nowiki>",
		"wikitext": "[[File:Foobar.jpg|<nowiki>text with a [[MeatBall:Link|link]] in it</nowiki>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">text with a [[MeatBall:Link|link]] in it</span>&lt;/nowiki&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "Escape HTML special chars in image alt text",
		"wikitext": "[[File:Foobar.jpg|& < > \"]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"&amp; &lt; &gt; &quot;\"><img alt=\"&amp; &lt; &gt; &quot;\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"& &lt; &gt; &quot;\"><img alt=\"& &lt; &gt; &quot;\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">&amp; &lt; &gt; \"</span>]]</span></span>"
	},
	{
		"desc": "Escape HTML special chars in image alt text with LanguageConverter",
		"wikitext": "[[File:Foobar.jpg|& < > \"]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">&amp; &lt; &gt; \"</span>]]</span></span>"
	},
	{
		"desc": "Entities in file name and attributes",
		"wikitext": "[[File:7%25 solution.gif|manualthumb=7%25 solution.gif|link=7%25 solution|[[7%25 solution]]]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=7%25_solution.gif\" class=\"new\" title=\"File:7% solution.gif\"><span class=\"mw-file-element mw-broken-media\">7% solution</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/7%25_solution\" title=\"7% solution\"><img alt=\"7% solution\" src=\"/wiki/File%3A7%25_solution.gif\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:7%25 solution.gif</span>|<span class=\"wpb-image-caption\">manualthumb=7%25 solution.gif</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">7%25 solution</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">7%25 solution</span>]]</span></span>]]</span></span>"
	},
	{
		"desc": "T2499: Alt text should have &#1234;, not &amp;1234;",
		"wikitext": "[[File:Foobar.jpg|&#9792;]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"‚ôÄ\"><img alt=\"‚ôÄ\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"&#9792;\"><img alt=\"&#9792;\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">&amp;#9792;</span>]]</span></span>"
	},
	{
		"desc": "Broken image caption with link",
		"wikitext": "[[Image:Foobar.jpg|thumb|This is a broken caption. But [[Main Page|this]] is just an ordinary link.",
		"html": "<p>[[Image:Foobar.jpg|thumb|This is a broken caption. But <a href=\"/wiki/Main_Page\" title=\"Main Page\">this</a> is just an ordinary link.\n</p>",
		"render": "<p>[[Image:Foobar.jpg|thumb|This is a broken caption. But <a href=\"/wiki/Main_Page\" title=\"Main Page\">this</a> is just an ordinary link.\n</p>",
		"print": "<span class=\"wpb-root\">[[Image:Foobar.jpg|thumb|This is a broken caption. But <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">this</span>]]</span> is just an ordinary link.</span>"
	},
	{
		"desc": "Image caption containing another image",
		"wikitext": "[[File:Foobar.jpg|thumb|This is a caption with another [[File:Thumb.png|image]] inside it!]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>This is a caption with another <span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Thumb.png\" class=\"mw-file-description\" title=\"image\"><img alt=\"image\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a></span> inside it!</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>This is a caption with another <span><a href=\"/wiki/File%3AThumb.png\" class=\"mw-file-description\" title=\"image\"><img alt=\"image\" src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a></span> inside it!</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">This is a caption with another <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Thumb.png</span>|<span class=\"wpb-image-caption\">image</span>]]</span> inside it!</span>]]</span></span>"
	},
	{
		"desc": "Image: caption containing a newline",
		"wikitext": "[[File:Foobar.jpg|This\n*is some text]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"This *is some text\"><img alt=\"This *is some text\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"This *is some text\"><img alt=\"This *is some text\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">This\n*is some text</span>]]</span></span>"
	},
	{
		"desc": "Image: caption containing leading space",
		"wikitext": "[[File:Foobar.jpg|thumb| bar]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption> bar</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption> bar</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"> bar</span>]]</span></span>"
	},
	{
		"desc": "Image: caption containing a table",
		"wikitext": "[[Image:Foobar.jpg|thumb|200px|This is an example image thumbnail caption with a table\n{|\n!Foo!!Bar\n|-\n|Foo1||Bar1\n|}\nand some more text.]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/200px-Foobar.jpg\" decoding=\"async\" width=\"200\" height=\"23\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/400px-Foobar.jpg 2x\" /></a><figcaption>This is an example image thumbnail caption with a table <table> <tbody><tr> <th>Foo</th> <th>Bar </th></tr> <tr> <td>Foo1</td> <td>Bar1 </td></tr></tbody></table> and some more text.</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"200\"></a><figcaption>This is an example image thumbnail caption with a table <table > <tbody><tr> <th >Foo</th> <th >Bar </th></tr><tr > <td >Foo1</td> <td >Bar1 </td></tr></tbody></table> and some more text.</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200</span>px</span>|<span class=\"wpb-image-caption\">This is an example image thumbnail caption with a table\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">Foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">Bar</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Foo1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">Bar1</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\nand some more text.</span>]]</span></span>"
	},
	{
		"desc": "T5090: External links other than http: in image captions",
		"wikitext": "[[File:Foobar.jpg|thumb|200x200px|This caption has [irc://example.net irc] and [https://example.com Secure] ext links in it.]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/200px-Foobar.jpg\" decoding=\"async\" width=\"200\" height=\"23\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/400px-Foobar.jpg 2x\" /></a><figcaption>This caption has <a rel=\"nofollow\" class=\"external text\" href=\"irc://example.net\">irc</a> and <a rel=\"nofollow\" class=\"external text\" href=\"https://example.com\">Secure</a> ext links in it.</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"200\" height=\"200\"></a><figcaption>This caption has <a rel=\"nofollow\" class=\"external\" href=\"irc://example.net\">irc</a> and <a rel=\"nofollow\" class=\"external\" href=\"https://example.com/\">Secure</a> ext links in it.</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200x200</span>px</span>|<span class=\"wpb-image-caption\">This caption has <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">irc://example.net</span> <span class=\"wpb-ext-link-text\">irc</span>]</span> and <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">https://example.com</span> <span class=\"wpb-ext-link-text\">Secure</span>]</span> ext links in it.</span>]]</span></span>"
	},
	{
		"desc": "Custom class",
		"wikitext": "[[Image:foobar.jpg|a|class=b]]",
		"html": "<p><span class=\"mw-default-size b\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"a\"><img alt=\"a\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span class=\"b\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"a\"><img alt=\"a\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-caption\">a</span>|<span class=\"wpb-image-parameter\">class=<span class=\"wpb-image-caption\">b</span></span>]]</span></span>"
	},
	{
		"desc": "\"border\", \"frameless\" and \"class\" attributes on an image.",
		"wikitext": "[[File:Foobar.jpg|frameless|border|class=extra|caption]]",
		"html": "<p><span class=\"mw-default-size mw-image-border extra\" typeof=\"mw:File/Frameless\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span class=\"mw-image-border extra\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\">border</span>|<span class=\"wpb-image-parameter\">class=<span class=\"wpb-image-caption\">extra</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Invalid image attributes (T64500)",
		"wikitext": "[[File:Foobar.jpg|thumb|float|left|caption]]\n\n[[File:Foobar.jpg|thumb|righ|caption]]\n\n[[File:Foobar.jpg|bogus1|thumb|bogus2|left|bogus3|caption]]",
		"html": "<figure class=\"mw-default-size mw-halign-left\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-default-size mw-halign-left\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/220px-Foobar.jpg\" decoding=\"async\" width=\"220\" height=\"25\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/330px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/440px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure>",
		"render": "<figure class=\"mw-halign-left\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>\n<figure class=\"mw-halign-left\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">float</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">righ</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">bogus1</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">bogus2</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-caption\">bogus3</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Redirected image",
		"wikitext": "[[Image:Barfoo.jpg]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/wiki/File:Barfoo.jpg\" class=\"mw-redirect\" title=\"File:Barfoo.jpg\"><span class=\"mw-file-element mw-broken-media\">File:Barfoo.jpg</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Barfoo.jpg</span>]]</span></span>"
	},
	{
		"desc": "Missing image with uploads disabled",
		"wikitext": "[[File:Foobaz.jpg]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobaz.jpg</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with size and middle alignment",
		"wikitext": "[[File:Foobar.jpg|middle|50px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">middle</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with size, middle alignment, non-standard namespace alias",
		"wikitext": "[[Image:Foobar.jpg|middle|50px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">middle</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with size and middle alignment (existing content)",
		"wikitext": "[[File:Foobar.jpg|50px|middle]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>|<span class=\"wpb-image-parameter\">middle</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with size and middle alignment and non-standard namespace name",
		"wikitext": "[[Image:Foobar.jpg|50px|middle]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>|<span class=\"wpb-image-parameter\">middle</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with both sizes, a baseline alignment, and a caption",
		"wikitext": "[[File:Foobar.jpg|500x10px|baseline|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">500x10</span>px</span>|<span class=\"wpb-image-parameter\">baseline</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with border and size spec",
		"wikitext": "[[File:Foobar.jpg|50px|border|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50</span>px</span>|<span class=\"wpb-image-parameter\">border</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - thumbnail with halign, valign, and caption",
		"wikitext": "[[File:Foobar.jpg|left|baseline|thumb|caption content]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-parameter\">baseline</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption content</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - thumbnail with halign, valign, and caption (existing content)",
		"wikitext": "[[File:Foobar.jpg|thumb|left|baseline|caption content]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-parameter\">baseline</span>|<span class=\"wpb-image-caption\">caption content</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - thumbnail with specific size, halign, valign, and caption",
		"wikitext": "[[Image:Foobar.jpg|right|middle|thumb|50x50px|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\">middle</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50x50</span>px</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - thumbnail with specific size, halign, valign, and caption (existing content)",
		"wikitext": "[[File:Foobar.jpg|thumb|50x50px|right|middle|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">50x50</span>px</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\">middle</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - framed image with specific size and caption (size is ignored)",
		"wikitext": "[[File:Foobar.jpg|frame|500x50px|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">500x50</span>px</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - framed image with specific size, halign, valign, and caption (size is ignored)",
		"wikitext": "[[File:Foobar.jpg|left|baseline|frame|500x50px|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">left</span>|<span class=\"wpb-image-parameter\">baseline</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">500x50</span>px</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - frameless image with specific size, border, and caption",
		"wikitext": "[[File:Foobar.jpg|frameless|442x50px|border|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">442x50</span>px</span>|<span class=\"wpb-image-parameter\">border</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - simple image with a formatted caption",
		"wikitext": "[[File:Foobar.jpg|<table><tr><td>a</td><td>b</td></tr><tr><td>c</td></tr></table>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>a<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>b<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>c<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - caption with a template in it",
		"wikitext": "[[File:Foobar.jpg|thumb|200x23px|This caption has a {{1x|transclusion}} in it.]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200x23</span>px</span>|<span class=\"wpb-image-caption\">This caption has a <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">transclusion</span></span>}}</span> in it.</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - caption with unbalanced tags in it",
		"wikitext": "foo\n[[File:Foobar.jpg|thumb|200x200px|This caption has a <center>unbalanced tag in it.]]\nbar",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">200x200</span>px</span>|<span class=\"wpb-image-caption\">This caption has a <span class=\"wpb-html\">&lt;center&gt;</span>unbalanced tag in it.</span>]]</span>\nbar</span>"
	},
	{
		"desc": "Parsoid-specific image handling - empty caption (1)",
		"wikitext": "[[File:Foobar.jpg|thumb|]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - empty caption (2)",
		"wikitext": "[[File:Foobar.jpg|thumb]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - whitespace caption",
		"wikitext": "[[File:Foobar.jpg|thumb| ]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"> </span>]]</span></span>"
	},
	{
		"desc": "Parsoid-specific image handling - lang option",
		"wikitext": "foo\n[[File:Foobar.svg|lang=de|caption]]\nbar",
		"html": "<p>foo\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/index.php?title=File:Foobar.svg&amp;lang=de\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"http://example.com/images/thumb/f/ff/Foobar.svg/langde-240px-Foobar.svg.png\" decoding=\"async\" width=\"240\" height=\"180\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/f/ff/Foobar.svg/langde-360px-Foobar.svg.png 1.5x, http://example.com/images/thumb/f/ff/Foobar.svg/langde-480px-Foobar.svg.png 2x\" /></a></span>\nbar\n</p>",
		"render": "<p>foo\n<span><a href=\"/wiki/File%3AFoobar.svg?lang=de\" class=\"mw-file-description\" title=\"caption\"><img alt=\"caption\" src=\"/wiki/File%3AFoobar.svg\" class=\"mw-file-element\"></a></span>\nbar\n</p>",
		"print": "<span class=\"wpb-root\">foo\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.svg</span>|<span class=\"wpb-image-parameter\">lang=<span class=\"wpb-image-caption\">de</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\nbar</span>"
	},
	{
		"desc": "File containing double quotes and spaces",
		"wikitext": "[[File:Cool \"Gator\".png]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Cool_%22Gator%22.png\" class=\"new\" title=\"File:Cool &quot;Gator&quot;.png\"><span class=\"mw-file-element mw-broken-media\">File:Cool \"Gator\".png</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ACool_%22Gator%22.png\" class=\"mw-file-description\"><img src=\"/wiki/File%3ACool_%22Gator%22.png\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Cool \"Gator\".png</span>]]</span></span>"
	},
	{
		"desc": "File containing single quotes",
		"wikitext": "[[File:Foo's ''italic'' bar.jpg]]\n[[File:Foo's ''italic'' bar.jpg|Foo's ''italic'' bar]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Foo%27s_%27%27italic%27%27_bar.jpg\" class=\"new\" title=\"File:Foo&#39;s &#39;&#39;italic&#39;&#39; bar.jpg\"><span class=\"mw-file-element mw-broken-media\">File:Foo's <i>italic</i> bar.jpg</span></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Foo%27s_%27%27italic%27%27_bar.jpg\" class=\"new\" title=\"File:Foo&#39;s &#39;&#39;italic&#39;&#39; bar.jpg\"><span class=\"mw-file-element mw-broken-media\">Foo's italic bar</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoo's_''italic''_bar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoo's_''italic''_bar.jpg\" class=\"mw-file-element\"></a></span>\n<span><a href=\"/wiki/File%3AFoo's_''italic''_bar.jpg\" class=\"mw-file-description\" title=\"Foo's italic bar\"><img alt=\"Foo's italic bar\" src=\"/wiki/File%3AFoo's_''italic''_bar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foo's ''italic'' bar.jpg</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foo's ''italic'' bar.jpg</span>|<span class=\"wpb-image-caption\">Foo's <span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span> bar</span>]]</span></span>"
	},
	{
		"desc": "Broken image links with HTML captions (T41700)",
		"wikitext": "[[File:Nonexistent|<script></script>]]\n[[File:Nonexistent|100x100px|<script></script>]]\n[[File:Nonexistent|&lt;]]\n[[File:Nonexistent|a<i>b</i>c]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Nonexistent\" class=\"new\" title=\"File:Nonexistent\"><span class=\"mw-file-element mw-broken-media\">&lt;script&gt;&lt;/script&gt;</span></a></span>\n<span typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Nonexistent\" class=\"new\" title=\"File:Nonexistent\"><span class=\"mw-file-element mw-broken-media\" data-width=\"100\" data-height=\"100\">&lt;script&gt;&lt;/script&gt;</span></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Nonexistent\" class=\"new\" title=\"File:Nonexistent\"><span class=\"mw-file-element mw-broken-media\">&lt;</span></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Nonexistent\" class=\"new\" title=\"File:Nonexistent\"><span class=\"mw-file-element mw-broken-media\">abc</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ANonexistent\" class=\"mw-file-description\" title=\"&lt;script&gt;&lt;/script&gt;\"><img alt=\"&lt;script&gt;&lt;/script&gt;\" src=\"/wiki/File%3ANonexistent\" class=\"mw-file-element\"></a></span>\n<span><a href=\"/wiki/File%3ANonexistent\" class=\"mw-file-description\" title=\"&lt;script&gt;&lt;/script&gt;\"><img alt=\"&lt;script&gt;&lt;/script&gt;\" src=\"/wiki/File%3ANonexistent\" class=\"mw-file-element\" width=\"100\" height=\"100\"></a></span>\n<span><a href=\"/wiki/File%3ANonexistent\" class=\"mw-file-description\" title=\"&lt;\"><img alt=\"&lt;\" src=\"/wiki/File%3ANonexistent\" class=\"mw-file-element\"></a></span>\n<span><a href=\"/wiki/File%3ANonexistent\" class=\"mw-file-description\" title=\"abc\"><img alt=\"abc\" src=\"/wiki/File%3ANonexistent\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Nonexistent</span>|<span class=\"wpb-image-caption\">&lt;script&gt;&lt;/script&gt;</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Nonexistent</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">100x100</span>px</span>|<span class=\"wpb-image-caption\">&lt;script&gt;&lt;/script&gt;</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Nonexistent</span>|<span class=\"wpb-image-caption\">&amp;lt;</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Nonexistent</span>|<span class=\"wpb-image-caption\">a<span class=\"wpb-html\">&lt;i&gt;</span>b<span class=\"wpb-html\">&lt;/i&gt;</span>c</span>]]</span></span>"
	},
	{
		"desc": "Media in wikilink",
		"wikitext": "[[Test|[[File:Foobar.jpg]]]]",
		"html": "<p>[[Test|<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>]]\n</p>",
		"render": "<p>[[Test|<span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>]]\n</p>",
		"print": "<span class=\"wpb-root\">[[Test|<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span>]]</span>"
	},
	{
		"desc": "Template with thumb image (with link in description)",
		"wikitext": "{{paramtest|param=[[Image:noimage.png|thumb|[[no link|link]] [[no link|caption]]]]}}",
		"html": "<p>This is a test template with parameter </p><figure class=\"mw-default-size\" typeof=\"mw:Error mw:File/Thumb\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Noimage.png\" class=\"new\" title=\"File:Noimage.png\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">File:Noimage.png</span></a><figcaption><a href=\"/wiki/No_link\" title=\"No link\">link</a> <a href=\"/wiki/No_link\" title=\"No link\">caption</a></figcaption></figure>",
		"render": "This is a test template with parameter <figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3ANoimage.png\" class=\"mw-file-description\"><img src=\"/wiki/File%3ANoimage.png\" class=\"mw-file-element\"></a><figcaption><a href=\"/wiki/No_link\" title=\"No link\">link</a> <a href=\"/wiki/No_link\" title=\"No link\">caption</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">paramtest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">param</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:noimage.png</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">no link</span>|<span class=\"wpb-link-text\">link</span>]]</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">no link</span>|<span class=\"wpb-link-text\">caption</span>]]</span></span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "T3219 URL next to image (good)",
		"wikitext": "http://example.com [[File:Foobar.jpg]]",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a> <span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a> <span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span> <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "T3219 URL next to image (broken)",
		"wikitext": "http://example.com[[File:Foobar.jpg]]",
		"html": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>]]</span></span>"
	},
	{
		"desc": "Image link to nonexistent file (T3850 - good)",
		"wikitext": "[[File:No_such.jpg]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=No_such.jpg\" class=\"new\" title=\"File:No such.jpg\"><span class=\"mw-file-element mw-broken-media\">File:No such.jpg</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ANo_such.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ANo_such.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:No_such.jpg</span>]]</span></span>"
	},
	{
		"desc": ":Image link to nonexistent file (T3850 - bad)",
		"wikitext": "[[:Image:No such.jpg]]",
		"html": "<p><a href=\"/index.php?title=File:No_such.jpg&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"File:No such.jpg (page does not exist)\">Image:No such.jpg</a>\n</p>",
		"render": "<p><a href=\"/wiki/File%3ANo_such.jpg\" title=\"File:No such.jpg\">Image:No such.jpg</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">:Image:No such.jpg</span>]]</span></span>"
	},
	{
		"desc": "Fuzz testing: image with bogus manual thumbnail",
		"wikitext": "[[Image:foobar.jpg|thumbnail= ]]",
		"html": "<figure typeof=\"mw:Error mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">Error creating thumbnail: </span></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3A\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\"> </span></span>]]</span></span>"
	},
	{
		"desc": "Gallery with valid attributes",
		"wikitext": "<gallery type=\"123\" summary=\"345\">\nFile:File:Foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\" type=\"123\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"height: 150px;\"><span typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=File:Foobar.jpg\" class=\"new\" title=\"File:File:Foobar.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"120\" data-height=\"120\">File:File:Foobar.jpg</span></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">type</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">summary</span>=\"<span class=\"wpb-attr-value\">345</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery",
		"wikitext": "<gallery>\nimage1.png |\nimage2.gif|||||\n\nimage3|\nimage4    |300px| centre\n image5.svg| http://///////\n[[x|xx]]]]\n* image6\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image1.png </span>|</span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image2.gif</span>|||||</span>\n\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image3</span>|</span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image4    </span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">300</span>px</span>|<span class=\"wpb-image-parameter\"> centre</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\"> image5.svg</span>|<span class=\"wpb-image-caption\"> <span class=\"wpb-free-ext-link\">http://///////</span></span></span>\n<span class=\"wpb-noinclude\">[[x|xx]]]]</span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">* image6</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with line not in the file namespace",
		"wikitext": "<gallery>\n:'''''Albert Willimsky''' ''Geboren am 28.2.1890''\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"height: 150px;\"><span typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=%27%27%27%27%27Albert_Willimsky%27%27%27_%27%27Geboren_am_28.2.1890%27%27\" class=\"new\" title=\"&#39;&#39;&#39;&#39;&#39;Albert Willimsky&#39;&#39;&#39; &#39;&#39;Geboren am 28.2.1890&#39;&#39;\"><span class=\"mw-file-element mw-broken-media\" data-width=\"120\" data-height=\"120\">'''''Albert Willimsky''' ''Geboren am 28.2.1890''</span></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">:'''''Albert Willimsky''' ''Geboren am 28.2.1890''</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery (with options, html)",
		"wikitext": "<gallery widths=\"70px\" heights=\"40px\" perrow=\"2\" caption=\"Foo [[Main Page]]\">\nFile:Nonexistent.jpg|caption\nFile:Nonexistent.jpg\nimage:foobar.jpg|some '''caption''' [[Main Page]]\nimage:foobar.jpg\nimage:foobar.jpg|alt=This is a foo-bar.|blabla.\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">widths</span>=\"<span class=\"wpb-attr-value\">70px</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">heights</span>=\"<span class=\"wpb-attr-value\">40px</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">perrow</span>=\"<span class=\"wpb-attr-value\">2</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">Foo <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Nonexistent.jpg</span>|<span class=\"wpb-image-caption\">caption</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Nonexistent.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span>|<span class=\"wpb-image-caption\">some <span class=\"wpb-quote\">'''</span>caption<span class=\"wpb-quote\">'''</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">This is a foo-bar.</span></span>|<span class=\"wpb-image-caption\">blabla.</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery (without px units)",
		"wikitext": "<gallery widths=\"70\" heights=\"40\">\nFile:Foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 105px\">\n\t\t\t<div class=\"thumb\" style=\"width: 100px; height: 70px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/70px-Foobar.jpg\" decoding=\"async\" width=\"70\" height=\"8\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/105px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/140px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">widths</span>=\"<span class=\"wpb-attr-value\">70</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">heights</span>=\"<span class=\"wpb-attr-value\">40</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery (with invalid units)",
		"wikitext": "<gallery widths=\"70em\" heights=\"40em\">\nFile:Foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">widths</span>=\"<span class=\"wpb-attr-value\">70em</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">heights</span>=\"<span class=\"wpb-attr-value\">40em</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with link that has fragment",
		"wikitext": "<gallery>\nimage:foobar.jpg|link=Main_Page\nimage:foobar.jpg|link=Main_Page#section\nimage:foobar.jpg|link=Main Page#section|caption\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main_Page</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main_Page#section</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main Page#section</span></span>|<span class=\"wpb-image-caption\">caption</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with template inside caption",
		"wikitext": "<gallery caption=\"{{1x|hi}}\">\nFile:Foobar.jpg|{{1x|ho}}\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t<li class=\"gallerycaption\">hi</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"ho\"><img alt=\"ho\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">ho</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span></span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">ho</span></span>}}</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with wikitext inside gallery caption",
		"wikitext": "<gallery caption=\"# This should not be a list item\n\nText '''bold''' [[link]] {{ns:-1}}\n\n[[File:Foobar.jpg|thumb|File in gallery caption]]\">\nFile:Foobar.jpg|Image caption\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\"># This should not be a list item\n\nText <span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">link</span>]]</span> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">ns</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-1</span></span>}}</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">File in gallery caption</span>]]</span></span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">Image caption</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with wikitext inside caption",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|[[File:Foobar.jpg|alt=inneralt|20x20px|desc]]\nFile:Foobar.jpg|alt=galleryalt|{{Test|unamedParam|alt=param}}\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"galleryalt\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"desc\"><img alt=\"inneralt\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/20px-Foobar.jpg\" decoding=\"async\" width=\"20\" height=\"2\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/30px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/40px-Foobar.jpg 2x\" /></a></span></div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"This is a test template\"><img alt=\"galleryalt\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">This is a test template</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">inneralt</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">20x20</span>px</span>|<span class=\"wpb-image-caption\">desc</span>]]</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Test</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">unamedParam</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">alt</span>=<span class=\"wpb-parameter-value\">param</span></span>}}</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with wikitext incl bogus HTML tag (T237318)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|</ref>\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"&lt;/ref&gt;\"><img alt=\"&lt;/ref&gt;\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">&lt;/ref&gt;</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">&lt;/ref&gt;</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery (with showfilename option)",
		"wikitext": "<gallery showfilename=\"\">\nFile:Nonexistent.jpg|caption\nFile:Nonexistent.jpg\nFile:Foobar.jpg|some '''caption''' [[Main Page]]\nFile:Foobar.jpg\nFile:Redirect to foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"height: 150px;\"><span typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Nonexistent.jpg\" class=\"new\" title=\"File:Nonexistent.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"120\" data-height=\"120\">caption</span></a></span></div>\n\t\t\t<div class=\"gallerytext\"><a href=\"/wiki/File:Nonexistent.jpg\" class=\"galleryfilename galleryfilename-truncate\" title=\"File:Nonexistent.jpg\">Nonexistent.jpg</a>\ncaption</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"height: 150px;\"><span typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Nonexistent.jpg\" class=\"new\" title=\"File:Nonexistent.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"120\" data-height=\"120\">File:Nonexistent.jpg</span></a></span></div>\n\t\t\t<div class=\"gallerytext\"><a href=\"/wiki/File:Nonexistent.jpg\" class=\"galleryfilename galleryfilename-truncate\" title=\"File:Nonexistent.jpg\">Nonexistent.jpg</a>\n</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"some caption Main Page\"><img alt=\"some caption Main Page\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"><a href=\"/wiki/File:Foobar.jpg\" class=\"galleryfilename galleryfilename-truncate\" title=\"File:Foobar.jpg\">Foobar.jpg</a>\nsome <b>caption</b> <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"><a href=\"/wiki/File:Foobar.jpg\" class=\"galleryfilename galleryfilename-truncate\" title=\"File:Foobar.jpg\">Foobar.jpg</a>\n</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"><a href=\"/wiki/File:Foobar.jpg\" class=\"galleryfilename galleryfilename-truncate\" title=\"File:Foobar.jpg\">Foobar.jpg</a>\n</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">showfilename</span>=\"\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Nonexistent.jpg</span>|<span class=\"wpb-image-caption\">caption</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Nonexistent.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">some <span class=\"wpb-quote\">'''</span>caption<span class=\"wpb-quote\">'''</span> <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Redirect to foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery (with namespace-less filenames)",
		"wikitext": "<gallery>\nFile:Nonexistent.jpg\nNonexistent.jpg\nimage:foobar.jpg\nfoobar.jpg\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Nonexistent.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">Nonexistent.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">image:foobar.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery override link with wikilink (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|link=Wikilink|alt=galleryalt\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Wikilink\" title=\"Wikilink\"><img alt=\"galleryalt\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Wikilink</span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery override link with absolute external link (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|link=http://www.example.org\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"http://www.example.org\" rel=\"nofollow\"><img alt=\"galleryalt\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://www.example.org</span></span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery override link with absolute external link with LanguageConverter",
		"wikitext": "<gallery>\nFile:foobar.jpg|caption|alt=galleryalt|link=http://www.example.org\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:foobar.jpg</span>|<span class=\"wpb-image-caption\">caption</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://www.example.org</span></span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery override link with malicious javascript (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|link=\" onclick=\"alert('malicious javascript code!');\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">\" onclick=\"alert('malicious javascript code!');</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with invalid title as link (T45964)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|link=<\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=&lt;</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Serialize gallery without attrs in data-mw",
		"wikitext": "<gallery caption=\"123\">\nFile:Test.png\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Test.png</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery with class and style attributes",
		"wikitext": "<gallery class=\"center\" style=\"text-align: center;\">\nFile:Foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional center\" style=\"text-align: center;\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">text-align: center;</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery in nolines mode",
		"wikitext": "<gallery mode=\"nolines\" showfilenames=\"yes\" caption=\"No Lines!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-nolines\">\n\t<li class=\"gallerycaption\">No Lines!</li>\n\t\t<li class=\"gallerybox\" style=\"width: 125px\">\n\t\t\t<div class=\"thumb\" style=\"width: 120px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"foo\"><img alt=\"foo\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">foo</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">mode</span>=\"<span class=\"wpb-attr-value\">nolines</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">showfilenames</span>=\"<span class=\"wpb-attr-value\">yes</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">No Lines!</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">foo</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery in slideshow mode",
		"wikitext": "<gallery mode=\"slideshow\" showthumbnails=\"\">\nFile:Foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-slideshow\" data-showthumbnails=\"1\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">mode</span>=\"<span class=\"wpb-attr-value\">slideshow</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">showthumbnails</span>=\"\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery in packed mode",
		"wikitext": "<gallery mode=\"packed\">\nFile:Foobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-packed\">\n\t\t<li class=\"gallerybox\" style=\"width: 1061.3333333333px\">\n\t\t\t<div class=\"thumb\" style=\"width: 1059.3333333333px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1589px-Foobar.jpg\" decoding=\"async\" width=\"1060\" height=\"120\" class=\"mw-file-element\" srcset=\"http://example.com/images/3/3a/Foobar.jpg 1.5x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">mode</span>=\"<span class=\"wpb-attr-value\">packed</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery in packed-overlay mode",
		"wikitext": "<gallery mode=\"packed-overlay\" showfilenames=\"yes\" caption=\"Packed Overlay!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-packed-overlay\">\n\t<li class=\"gallerycaption\">Packed Overlay!</li>\n\t\t<li class=\"gallerybox\" style=\"width: 1061.3333333333px\">\n\t\t\t<div class=\"thumb\" style=\"width: 1059.3333333333px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"foo\"><img alt=\"foo\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1589px-Foobar.jpg\" decoding=\"async\" width=\"1060\" height=\"120\" class=\"mw-file-element\" srcset=\"http://example.com/images/3/3a/Foobar.jpg 1.5x\" /></a></span></div>\n\t\t\t<div class=\"gallerytextwrapper\" style=\"width: 1040px\"><div class=\"gallerytext\">foo</div>\n\t\t\t</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">mode</span>=\"<span class=\"wpb-attr-value\">packed-overlay</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">showfilenames</span>=\"<span class=\"wpb-attr-value\">yes</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">Packed Overlay!</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">foo</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery in packed-hover mode",
		"wikitext": "<gallery mode=\"packed-hover\" showfilenames=\"yes\" caption=\"Packed Hover!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-packed-hover\">\n\t<li class=\"gallerycaption\">Packed Hover!</li>\n\t\t<li class=\"gallerybox\" style=\"width: 1061.3333333333px\">\n\t\t\t<div class=\"thumb\" style=\"width: 1059.3333333333px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"foo\"><img alt=\"foo\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/1589px-Foobar.jpg\" decoding=\"async\" width=\"1060\" height=\"120\" class=\"mw-file-element\" srcset=\"http://example.com/images/3/3a/Foobar.jpg 1.5x\" /></a></span></div>\n\t\t\t<div class=\"gallerytextwrapper\" style=\"width: 1040px\"><div class=\"gallerytext\">foo</div>\n\t\t\t</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">mode</span>=\"<span class=\"wpb-attr-value\">packed-hover</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">showfilenames</span>=\"<span class=\"wpb-attr-value\">yes</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">Packed Hover!</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">foo</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Serialize gallery image captions on a line",
		"wikitext": "<gallery>\nFile:Foobar.jpg| hi  ho \nFile:Foobar.jpg|hi<br />ho\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"> hi  ho </span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">hi<span class=\"wpb-html\">&lt;br<span class=\"wpb-html-attrs\"> </span>/&gt;</span>ho</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Centre-aligned image",
		"wikitext": "[[Image:foobar.jpg|centre]]",
		"html": "<figure class=\"mw-default-size mw-halign-center\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure class=\"mw-halign-center\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">centre</span>]]</span></span>"
	},
	{
		"desc": "None-aligned image",
		"wikitext": "[[Image:foobar.jpg|none]]",
		"html": "<figure class=\"mw-default-size mw-halign-none\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure class=\"mw-halign-none\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\">none</span>]]</span></span>"
	},
	{
		"desc": "Width + Height sized image (using px) (height is ignored)",
		"wikitext": "[[Image:foobar.jpg|640x480px]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/640px-Foobar.jpg\" decoding=\"async\" width=\"640\" height=\"73\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/960px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/1280px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"640\" height=\"480\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">640x480</span>px</span>]]</span></span>"
	},
	{
		"desc": "Width-sized image (using px, no following whitespace)",
		"wikitext": "[[Image:foobar.jpg|640px]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/640px-Foobar.jpg\" decoding=\"async\" width=\"640\" height=\"73\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/960px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/1280px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"640\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">640</span>px</span>]]</span></span>"
	},
	{
		"desc": "Width-sized image (using px, with following whitespace - test regression from r39467)",
		"wikitext": "[[Image:foobar.jpg|640px ]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/640px-Foobar.jpg\" decoding=\"async\" width=\"640\" height=\"73\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/960px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/1280px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"640\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">640</span>px </span>]]</span></span>"
	},
	{
		"desc": "Width-sized image (using px, with preceding whitespace - test regression from r39467)",
		"wikitext": "[[Image:foobar.jpg| 640px]]",
		"html": "<p><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/640px-Foobar.jpg\" decoding=\"async\" width=\"640\" height=\"73\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/960px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/1280px-Foobar.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"640\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:foobar.jpg</span>|<span class=\"wpb-image-parameter\"> <span class=\"wpb-image-caption\">640</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image with page parameter",
		"wikitext": "[[File:LoremIpsum.djvu]]\n\n[[File:LoremIpsum.djvu|page=2]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:LoremIpsum.djvu\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page1-2480px-LoremIpsum.djvu.jpg\" decoding=\"async\" width=\"2480\" height=\"3508\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page1-3720px-LoremIpsum.djvu.jpg 1.5x, http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page1-4960px-LoremIpsum.djvu.jpg 2x\" /></a></span>\n</p><p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/index.php?title=File:LoremIpsum.djvu&amp;page=2\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-2480px-LoremIpsum.djvu.jpg\" decoding=\"async\" width=\"2480\" height=\"3508\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-3720px-LoremIpsum.djvu.jpg 1.5x, http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-4960px-LoremIpsum.djvu.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-description\"><img src=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-element\"></a></span>\n</p><p><span><a href=\"/wiki/File%3ALoremIpsum.djvu?page=2\" class=\"mw-file-description\"><img src=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-parameter\">page=<span class=\"wpb-image-caption\">2</span></span>]]</span></span>"
	},
	{
		"desc": "Image with page parameter and link",
		"wikitext": "[[File:LoremIpsum.djvu|link=https://google.com|page=2]]\n[[File:LoremIpsum.djvu|link=https://google.com?page=4|page=2]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"https://google.com\" rel=\"nofollow\"><img src=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-2480px-LoremIpsum.djvu.jpg\" decoding=\"async\" width=\"2480\" height=\"3508\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-3720px-LoremIpsum.djvu.jpg 1.5x, http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-4960px-LoremIpsum.djvu.jpg 2x\" /></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"https://google.com?page=4\" rel=\"nofollow\"><img src=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-2480px-LoremIpsum.djvu.jpg\" decoding=\"async\" width=\"2480\" height=\"3508\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-3720px-LoremIpsum.djvu.jpg 1.5x, http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-4960px-LoremIpsum.djvu.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"https://google.com/\" rel=\"nofollow\"><img src=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-element\"></a></span>\n<span><a href=\"https://google.com/?page=4\" rel=\"nofollow\"><img src=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">https://google.com</span></span>|<span class=\"wpb-image-parameter\">page=<span class=\"wpb-image-caption\">2</span></span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">https://google.com?page=4</span></span>|<span class=\"wpb-image-parameter\">page=<span class=\"wpb-image-caption\">2</span></span>]]</span></span>"
	},
	{
		"desc": "Image with page parameter and manualthumb",
		"wikitext": "[[File:LoremIpsum.djvu|thumbnail=Thumb.png|page=2]]",
		"html": "<figure typeof=\"mw:File/Thumb\"><a href=\"/index.php?title=File:LoremIpsum.djvu&amp;page=2\" title=\"File:LoremIpsum.djvu\"><img resource=\"/wiki/File:LoremIpsum.djvu?page=2\" src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3ALoremIpsum.djvu?page=2\" title=\"File:LoremIpsum.djvu\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Thumb.png</span></span>|<span class=\"wpb-image-parameter\">page=<span class=\"wpb-image-caption\">2</span></span>]]</span></span>"
	},
	{
		"desc": "Image with page parameter generated by a template",
		"wikitext": "[[File:LoremIpsum.djvu|page={{1x|2}}]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/index.php?title=File:LoremIpsum.djvu&amp;page=2\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-2480px-LoremIpsum.djvu.jpg\" decoding=\"async\" width=\"2480\" height=\"3508\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-3720px-LoremIpsum.djvu.jpg 1.5x, http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-4960px-LoremIpsum.djvu.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ALoremIpsum.djvu?page=2\" class=\"mw-file-description\"><img src=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-caption\">page=<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Image with modified page parameter; serialize data-mw not href query",
		"wikitext": "[[File:LoremIpsum.djvu|page 2]]\n\n[[File:LoremIpsum.djvu|page {{1x|2}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-parameter\">page <span class=\"wpb-image-caption\">2</span></span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-caption\">page <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Image with modified page parameter; serialize data-mw not href query (2)",
		"wikitext": "[[File:LoremIpsum.djvu|page 2]]\n\n[[File:LoremIpsum.djvu|page {{1x|2}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-parameter\">page <span class=\"wpb-image-caption\">2</span></span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-caption\">page <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Images with the \"|\" character in the comment",
		"wikitext": "[[File:Foobar.jpg|thumb|An [http://test/?param1=|left|&param2=|x external] URL]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>An <a rel=\"nofollow\" class=\"external text\" href=\"http://test/?param1=%7Cleft%7C&amp;param2=%7Cx\">external</a> URL</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>An <a rel=\"nofollow\" class=\"external\" href=\"http://test/?param1=|left|&param2=|x\">external</a> URL</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">An <span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://test/?param1=|left|&amp;param2=|x</span> <span class=\"wpb-ext-link-text\">external</span>]</span> URL</span>]]</span></span>"
	},
	{
		"desc": "T146305: Don't break image parsing if nested language converter markup is in the caption.",
		"wikitext": "[[File:Foobar.jpg|thumb|-{|zh-cn:blog (hk: -{zh-hans|WEBJOURNAL}-, tw: -{zh-hans|WEBLOG}-)}-]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>blog (hk: WEBJOURNAL, tw: WEBLOG)</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>blog (hk: WEBJOURNAL, tw: WEBLOG)</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-converter\">-{|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-variant\">zh-cn</span>:<span class=\"wpb-converter-rule-to\">blog (hk: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">zh-hans</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">WEBJOURNAL</span></span>}-</span>, tw: <span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">zh-hans</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">WEBLOG</span></span>}-</span>)</span></span>}-</span></span>]]</span></span>"
	},
	{
		"desc": "Don't break gallery if language converter markup is inside.",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=-{R|bat}-|[[File:foobar.jpg|20px|desc|alt=-{R|foo}-|-{R|bar}-]]\nFile:Foobar.jpg|alt=galleryalt|{{Test|unamedParam|alt=-{R|param}-}}\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">-{R|bat}-</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">20</span>px</span>|<span class=\"wpb-image-caption\">desc</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">-{R|foo}-</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">bar</span></span>}-</span></span>]]</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">galleryalt</span></span>|<span class=\"wpb-image-caption\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Test</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">unamedParam</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">alt</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">param</span></span>}-</span></span></span>}}</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Free external link invading image caption",
		"wikitext": "[[File:Foobar.jpg|thumb|http://x|hello]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>hello</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>hello</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://x</span></span>|<span class=\"wpb-image-caption\">hello</span>]]</span></span>"
	},
	{
		"desc": "Special characters in embedded file links (T29679)",
		"wikitext": "[[File:Contains & ampersand.jpg]]\n[[File:Does not exist.jpg|Title with & ampersand]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Contains_%26_ampersand.jpg\" class=\"new\" title=\"File:Contains &amp; ampersand.jpg\"><span class=\"mw-file-element mw-broken-media\">File:Contains &amp; ampersand.jpg</span></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Does_not_exist.jpg\" class=\"new\" title=\"File:Does not exist.jpg\"><span class=\"mw-file-element mw-broken-media\">Title with &amp; ampersand</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AContains_%26_ampersand.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AContains_%26_ampersand.jpg\" class=\"mw-file-element\"></a></span>\n<span><a href=\"/wiki/File%3ADoes_not_exist.jpg\" class=\"mw-file-description\" title=\"Title with & ampersand\"><img alt=\"Title with & ampersand\" src=\"/wiki/File%3ADoes_not_exist.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Contains &amp; ampersand.jpg</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Does not exist.jpg</span>|<span class=\"wpb-image-caption\">Title with &amp; ampersand</span>]]</span></span>"
	},
	{
		"desc": "1. Treebuilder fixup of formatting elt",
		"wikitext": "{|\n|\n<small>\n[[Image:Foobar.jpg|right|Test]]\n</small>\n|}",
		"html": "<table>\n<tbody><tr>\n<td>\n<p><small>\n</small></p><small>\n<figure class=\"mw-default-size mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Test\"><img alt=\"Test\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a><figcaption>Test</figcaption></figure>\n</small><p><small></small>\n</p>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >\n<p><small >\n</p>\n<figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"Test\"><img alt=\"Test\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Test</figcaption></figure>\n<p></small>\n</p>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n<span class=\"wpb-html\">&lt;small&gt;</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-caption\">Test</span>]]</span>\n<span class=\"wpb-html\">&lt;/small&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2. Treebuilder fixup of formatting elt",
		"wikitext": "'''foo[[File:Foobar.jpg|thumb|caption]]bar'''\n\n<small>[[Image:Foobar.jpg|right|300px]]</small>",
		"html": "<p><b>foo</b></p><b><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure></b><p><b>bar</b>\n</p><small><figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg\" decoding=\"async\" width=\"300\" height=\"34\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/450px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/600px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure></small>",
		"render": "<b>foo</b><b><figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure></b><b>bar</b>\n<small ><figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"300\"></a><figcaption></figcaption></figure></small>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>bar<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-html\">&lt;small&gt;</span><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">300</span>px</span>]]</span><span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "3. Treebuilder fixup of formatting elt",
		"wikitext": "<small>'''foo[[File:Foobar.jpg|thumb|caption]]bar'''</small>",
		"html": "<p><small><b>foo</b></small></p><small><b><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>caption</figcaption></figure></b></small><p><small><b>bar</b></small></p>",
		"render": "<small ><b>foo</b><b><figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>caption</figcaption></figure></b><b>bar</b></small>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;small&gt;</span><span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>bar<span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;/small&gt;</span></span>"
	},
	{
		"desc": "4. Treebuilder fixup of formatting elt: formatting tags around captionless images",
		"wikitext": "'''<small>[[Image:Foobar.jpg|right|300px]]</small>'''",
		"html": "<b><small><figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/300px-Foobar.jpg\" decoding=\"async\" width=\"300\" height=\"34\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/450px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/600px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure></small></b>",
		"render": "<small ><b><figure class=\"mw-halign-right\" typeof=\"mw:File\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\" width=\"300\"></a><figcaption></figcaption></figure></b></small>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;small&gt;</span><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">300</span>px</span>]]</span><span class=\"wpb-html\">&lt;/small&gt;</span><span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Image: Modifying size of an image (1)",
		"wikitext": "[[Image:Foobar.jpg|230x230px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">230x230</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying size of an image (2)",
		"wikitext": "[[Image:Foobar.jpg|230x230px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">230x230</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying size of an image (3)",
		"wikitext": "[[Image:Foobar.jpg|thumb]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying alignment of an image (T50665)",
		"wikitext": "[[Image:Foobar.jpg|thumb|caption|right]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>|<span class=\"wpb-image-parameter\">right</span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying mw-default-size of an frameless image (T64805)",
		"wikitext": "[[Image:Foobar.jpg|frameless|right]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-parameter\">right</span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying valign of an image (T51221)",
		"wikitext": "[[File:Foobar.jpg|20px|middle]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">20</span>px</span>|<span class=\"wpb-image-parameter\">middle</span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying alt attribute of an image (T58400)",
		"wikitext": "[[File:Foobar.jpg|thumb|some caption|alt=some alternate text]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">some caption</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">some alternate text</span></span>]]</span></span>"
	},
	{
		"desc": "Image: Modifying caption of an image",
		"wikitext": "[[Image:Foobar.jpg|thumb|original caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">Image:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">original caption</span>]]</span></span>"
	},
	{
		"desc": "Image: empty alt attribute (T50924)",
		"wikitext": "[[File:Foobar.jpg|alt=|thumb|bar]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img alt=\"\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>bar</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>bar</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"></span></span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">bar</span>]]</span></span>"
	},
	{
		"desc": "Image: Block level image should have \\n before and after",
		"wikitext": "123\n[[File:Foobar.jpg|right|thumb|150x150px]]\n456",
		"print": "<span class=\"wpb-root\">123\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">150x150</span>px</span>]]</span>\n456</span>"
	},
	{
		"desc": "Image: New block level image should have \\n before and after (existing content)",
		"wikitext": "123\n[[File:Foobar.jpg|right|thumb|150x150px]]\n456",
		"print": "<span class=\"wpb-root\">123\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">right</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">150x150</span>px</span>]]</span>\n456</span>"
	},
	{
		"desc": "Image: upright option (parsoid)",
		"wikitext": "[[File:Foobar.jpg|thumb|upright|caption]]\n[[File:Foobar.jpg|thumb|upright=0.5|caption]]\n[[File:Foobar.jpg|thumb|500x500px|upright=0.5|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">upright</span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">upright=<span class=\"wpb-image-caption\">0.5</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">500x500</span>px</span>|<span class=\"wpb-image-parameter\">upright=<span class=\"wpb-image-caption\">0.5</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image: upright option is ignored on inline and frame images (parsoid)",
		"wikitext": "[[File:Foobar.jpg|500x500px|upright=0.5|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">500x500</span>px</span>|<span class=\"wpb-image-parameter\">upright=<span class=\"wpb-image-caption\">0.5</span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Image: in template parameter with empty parameter",
		"wikitext": "{{1x|[[File:Foobar.jpg|link=]]}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>]]</span></span></span>}}</span></span>"
	},
	{
		"desc": "Image: from basic HTML (1)",
		"wikitext": "[[File:Foobar.jpg|link=|alt=Alt|100x100px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">Alt</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">100x100</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: from basic HTML (2)",
		"wikitext": "[[File:Foobar.jpg|link=|alt=Alt|100x100px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">Alt</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">100x100</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: from basic HTML (3)",
		"wikitext": "[[File:Foobar.jpg|link=Main|alt=Alt|100x100px]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Main</span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">Alt</span></span>|<span class=\"wpb-image-parameter\"><span class=\"wpb-image-caption\">100x100</span>px</span>]]</span></span>"
	},
	{
		"desc": "Image: from basic HTML (4)",
		"wikitext": "[[File:Foobar.jpg|link=]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"></span></span>]]</span></span>"
	},
	{
		"desc": "Image: Invalid title as link",
		"wikitext": "[[File:Foobar.jpg|link=<]]\n[[File:Foobar.jpg|link=<|thumb]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"link=&lt;\"><img alt=\"link=&lt;\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>link=&lt;</figcaption></figure>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"link=&lt;\"><img alt=\"link=&lt;\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>link=&lt;</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=&lt;</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=&lt;</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span></span>"
	},
	{
		"desc": "Image with page parameter and invalid link",
		"wikitext": "[[File:LoremIpsum.djvu|link=<|page=2]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/index.php?title=File:LoremIpsum.djvu&amp;page=2\" class=\"mw-file-description\" title=\"link=&lt;\"><img alt=\"link=&lt;\" src=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-2480px-LoremIpsum.djvu.jpg\" decoding=\"async\" width=\"2480\" height=\"3508\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-3720px-LoremIpsum.djvu.jpg 1.5x, http://example.com/images/thumb/5/5f/LoremIpsum.djvu/page2-4960px-LoremIpsum.djvu.jpg 2x\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ALoremIpsum.djvu?page=2\" class=\"mw-file-description\" title=\"link=&lt;\"><img alt=\"link=&lt;\" src=\"/wiki/File%3ALoremIpsum.djvu\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:LoremIpsum.djvu</span>|<span class=\"wpb-image-caption\">link=&lt;</span>|<span class=\"wpb-image-parameter\">page=<span class=\"wpb-image-caption\">2</span></span>]]</span></span>"
	},
	{
		"desc": "Percent decode titles in the link option (T216003#7836261)",
		"wikitext": "[[Test%22123]]\n[[File:Foobar.jpg|link=Test%22123]]\n[[File:Foobar.jpg|link=[[Test%22123]]]]\n\n<gallery>\nFile:Foobar.jpg|link=Test%22123\nFile:Foobar.jpg|link=[[Test%22123]]\n</gallery>",
		"html": "<p><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\">Test\"123</a>\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\"><img src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "<p><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\">Test\"123</a>\n<span><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n<span><a href=\"/wiki/Test%22123\" title=\"Test&quot;123\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test%22123</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Test%22123</span></span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test%22123</span>]]</span></span></span>]]</span>\n\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\">Test%22123</span></span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test%22123</span>]]</span></span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Should not double decode the link option",
		"wikitext": "[[Test%2522]]\n[[File:Foobar.jpg|link=Test%2522]]\n[[File:Foobar.jpg|link=[[Test%2522]]]]",
		"html": "<p>[[Test%2522]]\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"link=Test%2522\"><img alt=\"link=Test%2522\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n<span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"link=[[Test%2522]]\"><img alt=\"link=[[Test%2522]]\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p>[[Test%2522]]\n<span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"link=Test%2522\"><img alt=\"link=Test%2522\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n<span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"link=[[Test%2522]]\"><img alt=\"link=[[Test%2522]]\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\">[[Test%2522]]\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=Test%2522</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">link=[[Test%2522]]</span>]]</span></span>"
	},
	{
		"desc": "Various link types in alt and link options",
		"wikitext": "[[File:Foobar.jpg|link=[[Main Page]]|alt=[[Main Page]]|caption]]\n\n[[File:Foobar.jpg|link=[[Media:Thumb.png]]|alt=[[Media:Thumb.png]]|caption]]\n\n[[File:Foobar.jpg|link=[[wikipedia:Foo]]|alt=[[wikipedia:Foo]]|caption]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Thumb.png</span>]]</span></span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Media:Thumb.png</span>]]</span></span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span>\n\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">link=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">wikipedia:Foo</span>]]</span></span></span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">wikipedia:Foo</span>]]</span></span></span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "Magic links inside image captions (autolinked)",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com]]\n[[File:Foobar.jpg|thumb|RFC 1234]]\n[[File:Foobar.jpg|thumb|PMID 1234]]\n[[File:Foobar.jpg|thumb|ISBN 123456789x]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com\">http://example.com</a></figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption><a class=\"external mw-magiclink-rfc\" rel=\"nofollow\" href=\"https://tools.ietf.org/html/rfc1234\">RFC 1234</a></figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption><a class=\"external mw-magiclink-pmid\" rel=\"nofollow\" href=\"//www.ncbi.nlm.nih.gov/pubmed/1234?dopt=Abstract\">PMID 1234</a></figcaption></figure>\n<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption><a href=\"/wiki/Special:BookSources/123456789X\" class=\"internal mw-magiclink-isbn\">ISBN 123456789x</a></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a rel=\"nofollow\" class=\"external free\" href=\"http://example.com/\">http://example.com</a></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a rel=\"nofollow\" class=\"external\" href=\"https://tools.ietf.org/html/rfc1234\">RFC 1234</a></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a rel=\"nofollow\" class=\"external\" href=\"https://pubmed.ncbi.nlm.nih.gov/1234\">PMID 1234</a></figcaption></figure>\n<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption><a href=\"/wiki/Special%3ABookSources%2F123456789X\">ISBN 123456789x</a></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-free-ext-link\">http://example.com</span></span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-magic-link\">RFC 1234</span></span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-magic-link\">PMID 1234</span></span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-magic-link\">ISBN 123456789x</span></span>]]</span></span>"
	},
	{
		"desc": "File in link scenarios",
		"wikitext": "[http://www.google.com [[File:Foobar.jpg|123]]]\n\n[http://www.google.com [[File:Foobar.jpg|thumb|123]]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.google.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">123</span>]]</span></span>]</span>\n\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://www.google.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">123</span>]]</span></span>]</span></span>"
	},
	{
		"desc": "Thumbnail output",
		"wikitext": "[[File:Thumb.png|thumb]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Thumb.png\" class=\"mw-file-description\"><img src=\"http://example.com/images/e/ea/Thumb.png\" decoding=\"async\" width=\"135\" height=\"135\" class=\"mw-file-element\" /></a><figcaption></figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AThumb.png\" class=\"mw-file-description\"><img src=\"/wiki/File%3AThumb.png\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Thumb.png</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span></span>"
	},
	{
		"desc": "File with caption with pipe in extension tag attribute",
		"wikitext": "[[File:Foobar.jpg|thumb|Test <nowiki bogus=\"attri|bute\"/> 123]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption>Test  123</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>Test  123</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">Test <span class=\"wpb-ext\">&lt;nowiki<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">bogus</span>=\"<span class=\"wpb-attr-value\">attri|bute</span>\"</span></span>/&gt;</span> 123</span>]]</span></span>"
	},
	{
		"desc": "File with table in caption with extra table attribute spaces",
		"wikitext": "[[File:Foobar.jpg|thumb|\n{|\n|-  \n|hi\n|}\n]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption> <table>  <tbody><tr> <td>hi </td></tr></tbody></table> </figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption> <table > <tbody><tr > <td >hi </td></tr></tbody></table> </figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\">  </span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">hi</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n</span>]]</span></span>"
	},
	{
		"desc": "File in formatting element violating content model",
		"wikitext": "<p>''[[File:Foobar.jpg|thumb]]''</p>",
		"html": "<p><i></i></p><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure><p class=\"mw-empty-elt\"></p>",
		"render": "<p ><i><figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure></i></p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-quote\">''</span><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span><span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "File in formatting element violating content model, multiple open",
		"wikitext": "<p>'''''[[File:Foobar.jpg|thumb]]'''''</p>",
		"html": "<p><i><b></b></i></p><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption></figcaption></figure><p class=\"mw-empty-elt\"></p>",
		"render": "<p ><i><b><figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure></b></i></p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-quote\">'''''</span><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span><span class=\"wpb-quote\">'''''</span><span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "File in formatting element violating content model, figcaption content",
		"wikitext": "<p>''test [[File:Foobar.jpg|thumb|123]] 456''</p>",
		"html": "<p><i>test </i></p><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption><i>123</i></figcaption></figure><p><i> 456</i></p><p class=\"mw-empty-elt\"></p>",
		"render": "<p ><i>test </i><i><figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption>123</figcaption></figure></i><i> 456</i></p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-quote\">''</span>test <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">123</span>]]</span> 456<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Table in figcaption nested in table",
		"wikitext": "{|\n|foo\n|[[File:Foobar.jpg|thumb|\n{|\n|bar\n|}\n]]\n|}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td>\n<td><figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/270px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/360px-Foobar.jpg 2x\" /></a><figcaption> <table> <tbody><tr> <td>bar </td></tr></tbody></table> </figcaption></figure>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td>\n<td ><figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a><figcaption> <table > <tbody><tr> <td >bar </td></tr></tbody></table> </figcaption></figure>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Files with case sensitive media options",
		"wikitext": "[[File:Foobar.jpg|thumb|left]]\n[[File:Foobar.jpg|thumb|Left]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-parameter\">left</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">Left</span>]]</span></span>"
	},
	{
		"desc": "Exercise selser on native galleries",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=123|123\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">123</span></span>|<span class=\"wpb-image-caption\">123</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Selser preserves spacing in gallery when only caption is edited",
		"wikitext": "<gallery caption=\"123\">\nFile:Foobar.jpg\n\nFile:Foobar.jpg\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Selser preserves unedited gallery lines",
		"wikitext": "<gallery>\nFile:Foobar.jpg|123\nFile:Foobar.jpg|thumb|haha\n</gallery>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">123</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">haha</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Format option in gallery - T214601",
		"wikitext": "<gallery>\nFile:Foobar.jpg|thumb|123\nFile:Doesnotexist.jpg|thumb|456 - has an error noted in the rdfa\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"123\"><img alt=\"123\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">123</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"height: 150px;\"><span typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Doesnotexist.jpg\" class=\"new\" title=\"File:Doesnotexist.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"120\" data-height=\"120\">456 - has an error noted in the rdfa</span></a></span></div>\n\t\t\t<div class=\"gallerytext\">456 - has an error noted in the rdfa</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">123</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Doesnotexist.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">456 - has an error noted in the rdfa</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Broken inline media with a caption and an alt",
		"wikitext": "[[File:Broken.jpg|alt=An alternative text description.|A caption for the media.]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Broken.jpg\" class=\"new\" title=\"File:Broken.jpg\"><span class=\"mw-file-element mw-broken-media\">An alternative text description.</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-description\" title=\"A caption for the media.\"><img alt=\"An alternative text description.\" src=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Broken.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">An alternative text description.</span></span>|<span class=\"wpb-image-caption\">A caption for the media.</span>]]</span></span>"
	},
	{
		"desc": "Broken block media with a caption and an alt",
		"wikitext": "[[File:Broken.jpg|alt=An alternative text description.|thumb|A caption for the media.]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:Error mw:File/Thumb\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Broken.jpg\" class=\"new\" title=\"File:Broken.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">An alternative text description.</span></a><figcaption>A caption for the media.</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-description\"><img alt=\"An alternative text description.\" src=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-element\"></a><figcaption>A caption for the media.</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Broken.jpg</span>|<span class=\"wpb-image-parameter\">alt=<span class=\"wpb-image-caption\">An alternative text description.</span></span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">A caption for the media.</span>]]</span></span>"
	},
	{
		"desc": "Broken inline media with a caption",
		"wikitext": "[[File:Broken.jpg|A caption for the media.]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Broken.jpg\" class=\"new\" title=\"File:Broken.jpg\"><span class=\"mw-file-element mw-broken-media\">A caption for the media.</span></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-description\" title=\"A caption for the media.\"><img alt=\"A caption for the media.\" src=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Broken.jpg</span>|<span class=\"wpb-image-caption\">A caption for the media.</span>]]</span></span>"
	},
	{
		"desc": "Broken block media with a caption",
		"wikitext": "[[File:Broken.jpg|thumb|A caption for the media.]]",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:Error mw:File/Thumb\"><a href=\"/index.php?title=Special:Upload&amp;wpDestFile=Broken.jpg\" class=\"new\" title=\"File:Broken.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">File:Broken.jpg</span></a><figcaption>A caption for the media.</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ABroken.jpg\" class=\"mw-file-element\"></a><figcaption>A caption for the media.</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Broken.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">A caption for the media.</span>]]</span></span>"
	},
	{
		"desc": "Gallery line without file namespace",
		"wikitext": "<gallery>\nFoobar.jpg\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">Foobar.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Lines added to a self-closed gallery should not be dropped",
		"wikitext": "<gallery caption=\"123\" />",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">caption</span>=\"<span class=\"wpb-attr-value\">123</span>\"</span> </span>/&gt;</span></span>"
	},
	{
		"desc": "Broken media with frame and frameless formats",
		"wikitext": "[[File:Barfoo.jpg|frame|123]]\n[[File:Barfoo.jpg|frameless|123]]",
		"html": "<figure typeof=\"mw:Error mw:File/Frame\"><a href=\"/wiki/File:Barfoo.jpg\" class=\"mw-redirect\" title=\"File:Barfoo.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">File:Barfoo.jpg</span></a><figcaption>123</figcaption></figure>\n<p><span class=\"mw-default-size\" typeof=\"mw:Error mw:File/Frameless\"><a href=\"/wiki/File:Barfoo.jpg\" class=\"mw-redirect\" title=\"File:Barfoo.jpg\"><span class=\"mw-file-element mw-broken-media\">123</span></a></span>\n</p>",
		"render": "<figure typeof=\"mw:File/Frame\"><a href=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-element\"></a><figcaption>123</figcaption></figure>\n<p><span><a href=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-description\" title=\"123\"><img alt=\"123\" src=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Barfoo.jpg</span>|<span class=\"wpb-image-parameter\">frame</span>|<span class=\"wpb-image-caption\">123</span>]]</span>\n<span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Barfoo.jpg</span>|<span class=\"wpb-image-parameter\">frameless</span>|<span class=\"wpb-image-caption\">123</span>]]</span></span>"
	},
	{
		"desc": "Media with broken manualthumb",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Barfoo.jpg|123]]",
		"html": "<figure typeof=\"mw:Error mw:File/Thumb\"><a href=\"/wiki/File:Foobar.jpg\" title=\"File:Foobar.jpg\"><span class=\"mw-file-element mw-broken-media\" data-width=\"180\">Error creating thumbnail: </span></a><figcaption>123</figcaption></figure>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AFoobar.jpg\" title=\"File:Foobar.jpg\"><img src=\"/wiki/File%3ABarfoo.jpg\" class=\"mw-file-element\"></a><figcaption>123</figcaption></figure>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumbnail=<span class=\"wpb-image-caption\">Barfoo.jpg</span></span>|<span class=\"wpb-image-caption\">123</span>]]</span></span>"
	},
	{
		"desc": "Media with caption that would stringify to a valid media option",
		"wikitext": "[[File:Foobar.jpg|'''thumb''']]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"thumb\"><img alt=\"thumb\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"thumb\"><img alt=\"thumb\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\"><span class=\"wpb-quote\">'''</span>thumb<span class=\"wpb-quote\">'''</span></span>]]</span></span>"
	},
	{
		"desc": "Collect media metadata",
		"wikitext": "[[File:Foobar.jpg|123]]",
		"html": "<p><span class=\"mw-default-size\" typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"123\"><img alt=\"123\" src=\"http://example.com/images/3/3a/Foobar.jpg\" decoding=\"async\" width=\"1941\" height=\"220\" class=\"mw-file-element\" /></a></span>\n</p>",
		"render": "<p><span><a href=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-description\" title=\"123\"><img alt=\"123\" src=\"/wiki/File%3AFoobar.jpg\" class=\"mw-file-element\"></a></span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">123</span>]]</span></span>"
	},
	{
		"desc": "Entities in media filenames",
		"wikitext": "[[File:Hi&#45;ho.jpg|thumb]]\n\n<gallery>\nHi&#45;ho.jpg\nFile:Hi&#45;ho.jpg\n</gallery>",
		"html": "<figure class=\"mw-default-size\" typeof=\"mw:File/Thumb\"><a href=\"/wiki/File:Hi-ho.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/9/9d/Hi-ho.jpg/180px-Hi-ho.jpg\" decoding=\"async\" width=\"180\" height=\"20\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/9/9d/Hi-ho.jpg/270px-Hi-ho.jpg 1.5x, http://example.com/images/thumb/9/9d/Hi-ho.jpg/360px-Hi-ho.jpg 2x\" /></a><figcaption></figcaption></figure>\n<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Hi-ho.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/9/9d/Hi-ho.jpg/120px-Hi-ho.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/9/9d/Hi-ho.jpg/180px-Hi-ho.jpg 1.5x, http://example.com/images/thumb/9/9d/Hi-ho.jpg/240px-Hi-ho.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Hi-ho.jpg\" class=\"mw-file-description\"><img src=\"http://example.com/images/thumb/9/9d/Hi-ho.jpg/120px-Hi-ho.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/9/9d/Hi-ho.jpg/180px-Hi-ho.jpg 1.5x, http://example.com/images/thumb/9/9d/Hi-ho.jpg/240px-Hi-ho.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\"></div>\n\t\t</li>\n</ul>",
		"render": "<figure typeof=\"mw:File/Thumb\"><a href=\"/wiki/File%3AHi-ho.jpg\" class=\"mw-file-description\"><img src=\"/wiki/File%3AHi-ho.jpg\" class=\"mw-file-element\"></a><figcaption></figcaption></figure>\n<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Hi&amp;#45;ho.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>]]</span>\n\n<span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">Hi&amp;#45;ho.jpg</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Hi&amp;#45;ho.jpg</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Inline gallery attributes are appended to the defaults",
		"wikitext": "<gallery perrow=\"1\" style=\"color: red\">\nFile:Foobar.jpg|One\nFile:Foobar.jpg|Two\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\" style=\"max-width: 163px;color: red\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"One\"><img alt=\"One\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">One</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Two\"><img alt=\"Two\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">Two</div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">perrow</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">One</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">Two</span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "Gallery line with trailing closing square brackets",
		"wikitext": "<gallery>\nFile:Foobar.jpg|Testing 123]]\nFile:Foobar.jpg|Testing [[123]]\n</gallery>",
		"html": "<ul class=\"gallery mw-gallery-traditional\">\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Testing 123]]\"><img alt=\"Testing 123]]\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">Testing 123]]</div>\n\t\t</li>\n\t\t<li class=\"gallerybox\" style=\"width: 155px\">\n\t\t\t<div class=\"thumb\" style=\"width: 150px; height: 150px;\"><span typeof=\"mw:File\"><a href=\"/wiki/File:Foobar.jpg\" class=\"mw-file-description\" title=\"Testing 123\"><img alt=\"Testing 123\" src=\"http://example.com/images/thumb/3/3a/Foobar.jpg/120px-Foobar.jpg\" decoding=\"async\" width=\"120\" height=\"14\" class=\"mw-file-element\" srcset=\"http://example.com/images/thumb/3/3a/Foobar.jpg/180px-Foobar.jpg 1.5x, http://example.com/images/thumb/3/3a/Foobar.jpg/240px-Foobar.jpg 2x\" /></a></span></div>\n\t\t\t<div class=\"gallerytext\">Testing <a href=\"/index.php?title=123&amp;action=edit&amp;redlink=1\" class=\"new\" title=\"123 (page does not exist)\">123</a></div>\n\t\t</li>\n</ul>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;gallery&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">Testing 123]]</span></span>\n<span class=\"wpb-gallery-image\"><span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-caption\">Testing <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">123</span>]]</span></span></span>\n</span>&lt;/gallery&gt;</span></span>"
	},
	{
		"desc": "parserFunctionTests"
	},
	{
		"desc": "T240248: Erroring parser function shouldn't break references",
		"wikitext": "<ref>something</ref>\n{{#ifeq: {{#expr: string < 5 }} | 1 | true | false or error }}\n<references />",
		"html": "<p><sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\nfalse or error\n</p>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">‚Üë</a></span> <span class=\"reference-text\">something</span>\n</li>\n</ol></div>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;ref&gt;<span class=\"wpb-ext-inner\">something</span>&lt;/ref&gt;</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#ifeq</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#expr</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> string &lt; 5 </span></span>}}</span> </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> 1 </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> true </span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> false or error </span></span>}}</span>\n<span class=\"wpb-ext\">&lt;references<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "pfeqParserTests"
	},
	{
		"desc": "Basic usage of {{=}}",
		"wikitext": "This uses {{=}}.",
		"html": "<p>This uses =.\n</p>",
		"render": "<p>This uses =.\n</p>",
		"print": "<span class=\"wpb-root\">This uses <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">=</span>}}</span>.</span>"
	},
	{
		"desc": "Using {{Template:=}} doesn't invoke the parser function",
		"wikitext": "This uses {{Template:=}}.",
		"html": "<p>This uses no.\n</p>",
		"render": "<p>This uses no.\n</p>",
		"print": "<span class=\"wpb-root\">This uses <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Template:=</span>}}</span>.</span>"
	},
	{
		"desc": "poem"
	},
	{
		"desc": "<poem>",
		"wikitext": "<poem>\nthis\nis\na\ntest\n</poem>",
		"html": "<div class=\"poem\">\n<p>this<br />\nis<br />\na<br />\ntest\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p>this<br>\nis<br>\na<br>\ntest\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\nthis\nis\na\ntest\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "<poem> with recursive parsing",
		"wikitext": "<poem>\nthis ''is'' a '''test'''\n</poem>",
		"html": "<div class=\"poem\">\n<p>this <i>is</i> a <b>test</b>\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p>this <i>is</i> a <b>test</b>\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\nthis <span class=\"wpb-quote\">''</span>is<span class=\"wpb-quote\">''</span> a <span class=\"wpb-quote\">'''</span>test<span class=\"wpb-quote\">'''</span>\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "<poem> with leading whitespace",
		"wikitext": "<poem>\n\n   test\n\n</poem>",
		"html": "<div class=\"poem\">\n<p><br />\n&#160;&#160;&#160;test<br />\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p><br>\n&nbsp;&nbsp;&nbsp;test<br>\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\n\n   test\n\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Horizontal rule",
		"wikitext": "<poem>\nsome\n-----\ntext\n</poem>",
		"html": "<div class=\"poem\">\n<p>some<br />\n</p>\n<hr />\n<p>text\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p>some<br>\n</p>\n<hr>\n<p>text\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\nsome\n<span class=\"wpb-hr\">-----</span>\ntext\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "nested <poem><nowiki>",
		"wikitext": "<poem><nowiki>\nthis\nis\na\ntest\n</nowiki></poem>",
		"html": "<div class=\"poem\">\n<p><br />\nthis<br />\nis<br />\na<br />\ntest<br />\n\n</p>\n</div>",
		"render": "<div class=\"poem\">&#10;this&#10;is&#10;a&#10;test&#10;</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">\nthis\nis\na\ntest\n</span>&lt;/nowiki&gt;</span></span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "nested <poem><nowiki> with formatting",
		"wikitext": "<poem><nowiki>\nthis\n'''is'''\na\ntest\n</nowiki></poem>",
		"html": "<div class=\"poem\">\n<p><br />\nthis<br />\n'''is'''<br />\na<br />\ntest<br />\n\n</p>\n</div>",
		"render": "<div class=\"poem\">&#10;this&#10;'''is'''&#10;a&#10;test&#10;</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">\nthis\n'''is'''\na\ntest\n</span>&lt;/nowiki&gt;</span></span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Basic <poem> usage with style",
		"wikitext": "<poem style=\"border: 2px solid #d6d2c5; background-color: #f9f4e6; padding: 1em;\">\nA stately pleasure-dome decree:\nWhere Alph, the sacred river, ran\nThrough caverns measureless to man\nDown to a sunless sea.\n</poem>",
		"html": "<div style=\"border: 2px solid #d6d2c5; background-color: #f9f4e6; padding: 1em;\" class=\"poem\">\n<p>A stately pleasure-dome decree:<br />\nWhere Alph, the sacred river, ran<br />\nThrough caverns measureless to man<br />\nDown to a sunless sea.\n</p>\n</div>",
		"render": "<div style=\"border: 2px solid #d6d2c5; background-color: #f9f4e6; padding: 1em;\" class=\"poem\">\n<p>A stately pleasure-dome decree:<br>\nWhere Alph, the sacred river, ran<br>\nThrough caverns measureless to man<br>\nDown to a sunless sea.\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">border: 2px solid #d6d2c5; background-color: #f9f4e6; padding: 1em;</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\nA stately pleasure-dome decree:\nWhere Alph, the sacred river, ran\nThrough caverns measureless to man\nDown to a sunless sea.\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Verify Parsoid handles entities in nowikis in poem correctly",
		"wikitext": "<poem>\nL1\nL2\n<nowiki>\n<ref>Not a ref</ref>\nfoo &amp; bar\n[[Not a link]]\n</nowiki>\nL3\n</poem>",
		"html": "<div class=\"poem\">\n<p>L1<br />\nL2<br />\n<br />\n&lt;ref&gt;Not a ref&lt;/ref&gt;<br />\nfoo &amp; bar<br />\n[[Not a link]]<br />\n<br />\nL3\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p>L1<br>\nL2<br>\n&#10;&lt;ref&gt;Not a ref&lt;/ref&gt;&#10;foo &amp; bar&#10;[[Not a link]]&#10;<br>\nL3\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\nL1\nL2\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">\n&lt;ref&gt;Not a ref&lt;/ref&gt;\nfoo &amp;amp; bar\n[[Not a link]]\n</span>&lt;/nowiki&gt;</span>\nL3\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "UTF-8 sequences in extension tags (T231945)",
		"wikitext": "<poem>\n{{1x|·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·ÇÅ·Äù·Ä∫·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·Äõ·ÇÉ·Çá·Å∏·ÇÉ·Çá}}\n</poem>",
		"html": "<div class=\"poem\">\n<p>·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·ÇÅ·Äù·Ä∫·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·Äõ·ÇÉ·Çá·Å∏·ÇÉ·Çá\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p>·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·ÇÅ·Äù·Ä∫·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·Äõ·ÇÉ·Çá·Å∏·ÇÉ·Çá\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·ÇÅ·Äù·Ä∫·Å∂·Ä≠·Ä∞·Äù·Ä∫·Ä∏·Äõ·ÇÉ·Çá·Å∏·ÇÉ·Çá</span></span>}}</span>\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Multi-line poems with indentation use spans and breaks correctly (T235709)",
		"wikitext": "<poem>\n''CONGREGATI''\n:'''EX TOTO ORBE'''\n::'''''MATHEMATICI'''''\n:<span>foo</span>\n</poem>",
		"html": "<div class=\"poem\">\n<p><i>CONGREGATI</i><br />\n<span class=\"mw-poem-indented\" style=\"display: inline-block; margin-inline-start: 1em;\"><b>EX TOTO ORBE</b></span><br />\n<span class=\"mw-poem-indented\" style=\"display: inline-block; margin-inline-start: 2em;\"><i><b>MATHEMATICI</b></i></span><br />\n<span class=\"mw-poem-indented\" style=\"display: inline-block; margin-inline-start: 1em;\"><span>foo</span></span>\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p><i>CONGREGATI</i><br>\n</p>\n<dl><dd><b>EX TOTO ORBE</b><br>\n<dl><dd><i><b>MATHEMATICI</b></i></dd></dl></dd><br>\n<dd><span >foo</span></dd></dl>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-quote\">''</span>CONGREGATI<span class=\"wpb-quote\">''</span>\n<span class=\"wpb-list\">:</span><span class=\"wpb-quote\">'''</span>EX TOTO ORBE<span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-list\">::</span><span class=\"wpb-quote\">'''''</span>MATHEMATICI<span class=\"wpb-quote\">'''''</span>\n<span class=\"wpb-list\">:</span><span class=\"wpb-html\">&lt;span&gt;</span>foo<span class=\"wpb-html\">&lt;/span&gt;</span>\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Indention syntax with no content",
		"wikitext": "<poem>\n::\n</poem>",
		"html": "<div class=\"poem\">\n<dl><dd><dl><dd></dd></dl></dd></dl>\n</div>",
		"render": "<div class=\"poem\">\n<dl><dd><dl><dd></dd></dl></dd></dl>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-list\">::</span>\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Poem with class",
		"wikitext": "<poem class=\"hiho\">\nhi ho\n</poem>",
		"html": "<div class=\"poem hiho\">\n<p>hi ho\n</p>\n</div>",
		"render": "<div class=\"hiho poem\">\n<p>hi ho\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">hiho</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">\nhi ho\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "Poem with empty class",
		"wikitext": "<poem class=\"\">\nhi ho\n</poem>",
		"html": "<div class=\"poem\">\n<p>hi ho\n</p>\n</div>",
		"render": "<div class=\"poem\">\n<p>hi ho\n</p>\n</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;poem<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">class</span>=\"\"</span></span>&gt;<span class=\"wpb-ext-inner\">\nhi ho\n</span>&lt;/poem&gt;</span></span>"
	},
	{
		"desc": "preTags"
	},
	{
		"desc": "<pre> with attributes (T5202)",
		"wikitext": "<pre style=\"background: blue; color:white\">Bluescreen of WikiDeath</pre>",
		"html": "<pre style=\"background: blue; color:white\">Bluescreen of WikiDeath</pre>",
		"render": "<pre style=\"background: blue; color:white\">Bluescreen of WikiDeath</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">background: blue; color:white</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Bluescreen of WikiDeath</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "<pre> with width attribute (T5202)",
		"wikitext": "<pre width=\"8\">Narrow screen goodies</pre>",
		"html": "<pre width=\"8\">Narrow screen goodies</pre>",
		"render": "<pre width=\"8\">Narrow screen goodies</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">width</span>=\"<span class=\"wpb-attr-value\">8</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Narrow screen goodies</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "<pre> with forbidden attribute (T5202)",
		"wikitext": "<pre width=\"8\" onmouseover=\"alert(document.cookie)\">Narrow screen goodies</pre>",
		"html": "<pre width=\"8\">Narrow screen goodies</pre>",
		"render": "<pre width=\"8\" >Narrow screen goodies</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">width</span>=\"<span class=\"wpb-attr-value\">8</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">onmouseover</span>=\"<span class=\"wpb-attr-value\">alert(document.cookie)</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Narrow screen goodies</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Entities inside <pre>",
		"wikitext": "<pre>&lt;</pre>",
		"html": "<pre>&lt;</pre>",
		"render": "<pre >&lt;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">&amp;lt;</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "<pre> with forbidden attribute values (T5202)",
		"wikitext": "<pre width=\"8\" style=\"border-width: expression(alert(document.cookie))\">Narrow screen goodies</pre>",
		"html": "<pre width=\"8\" style=\"/* insecure input */\">Narrow screen goodies</pre>",
		"render": "<pre width=\"8\" >Narrow screen goodies</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">width</span>=\"<span class=\"wpb-attr-value\">8</span>\"</span> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">border-width: expression(alert(document.cookie))</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">Narrow screen goodies</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "<nowiki> inside <pre> (T15238)",
		"wikitext": "<pre>\n<nowiki>\n</pre>\n<pre>\n<nowiki></nowiki>\n</pre>\n<pre><nowiki><nowiki></nowiki>Foo<nowiki></nowiki></nowiki></pre>",
		"html": "<pre>&lt;nowiki&gt;\n</pre>\n<pre>\n\n</pre>\n<pre>&lt;nowiki&gt;Foo&lt;/nowiki&gt;</pre>",
		"render": "<pre >&#10;&lt;nowiki&gt;&#10;</pre>\n<pre >&#10;&#10;</pre>\n<pre >&lt;nowiki&gt;Foo&lt;/nowiki&gt;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n&lt;nowiki&gt;\n</span>&lt;/pre&gt;</span>\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n<span class=\"wpb-noinclude\">&lt;nowiki&gt;</span><span class=\"wpb-noinclude\">&lt;/nowiki&gt;</span>\n</span>&lt;/pre&gt;</span>\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\"><span class=\"wpb-noinclude\">&lt;nowiki&gt;</span>&lt;nowiki&gt;<span class=\"wpb-noinclude\">&lt;/nowiki&gt;</span>Foo<span class=\"wpb-noinclude\">&lt;nowiki&gt;</span><span class=\"wpb-noinclude\">&lt;/nowiki&gt;</span>&lt;/nowiki&gt;</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "<nowiki> inside of #tag:pre",
		"wikitext": "{{#tag:pre|Foo <nowiki>&rarr;bar</nowiki>}}",
		"html": "<pre>Foo &#8594;bar</pre>",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">pre</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&amp;rarr;bar</span>&lt;/nowiki&gt;</span></span></span>}}</span></span>"
	},
	{
		"desc": "<nowiki> and <pre> preference (first one wins)",
		"wikitext": "<pre>\n<nowiki>\n</pre>\n</nowiki>\n</pre>\n\n<nowiki>\n<pre>\n<nowiki>\n</pre>\n</nowiki>\n</pre>",
		"html": "<pre>&lt;nowiki&gt;\n</pre>\n<p>&lt;/nowiki&gt;\n</p>\n\n<p>\n&lt;pre&gt;\n&lt;nowiki&gt;\n&lt;/pre&gt;\n\n</p>",
		"render": "<pre >&#10;&lt;nowiki&gt;&#10;</pre>\n<p>&lt;/nowiki&gt;\n</p>\n</pre>\n<p>&#10;&lt;pre&gt;&#10;&lt;nowiki&gt;&#10;&lt;/pre&gt;&#10;\n</p>\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n&lt;nowiki&gt;\n</span>&lt;/pre&gt;</span>\n&lt;/nowiki&gt;\n<span class=\"wpb-html\">&lt;/pre&gt;</span>\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">\n&lt;pre&gt;\n&lt;nowiki&gt;\n&lt;/pre&gt;\n</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-html\">&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "</pre> inside nowiki",
		"wikitext": "<nowiki></pre></nowiki>",
		"html": "<p>&lt;/pre&gt;\n</p>",
		"render": "<p>&lt;/pre&gt;\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;/pre&gt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Empty pre; pre inside other HTML tags (T56946)",
		"wikitext": "a\n\n<div><pre>\nfoo\n</pre></div>\n<pre></pre>",
		"html": "<p>a\n</p>\n<div><pre>foo\n</pre></div>\n<pre></pre>",
		"render": "<p>a\n</p>\n<div ><pre >&#10;foo&#10;</pre></div>\n<pre ></pre>",
		"print": "<span class=\"wpb-root\">a\n\n<span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\nfoo\n</span>&lt;/pre&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span>\n<span class=\"wpb-ext\">&lt;pre&gt;&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "HTML pre followed by indent-pre",
		"wikitext": "<pre>foo</pre>\n bar",
		"html": "<pre>foo</pre>\n<pre>bar\n</pre>",
		"render": "<pre >foo</pre>\n<pre>bar\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/pre&gt;</span>\n bar</span>"
	},
	{
		"desc": "Block tag pre",
		"wikitext": "<p><pre>foo</pre></p>",
		"html": "<p class=\"mw-empty-elt\"></p><pre>foo</pre><p class=\"mw-empty-elt\"></p>",
		"render": "<p ><pre >foo</pre></p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;p&gt;</span><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/pre&gt;</span><span class=\"wpb-html\">&lt;/p&gt;</span></span>"
	},
	{
		"desc": "Pres with newline attributes",
		"wikitext": "<pre class=\"one\ntwo\">hi</pre>",
		"html": "<pre class=\"one two\">hi</pre>",
		"render": "<pre class=\"one two\">hi</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">one\ntwo</span>\"</span></span>&gt;<span class=\"wpb-ext-inner\">hi</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Things that look like <pre> tags aren't treated as such",
		"wikitext": "Barack Obama <President> of the United States\n<President></President>",
		"html": "<p>Barack Obama &lt;President&gt; of the United States\n&lt;President&gt;&lt;/President&gt;\n</p>",
		"render": "<p>Barack Obama &lt;President&gt; of the United States\n&lt;President&gt;&lt;/President&gt;\n</p>",
		"print": "<span class=\"wpb-root\">Barack Obama &lt;President&gt; of the United States\n&lt;President&gt;&lt;/President&gt;</span>"
	},
	{
		"desc": "Handle broken pre-like tags (T66025)",
		"wikitext": "{{1x|<pre <pre>x</pre>}}\n\n<table><pre </table>",
		"html": "<pre>x</pre>\n&lt;pre <table></table>",
		"render": "<pre >x</pre>\n<table >&lt;pre </table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"><span class=\"wpb-attr-dirty\"> &lt;pre</span></span>&gt;<span class=\"wpb-ext-inner\">x</span>&lt;/pre&gt;</span></span></span>}}</span>\n\n<span class=\"wpb-html\">&lt;table&gt;</span>&lt;pre <span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Less than in attribute position",
		"wikitext": "<pre <pre>123</pre>\n\n<div <div>123</div>",
		"html": "<pre>123</pre><p>\n&lt;div </p><div>123</div>",
		"render": "<pre >123</pre>\n&lt;div <div >123</div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"><span class=\"wpb-attr-dirty\"> &lt;pre</span></span>&gt;<span class=\"wpb-ext-inner\">123</span>&lt;/pre&gt;</span>\n\n&lt;div <span class=\"wpb-html\">&lt;div&gt;</span>123<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Parsoid: handle pre with space after attribute",
		"wikitext": "<pre style=\"width:50%;\" >{{1x|foo}}</pre>",
		"html": "<pre style=\"width:50%;\">{{1x|foo}}</pre>",
		"render": "<pre style=\"width:50%;\">{{1x|foo}}</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> <span class=\"wpb-ext-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">width:50%;</span>\"</span> </span>&gt;<span class=\"wpb-ext-inner\">{{1x|foo}}</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "Self-closed pre",
		"wikitext": "<pre />",
		"html": "<pre></pre>",
		"render": "<pre ></pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre<span class=\"wpb-ext-attrs\"> </span>/&gt;</span></span>"
	},
	{
		"desc": "HTML-pre: 1. embedded newlines",
		"wikitext": "<pre>foo</pre>\n\n<pre>\nfoo\n</pre>\n\n<pre>\n\nfoo\n</pre>\n\n<pre>\n\n\nfoo\n</pre>",
		"html": "<pre>foo</pre>\n<pre>foo\n</pre>\n<pre>\n\nfoo\n</pre>\n<pre>\n\n\nfoo\n</pre>",
		"render": "<pre >foo</pre>\n<pre >&#10;foo&#10;</pre>\n<pre >&#10;&#10;foo&#10;</pre>\n<pre >&#10;&#10;&#10;foo&#10;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">foo</span>&lt;/pre&gt;</span>\n\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\nfoo\n</span>&lt;/pre&gt;</span>\n\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n\nfoo\n</span>&lt;/pre&gt;</span>\n\n<span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n\n\nfoo\n</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "HTML-pre: big spaces",
		"wikitext": "<pre>\n\n\n\n\nhaha\n\n\n\n\nhaha\n\n\n\n\n</pre>",
		"html": "<pre>\n\n\n\n\nhaha\n\n\n\n\nhaha\n\n\n\n\n</pre>",
		"render": "<pre >&#10;&#10;&#10;&#10;&#10;haha&#10;&#10;&#10;&#10;&#10;haha&#10;&#10;&#10;&#10;&#10;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n\n\n\n\nhaha\n\n\n\n\nhaha\n\n\n\n\n</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "HTML-pre: 2: indented text",
		"wikitext": "<pre>\n foo\n</pre>",
		"html": "<pre> foo\n</pre>",
		"render": "<pre >&#10; foo&#10;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n foo\n</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "HTML-pre: 3: other wikitext",
		"wikitext": "<pre>\n* foo\n# bar\n= no-h =\n'' no-italic ''\n[[ NoLink ]]\n</pre>",
		"html": "<pre>* foo\n# bar\n= no-h =\n'' no-italic ''\n[[ NoLink ]]\n</pre>",
		"render": "<pre >&#10;* foo&#10;# bar&#10;= no-h =&#10;'' no-italic ''&#10;[[ NoLink ]]&#10;</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;pre&gt;<span class=\"wpb-ext-inner\">\n* foo\n# bar\n= no-h =\n'' no-italic ''\n[[ NoLink ]]\n</span>&lt;/pre&gt;</span></span>"
	},
	{
		"desc": "preprocessor"
	},
	{
		"desc": "Preprocessor precedence 1: link is rightmost opening",
		"wikitext": "{{[[Foo|bar}}]]\n\nBut close-brace is not a valid character in a link title:\n{{[[Foo}}|bar]]\n\nHowever, we can still tell this was handled as a link in the preprocessor:\n{{1x|[[Foo}}|bar]]|bat}}",
		"html": "<p>{{<a href=\"/wiki/Foo\" title=\"Foo\">bar}}</a>\n</p><p>But close-brace is not a valid character in a link title:\n{{[[Foo}}|bar]]\n</p><p>However, we can still tell this was handled as a link in the preprocessor:\n[[Foo}}|bar]]\n</p>",
		"render": "<p>{{<a href=\"/wiki/Foo\" title=\"Foo\">bar}}</a>\n</p><p>But close-brace is not a valid character in a link title:\n{{[[Foo}}|bar]]\n</p><p>However, we can still tell this was handled as a link in the preprocessor:\n[[Foo}}|bar]]\n</p>",
		"print": "<span class=\"wpb-root\">{{<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">bar}}</span>]]</span>\n\nBut close-brace is not a valid character in a link title:\n{{[[Foo}}|bar]]\n\nHowever, we can still tell this was handled as a link in the preprocessor:\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">[[Foo}}|bar]]</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">bat</span></span>}}</span></span>"
	},
	{
		"desc": "Preprocessor precedence 2: template is rightmost opening",
		"wikitext": "-{{1x|foo}-}}-",
		"print": "<span class=\"wpb-root\">-<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo}-</span></span>}}</span>-</span>"
	},
	{
		"desc": "Preprocessor precedence 3: language converter is rightmost opening",
		"wikitext": "{{1x|hi}}\n\n{{-{R|1x|hi}}}-\n\n[[-{R|raw]]}-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi</span></span>}}</span>\n\n{{<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">1x|hi}}</span></span>}-</span>\n\n[[<span class=\"wpb-converter\">-{<span class=\"wpb-converter-flags\"><span class=\"wpb-converter-flag\">R</span></span>|<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">raw]]</span></span>}-</span></span>"
	},
	{
		"desc": "Preprocessor precedence 4: left-most angle bracket",
		"wikitext": "<!--{raw}-->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--{raw}--&gt;</span></span>"
	},
	{
		"desc": "Preprocessor precedence 5: tplarg takes precedence over template",
		"wikitext": "{{Precedence5|Bullet}}",
		"html": "<ul><li>Bar</li></ul>",
		"render": "<ul><li>Bar</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Precedence5</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bullet</span></span>}}</span></span>"
	},
	{
		"desc": "Preprocessor precedence 6: broken link is rightmost opening",
		"wikitext": "{{1x|[[Foo}}\n\n{{1x|[[Foo|bar|bat=baz}}",
		"html": "<p>{{1x|[[Foo}}\n</p><p>{{1x|[[Foo|bar|bat=baz}}\n</p>",
		"render": "<p>{{1x|[[Foo}}\n</p><p>{{1x|[[Foo|bar|bat=baz}}\n</p>",
		"print": "<span class=\"wpb-root\">{{1x|[[Foo}}\n\n{{1x|[[Foo|bar|bat=baz}}</span>"
	},
	{
		"desc": "Preprocessor precedence 7: broken template is rightmost opening",
		"wikitext": "[[Foo|{{1x|Bar]]\n\n[[Foo|{{1x|Bar]]-x}}-y]]-z\n\nCareful: linktrails can move the end of the wikilink:\n[[Foo|{{1x|y']]a}}l]]l",
		"html": "<p><a href=\"/wiki/Foo\" title=\"Foo\">{{1x|Bar</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Bar</a>-x-y]]-z\n</p><p>Careful: linktrails can move the end of the wikilink:\n<a href=\"/wiki/Foo\" title=\"Foo\">y'al</a>]]l\n</p>",
		"render": "<p><a href=\"/wiki/Foo\" title=\"Foo\">{{1x|Bar</a>\n</p><p><a href=\"/wiki/Foo\" title=\"Foo\">Bar</a>-x-y]]-z\n</p><p>Careful: linktrails can move the end of the wikilink:\n<a href=\"/wiki/Foo\" title=\"Foo\">y'</a>al]]l\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">{{1x|Bar</span>]]</span>\n\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bar]]-x</span></span>}}</span>-y</span>]]</span>-z\n\nCareful: linktrails can move the end of the wikilink:\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">y']]a</span></span>}}</span>l</span>]]</span>l</span>"
	},
	{
		"desc": "Preprocessor precedence 8: broken language converter is rightmost opening",
		"wikitext": "[[Foo-{R|raw]]",
		"print": "<span class=\"wpb-root\">[[Foo-{R|raw]]</span>"
	},
	{
		"desc": "Preprocessor precedence 9: groups of braces",
		"wikitext": "{{Preprocessor precedence 9|Four|Bullet|1|2}}",
		"html": "<dl><dt>4</dt>\n<dd>{Four}</dd>\n<dt>5</dt>\n<dd></dd></dl>\n<ul><li>Bar</li></ul>\n<dl><dt>6</dt>\n<dd>Four</dd>\n<dt>7</dt>\n<dd>{Bullet}</dd></dl>",
		"render": "<dl><dt>4</dt>\n<dd>{Four}</dd>\n<dt>5</dt>\n<dd></dd></dl>\n<ul><li>Bar</li></ul>\n<dl><dt>6</dt>\n<dd>Four</dd>\n<dt>7</dt>\n<dd>{Bullet}</dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Preprocessor precedence 9</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Four</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bullet</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span></span>"
	},
	{
		"desc": "Preprocessor precedence 10: groups of braces with leading dash",
		"wikitext": "{{Preprocessor precedence 10|Three|raw2|Bullet|1|2}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Preprocessor precedence 10</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Three</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">raw2</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bullet</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">1</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">2</span></span>}}</span></span>"
	},
	{
		"desc": "Preprocessor precedence 11: found during visual diff testing",
		"wikitext": "{{#tag:span|-{{#tag:span|-{{1x|x}}}}}}\n\n{{1x|-{{1x|-{{1x|x}}}}}}\n\n{{1x|-{{1x|x}}}}",
		"html": "<p><span>-<span>-x</span></span>\n</p><p>--x\n</p><p>-x\n</p>",
		"render": "<p><br>\n--x\n</p><p>-x\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">span</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#tag</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">span</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>}}</span></span></span>}}</span></span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>}}</span></span></span>}}</span></span></span>}}</span>\n\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">-<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">x</span></span>}}</span></span></span>}}</span></span>"
	},
	{
		"desc": "Preprocessor precedence 13: broken language converter in external link",
		"wikitext": "*[http://example.com/-{foo Example in URL]\n*[http://example.com Example in -{link} description]\n*{{1x|[http://example.com/-{foo Breaks template, however]}}",
		"html": "<ul><li><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/-{foo\">Example in URL</a></li>\n<li><a rel=\"nofollow\" class=\"external text\" href=\"http://example.com\">Example in -{link} description</a></li>\n<li>{{1x|<a rel=\"nofollow\" class=\"external text\" href=\"http://example.com/-{foo\">Breaks template, however</a>}}</li></ul>",
		"render": "<ul><li><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/-%7Bfoo\">Example in URL</a></li>\n<li><a rel=\"nofollow\" class=\"external\" href=\"http://example.com/\">Example in -{link} description</a></li>\n<li>{{1x|<a rel=\"nofollow\" class=\"external\" href=\"http://example.com/-%7Bfoo\">Breaks template, however</a>}}</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/-{foo</span> <span class=\"wpb-ext-link-text\">Example in URL</span>]</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com</span> <span class=\"wpb-ext-link-text\">Example in -{link} description</span>]</span>\n<span class=\"wpb-list\">*</span>{{1x|<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://example.com/-{foo</span> <span class=\"wpb-ext-link-text\">Breaks template, however</span>]</span>}}</span>"
	},
	{
		"desc": "Preprocessor precedence 14: broken language converter in comment",
		"wikitext": "*<!--{{foo}}-->...should be ok\n*<!---{{foo}}-->...extra dashes\n*{{1x|foo<!-- -{bar} -->bat}}...should be ok",
		"html": "<ul><li>...should be ok</li>\n<li>...extra dashes</li>\n<li>foobat...should be ok</li></ul>",
		"render": "<ul><li>...should be ok</li>\n<li>...extra dashes</li>\n<li>foobat...should be ok</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span><span class=\"wpb-comment\">&lt;!--{{foo}}--&gt;</span>...should be ok\n<span class=\"wpb-list\">*</span><span class=\"wpb-comment\">&lt;!---{{foo}}--&gt;</span>...extra dashes\n<span class=\"wpb-list\">*</span><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo<span class=\"wpb-comment\">&lt;!-- -{bar} --&gt;</span>bat</span></span>}}</span>...should be ok</span>"
	},
	{
		"desc": "Preprocessor precedence 15: broken brace markup in headings",
		"wikitext": "__NOTOC__ __NOEDITSECTION__\n===1 foo[bar 1===\n1\n===2 foo[[bar 2===\n2\n===3 foo{bar 3===\n3\n===4 foo{{bar 4===\n4\n===5 foo{{{bar 5===\n5\n===6 foo-{bar 6===\n6",
		"html": "<div class=\"mw-heading mw-heading3\"><h3 id=\"1_foo[bar_1\"><span id=\"1_foo.5Bbar_1\"></span>1 foo[bar 1</h3></div>\n<p>1\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"2_foo[[bar_2\"><span id=\"2_foo.5B.5Bbar_2\"></span>2 foo[[bar 2</h3></div>\n<p>2\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"3_foo{bar_3\"><span id=\"3_foo.7Bbar_3\"></span>3 foo{bar 3</h3></div>\n<p>3\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"4_foo{{bar_4\"><span id=\"4_foo.7B.7Bbar_4\"></span>4 foo{{bar 4</h3></div>\n<p>4\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"5_foo{{{bar_5\"><span id=\"5_foo.7B.7B.7Bbar_5\"></span>5 foo{{{bar 5</h3></div>\n<p>5\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"6_foo-{bar_6\"><span id=\"6_foo-.7Bbar_6\"></span>6 foo-{bar 6</h3></div>\n<p>6\n</p>",
		"render": "<div class=\"mw-heading mw-heading3\"><h3 id=\"1_foo[bar_1\">1 foo[bar 1</h3></div>\n<p>1\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"2_foo[[bar_2\">2 foo[[bar 2</h3></div>\n<p>2\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"3_foo{bar_3\">3 foo{bar 3</h3></div>\n<p>3\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"4_foo{{bar_4\">4 foo{{bar 4</h3></div>\n<p>4\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"5_foo{{{bar_5\">5 foo{{{bar 5</h3></div>\n<p>5\n</p>\n<div class=\"mw-heading mw-heading3\"><h3 id=\"6_foo-{bar_6\">6 foo-{bar 6</h3></div>\n<p>6\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-double-underscore\">__NOTOC__</span> <span class=\"wpb-double-underscore\">__NOEDITSECTION__</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">1 foo[bar 1</span>===</span>\n1\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">2 foo[[bar 2</span>===</span>\n2\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">3 foo{bar 3</span>===</span>\n3\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">4 foo{{bar 4</span>===</span>\n4\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">5 foo{{{bar 5</span>===</span>\n5\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\">6 foo-{bar 6</span>===</span>\n6</span>"
	},
	{
		"desc": "Preprocessor precedence 16: matching closing braces to opening braces",
		"wikitext": "-{{{1x|foo}}bar}-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo</span></span>}}</span>bar</span></span>}-</span></span>"
	},
	{
		"desc": "Preprocessor precedence 17: template w/o target shouldn't prevent closing",
		"wikitext": "{{1x|hi {{}}}}",
		"html": "<p>hi {{}}\n</p>",
		"render": "<p>hi {{}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">hi {{}}</span></span>}}</span></span>"
	},
	{
		"desc": "Preprocessor precedence 19: break syntax",
		"wikitext": "-{{",
		"html": "<p>-{{\n</p>",
		"render": "<p>-{{\n</p>",
		"print": "<span class=\"wpb-root\">-{{</span>"
	},
	{
		"desc": "Language converter over extlink",
		"wikitext": "{{1x\n| [-{oh no]}-]\n}}",
		"html": "<pre>[-{oh no]}-]\n</pre>",
		"render": "<pre>[oh no]]\n</pre>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x\n</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> [<span class=\"wpb-converter\">-{<span class=\"wpb-converter-rule\"><span class=\"wpb-converter-rule-to\">oh no]</span></span>}-</span>]\n</span></span>}}</span></span>"
	},
	{
		"desc": "pst"
	},
	{
		"desc": "pre-save transform: subst:",
		"wikitext": "{{subst:test}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">test</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: normal template",
		"wikitext": "{{test}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">test</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: nonexistent template",
		"wikitext": "{{thistemplatedoesnotexist}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">thistemplatedoesnotexist</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: subst magic variables",
		"wikitext": "{{subst:SITENAME}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{subst:<span class=\"wpb-magic-word-name\">SITENAME</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: subst: templates with parameters",
		"wikitext": "{{subst:paramtest|param=\"something else\"}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">paramtest</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">param</span>=<span class=\"wpb-parameter-value\">\"something else\"</span></span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: nowiki in subst (T3188)",
		"wikitext": "{{subst:nowikitest}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">nowikitest</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: comment in subst (T3936)",
		"wikitext": "{{subst:commenttest}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">commenttest</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: unclosed tag",
		"wikitext": "<nowiki>'''not wiki'''",
		"print": "<span class=\"wpb-root\">&lt;nowiki&gt;<span class=\"wpb-quote\">'''</span>not wiki<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "pre-save transform: mixed tag case",
		"wikitext": "<NOwiki>'''not wiki'''</noWIKI>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;NOwiki&gt;<span class=\"wpb-ext-inner\">'''not wiki'''</span>&lt;/noWIKI&gt;</span></span>"
	},
	{
		"desc": "pre-save transform: unclosed comment in <nowiki>",
		"wikitext": "wiki<nowiki>nowiki<!--nowiki</nowiki>wiki",
		"print": "<span class=\"wpb-root\">wiki<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">nowiki&lt;!--nowiki</span>&lt;/nowiki&gt;</span>wiki</span>"
	},
	{
		"desc": "(confirming safety of fix for subst T3936)",
		"wikitext": "{{Template:dangerous}}",
		"html": "<p>@<span>Oh no</span>\n</p>",
		"render": "<p>@<span >Oh no</span>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">Template:dangerous</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: comment containing gallery (T7024)",
		"wikitext": "<!-- <gallery>data</gallery> -->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- &lt;gallery&gt;data&lt;/gallery&gt; --&gt;</span></span>"
	},
	{
		"desc": "pre-save transform: comment containing nowiki",
		"wikitext": "<!-- <nowiki>data</nowiki> -->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- &lt;nowiki&gt;data&lt;/nowiki&gt; --&gt;</span></span>"
	},
	{
		"desc": "pre-save transform: <noinclude> in subst (T5298)",
		"wikitext": "{{subst:Includes}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">Includes</span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: <onlyinclude> in subst (T5298)",
		"wikitext": "{{subst:Includes2}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">Includes2</span>}}</span></span>"
	},
	{
		"desc": "T24297: safesubst: works during PST",
		"wikitext": "{{subst:SafeSubstTest}}{{safesubst:SubstTest}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">SafeSubstTest</span>}}</span><span class=\"wpb-template\">{{safesubst:<span class=\"wpb-template-name\">SubstTest</span>}}</span></span>"
	},
	{
		"desc": "T24297: safesubst: works during normal parse",
		"wikitext": "{{SafeSubstTest}}",
		"html": "<p>Foobar\n</p>",
		"render": "<p>Foobar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">SafeSubstTest</span>}}</span></span>"
	},
	{
		"desc": "subst: does not work during normal parse",
		"wikitext": "{{SubstTest}}",
		"html": "<p>{{subst:Includes}}\n</p>",
		"render": "<p><a href=\"/wiki/Template%3ASubstTest?action=edit&redlink=1\" class=\"new\" title=\"Template:SubstTest (page does not exist)\">Template:SubstTest</a>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">SubstTest</span>}}</span></span>"
	},
	{
		"desc": "safesubst self: does not work during normal parse - T276476",
		"wikitext": "{{SafeSubstSelfTest}}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">SafeSubstSelfTest</span>}}</span></span>"
	},
	{
		"desc": "Template named safesubst - T309405",
		"wikitext": "{{safesubst|123}}",
		"html": "<p>123\n</p>",
		"render": "<p>123\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">safesubst</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">123</span></span>}}</span></span>"
	},
	{
		"desc": "subst: with whitespace - variable vs. template",
		"wikitext": "Variable: {{subst: ROOTPAGENAME}}\nVariable: {{subst:ROOTPAGENAME}}\nTemplate: {{subst: ROOTPAGENAME|template}}\nTemplate: {{subst:ROOTPAGENAME|template}}",
		"print": "<span class=\"wpb-root\">Variable: <span class=\"wpb-magic-word\">{{subst: <span class=\"wpb-magic-word-name\">ROOTPAGENAME</span>}}</span>\nVariable: <span class=\"wpb-magic-word\">{{subst:<span class=\"wpb-magic-word-name\">ROOTPAGENAME</span>}}</span>\nTemplate: <span class=\"wpb-template\">{{subst: <span class=\"wpb-template-name\">ROOTPAGENAME</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">template</span></span>}}</span>\nTemplate: <span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">ROOTPAGENAME</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">template</span></span>}}</span></span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\")",
		"wikitext": "[[Article (context)|]]\n[[Bar:Article|]]\n[[:Bar:Article|]]\n[[Bar:Article (context)|]]\n[[:Bar:Article (context)|]]\n[[|Article]]\n[[|Article (context)]]\n[[Bar:X (Y) Z|]]\n[[:Bar:X (Y) Z|]]",
		"print": "<span class=\"wpb-root\">[[Article (context)|]]\n[[Bar:Article|]]\n[[:Bar:Article|]]\n[[Bar:Article (context)|]]\n[[:Bar:Article (context)|]]\n[[|Article]]\n[[|Article (context)]]\n[[Bar:X (Y) Z|]]\n[[:Bar:X (Y) Z|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with interwiki prefix",
		"wikitext": "[[interwiki:Article|]]\n[[:interwiki:Article|]]\n[[interwiki:Bar:Article|]]\n[[:interwiki:Bar:Article|]]",
		"print": "<span class=\"wpb-root\">[[interwiki:Article|]]\n[[:interwiki:Article|]]\n[[interwiki:Bar:Article|]]\n[[:interwiki:Bar:Article|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with parens in title",
		"wikitext": "[[|Article]]",
		"print": "<span class=\"wpb-root\">[[|Article]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with single, double-width and Arabic comma in title",
		"wikitext": "[[|Otherplace]]\n[[Otherplace, Elsewhere|]]\n[[Otherplace, Elsewhere, Anywhere|]]\n[[OtherplaceÔºåElsewhere|]]\n[[Otherplaceÿå Elsewhere|]]",
		"print": "<span class=\"wpb-root\">[[|Otherplace]]\n[[Otherplace, Elsewhere|]]\n[[Otherplace, Elsewhere, Anywhere|]]\n[[OtherplaceÔºåElsewhere|]]\n[[Otherplaceÿå Elsewhere|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with parens and comma",
		"wikitext": "[[|Otherplace]]\n[[Otherplace (place), Elsewhere|]]",
		"print": "<span class=\"wpb-root\">[[|Otherplace]]\n[[Otherplace (place), Elsewhere|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with comma and parens",
		"wikitext": "[[|Yes, you.]]\n[[Me, Myself, and I (1937 song)|]]",
		"print": "<span class=\"wpb-root\">[[|Yes, you.]]\n[[Me, Myself, and I (1937 song)|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with namespace",
		"wikitext": "[[|Article]]",
		"print": "<span class=\"wpb-root\">[[|Article]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with namespace and parens",
		"wikitext": "[[|Article]]",
		"print": "<span class=\"wpb-root\">[[|Article]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with namespace and comma",
		"wikitext": "[[|Article]]",
		"print": "<span class=\"wpb-root\">[[|Article]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with namespace, comma and parens",
		"wikitext": "[[|Article]]",
		"print": "<span class=\"wpb-root\">[[|Article]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with namespace, parens and comma",
		"wikitext": "[[|Article]]",
		"print": "<span class=\"wpb-root\">[[|Article]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with full-width parens and no space (Japanese and Chinese style, T32149)",
		"wikitext": "[[ArticleÔºàcontextÔºâ|]]\n[[Bar:ArticleÔºàcontextÔºâ|]]\n[[:Bar:ArticleÔºàcontextÔºâ|]]\n[[|ArticleÔºàcontextÔºâ]]\n[[Bar:XÔºàYÔºâZ|]]\n[[:Bar:XÔºàYÔºâZ|]]",
		"print": "<span class=\"wpb-root\">[[ArticleÔºàcontextÔºâ|]]\n[[Bar:ArticleÔºàcontextÔºâ|]]\n[[:Bar:ArticleÔºàcontextÔºâ|]]\n[[|ArticleÔºàcontextÔºâ]]\n[[Bar:XÔºàYÔºâZ|]]\n[[:Bar:XÔºàYÔºâZ|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with full-width parens and space (Japanese and Chinese style, T32149)",
		"wikitext": "[[Article ÔºàcontextÔºâ|]]\n[[Bar:Article ÔºàcontextÔºâ|]]\n[[:Bar:Article ÔºàcontextÔºâ|]]\n[[|Article ÔºàcontextÔºâ]]\n[[Bar:X ÔºàYÔºâ Z|]]\n[[:Bar:X ÔºàYÔºâ Z|]]",
		"print": "<span class=\"wpb-root\">[[Article ÔºàcontextÔºâ|]]\n[[Bar:Article ÔºàcontextÔºâ|]]\n[[:Bar:Article ÔºàcontextÔºâ|]]\n[[|Article ÔºàcontextÔºâ]]\n[[Bar:X ÔºàYÔºâ Z|]]\n[[:Bar:X ÔºàYÔºâ Z|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with parens and no space (Korean style, T32149)",
		"wikitext": "[[Article(context)|]]\n[[Bar:Article(context)|]]\n[[:Bar:Article(context)|]]\n[[|Article(context)]]\n[[Bar:X(Y)Z|]]\n[[:Bar:X(Y)Z|]]",
		"print": "<span class=\"wpb-root\">[[Article(context)|]]\n[[Bar:Article(context)|]]\n[[:Bar:Article(context)|]]\n[[|Article(context)]]\n[[Bar:X(Y)Z|]]\n[[:Bar:X(Y)Z|]]</span>"
	},
	{
		"desc": "pre-save transform: context links (\"pipe trick\") with commas (T23660)",
		"wikitext": "[[Article (context), context|]]\n[[Article (context)Ôºåcontext|]]\n[[Bar:Article (context), context|]]\n[[Bar:Article (context)Ôºåcontext|]]\n[[:Bar:Article (context), context|]]\n[[:Bar:Article (context)Ôºåcontext|]]",
		"print": "<span class=\"wpb-root\">[[Article (context), context|]]\n[[Article (context)Ôºåcontext|]]\n[[Bar:Article (context), context|]]\n[[Bar:Article (context)Ôºåcontext|]]\n[[:Bar:Article (context), context|]]\n[[:Bar:Article (context)Ôºåcontext|]]</span>"
	},
	{
		"desc": "Parsoid: backwards pipe trick",
		"wikitext": "[[|'''bar''']]",
		"html": "<p>[[|<b>bar</b>]]\n</p>",
		"render": "<p>[[|<b>bar</b>]]\n</p>",
		"print": "<span class=\"wpb-root\">[[|<span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''</span>]]</span>"
	},
	{
		"desc": "pre-save transform: trim trailing empty lines",
		"wikitext": "Empty lines are trimmed",
		"print": "<span class=\"wpb-root\">Empty lines are trimmed</span>"
	},
	{
		"desc": "pre-save transform: Signature expansion",
		"wikitext": "* ~~~\n* ~~~~\n* ~~~~~\n* <noinclude>~~~</noinclude>\n* <includeonly>~~~</includeonly>\n* <onlyinclude>~~~</onlyinclude>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>~~~\n<span class=\"wpb-list\">* </span>~~~~\n<span class=\"wpb-list\">* </span>~~~~~\n<span class=\"wpb-list\">* </span><span class=\"wpb-noinclude\">&lt;noinclude&gt;</span>~~~<span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-include\">&lt;includeonly&gt;~~~&lt;/includeonly&gt;</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span>~~~<span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span></span>"
	},
	{
		"desc": "ParserOutput flags from signature expansion (T84843)",
		"wikitext": "~~~~",
		"print": "<span class=\"wpb-root\">~~~~</span>"
	},
	{
		"desc": "pre-save transform: Signature expansion in nowiki tags (T2093)",
		"wikitext": "Shall not expand:\n\n<nowiki>~~~~</nowiki>\n\n<includeonly><nowiki>~~~~</nowiki></includeonly>\n\n<noinclude><nowiki>~~~~</nowiki></noinclude>\n\n<onlyinclude><nowiki>~~~~</nowiki></onlyinclude>\n\n{{subst:Foo}} shall be converted to FOO\n\nAs well as inside noinclude/onlyinclude\n<noinclude>{{subst:Foo}}</noinclude>\n<onlyinclude>{{subst:Foo}}</onlyinclude>\n\nBut not inside includeonly\n<includeonly>{{subst:Foo}}</includeonly>",
		"print": "<span class=\"wpb-root\">Shall not expand:\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">~~~~</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-include\">&lt;includeonly&gt;&lt;nowiki&gt;~~~~&lt;/nowiki&gt;&lt;/includeonly&gt;</span>\n\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">~~~~</span>&lt;/nowiki&gt;</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>\n\n<span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">~~~~</span>&lt;/nowiki&gt;</span><span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span>\n\n<span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">Foo</span>}}</span> shall be converted to FOO\n\nAs well as inside noinclude/onlyinclude\n<span class=\"wpb-noinclude\">&lt;noinclude&gt;</span><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">Foo</span>}}</span><span class=\"wpb-noinclude\">&lt;/noinclude&gt;</span>\n<span class=\"wpb-noinclude\">&lt;onlyinclude&gt;</span><span class=\"wpb-template\">{{subst:<span class=\"wpb-template-name\">Foo</span>}}</span><span class=\"wpb-noinclude\">&lt;/onlyinclude&gt;</span>\n\nBut not inside includeonly\n<span class=\"wpb-include\">&lt;includeonly&gt;{{subst:Foo}}&lt;/includeonly&gt;</span></span>"
	},
	{
		"desc": "Parsoid: Recognize nowiki with trailing space in tags",
		"wikitext": "<nowiki ><div>[[foo]]</nowiki >\n\na<nowiki / >b\n\nc<nowiki />d\n\ne<nowiki/ >f",
		"html": "<p>&lt;div&gt;[[foo]]\n</p><p>a&lt;nowiki / &gt;b\n</p><p>cd\n</p><p>e&lt;nowiki/ &gt;f\n</p>",
		"render": "<p>&lt;div&gt;[[foo]]\n</p><p>a&lt;nowiki / &gt;b\n</p><p>cd\n</p><p>e&lt;nowiki/ &gt;f\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki<span class=\"wpb-ext-attrs\"> </span>&gt;<span class=\"wpb-ext-inner\">&lt;div&gt;[[foo]]</span>&lt;/nowiki &gt;</span>\n\na&lt;nowiki / &gt;b\n\nc<span class=\"wpb-ext\">&lt;nowiki<span class=\"wpb-ext-attrs\"> </span>/&gt;</span>d\n\ne&lt;nowiki/ &gt;f</span>"
	},
	{
		"desc": "Category with empty sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|]]",
		"print": "<span class=\"wpb-root\">[[Category:MediaWiki User's Guide|]]</span>"
	},
	{
		"desc": "Category with empty sort key and parentheses",
		"wikitext": "[[Category:Foo (bar)|]]",
		"print": "<span class=\"wpb-root\">[[Category:Foo (bar)|]]</span>"
	},
	{
		"desc": "Category with link tail",
		"wikitext": "123[[Category:Foo]]456",
		"print": "<span class=\"wpb-root\">123<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>456</span>"
	},
	{
		"desc": "Category with template",
		"wikitext": "[[Category:{{1x|Foo}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Category with template in sort key",
		"wikitext": "[[Category:Foo|{{1x|Bar}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bar</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Category with template in sort key and title",
		"wikitext": "[[Category:{{1x|Foo}}|{{1x|Bar}}]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span></span>|<span class=\"wpb-link-text\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Bar</span></span>}}</span></span>]]</span></span>"
	},
	{
		"desc": "Tildes in comments",
		"wikitext": "<!-- ~~~~ -->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- ~~~~ --&gt;</span></span>"
	},
	{
		"desc": "quotes"
	},
	{
		"desc": "Quotes",
		"wikitext": "Normal text. '''Bold text.''' Normal text. ''Italic text.''\n\nNormal text. '''''Bold italic text.''''' Normal text.",
		"html": "<p>Normal text. <b>Bold text.</b> Normal text. <i>Italic text.</i>\n</p><p>Normal text. <i><b>Bold italic text.</b></i> Normal text.\n</p>",
		"render": "<p>Normal text. <b>Bold text.</b> Normal text. <i>Italic text.</i>\n</p><p>Normal text. <i><b>Bold italic text.</b></i> Normal text.\n</p>",
		"print": "<span class=\"wpb-root\">Normal text. <span class=\"wpb-quote\">'''</span>Bold text.<span class=\"wpb-quote\">'''</span> Normal text. <span class=\"wpb-quote\">''</span>Italic text.<span class=\"wpb-quote\">''</span>\n\nNormal text. <span class=\"wpb-quote\">'''''</span>Bold italic text.<span class=\"wpb-quote\">'''''</span> Normal text.</span>"
	},
	{
		"desc": "Quotes wrapping HTML table",
		"wikitext": "'''<table><tr><td>hi</td></tr></table>'''",
		"html": "<b><table><tbody><tr><td>hi</td></tr></tbody></table></b>",
		"render": "<table ><tr ><td ><b>hi</b></td></tr></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>hi<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span><span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Unclosed and unmatched quotes",
		"wikitext": "'''''Bold italic text '''with bold deactivated''' in between.'''''\n\n'''''Bold italic text ''with italic deactivated'' in between.'''''\n\n'''Bold text..\n\n..spanning two paragraphs (should not work).'''\n\n'''Bold tag left open\n\n''Italic tag left open\n\nNormal text.\n\n<!-- Unmatching number of opening, closing tags: -->\n'''This year''''s election ''should'' beat '''last year''''s.\n\n''Tom'''s car is bigger than ''Susan'''s.\n\nPlain ''italic'''s plain",
		"html": "<p><i><b>Bold italic text </b>with bold deactivated<b> in between.</b></i>\n</p><p><b><i>Bold italic text </i>with italic deactivated<i> in between.</i></b>\n</p><p><b>Bold text..</b>\n</p><p>..spanning two paragraphs (should not work).<b></b>\n</p><p><b>Bold tag left open</b>\n</p><p><i>Italic tag left open</i>\n</p><p>Normal text.\n</p><p><b>This year'</b>s election <i>should</i> beat <b>last year'</b>s.\n</p><p><i>Tom<b>s car is bigger than </b></i><b>Susan</b>s.\n</p><p>Plain <i>italic'</i>s plain\n</p>",
		"render": "<p><i><b>Bold italic text </b></i><i>with bold deactivated</i><i><b> in between.</b></i>\n</p><p><i><b>Bold italic text </b></i><b>with italic deactivated</b><i><b> in between.</b></i>\n</p><p><b>Bold text..</b>\n</p><p>..spanning two paragraphs (should not work).<b></b>\n</p><p><b>Bold tag left open</b>\n</p><p><i>Italic tag left open</i>\n</p><p>Normal text.\n</p><p><b>This year'</b>s election <i>should</i> beat <b>last year'</b>s.\n</p><p><i>Tom</i><i><b>s car is bigger than </b></i><b>Susan</b>s.\n</p><p>Plain <i>italic'</i>s plain\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>Bold italic text <span class=\"wpb-quote\">'''</span>with bold deactivated<span class=\"wpb-quote\">'''</span> in between.<span class=\"wpb-quote\">'''''</span>\n\n<span class=\"wpb-quote\">'''''</span>Bold italic text <span class=\"wpb-quote\">''</span>with italic deactivated<span class=\"wpb-quote\">''</span> in between.<span class=\"wpb-quote\">'''''</span>\n\n<span class=\"wpb-quote\">'''</span>Bold text..\n\n..spanning two paragraphs (should not work).<span class=\"wpb-quote\">'''</span>\n\n<span class=\"wpb-quote\">'''</span>Bold tag left open\n\n<span class=\"wpb-quote\">''</span>Italic tag left open\n\nNormal text.\n\n<span class=\"wpb-comment\">&lt;!-- Unmatching number of opening, closing tags: --&gt;</span>\n<span class=\"wpb-quote\">'''</span>This year'<span class=\"wpb-quote\">'''</span>s election <span class=\"wpb-quote\">''</span>should<span class=\"wpb-quote\">''</span> beat <span class=\"wpb-quote\">'''</span>last year'<span class=\"wpb-quote\">'''</span>s.\n\n<span class=\"wpb-quote\">''</span>Tom<span class=\"wpb-quote\">'''</span>s car is bigger than <span class=\"wpb-quote\">''</span>Susan<span class=\"wpb-quote\">'''</span>s.\n\nPlain <span class=\"wpb-quote\">''</span>italic'<span class=\"wpb-quote\">''</span>s plain</span>"
	},
	{
		"desc": "Italics and bold",
		"wikitext": "*plain\n*plain''italic''plain\n*plain''italic''plain''italic''plain\n*plain'''bold'''plain\n*plain'''bold'''plain'''bold'''plain\n*plain''italic''plain'''bold'''plain\n*plain'''bold'''plain''italic''plain\n*plain''italic'''bold-italic'''italic''plain\n*plain'''bold''bold-italic''bold'''plain\n*plain'''''bold-italic'''italic''plain\n*plain'''''bold-italic''bold'''plain\n*plain''italic'''bold-italic'''''plain\n*plain'''bold''bold-italic'''''plain\n*plain l'''italic''plain\n*plain l''''bold''' plain",
		"html": "<ul><li>plain</li>\n<li>plain<i>italic</i>plain</li>\n<li>plain<i>italic</i>plain<i>italic</i>plain</li>\n<li>plain<b>bold</b>plain</li>\n<li>plain<b>bold</b>plain<b>bold</b>plain</li>\n<li>plain<i>italic</i>plain<b>bold</b>plain</li>\n<li>plain<b>bold</b>plain<i>italic</i>plain</li>\n<li>plain<i>italic<b>bold-italic</b>italic</i>plain</li>\n<li>plain<b>bold<i>bold-italic</i>bold</b>plain</li>\n<li>plain<i><b>bold-italic</b>italic</i>plain</li>\n<li>plain<b><i>bold-italic</i>bold</b>plain</li>\n<li>plain<i>italic<b>bold-italic</b></i>plain</li>\n<li>plain<b>bold<i>bold-italic</i></b>plain</li>\n<li>plain l'<i>italic</i>plain</li>\n<li>plain l'<b>bold</b> plain</li></ul>",
		"render": "<ul><li>plain</li>\n<li>plain<i>italic</i>plain</li>\n<li>plain<i>italic</i>plain<i>italic</i>plain</li>\n<li>plain<b>bold</b>plain</li>\n<li>plain<b>bold</b>plain<b>bold</b>plain</li>\n<li>plain<i>italic</i>plain<b>bold</b>plain</li>\n<li>plain<b>bold</b>plain<i>italic</i>plain</li>\n<li>plain<i>italic</i><i><b>bold-italic</b></i><i>italic</i>plain</li>\n<li>plain<b>bold</b><i><b>bold-italic</b></i><b>bold</b>plain</li>\n<li>plain<i><b>bold-italic</b></i><i>italic</i>plain</li>\n<li>plain<i><b>bold-italic</b></i><b>bold</b>plain</li>\n<li>plain<i>italic</i><i><b>bold-italic</b></i>plain</li>\n<li>plain<b>bold</b><i><b>bold-italic</b></i>plain</li>\n<li>plain l'<i>italic</i>plain</li>\n<li>plain l'<b>bold</b> plain</li></ul>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">'''</span>bold-italic<span class=\"wpb-quote\">'''</span>italic<span class=\"wpb-quote\">''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">''</span>bold-italic<span class=\"wpb-quote\">''</span>bold<span class=\"wpb-quote\">'''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''''</span>bold-italic<span class=\"wpb-quote\">'''</span>italic<span class=\"wpb-quote\">''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''''</span>bold-italic<span class=\"wpb-quote\">''</span>bold<span class=\"wpb-quote\">'''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">'''</span>bold-italic<span class=\"wpb-quote\">'''''</span>plain\n<span class=\"wpb-list\">*</span>plain<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">''</span>bold-italic<span class=\"wpb-quote\">'''''</span>plain\n<span class=\"wpb-list\">*</span>plain l'<span class=\"wpb-quote\">''</span>italic<span class=\"wpb-quote\">''</span>plain\n<span class=\"wpb-list\">*</span>plain l'<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span> plain</span>"
	},
	{
		"desc": "Italics and possessives (1)",
		"wikitext": "obtained by ''[[Lunar Prospector]]'''s gamma-ray spectrometer",
		"html": "<p>obtained by <i><a href=\"/wiki/Lunar_Prospector\" title=\"Lunar Prospector\">Lunar Prospector</a>'</i>s gamma-ray spectrometer\n</p>",
		"render": "<p>obtained by <i><a href=\"/wiki/Lunar_Prospector\" title=\"Lunar Prospector\">Lunar Prospector</a></i><i>'</i>s gamma-ray spectrometer\n</p>",
		"print": "<span class=\"wpb-root\">obtained by <span class=\"wpb-quote\">''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Lunar Prospector</span>]]</span>'<span class=\"wpb-quote\">''</span>s gamma-ray spectrometer</span>"
	},
	{
		"desc": "Italics and possessives (2)",
		"wikitext": "'''''Flaming Pie''''' is ... released in 1997. In ''Flaming Pie'''s liner notes",
		"html": "<p><i><b>Flaming Pie</b></i> is ... released in 1997. In <i>Flaming Pie'</i>s liner notes\n</p>",
		"render": "<p><i><b>Flaming Pie</b></i> is ... released in 1997. In <i>Flaming Pie'</i>s liner notes\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>Flaming Pie<span class=\"wpb-quote\">'''''</span> is ... released in 1997. In <span class=\"wpb-quote\">''</span>Flaming Pie'<span class=\"wpb-quote\">''</span>s liner notes</span>"
	},
	{
		"desc": "Italics and possessives (3)",
		"wikitext": "The first monolingual dictionary written in a Romance language was ''Sebasti√°n Covarrubias''' ''Tesoro de la lengua castellana o espa√±ola'', published in 1611 in Madrid. In 1612 the first edition of the ''Vocabolario dell'[[Accademia della Crusca]]'', for Italian, was published. In 1690 in Rotterdam was published, posthumously, the ''Dictionnaire Universel''.",
		"html": "<p>The first monolingual dictionary written in a Romance language was <i>Sebasti√°n Covarrubias'</i> <i>Tesoro de la lengua castellana o espa√±ola</i>, published in 1611 in Madrid. In 1612 the first edition of the <i>Vocabolario dell'<a href=\"/wiki/Accademia_della_Crusca\" title=\"Accademia della Crusca\">Accademia della Crusca</a></i>, for Italian, was published. In 1690 in Rotterdam was published, posthumously, the <i>Dictionnaire Universel</i>.\n</p>",
		"render": "<p>The first monolingual dictionary written in a Romance language was <i>Sebasti√°n Covarrubias'</i> <i>Tesoro de la lengua castellana o espa√±ola</i>, published in 1611 in Madrid. In 1612 the first edition of the <i>Vocabolario dell'</i><i><a href=\"/wiki/Accademia_della_Crusca\" title=\"Accademia della Crusca\">Accademia della Crusca</a></i>, for Italian, was published. In 1690 in Rotterdam was published, posthumously, the <i>Dictionnaire Universel</i>.\n</p>",
		"print": "<span class=\"wpb-root\">The first monolingual dictionary written in a Romance language was <span class=\"wpb-quote\">''</span>Sebasti√°n Covarrubias'<span class=\"wpb-quote\">''</span> <span class=\"wpb-quote\">''</span>Tesoro de la lengua castellana o espa√±ola<span class=\"wpb-quote\">''</span>, published in 1611 in Madrid. In 1612 the first edition of the <span class=\"wpb-quote\">''</span>Vocabolario dell'<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Accademia della Crusca</span>]]</span><span class=\"wpb-quote\">''</span>, for Italian, was published. In 1690 in Rotterdam was published, posthumously, the <span class=\"wpb-quote\">''</span>Dictionnaire Universel<span class=\"wpb-quote\">''</span>.</span>"
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,2)",
		"wikitext": "''foo''",
		"html": "<p><i>foo</i>\n</p>",
		"render": "<p><i>foo</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,3)",
		"wikitext": "''foo'''",
		"html": "<p><i>foo'</i>\n</p>",
		"render": "<p><i>foo'</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,4)",
		"wikitext": "''foo''''",
		"html": "<p><i>foo''</i>\n</p>",
		"render": "<p><i>foo''</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo''<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,4) w/ nowiki",
		"wikitext": "''foo<nowiki>''</nowiki>''",
		"html": "<p><i>foo''</i>\n</p>",
		"render": "<p><i>foo</i><i>''</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,5)",
		"wikitext": "''foo'''''",
		"html": "<p><i>foo</i><b></b>\n</p>",
		"render": "<p><i>foo</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,5-3)",
		"wikitext": "''foo''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,2)",
		"wikitext": "'''foo''",
		"html": "<p>'<i>foo</i>\n</p>",
		"render": "<p>'<i>foo</i>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,3)",
		"wikitext": "'''foo'''",
		"html": "<p><b>foo</b>\n</p>",
		"render": "<p><b>foo</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,4)",
		"wikitext": "'''foo''''",
		"html": "<p><b>foo'</b>\n</p>",
		"render": "<p><b>foo'</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,5)",
		"wikitext": "'''foo'''''",
		"html": "<p><b>foo</b><i></i>\n</p>",
		"render": "<p><b>foo</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,5-2)",
		"wikitext": "'''foo'''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,2)",
		"wikitext": "''''foo''",
		"html": "<p>''<i>foo</i>\n</p>",
		"render": "<p>''<i>foo</i>\n</p>",
		"print": "<span class=\"wpb-root\">''<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,2) w/ nowiki",
		"wikitext": "<nowiki>''</nowiki>''foo''",
		"html": "<p>''<i>foo</i>\n</p>",
		"render": "<p>''<i>foo</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,3)",
		"wikitext": "''''foo'''",
		"html": "<p>'<b>foo</b>\n</p>",
		"render": "<p>'<b>foo</b>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,4)",
		"wikitext": "''''foo''''",
		"html": "<p>'<b>foo'</b>\n</p>",
		"render": "<p>'<b>foo'</b>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,4) w/ nowiki",
		"wikitext": "'<nowiki/>'''foo''''",
		"html": "<p>'<b>foo'</b>\n</p>",
		"render": "<p>'<b>foo'</b>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,5)",
		"wikitext": "''''foo'''''",
		"html": "<p>'<b>foo</b><i></i>\n</p>",
		"render": "<p>'<b>foo</b>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,5-2)",
		"wikitext": "''''foo'''",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,2)",
		"wikitext": "'''''foo''",
		"html": "<p><b><i>foo</i></b>\n</p>",
		"render": "<p><i><b>foo</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,2+3)",
		"wikitext": "'''''foo'''''",
		"html": "<p><i><b>foo</b></i>\n</p>",
		"render": "<p><i><b>foo</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,3)",
		"wikitext": "'''''foo'''",
		"html": "<p><i><b>foo</b></i>\n</p>",
		"render": "<p><i><b>foo</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,3+2)",
		"wikitext": "'''''foo'''''",
		"html": "<p><i><b>foo</b></i>\n</p>",
		"render": "<p><i><b>foo</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,4)",
		"wikitext": "'''''foo''''",
		"html": "<p><i><b>foo'</b></i>\n</p>",
		"render": "<p><i><b>foo'</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo'<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,5)",
		"wikitext": "'''''foo'''''",
		"html": "<p><i><b>foo</b></i>\n</p>",
		"render": "<p><i><b>foo</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,6)",
		"wikitext": "'''''foo''''''",
		"html": "<p><i><b>foo'</b></i>\n</p>",
		"render": "<p><i><b>foo'</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''''</span>foo'<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,2)",
		"wikitext": "''foo''''bar''",
		"html": "<p><i>foo'<b>bar</b></i><b></b>\n</p>",
		"render": "<p><i>foo'</i><i><b>bar</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,2+3) w/ nowiki",
		"wikitext": "''foo'<nowiki/>'''bar'''''",
		"html": "<p><i>foo'<b>bar</b></i>\n</p>",
		"render": "<p><i>foo'</i><i><b>bar</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,3)",
		"wikitext": "''foo''''bar'''",
		"html": "<p><i>foo'<b>bar</b></i>\n</p>",
		"render": "<p><i>foo'</i><i><b>bar</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,3+2) w/ nowiki",
		"wikitext": "''foo'<nowiki/>'''bar'''''",
		"html": "<p><i>foo'<b>bar</b></i>\n</p>",
		"render": "<p><i>foo'</i><i><b>bar</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,4)",
		"wikitext": "''foo''''bar''''",
		"html": "<p><i>foo'<b>bar'</b></i>\n</p>",
		"render": "<p><i>foo'</i><i><b>bar'</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-quote\">'''</span>bar'<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,4+2) w/ nowiki",
		"wikitext": "''foo'<nowiki/>'''bar'<nowiki/>'''''",
		"html": "<p><i>foo'<b>bar'</b></i>\n</p>",
		"render": "<p><i>foo'</i><i><b>bar'</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">'''</span>bar'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (3,4,2)",
		"wikitext": "'''foo''''bar''",
		"html": "<p><b>foo'</b>bar<i></i>\n</p>",
		"render": "<p><b>foo'</b>bar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (3,4,2-2)",
		"wikitext": "'''foo''''bar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span>bar</span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (3,4,3)",
		"wikitext": "'''foo''''bar'''",
		"html": "<p><b>foo'</b>bar<b></b>\n</p>",
		"render": "<p><b>foo'</b>bar\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (3,4,3-3)",
		"wikitext": "'''foo''''bar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-quote\">'''</span>bar</span>"
	},
	{
		"desc": "Italics and bold: other quote tests: (2,3,5)",
		"wikitext": "''this is about '''foo's family'''''",
		"html": "<p><i>this is about <b>foo's family</b></i>\n</p>",
		"render": "<p><i>this is about </i><i><b>foo's family</b></i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>this is about <span class=\"wpb-quote\">'''</span>foo's family<span class=\"wpb-quote\">'''''</span></span>"
	},
	{
		"desc": "Italics and bold: other quote tests: (2,(3,3),2)",
		"wikitext": "''this is about '''foo's''' family''",
		"html": "<p><i>this is about <b>foo's</b> family</i>\n</p>",
		"render": "<p><i>this is about </i><i><b>foo's</b></i><i> family</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>this is about <span class=\"wpb-quote\">'''</span>foo's<span class=\"wpb-quote\">'''</span> family<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: other quote tests: (3,2,3,2)",
		"wikitext": "'''this is about ''foo'''s family''",
		"html": "<p><b>this is about <i>foo</i></b><i>s family</i>\n</p>",
		"render": "<p><b>this is about </b><i><b>foo</b></i><i>s family</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>this is about <span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">'''</span>s family<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: other quote tests: (3,2,3+2+2,2)",
		"wikitext": "'''this is about ''foo'''''<nowiki/>''s family''",
		"html": "<p><b>this is about <i>foo</i></b><i>s family</i>\n</p>",
		"render": "<p><b>this is about </b><i><b>foo</b></i><i>s family</i>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>this is about <span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">'''''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">''</span>s family<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Italics and bold: other quote tests: (3,2,3,3)",
		"wikitext": "'''this is about ''foo'''s family'''",
		"html": "<p>'<i>this is about </i>foo<b>s family</b>\n</p>",
		"render": "<p>'<i>this is about </i>foo<b>s family</b>\n</p>",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-quote\">''</span>this is about <span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">'''</span>s family<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italics and bold: other quote tests: (3,(2,2),3)",
		"wikitext": "'''this is about ''foo's'' family'''",
		"html": "<p><b>this is about <i>foo's</i> family</b>\n</p>",
		"render": "<p><b>this is about </b><i><b>foo's</b></i><b> family</b>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">'''</span>this is about <span class=\"wpb-quote\">''</span>foo's<span class=\"wpb-quote\">''</span> family<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Italicized possessive",
		"wikitext": "The ''[[Main Page]]'''s talk page.",
		"html": "<p>The <i><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>'</i>s talk page.\n</p>",
		"render": "<p>The <i><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></i><i>'</i>s talk page.\n</p>",
		"print": "<span class=\"wpb-root\">The <span class=\"wpb-quote\">''</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>'<span class=\"wpb-quote\">''</span>s talk page.</span>"
	},
	{
		"desc": "Quote balancing context should be restricted to td/th cells on the same wikitext line",
		"wikitext": "{|\n!''a!!''b\n|''a||''b\n|}",
		"html": "<table>\n<tbody><tr>\n<th><i>a</i></th>\n<th><i>b</i>\n</th>\n<td><i>a</i></td>\n<td><i>b</i>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th ><i>a</i></th>\n<th ><i>b</i>\n</th>\n<td ><i>a</i></td>\n<td ><i>b</i>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span>a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span>b</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span>a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span>b</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Bold conversion test",
		"wikitext": "a b'''c ''d e'''f'' g h'''i ''j",
		"html": "<p>a b'<i>c </i>d e<b>f<i> g h</i></b><i>i </i>j\n</p>",
		"render": "<p>a b'<i>c </i>d e<b>f</b><i><b> g h</b></i><i>i </i>j\n</p>",
		"print": "<span class=\"wpb-root\">a b'<span class=\"wpb-quote\">''</span>c <span class=\"wpb-quote\">''</span>d e<span class=\"wpb-quote\">'''</span>f<span class=\"wpb-quote\">''</span> g h<span class=\"wpb-quote\">'''</span>i <span class=\"wpb-quote\">''</span>j</span>"
	},
	{
		"desc": "redirects"
	},
	{
		"desc": "1. Simple redirect to page",
		"wikitext": "#REDIRECT [[Main Page]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>"
	},
	{
		"desc": "2. Other redirect variants",
		"wikitext": "#REDIRECT [[Main_Page]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main_Page</span>]]</span></span></span>"
	},
	{
		"desc": "3. Other redirect variants",
		"wikitext": "#REDIRECT [[<nowiki>[[Bar]]</nowiki>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#</span>REDIRECT [[<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[Bar]]</span>&lt;/nowiki&gt;</span>]]</span>"
	},
	{
		"desc": "4. Redirect to a templated destination",
		"wikitext": "#REDIRECT [[{{1x|Foo}}bar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#</span>REDIRECT <span class=\"wpb-link\">[[<span class=\"wpb-link-target\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>}}</span>bar</span>]]</span></span>"
	},
	{
		"desc": "Empty redirect",
		"wikitext": "#REDIRECT [[]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">#</span>REDIRECT [[]]</span>"
	},
	{
		"desc": "Optional colon in #REDIRECT",
		"wikitext": "#REDIRECT:[[Main Page]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT:</span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>"
	},
	{
		"desc": "Whitespace in #REDIRECT with optional colon",
		"wikitext": " \n #REDIRECT \n: \n[[Main Page]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"> \n <span class=\"wpb-redirect-syntax\">#REDIRECT \n: \n</span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span></span>"
	},
	{
		"desc": "Piped link in #REDIRECT",
		"wikitext": "#REDIRECT [[Main Page|bar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-noinclude\">bar</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to category (T104502)",
		"wikitext": "#REDIRECT [[Category:Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to category with URL encoding (T104502)",
		"wikitext": "#REDIRECT [[Category%3AFoo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Category%3AFoo</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to category page",
		"wikitext": "#REDIRECT [[:Category:Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">:Category:Foo</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to image page (1)",
		"wikitext": "#REDIRECT [[File:Wiki.png]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">File:Wiki.png</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to image page (2)",
		"wikitext": "#REDIRECT [[Image:Wiki.png]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Image:Wiki.png</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to language (1) (T104918)",
		"wikitext": "#REDIRECT [[en:File:Wiki.png]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">en:File:Wiki.png</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to language (2) (T104918)",
		"wikitext": "#REDIRECT [[:en:File:Wiki.png]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">:en:File:Wiki.png</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect to interwiki (T104918)",
		"wikitext": "#REDIRECT [[meatball:File:Wiki.png]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">meatball:File:Wiki.png</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect syntax under text isn't considered a redirect",
		"wikitext": "some text\n\n#redirect [[Main Page]]",
		"print": "<span class=\"wpb-root\">some text\n\n<span class=\"wpb-list\">#</span>redirect <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span>"
	},
	{
		"desc": "New redirect",
		"wikitext": "#REDIRECT [[Foo]]\nFoo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>\n</span>Foo</span>"
	},
	{
		"desc": "Redirect followed by block on the same line",
		"wikitext": "#REDIRECT [[Main Page]]<!-- haha -->==hi==",
		"html": "<ol><li>REDIRECT <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>==hi==</li></ol>",
		"render": "<ul class=\"redirectText\"><li><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></li></ul><div class=\"mw-heading mw-heading2\"><h2 id=\"hi\">hi</h2></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span><span class=\"wpb-comment\">&lt;!-- haha --&gt;</span><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">hi</span>==</span></span>"
	},
	{
		"desc": "Redirect followed by horizontal rule on the same line",
		"wikitext": "#REDIRECT [[Main Page]]----",
		"html": "<ol><li>REDIRECT <a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a>----</li></ol>",
		"render": "<ul class=\"redirectText\"><li><a href=\"/wiki/Main_Page\" title=\"Main Page\">Main Page</a></li></ul><hr>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span></span><span class=\"wpb-hr\">----</span></span>"
	},
	{
		"desc": "Redirect followed by a newline",
		"wikitext": "#REDIRECT [[Main Page]]\nA newline",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>\n</span>A newline</span>"
	},
	{
		"desc": "Redirect followed by multiple newlines",
		"wikitext": "#REDIRECT [[Main Page]]\n\n\nA newline",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Main Page</span>]]</span>\n\n\n</span>A newline</span>"
	},
	{
		"desc": "Drop duplicate redirects",
		"wikitext": "#REDIRECT [[Foo]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Foo</span>]]</span></span></span>"
	},
	{
		"desc": "Redirect containing double quotes and spaces",
		"wikitext": "#REDIRECT [[Cool \"Gator\"]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-redirect\"><span class=\"wpb-redirect-syntax\">#REDIRECT </span><span class=\"wpb-redirect-target\">[[<span class=\"wpb-link-target\">Cool \"Gator\"</span>]]</span></span></span>"
	},
	{
		"desc": "Broken redirect shouldn't crash parsoid (T332242)",
		"wikitext": "<!-- Not a valid redirect nor a valid parser function -->\n{{#REDIRECT [[]]}}",
		"html": "<p>{{#REDIRECT [[]]}}\n</p>",
		"render": "<p>{{#REDIRECT [[]]}}\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!-- Not a valid redirect nor a valid parser function --&gt;</span>\n{{#REDIRECT [[]]}}</span>"
	},
	{
		"desc": "stringFunctionTests"
	},
	{
		"desc": "#len",
		"wikitext": "{{#len:}}\n{{#len:0}}\n{{#len:test}}",
		"html": "<p>0\n1\n4\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#len</span>:}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#len</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">0</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#len</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">test</span></span>}}</span></span>"
	},
	{
		"desc": "#urldecode",
		"wikitext": "{{#urldecode:}}\n{{#urldecode:foo%20bar}}\n{{#urldecode:%D0%9C%D0%B5%D0%B4%D0%B8%D0%B0%D0%92%D0%B8%D0%BA%D0%B8}}\n{{#urldecode: some unescaped string}}",
		"html": "<p>foo bar\n–ú–µ–¥–∏–∞–í–∏–∫–∏\nsome unescaped string\n</p>",
		"render": "<p><br>\n</p><p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#urldecode</span>:}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#urldecode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">foo%20bar</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#urldecode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">%D0%9C%D0%B5%D0%B4%D0%B8%D0%B0%D0%92%D0%B8%D0%BA%D0%B8</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#urldecode</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"> some unescaped string</span></span>}}</span></span>"
	},
	{
		"desc": "#pos",
		"wikitext": "{{#pos:≈Ωmr≈ælina|≈ælina}}\n{{#pos:stringstring|str|4}}",
		"html": "<p>3\n6\n</p>",
		"render": "<p><br>\n</p>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#pos</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">≈Ωmr≈ælina</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">≈ælina</span></span>}}</span>\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#pos</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">stringstring</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">str</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">4</span></span>}}</span></span>"
	},
	{
		"desc": "#pos with too large offset (T209600)",
		"wikitext": "{{#pos:FooBar|Foo|32}}",
		"html": "",
		"render": "",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">#pos</span>:<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">FooBar</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">Foo</span></span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">32</span></span>}}</span></span>"
	},
	{
		"desc": "tables"
	},
	{
		"desc": "Tables with multiple newlines after individual lines embedded in links",
		"wikitext": "[[Test|\n{|\n\n|test\n|}]]",
		"html": "<p><a href=\"/wiki/Test\" title=\"Test\">\n</a></p><table>\n\n<tbody><tr>\n<td>test\n</td></tr></tbody></table>\n<p class=\"mw-empty-elt\"></p>",
		"render": "<a href=\"/wiki/Test\" title=\"Test\"> <table > <tbody><tr> <td >test </td></tr></tbody></table></a>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Test</span>|<span class=\"wpb-link-text\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">test</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>]]</span></span>"
	},
	{
		"desc": "A table with no data.",
		"wikitext": "{||}",
		"html": "",
		"render": "<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">|}</span></span></span></span>"
	},
	{
		"desc": "A table with no data (take 2)",
		"wikitext": "{|\n|}",
		"html": "<table>\n<tbody><tr><td></td></tr></tbody></table>",
		"render": "<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "A table with no data generated by a <table> markup",
		"wikitext": "<table></table>",
		"html": "<table></table>",
		"render": "<table ></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span><span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "Parsoid: Don't paragraph-wrap fosterable content even if table syntax is unbalanced",
		"wikitext": "{|\n<td>\n<td>\n</td>\n\n\n\n|}",
		"html": "<table>\n<tbody><tr><td>\n</td><td>\n</td>\n\n\n\n</tr><tr><td></td></tr></tbody></table>",
		"render": "<td > <td > </td><table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-html\">&lt;td&gt;</span>\n<span class=\"wpb-html\">&lt;td&gt;</span>\n<span class=\"wpb-html\">&lt;/td&gt;</span>\n\n\n</span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "A table with stray table end tags on start tag line (wt2html)",
		"wikitext": "{|style=\"color: red;\"|}\n\n{|style=\"color: red;\" |}\n|foo\n|}\n\n{|style=\"color: red;\"|} id=\"foo\"\n|foo\n|}\n\n{|style=\"color: red;\" |} id=\"foo\"\n|foo\n|}",
		"html": "<table style=\"color: red;\">\n\n</table><table style=\"color: red;\">\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>\n<table style=\"color: red;\" id=\"foo\">\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>\n<table style=\"color: red;\" id=\"foo\">\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table style=\"color: red;\">\n<tbody></tbody></table>\n<table style=\"color: red;\">\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>\n<table style=\"color: red;\" id=\"foo\">\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>\n<table style=\"color: red;\" id=\"foo\">\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span><span class=\"wpb-attr-dirty\">|}</span></span><span class=\"wpb-table-inter\">\n</span></span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span><span class=\"wpb-attr-dirty\"> |}</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span><span class=\"wpb-attr-dirty\">|} </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span><span class=\"wpb-attr-dirty\"> |} </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">id</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "A table with nothing but a caption",
		"wikitext": "{|\n|+caption\n|}",
		"html": "<table>\n<caption>caption\n</caption><tbody><tr><td></td></tr></tbody></table>",
		"render": "<table >\n<tbody>\n<caption >caption</caption></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-td-inner\">caption</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "A table with caption with default-spaced attributes and a table row",
		"wikitext": "{|\n|+ style=\"color: red;\" |caption1\n|-\n|foo\n|}",
		"html": "<table>\n<caption style=\"color: red;\">caption1\n</caption>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody>\n<caption style=\"color: red;\">caption1</caption><tr >\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span> </span>|<span class=\"wpb-td-inner\">caption1</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "A table with captions with non-default spaced attributes and a table row",
		"wikitext": "{|\n|+style=\"color: red;\"|caption2\n|+ style=\"color: red;\"|caption3\n|-\n|foo\n|}",
		"html": "<table>\n<caption style=\"color: red;\">caption2\n</caption>\n<caption style=\"color: red;\">caption3\n</caption>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody>\n<caption style=\"color: red;\">caption2</caption>\n<caption style=\"color: red;\">caption3</caption><tr >\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span></span>|<span class=\"wpb-td-inner\">caption2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red;</span>\"</span></span>|<span class=\"wpb-td-inner\">caption3</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table td-cell syntax variations",
		"wikitext": "{|\n|foo bar foo|baz\n|foo bar foo||baz\n|style='color:red;'|baz\n|style='color:red;'||baz\n|}",
		"html": "<table>\n<tbody><tr>\n<td>baz\n</td>\n<td>foo bar foo</td>\n<td>baz\n</td>\n<td style=\"color:red;\">baz\n</td>\n<td>style='color:red;'</td>\n<td>baz\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td  >baz\n</td>\n<td >foo bar foo</td>\n<td >baz\n</td>\n<td style=\"color:red;\">baz\n</td>\n<td >style='color:red;'</td>\n<td >baz\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">foo</span></span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">bar</span></span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">foo</span></span></span>|<span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo bar foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:red;</span>'</span></span>|<span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">style='color:red;'</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Simple table",
		"wikitext": "{|\n|1||2\n|-\n|3||4\n|}",
		"html": "<table>\n<tbody><tr>\n<td>1</td>\n<td>2\n</td></tr>\n<tr>\n<td>3</td>\n<td>4\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >1</td>\n<td >2\n</td></tr><tr >\n<td >3</td>\n<td >4\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">3</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">4</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Simple table but with multiple dashes for row wikitext",
		"wikitext": "{|\n|foo\n|-----\n|bar\n|}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td></tr>\n<tr>\n<td>bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td></tr><tr >\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-----</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Multiplication table",
		"wikitext": "{| border=\"1\" cellpadding=\"2\"\n|+Multiplication table\n|-\n!&times;!!1!!2!!3\n|-\n!1\n|1||2||3\n|-\n!2\n|2||4||6\n|-\n!3\n|3||6||9\n|-\n!4\n|4||8||12\n|-\n!5\n|5||10||15\n|}",
		"html": "<table border=\"1\" cellpadding=\"2\">\n<caption>Multiplication table\n</caption>\n<tbody><tr>\n<th>&#215;</th>\n<th>1</th>\n<th>2</th>\n<th>3\n</th></tr>\n<tr>\n<th>1\n</th>\n<td>1</td>\n<td>2</td>\n<td>3\n</td></tr>\n<tr>\n<th>2\n</th>\n<td>2</td>\n<td>4</td>\n<td>6\n</td></tr>\n<tr>\n<th>3\n</th>\n<td>3</td>\n<td>6</td>\n<td>9\n</td></tr>\n<tr>\n<th>4\n</th>\n<td>4</td>\n<td>8</td>\n<td>12\n</td></tr>\n<tr>\n<th>5\n</th>\n<td>5</td>\n<td>10</td>\n<td>15\n</td></tr></tbody></table>",
		"render": "<table border=\"1\" cellpadding=\"2\">\n<tbody>\n<caption >Multiplication table</caption><tr >\n<th >&times;</th>\n<th >1</th>\n<th >2</th>\n<th >3\n</th></tr><tr >\n<th >1\n</th>\n<td >1</td>\n<td >2</td>\n<td >3\n</td></tr><tr >\n<th >2\n</th>\n<td >2</td>\n<td >4</td>\n<td >6\n</td></tr><tr >\n<th >3\n</th>\n<td >3</td>\n<td >6</td>\n<td >9\n</td></tr><tr >\n<th >4\n</th>\n<td >4</td>\n<td >8</td>\n<td >12\n</td></tr><tr >\n<th >5\n</th>\n<td >5</td>\n<td >10</td>\n<td >15\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">border</span>=\"<span class=\"wpb-attr-value\">1</span>\"</span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">cellpadding</span>=\"<span class=\"wpb-attr-value\">2</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-td-inner\">Multiplication table</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">&amp;times;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-td-inner\">3</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">3</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">4</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">6</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">3</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">3</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">6</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">9</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">4</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">4</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">8</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">12</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">5</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">5</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">10</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">15</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"||\" in table headings",
		"wikitext": "{|\n!h1||h2\n|}",
		"html": "<table>\n<tbody><tr>\n<th>h1</th>\n<th>h2\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >h1</th>\n<th >h2\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">h1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">h2</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"!!\" in table data",
		"wikitext": "{|\n|Foo!!||\n|}",
		"html": "<table>\n<tbody><tr>\n<td>Foo!!</td>\n<td>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >Foo!!</td>\n<td >\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Foo!!</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"||\" in indented table headings",
		"wikitext": ":{|\n!h1||h2\n|}",
		"html": "<dl><dd><table>\n<tbody><tr>\n<th>h1</th>\n<th>h2\n</th></tr></tbody></table></dd></dl>",
		"render": "<dl><dd><table >\n<tbody><tr>\n<th >h1</th>\n<th >h2\n</th></tr></tbody></table></dd></dl>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-dd\">:</span><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">h1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">h2</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"!!\" in templates",
		"wikitext": "{|\n!a {{1x|b!!c}}\n|}",
		"html": "<table>\n<tbody><tr>\n<th>a b</th>\n<th>c\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >a b</th>\n<th >c\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">a <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">b!!c</span></span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"!!\" in table headings after newline",
		"wikitext": "{|\n!a\nb!!c\n|}",
		"html": "<table>\n<tbody><tr>\n<th>a\n<p>b!!c\n</p>\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >a\n<p>b!!c\n</p>\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">a\nb!!c</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"!!\" in table data of mixed wikitext / html syntax",
		"wikitext": "{|\n!a\n<tr><td>b!!c</td></tr>\n|}",
		"html": "<table>\n<tbody><tr>\n<th>a\n</th></tr><tr><td>b!!c</td></tr>\n</tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >a\n<tr ><td >b!!c</td></tr>\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">a\n<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>b!!c<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept empty attributes in td/th cells (td/th cells starting with leading ||)",
		"wikitext": "{|\n!|h1\n||a\n|}",
		"html": "<table>\n<tbody><tr>\n<th>h1\n</th>\n<td>a\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >h1\n</th>\n<td >a\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span>|<span class=\"wpb-td-inner\">h1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span>|<span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Accept \"| !\" at start of line in tables (ignore !-attribute)",
		"wikitext": "{|\n|-\n|!style=\"color:red\"|bar\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td>bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">!style=\"color:red\"</span></span>|<span class=\"wpb-td-inner\">bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Allow +/- in 2nd and later cells in a row, in 1st cell when td-attrs are present, or in 1st cell when there is a space between \"|\" and +/- ",
		"wikitext": "{|\n|-\n|style='color:red;'|+1\n|style='color:blue;'|-1\n|-\n|1||2||3\n|1||+2||-3\n|-\n| +1\n| -1\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td style=\"color:red;\">+1\n</td>\n<td style=\"color:blue;\">-1\n</td></tr>\n<tr>\n<td>1</td>\n<td>2</td>\n<td>3\n</td>\n<td>1</td>\n<td>+2</td>\n<td>-3\n</td></tr>\n<tr>\n<td>+1\n</td>\n<td>-1\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td style=\"color:red;\">+1\n</td>\n<td style=\"color:blue;\">-1\n</td></tr><tr >\n<td >1</td>\n<td >2</td>\n<td >3\n</td>\n<td >1</td>\n<td >+2</td>\n<td >-3\n</td></tr><tr >\n<td >+1\n</td>\n<td >-1\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:red;</span>'</span></span>|<span class=\"wpb-td-inner\">+1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:blue;</span>'</span></span>|<span class=\"wpb-td-inner\">-1</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">3</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">+2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">-3</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> +1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> -1</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table rowspan",
		"wikitext": "{| border=1\n|Cell 1, row 1\n|rowspan=2|Cell 2, row 1 (and 2)\n|Cell 3, row 1\n|-\n|Cell 1, row 2\n|Cell 3, row 2\n|}",
		"html": "<table border=\"1\">\n<tbody><tr>\n<td>Cell 1, row 1\n</td>\n<td rowspan=\"2\">Cell 2, row 1 (and 2)\n</td>\n<td>Cell 3, row 1\n</td></tr>\n<tr>\n<td>Cell 1, row 2\n</td>\n<td>Cell 3, row 2\n</td></tr></tbody></table>",
		"render": "<table border=\"1\">\n<tbody><tr>\n<td >Cell 1, row 1\n</td>\n<td rowspan=\"2\">Cell 2, row 1 (and 2)\n</td>\n<td >Cell 3, row 1\n</td></tr><tr >\n<td >Cell 1, row 2\n</td>\n<td >Cell 3, row 2\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">border</span>=<span class=\"wpb-attr-value\">1</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Cell 1, row 1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">rowspan</span>=<span class=\"wpb-attr-value\">2</span></span></span>|<span class=\"wpb-td-inner\">Cell 2, row 1 (and 2)</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Cell 3, row 1</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Cell 1, row 2</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Cell 3, row 2</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Nested table",
		"wikitext": "{| border=1\n| &alpha;\n|\n{| bgcolor=#ABCDEF border=2\n|nested\n|-\n|table\n|}\n|the original table again\n|}",
		"html": "<table border=\"1\">\n<tbody><tr>\n<td>&#945;\n</td>\n<td>\n<table bgcolor=\"#ABCDEF\" border=\"2\">\n<tbody><tr>\n<td>nested\n</td></tr>\n<tr>\n<td>table\n</td></tr></tbody></table>\n</td>\n<td>the original table again\n</td></tr></tbody></table>",
		"render": "<table border=\"1\">\n<tbody><tr>\n<td >&alpha;\n</td>\n<td >\n<table bgcolor=\"#ABCDEF\" border=\"2\">\n<tbody><tr>\n<td >nested\n</td></tr><tr >\n<td >table\n</td></tr></tbody></table>\n</td>\n<td >the original table again\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">border</span>=<span class=\"wpb-attr-value\">1</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> &amp;alpha;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">bgcolor</span>=<span class=\"wpb-attr-value\">#ABCDEF</span></span> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">border</span>=<span class=\"wpb-attr-value\">2</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">nested</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">table</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">the original table again</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Invalid attributes in table cell (T3830)",
		"wikitext": "{|\n|Cell:|broken\n|}",
		"html": "<table>\n<tbody><tr>\n<td>broken\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >broken\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">Cell:</span></span></span>|<span class=\"wpb-td-inner\">broken</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table cell attributes: Pipes protected by nowikis should be treated as a plain character",
		"wikitext": "{|\n|title=\"foo\" |bar\n|title=\"foo<nowiki>|</nowiki>\" |bar\n|title=\"foo<nowiki>|</nowiki>\" bar\n|}",
		"html": "<table>\n<tbody><tr>\n<td title=\"foo\">bar\n</td>\n<td title=\"foo&#124;\">bar\n</td>\n<td>title=\"foo|\" bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td title=\"foo\">bar\n</td>\n<td title=\"foo|\">bar\n</td>\n<td >title=\"foo|\" bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">foo</span>\"</span> </span>|<span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">title</span>=\"<span class=\"wpb-attr-value\">foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">|</span>&lt;/nowiki&gt;</span></span>\"</span> </span>|<span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">title=\"foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">|</span>&lt;/nowiki&gt;</span>\" bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table cell attributes: Pipes protected by nested nowikis should be treated as a plain character",
		"wikitext": "{|\n|<code><nowiki>{{ACB|PG}}</nowiki></code>\n|}",
		"html": "<table>\n<tbody><tr>\n<td><code>{{ACB|PG}}</code>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td ><code >{{ACB|PG}}</code>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;code&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">{{ACB|PG}}</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/code&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table security: embedded pipes",
		"wikitext": "{|\n| |[ftp://|x||]\" onmouseover=\"alert(document.cookie)\">test",
		"html": "<table>\n<tbody><tr>\n<td>[<a rel=\"nofollow\" class=\"external free\" href=\"ftp://%7Cx\">ftp://%7Cx</a></td>\n<td>]\" onmouseover=\"alert(document.cookie)\"&gt;test\n</td>\n</tr>\n</tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >[<a rel=\"nofollow\" class=\"external free\">ftp://|x</a></td>\n<td >]\" onmouseover=\"alert(document.cookie)\"&gt;test\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> </span>|<span class=\"wpb-td-inner\">[<span class=\"wpb-free-ext-link\">ftp://|x</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">]\" onmouseover=\"alert(document.cookie)\"&gt;test</span></span></span></span>"
	},
	{
		"desc": "Element attributes with double ! should not be broken up by <th>",
		"wikitext": "{|\n!hi <div class=\"!!\">ha</div> ho\n|}",
		"html": "<table>\n<tbody><tr>\n<th>hi <div class=\"!!\">ha</div> ho\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >hi <div class=\"!!\">ha</div> ho\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">hi <span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">!!</span>\"</span></span>&gt;</span>ha<span class=\"wpb-html\">&lt;/div&gt;</span> ho</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "! and || in element attributes should not be parsed as <th>/<td>",
		"wikitext": "{|\n|<div style=\"color: red !important;\" data-contrived=\"put this here ||\">hi</div>\n|}",
		"html": "<table>\n<tbody><tr>\n<td><div style=\"color: red !important;\" data-contrived=\"put this here &#124;&#124;\">hi</div>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td ><div style=\"color: red !important;\" >hi</div>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-html\">&lt;div<span class=\"wpb-html-attrs\"> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color: red !important;</span>\"</span> <span class=\"wpb-html-attr\"><span class=\"wpb-attr-key\">data-contrived</span>=\"<span class=\"wpb-attr-value\">put this here ||</span>\"</span></span>&gt;</span>hi<span class=\"wpb-html\">&lt;/div&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "! and || in td attributes should not be parsed as <th>/<td>",
		"wikitext": "{|\n|style=\"color: red !important;\" data-contrived=\"put this here ||\"|foo\n|}",
		"html": "<table>\n<tbody><tr>\n<td>style=\"color: red !important;\" data-contrived=\"put this here</td>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >style=\"color: red !important;\" data-contrived=\"put this here</td>\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">style=\"color: red !important;\" data-contrived=\"put this here </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">\"</span></span>|<span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Invalid text in table attributes should be discarded",
		"wikitext": "{| <span>boo</span> style='border:1px solid black'\n|  <span>boo</span> style='color:blue'  |1\n|<span>boo</span> style='color:blue'|2\n|}",
		"html": "<table style=\"border:1px solid black\">\n<tbody><tr>\n<td style=\"color:blue\">1\n</td>\n<td style=\"color:blue\">2\n</td></tr></tbody></table>",
		"render": "<table style=\"border:1px solid black\">\n<tbody><tr>\n<td style=\"color:blue\">1\n</td>\n<td style=\"color:blue\">2\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span> </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">border:1px solid black</span>'</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">  <span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span> </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:blue</span>'</span>  </span>|<span class=\"wpb-td-inner\">1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"><span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span> </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:blue</span>'</span></span>|<span class=\"wpb-td-inner\">2</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Invalid text in table attributes should be preserved by selective serializer",
		"wikitext": "{| <span>boo</span> style='border:1px solid black'\n|  <span>boo</span> style='color:blue'  | 1\n|<span>boo</span> style='color:blue'| 2\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> <span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span> </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">border:1px solid black</span>'</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\">  <span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span> </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:blue</span>'</span>  </span>|<span class=\"wpb-td-inner\"> 1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"><span class=\"wpb-html\">&lt;span&gt;</span>boo<span class=\"wpb-html\">&lt;/span&gt;</span> </span><span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>='<span class=\"wpb-attr-value\">color:blue</span>'</span></span>|<span class=\"wpb-td-inner\"> 2</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "1. Template-generated table cell attributes and cell content",
		"wikitext": "{|\n|{{table_attribs}}\n| {{table_attribs}}\n|| {{table_attribs_5}}\n| <!--foo--> <!--bar--> <!--baz--> {{table_attribs}}\n|align=center {{table_attribs}}\n| <!--foo--> align=center <!--bar--> {{table_attribs}}\n|}",
		"html": "<table>\n<tbody><tr>\n<td style=\"color:red;\">Foo\n</td>\n<td style=\"color:red;\">Foo\n</td>\n<td>style=\"color:red;\"</td>\n<td>Bar\n</td>\n<td style=\"color:red;\">Foo\n</td>\n<td align=\"center\" style=\"color:red;\">Foo\n</td>\n<td align=\"center\" style=\"color:red;\">Foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td ><a href=\"/wiki/Template%3ATable_attribs?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs (page does not exist)\">Template:Table_attribs</a>\n</td>\n<td ><a href=\"/wiki/Template%3ATable_attribs?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs (page does not exist)\">Template:Table_attribs</a>\n</td>\n<td ><a href=\"/wiki/Template%3ATable_attribs_5?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs_5 (page does not exist)\">Template:Table_attribs_5</a>\n</td>\n<td ><a href=\"/wiki/Template%3ATable_attribs?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs (page does not exist)\">Template:Table_attribs</a>\n</td>\n<td >align=center <a href=\"/wiki/Template%3ATable_attribs?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs (page does not exist)\">Template:Table_attribs</a>\n</td>\n<td >align=center  <a href=\"/wiki/Template%3ATable_attribs?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs (page does not exist)\">Template:Table_attribs</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs</span>}}</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs</span>}}</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span>|<span class=\"wpb-td-inner\"> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_5</span>}}</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> <span class=\"wpb-comment\">&lt;!--foo--&gt;</span> <span class=\"wpb-comment\">&lt;!--bar--&gt;</span> <span class=\"wpb-comment\">&lt;!--baz--&gt;</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs</span>}}</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">align=center <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs</span>}}</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> <span class=\"wpb-comment\">&lt;!--foo--&gt;</span> align=center <span class=\"wpb-comment\">&lt;!--bar--&gt;</span> <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs</span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2a. Template-generated table cell attributes and cell content",
		"wikitext": "{|\n|{{table_attribs_2}}\n|}",
		"html": "<table>\n<tbody><tr>\n<td data-sort-value=\"\" style=\"color:red;\">Foo\n</td>\n<td>Bar</td>\n<td>Baz\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td ><a href=\"/wiki/Template%3ATable_attribs_2?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs_2 (page does not exist)\">Template:Table_attribs_2</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_2</span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2b: Delete whitespace/comments if found in fosterable position while template-wrapping",
		"wikitext": "<table>\n<tr>\n<td>hi</td>\n{{1x|<td>ho</td>\n<!--comment-->\n<td>hi</td>}}\n<td>ho</td>\n</tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span>\n<span class=\"wpb-html\">&lt;td&gt;</span>hi<span class=\"wpb-html\">&lt;/td&gt;</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-html\">&lt;td&gt;</span>ho<span class=\"wpb-html\">&lt;/td&gt;</span>\n<span class=\"wpb-comment\">&lt;!--comment--&gt;</span>\n<span class=\"wpb-html\">&lt;td&gt;</span>hi<span class=\"wpb-html\">&lt;/td&gt;</span></span></span>}}</span>\n<span class=\"wpb-html\">&lt;td&gt;</span>ho<span class=\"wpb-html\">&lt;/td&gt;</span>\n<span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "3. Template-generated table cell attributes and cell content",
		"wikitext": "{|\n!align=center {{table_header_cells}}\n|-\n|align=center {{table_cells}}\n|}",
		"html": "<table>\n<tbody><tr>\n<th align=\"center\" style=\"color:red;\">Foo</th>\n<th style=\"color:red;\"><i>Bar</i></th>\n<th style=\"color:brown;\"><i>Foo</i> and Baz\n</th></tr>\n<tr>\n<td align=\"center\" style=\"color:red;\">Foo</td>\n<td style=\"color:red;\"><i>Bar</i></td>\n<td style=\"color:brown;\"><i>Foo</i> and Baz\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >align=center <a href=\"/wiki/Template%3ATable_header_cells?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_header_cells (page does not exist)\">Template:Table_header_cells</a>\n</th></tr><tr >\n<td >align=center <a href=\"/wiki/Template%3ATable_cells?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cells (page does not exist)\">Template:Table_cells</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">align=center <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_header_cells</span>}}</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">align=center <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cells</span>}}</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "4. Template-generated table cell attributes and cell content inside a templated table",
		"wikitext": "{{tbl-start}}\n!align=center {{table_header_cells}}\n|-\n|align=center {{table_cells}}\n{{tbl-end}}",
		"html": "<table>\n<tbody><tr>\n<th align=\"center\" style=\"color:red;\">Foo</th>\n<th style=\"color:red;\"><i>Bar</i></th>\n<th style=\"color:brown;\"><i>Foo</i> and Baz\n</th></tr>\n<tr>\n<td align=\"center\" style=\"color:red;\">Foo</td>\n<td style=\"color:red;\"><i>Bar</i></td>\n<td style=\"color:brown;\"><i>Foo</i> and Baz\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >align=center <a href=\"/wiki/Template%3ATable_header_cells?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_header_cells (page does not exist)\">Template:Table_header_cells</a>\n</th></tr><tr >\n<td >align=center <a href=\"/wiki/Template%3ATable_cells?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cells (page does not exist)\">Template:Table_cells</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-start</span>}}</span>\n!align=center <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_header_cells</span>}}</span>\n|-\n|align=center <span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cells</span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-end</span>}}</span></span>"
	},
	{
		"desc": "Table with row followed by newlines and table heading",
		"wikitext": "{|\n|-\n\n!foo\n|}",
		"html": "<table>\n\n\n<tbody><tr>\n<th>foo\n</th></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<th >foo\n</th></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table with empty line following the start tag",
		"wikitext": "{|\n\n|-\n|foo\n|}",
		"html": "<table>\n\n\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >foo\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table attributes with empty value",
		"wikitext": "{|\n| style=|hello\n|}",
		"html": "<table>\n<tbody><tr>\n<td style=\"\">hello\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td style=\"\">hello\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=</span></span>|<span class=\"wpb-td-inner\">hello</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Wikitext table with a lot of comments",
		"wikitext": "{|\n<!-- c0 -->\n|foo\n<!-- c1 -->\n|-<!-- c2 -->\n<!-- c3 -->\n|<!-- c4 -->\n<!-- c5 -->\n|}",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td></tr>\n<tr>\n<td>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td></tr><tr >\n<td >\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-comment\">&lt;!-- c0 --&gt;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo\n<span class=\"wpb-comment\">&lt;!-- c1 --&gt;</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"><span class=\"wpb-comment\">&lt;!-- c2 --&gt;</span></span></span><span class=\"wpb-table-inter\">\n<span class=\"wpb-comment\">&lt;!-- c3 --&gt;</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-comment\">&lt;!-- c4 --&gt;</span>\n<span class=\"wpb-comment\">&lt;!-- c5 --&gt;</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Wikitext table comments represented in parsoid dom",
		"wikitext": "{|<!--c1--><!--c2-->\n|-<!--c3-->\n|x\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td>x\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >x\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"><span class=\"wpb-comment\">&lt;!--c1--&gt;</span><span class=\"wpb-comment\">&lt;!--c2--&gt;</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"><span class=\"wpb-comment\">&lt;!--c3--&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Wikitext table with double-line table cell",
		"wikitext": "{|\n|a\nb\n|}",
		"html": "<table>\n<tbody><tr>\n<td>a\n<p>b\n</p>\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >a\n<p>b\n</p>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a\nb</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table cell with a single comment",
		"wikitext": "{|\n|<!-- c1 -->\n|a\n|}",
		"html": "<table>\n<tbody><tr>\n<td>\n</td>\n<td>a\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >\n</td>\n<td >a\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-comment\">&lt;!-- c1 --&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table-cell after a comment-only-empty-line",
		"wikitext": "{|\n|a\n<!--c1-->\n<!--c2-->|b\n|}",
		"html": "<table>\n<tbody><tr>\n<td>a\n</td>\n<td>b\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >a\n</td>\n<td >b\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a\n<span class=\"wpb-comment\">&lt;!--c1--&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-comment\">&lt;!--c2--&gt;</span>|</span><span class=\"wpb-td-inner\">b</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Build table with {{!}}",
		"wikitext": "{{{!}} class=\"wikitable\"\n!header\n!second header\n{{!}}- style=\"color:red;\"\n{{!}}data{{!}}{{!}} style=\"color:red;\" {{!}}second data\n{{!}}}",
		"html": "<table class=\"wikitable\">\n<tbody><tr>\n<th>header\n</th>\n<th>second header\n</th></tr>\n<tr style=\"color:red;\">\n<td>data</td>\n<td style=\"color:red;\">second data\n</td></tr></tbody></table>",
		"render": "<table class=\"wikitable\">\n<tbody><tr>\n<th >header\n</th>\n<th >second header\n</th></tr><tr style=\"color:red;\">\n<td >data</td>\n<td style=\"color:red;\">second data\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">wikitable</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">header</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">second header</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>-</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td-inner\">data</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span> </span>{{!}}<span class=\"wpb-td-inner\">second data</span></span></span><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>}</span></span></span>"
	},
	{
		"desc": "Build table with pipe as data",
		"wikitext": "{| class=\"wikitable\"\n!header\n!second header\n|- style=\"color:red;\"\n|data|| style=\"color:red;\" |second data\n|-\n| style=\"color:red;\" |data with | || style=\"color:red;\" | second data with |\n|-\n||data with | |||second data with |\n|}",
		"html": "<table class=\"wikitable\">\n<tbody><tr>\n<th>header\n</th>\n<th>second header\n</th></tr>\n<tr style=\"color:red;\">\n<td>data</td>\n<td style=\"color:red;\">second data\n</td></tr>\n<tr>\n<td style=\"color:red;\">data with |</td>\n<td style=\"color:red;\">second data with |\n</td></tr>\n<tr>\n<td>data with |</td>\n<td>second data with |\n</td></tr></tbody></table>",
		"render": "<table class=\"wikitable\">\n<tbody><tr>\n<th >header\n</th>\n<th >second header\n</th></tr><tr style=\"color:red;\">\n<td >data</td>\n<td style=\"color:red;\">second data\n</td></tr><tr >\n<td style=\"color:red;\">data with |</td>\n<td style=\"color:red;\">second data with |\n</td></tr><tr >\n<td >data with |</td>\n<td >second data with |\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">wikitable</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">header</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">second header</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">data</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span> </span>|<span class=\"wpb-td-inner\">second data</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span> </span>|<span class=\"wpb-td-inner\">data with | </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span> </span>|<span class=\"wpb-td-inner\"> second data with |</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span>|<span class=\"wpb-td-inner\">data with | </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span>|<span class=\"wpb-td-inner\">second data with |</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Build table with wikilink",
		"wikitext": "{| class=\"wikitable\"\n!header||second header\n|- style=\"color:red;\"\n|data [[Main Page|linktext]]||second data [[Main Page|linktext]]\n|-\n|data||second data [[Main Page|link|text with pipe]]\n|}",
		"html": "<table class=\"wikitable\">\n<tbody><tr>\n<th>header</th>\n<th>second header\n</th></tr>\n<tr style=\"color:red;\">\n<td>data <a href=\"/wiki/Main_Page\" title=\"Main Page\">linktext</a></td>\n<td>second data <a href=\"/wiki/Main_Page\" title=\"Main Page\">linktext</a>\n</td></tr>\n<tr>\n<td>data</td>\n<td>second data <a href=\"/wiki/Main_Page\" title=\"Main Page\">link|text with pipe</a>\n</td></tr></tbody></table>",
		"render": "<table class=\"wikitable\">\n<tbody><tr>\n<th >header</th>\n<th >second header\n</th></tr><tr style=\"color:red;\">\n<td >data <a href=\"/wiki/Main_Page\" title=\"Main Page\">linktext</a></td>\n<td >second data <a href=\"/wiki/Main_Page\" title=\"Main Page\">linktext</a>\n</td></tr><tr >\n<td >data</td>\n<td >second data <a href=\"/wiki/Main_Page\" title=\"Main Page\">link|text with pipe</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">wikitable</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">header</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">second header</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">style</span>=\"<span class=\"wpb-attr-value\">color:red;</span>\"</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">data <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">linktext</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">second data <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">linktext</span>]]</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">data</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">second data <span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Main Page</span>|<span class=\"wpb-link-text\">link|text with pipe</span>]]</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Wikitext table with html-syntax row",
		"wikitext": "{|\n|-\n<td>foo</td>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Fostered content in tables: Plain text",
		"wikitext": "{|\n|-\na\n|}",
		"html": "a\n<table></table>",
		"render": "a<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\na</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Fostered content in tables: Lists",
		"wikitext": "{|\n|-\n*a\n*b\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-list\">*</span>a\n<span class=\"wpb-list\">*</span>b</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Template generated table cell with attributes",
		"wikitext": "{|\n|-\n{{table_attribs_4}} ||a||b\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td style=\"background-color:#DC241f;\" width=\"10px\"></td>\n<td>a</td>\n<td>b\n</td></tr></tbody></table>",
		"render": "<a href=\"/wiki/Template%3ATable_attribs_4?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_attribs_4 (page does not exist)\">Template:Table_attribs_4</a> ||a||b<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-inter\">\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_attribs_4</span>}}</span> ||a||b</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templated table cell with untemplated attributes: Cell combination tests",
		"wikitext": "{|\n|-\n!class=\"test\"{{table_cell_content|attr=! align=left}} /* th & th combine */\n|-\n|class=\"test\"{{table_cell_content}} /* td & td combine */\n|-\n!class=\"test\"{{table_cell_content}} /* th & td combine */\n|-\n|class=\"test\"{{table_cell_content|attr=! align=left}} /* td & th combine */\n|-\n|class=\"test\"{{table_cell_content|attr=style='color:red;'}}\n|-\n|class=\"test\"{{table_cell_content|cmt=<!--bar-->}}\n|}",
		"html": "<table>\n\n<tbody><tr>\n<th class=\"test\" align=\"left\">foo /* th &amp; th combine */\n</th></tr>\n<tr>\n<td class=\"test\">foo /* td &amp; td combine */\n</td></tr>\n<tr>\n<th class=\"test\">foo /* th &amp; td combine */\n</th></tr>\n<tr>\n<td class=\"test\" align=\"left\">foo /* td &amp; th combine */\n</td></tr>\n<tr>\n<td class=\"test\" style=\"color:red;\">foo\n</td></tr>\n<tr>\n<td class=\"test\">foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<th >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a> /* th & th combine */\n</th></tr><tr >\n<td >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a> /* td & td combine */\n</td></tr><tr >\n<th >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a> /* th & td combine */\n</th></tr><tr >\n<td >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a> /* td & th combine */\n</td></tr><tr >\n<td >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a>\n</td></tr><tr >\n<td >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">attr</span>=<span class=\"wpb-parameter-value\">! align=left</span></span>}}</span> /* th &amp; th combine */</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>}}</span> /* td &amp; td combine */</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>}}</span> /* th &amp; td combine */</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">attr</span>=<span class=\"wpb-parameter-value\">! align=left</span></span>}}</span> /* td &amp; th combine */</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">attr</span>=<span class=\"wpb-parameter-value\">style='color:red;'</span></span>}}</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">cmt</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-comment\">&lt;!--bar--&gt;</span></span></span>}}</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T343874: Templated table that has a templated cell with untemplated attributes",
		"wikitext": "{{tbl-start}}\n|-\n|class=\"test\"{{table_cell_content}}\n|-\n|class=\"test\"{{table_cell_content|attr=! align=left}}\n{{tbl-end}}",
		"html": "<table>\n\n<tbody><tr>\n<td class=\"test\">foo\n</td></tr>\n<tr>\n<td class=\"test\" align=\"left\">foo\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a>\n</td></tr><tr >\n<td >class=\"test\"<a href=\"/wiki/Template%3ATable_cell_content?action=edit&redlink=1\" class=\"new\" title=\"Template:Table_cell_content (page does not exist)\">Template:Table_cell_content</a>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-start</span>}}</span>\n|-\n|class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>}}</span>\n|-\n|class=\"test\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">table_cell_content</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">attr</span>=<span class=\"wpb-parameter-value\">! align=left</span></span>}}</span>\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">tbl-end</span>}}</span></span>"
	},
	{
		"desc": "Templated table cell with untemplated attributes: Regression tests",
		"wikitext": "{|\n|class=\"foo\"\n{{1x|1={{!}}bar}}\n|}",
		"html": "<table>\n<tbody><tr>\n<td>class=\"foo\"\n</td>\n<td>bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<td >class=\"foo\"\n</td>\n<td >bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"foo\"\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>bar</span></span>}}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templated table cell with untemplated attributes: Unsupported (standalone mode) Scenarios",
		"wikitext": "{|\n|-\n|class=\"foo\"{{1x|1= {{!}}bar}}\n|-\n|class=\"foo\"{{1x|1=&nbsp;{{!}}bar}}\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td class=\"foo\">bar\n</td></tr>\n<tr>\n<td class=\"foo\">bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td class=\"foo\">bar\n</td></tr><tr >\n<td class=\"foo\">bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"foo\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\"> <span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>bar</span></span>}}</span></span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"foo\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\">&amp;nbsp;<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>bar</span></span>}}</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Templated table cell with untemplated attributes: Unsupported Scenario",
		"wikitext": "{|\n|-\n|class=\"foo\"{{1x|1={{!}}title=\"fail\"{{!}}bar}}\n|}",
		"html": "<table>\n\n<tbody><tr>\n<td class=\"foo\">title=\"fail\"|bar\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr >\n<td class=\"foo\">title=\"fail\"|bar\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">class=\"foo\"<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-key\">1</span>=<span class=\"wpb-parameter-value\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>title=\"fail\"<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span>bar</span></span>}}</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Parsoid: Round-trip tables directly followed by content (T53219)",
		"wikitext": "{|\n|foo\n|} bar\n\n{|\n|baz\n|}<b>quux</b>",
		"html": "<table>\n<tbody><tr>\n<td>foo\n</td></tr></tbody></table><p> bar\n</p><table>\n<tbody><tr>\n<td>baz\n</td></tr></tbody></table><p><b>quux</b></p>",
		"render": "<table >\n<tbody><tr>\n<td >foo\n</td></tr></tbody></table> bar\n<table >\n<tbody><tr>\n<td >baz\n</td></tr></tbody></table><b >quux</b>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span> bar\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-table-syntax\">\n|}</span></span><span class=\"wpb-html\">&lt;b&gt;</span>quux<span class=\"wpb-html\">&lt;/b&gt;</span></span>"
	},
	{
		"desc": "Parsoid: Default to a newline after tables in new content (T53219)",
		"wikitext": "{|\n|foo\n|}\nbar\n{|\n|baz\n|}\n'''quux'''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\nbar\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-quote\">'''</span>quux<span class=\"wpb-quote\">'''</span></span>"
	},
	{
		"desc": "Parsoid: Row-syntax table headings followed by comment & table cells",
		"wikitext": "{|\n!foo||bar\n<!-- foo -->  ||baz||quux\n|}",
		"html": "<table>\n<tbody><tr>\n<th>foo</th>\n<th>bar\n</th>\n<td>baz</td>\n<td>quux\n</td></tr></tbody></table>",
		"render": "<table >\n<tbody><tr>\n<th >foo</th>\n<th >bar\n</th>\n<td >baz</td>\n<td >quux\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">bar</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-comment\">&lt;!-- foo --&gt;</span>  |</span>|<span class=\"wpb-td-inner\">baz</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">quux</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Parsoid: Recover better from broken table attributes",
		"wikitext": "{| class=\"foo\n| class=\"bar\" |\nfoo\n|}",
		"html": "<table class=\"foo\">\n<tbody><tr>\n<td class=\"bar\">\n<p>foo\n</p>\n</td></tr></tbody></table>",
		"render": "<table class=\"foo\">\n<tbody><tr>\n<td class=\"bar\">\n<p>foo\n</p>\n</td></tr></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">foo</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">class</span>=\"<span class=\"wpb-attr-value\">bar</span>\"</span> </span>|<span class=\"wpb-td-inner\">\nfoo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: Digest broken attributes on table and tr tag",
		"wikitext": "{| || |} ++\n|- || || ++ --\n|- > [\n|}",
		"html": "<table>\n\n\n</table>",
		"render": "<table >\n<tbody></tbody></table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> || |} ++</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> || || ++ --</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-table-attrs\"><span class=\"wpb-attr-dirty\"> &gt; [</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Table with missing opening <tr> tag",
		"wikitext": "<table>\n<td>foo</td>\n</tr>\n</table>",
		"html": "<table>\n<tbody><tr><td>foo</td>\n</tr>\n</tbody></table>",
		"render": "<table >\n<td >foo</td>\n</tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-html\">&lt;td&gt;</span>foo<span class=\"wpb-html\">&lt;/td&gt;</span>\n<span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "1. Generate correct wikitext for tables with thead/tbody/tfoot",
		"wikitext": "{|\n|+Test\n!Month\n!Savings\n|-\n|January\n|$100\n|-\n|February\n|$80\n|-\n|Sum\n|$180\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|+</span><span class=\"wpb-td-inner\">Test</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">Month</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">Savings</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">January</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">$100</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">February</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">$80</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">Sum</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">$180</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "2. Generate correct wikitext for tables with thead/tbody/tfoot",
		"wikitext": "{|\n!heading\n|-\n|foo\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">heading</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Wikitext tables can be nested inside HTML tables",
		"wikitext": "<table>\n<tr><td>\n{|\n|foo\n|}\n</td></tr>\n</table>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;table&gt;</span>\n<span class=\"wpb-html\">&lt;tr&gt;</span><span class=\"wpb-html\">&lt;td&gt;</span>\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n<span class=\"wpb-html\">&lt;/td&gt;</span><span class=\"wpb-html\">&lt;/tr&gt;</span>\n<span class=\"wpb-html\">&lt;/table&gt;</span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, before",
		"wikitext": "{|\n|[[Eau]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, after",
		"wikitext": "{|\n|[[Eau]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, before multiple cells",
		"wikitext": "{|\n|[[Eau]]||[[Abc]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Abc</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, before multiple cells, without \"row\"",
		"wikitext": "{|\n|[[Eau]]||[[Abc]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Abc</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, between multiple cells",
		"wikitext": "{|\n|[[Eau]]||[[Abc]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Abc</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, between multiple cells, without \"row\"",
		"wikitext": "{|\n|[[Eau]]||[[Abc]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Abc</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, after multiple cells",
		"wikitext": "{|\n|[[Eau]]||[[Abc]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Abc</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T319143 - copy-pasting of cells, after multiple cells, without \"row\"",
		"wikitext": "{|\n|[[Eau]]||[[Abc]]\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Eau</span>]]</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Abc</span>]]</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "wtEscaping"
	},
	{
		"desc": "Headings: 0. Unnested",
		"wikitext": "<nowiki>=foo=</nowiki>\n\n<nowiki/>=foo=\n<!--cmt-->\n<nowiki>=foo=</nowiki>\n\n=foo''a''<nowiki>=</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>=foo=\n<span class=\"wpb-comment\">&lt;!--cmt--&gt;</span>\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span>\n\n=foo<span class=\"wpb-quote\">''</span>a<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Headings: 1. Nested inside html",
		"wikitext": "= =foo= =\n\n== =foo= ==\n\n=== =foo= ===\n\n=<nowiki>=foo=</nowiki>=\n==<nowiki>=foo=</nowiki>==\n===<nowiki>=foo=</nowiki>===\n====<nowiki>=foo=</nowiki>====\n=====<nowiki>=foo=</nowiki>=====\n======<nowiki>=foo=</nowiki>======",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> =foo= </span>=<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> =foo= </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"> =foo= </span>===<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span></span>=</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span></span>==</span>\n<span class=\"wpb-heading\">===<span class=\"wpb-heading-title\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span></span>===</span>\n<span class=\"wpb-heading\">====<span class=\"wpb-heading-title\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span></span>====</span>\n<span class=\"wpb-heading\">=====<span class=\"wpb-heading-title\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span></span>=====</span>\n<span class=\"wpb-heading\">======<span class=\"wpb-heading-title\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=foo=</span>&lt;/nowiki&gt;</span></span>======</span></span>"
	},
	{
		"desc": "Headings: 2. Outside heading nest on a single line <h1>foo</h1>*bar",
		"wikitext": "= foo =\n<nowiki>*</nowiki>bar\n\n= foo =\n=bar\n\n= foo =\n<nowiki>=bar=</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> foo </span>=</span>\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>bar\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> foo </span>=</span>\n=bar\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> foo </span>=</span>\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=bar=</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Headings: 3. Nested inside html with wikitext split by html tags",
		"wikitext": "= ='''bold'''foo= =",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> =<span class=\"wpb-quote\">'''</span>bold<span class=\"wpb-quote\">'''</span>foo= </span>=</span></span>"
	},
	{
		"desc": "Headings: 4a. No escaping needed (testing just h1 and h2)",
		"wikitext": "= =foo =\n\n= foo= =\n\n= =foo= =\n\n= =foo= bar =\n\n== =foo ==\n\n== foo= ==\n\n= = =\n\n= ''=''foo= =",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> =foo </span>=<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> foo= </span>=<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> =foo= </span>=<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> =foo= bar </span>=<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> =foo </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> foo= </span>==<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> = </span>=<span class=\"wpb-heading-trail\">\n</span></span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> <span class=\"wpb-quote\">''</span>=<span class=\"wpb-quote\">''</span>foo= </span>=</span></span>"
	},
	{
		"desc": "Headings: 4b. No escaping needed (inside p-tags)",
		"wikitext": "=foo= x\n=foo= <s></s>",
		"print": "<span class=\"wpb-root\">=foo= x\n=foo= <span class=\"wpb-html\">&lt;s&gt;</span><span class=\"wpb-html\">&lt;/s&gt;</span></span>"
	},
	{
		"desc": "Headings: 4c. Short headings (1)",
		"wikitext": "<nowiki>===</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">===</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Headings: 4d. Short headings (2)",
		"wikitext": "=\n==\n===\n====\n=====",
		"html": "<p>=\n==\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\".3D\">=</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: =\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\".3D.3D\">==</h1><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=2\" title=\"Edit section: ==\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\".3D_2\">=</h2><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=3\" title=\"Edit section: =\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<p>=\n==\n</p>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"=\">=</h1></div>\n<div class=\"mw-heading mw-heading1\"><h1 id=\"==\">==</h1></div>\n<div class=\"mw-heading mw-heading2\"><h2 id=\"=_2\">=</h2></div>",
		"print": "<span class=\"wpb-root\">=\n==\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">=</span>=</span>\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\">==</span>=</span>\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">=</span>==</span></span>"
	},
	{
		"desc": "Headings: 6a. Heading chars in SOL context (with trailing spaces)",
		"wikitext": "<nowiki>=a=</nowiki>\n\n<nowiki>=a=</nowiki> \n\n<nowiki>=a=</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span> \n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Headings: 6b. Heading chars in SOL context (with trailing newlines)",
		"wikitext": "<nowiki>=a=</nowiki>\nb\n\n<nowiki>=a=</nowiki> \nb\n\n<nowiki>=a=</nowiki>\t\nb",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span>\nb\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span> \nb\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span>\t\nb</span>"
	},
	{
		"desc": "Headings: 6c. Heading chars in SOL context (leading newline break)",
		"wikitext": "a\n<nowiki>=b=</nowiki>",
		"print": "<span class=\"wpb-root\">a\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=b=</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Headings: 6d. Heading chars in SOL context (with interspersed comments)",
		"wikitext": "<!--c0--><nowiki>=a=</nowiki>\n\n<!--c1--><nowiki>=a=</nowiki> <!--c2-->\t <!--c3-->",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--c0--&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-comment\">&lt;!--c1--&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=a=</span>&lt;/nowiki&gt;</span> <span class=\"wpb-comment\">&lt;!--c2--&gt;</span>\t <span class=\"wpb-comment\">&lt;!--c3--&gt;</span></span>"
	},
	{
		"desc": "Headings: 6d. Heading chars in SOL context (No escaping needed)",
		"wikitext": "=a=<div>b</div>",
		"print": "<span class=\"wpb-root\">=a=<span class=\"wpb-html\">&lt;div&gt;</span>b<span class=\"wpb-html\">&lt;/div&gt;</span></span>"
	},
	{
		"desc": "Headings: 7. Insert a newline between new content and headings",
		"wikitext": "== NEW ==\nnew\n\n==A==\na",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">==<span class=\"wpb-heading-title\"> NEW </span>==</span>\nnew\n\n<span class=\"wpb-heading\">==<span class=\"wpb-heading-title\">A</span>==</span>\na</span>"
	},
	{
		"desc": "Headings: Used as horizontal rule",
		"wikitext": "===============",
		"html": "<div class=\"mw-heading mw-heading6\"><h6 id=\"===\"><span id=\".3D.3D.3D\"></span>===</h6><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/index.php?title=Parser_test&amp;action=edit&amp;section=1\" title=\"Edit section: ===\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></div>",
		"render": "<div class=\"mw-heading mw-heading6\"><h6 id=\"===\">===</h6></div>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-heading\">======<span class=\"wpb-heading-title\">===</span>======</span></span>"
	},
	{
		"desc": "Lists: 0. Outside nests",
		"wikitext": "<nowiki>*</nowiki>foo\n\n<nowiki>#</nowiki>foo\n\n<nowiki>;</nowiki>Foo<nowiki>:</nowiki>bar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>foo\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">#</span>&lt;/nowiki&gt;</span>foo\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">;</span>&lt;/nowiki&gt;</span>Foo<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">:</span>&lt;/nowiki&gt;</span>bar</span>"
	},
	{
		"desc": "Lists: 1. Nested inside html (No unnecessary escapes)",
		"wikitext": "* *foo\n* #foo\n* :foo\n* ;foo\n*<nowiki>*foo</nowiki>\n*<nowiki>#foo</nowiki>\n*<nowiki>:foo</nowiki>\n*<nowiki>;foo</nowiki>\n\n# *foo\n# #foo\n# :foo\n# ;foo\n#<nowiki>*foo</nowiki>\n#<nowiki>#foo</nowiki>\n#<nowiki>:foo</nowiki>\n#<nowiki>;foo</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>*foo\n<span class=\"wpb-list\">* </span>#foo\n<span class=\"wpb-list\">* </span>:foo\n<span class=\"wpb-list\">* </span>;foo\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">#foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">:foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">;foo</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-list\"># </span>*foo\n<span class=\"wpb-list\"># </span>#foo\n<span class=\"wpb-list\"># </span>:foo\n<span class=\"wpb-list\"># </span>;foo\n<span class=\"wpb-list\">#</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">#</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">#foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">#</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">:foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">#</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">;foo</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Lists: 2. Inside definition lists",
		"wikitext": "; ;foo\n\n; <nowiki>:foo</nowiki>\n\n; <nowiki>:foo</nowiki>\n: bar\n\n: :foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">; </span>;foo\n\n<span class=\"wpb-list\">; </span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">:foo</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-list\">; </span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">:foo</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">: </span>bar\n\n<span class=\"wpb-list\">: </span>:foo</span>"
	},
	{
		"desc": "Lists: 3. Only bullets at start of text in wikitext-generated HTML should be escaped",
		"wikitext": "* *foo*bar\n*<nowiki>*foo</nowiki>''it''*bar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>*foo*bar\n<span class=\"wpb-list\">*</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*foo</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span>it<span class=\"wpb-quote\">''</span>*bar</span>"
	},
	{
		"desc": "Lists: 4. No escapes needed",
		"wikitext": "*foo*bar\n\n*''foo''*bar\n\n*[[Foo]]: bar\n\n*[[Foo]]*bar",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">*</span>foo*bar\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>*bar\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>: bar\n\n<span class=\"wpb-list\">*</span><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>*bar</span>"
	},
	{
		"desc": "Lists: 5. No unnecessary escapes",
		"wikitext": "* bar <span><nowiki>[[foo]]</nowiki></span>\n\n* =bar <span><nowiki>[[foo]]</nowiki></span>\n\n* [[bar <span><nowiki>[[foo]]</nowiki></span>\n\n* ]]bar <span><nowiki>[[foo]]</nowiki></span>\n\n* =bar <span>foo]]</span>=\n\n* <s></s>: a\n\n* ''* foo''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span>bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-list\">* </span>=bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-list\">* </span>[[bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-list\">* </span>]]bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n<span class=\"wpb-list\">* </span>=bar <span class=\"wpb-html\">&lt;span&gt;</span>foo]]<span class=\"wpb-html\">&lt;/span&gt;</span>=\n\n<span class=\"wpb-list\">* </span><span class=\"wpb-html\">&lt;s&gt;</span><span class=\"wpb-html\">&lt;/s&gt;</span>: a\n\n<span class=\"wpb-list\">* </span><span class=\"wpb-quote\">''</span>* foo<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "Lists: 6. Escape bullets in SOL position",
		"wikitext": "<!--cmt--><nowiki>*</nowiki>foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-comment\">&lt;!--cmt--&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>foo</span>"
	},
	{
		"desc": "Lists: 7. Escape bullets in a multi-line context",
		"wikitext": "a\n<nowiki>*</nowiki>b",
		"print": "<span class=\"wpb-root\">a\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>b</span>"
	},
	{
		"desc": "Lists: 8. Escape colons only if not present in tags",
		"wikitext": "; <nowiki>a:b</nowiki>''c:d''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">; </span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">a:b</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span>c:d<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "HRs: 1. Single line",
		"wikitext": "----<nowiki>----</nowiki>\n----=foo=\n----*foo",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-hr\">----</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">----</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-hr\">----</span>=foo=\n<span class=\"wpb-hr\">----</span>*foo</span>"
	},
	{
		"desc": "Tables: 1a. Simple example",
		"wikitext": "<nowiki>{|</nowiki>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">{|</span>&lt;/nowiki&gt;</span>\n|}</span>"
	},
	{
		"desc": "Tables: 1b. No escaping needed",
		"wikitext": "!foo",
		"print": "<span class=\"wpb-root\">!foo</span>"
	},
	{
		"desc": "Tables: 1c. No escaping needed",
		"wikitext": "|foo",
		"print": "<span class=\"wpb-root\">|foo</span>"
	},
	{
		"desc": "Tables: 1d. No escaping needed",
		"wikitext": "|}foo",
		"print": "<span class=\"wpb-root\">|}foo</span>"
	},
	{
		"desc": "Tables: 2a. Nested in td",
		"wikitext": "{|\n|<nowiki>foo|bar</nowiki>\n|-\n|x<div><nowiki>a|b</nowiki></div>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo|bar</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x<span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">a|b</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 2b. Nested in td",
		"wikitext": "{|\n|<nowiki>foo||bar</nowiki>\n|a''<nowiki>b||c</nowiki>''\n|a''<div><nowiki>b||c</nowiki></div>''\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo||bar</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">b||c</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">a<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;div&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">b||c</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/div&gt;</span><span class=\"wpb-quote\">''</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 2c. Nested in td -- no escaping needed",
		"wikitext": "{|\n|foo!!bar\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo!!bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 3a. Nested in th",
		"wikitext": "{|\n!foo!bar\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">foo!bar</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 3b. Nested in th",
		"wikitext": "{|\n!<nowiki>foo!!bar</nowiki>\n!''<nowiki>foo|bar</nowiki>''\n!''<nowiki>foo!!bar</nowiki>''\n!''<span><nowiki>foo!!bar</nowiki></span>''\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo!!bar</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo|bar</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo!!bar</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo!!bar</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-quote\">''</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 3c. Nested in th",
		"wikitext": "{|\n!<nowiki>foo||bar</nowiki>\n!<nowiki>foo||bar</nowiki>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo||bar</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">foo||bar</span>&lt;/nowiki&gt;</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 4a. Escape -",
		"wikitext": "{|\n!-bar\n|-\n| -bar\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">-bar</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> -bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 4b. Escape +",
		"wikitext": "{|\n!+bar\n|-\n| +bar\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\">+bar</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> +bar</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 4c. No escaping needed",
		"wikitext": "{|\n|foo-bar\n|foo+bar\n|-\n|''foo''-bar\n|''foo''+bar\n|-\n|foo\nbar|baz\n+bar\n-bar\n|-\n|x\n<div>a|b</div>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo-bar</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo+bar</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>-bar</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>+bar</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">foo\nbar|baz\n+bar\n-bar</span></span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x\n<span class=\"wpb-html\">&lt;div&gt;</span>a|b<span class=\"wpb-html\">&lt;/div&gt;</span></span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 4d. No escaping needed",
		"wikitext": "{|\n|[[Foo]]-bar\n||+1\n||-2\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>]]</span>-bar</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span>|<span class=\"wpb-td-inner\">+1</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span>|<span class=\"wpb-td-inner\">-2</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 4e. Escape }",
		"wikitext": "{|\n| }\n|-\n|x||}\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> }</span></span><span class=\"wpb-tr\"><span class=\"wpb-table-syntax\">\n|-</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\">x</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-td-inner\">}</span></span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Tables: 5. Empty table cells should get whitespace to avoid need for nowikis",
		"wikitext": "{|\n| || align=\"center\" | ||\n|}\n\n{|\n|\n| align=\"center\" |\n|\n|}\n\n{|\n| {{!}}{{!}} align=\"center\" | ||\n|}\n\n{|\n! !! align=\"center\" | !!\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">align</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> </span>|<span class=\"wpb-td-inner\"> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">align</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> </span>|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\"><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span><span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">align</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> </span>|<span class=\"wpb-td-inner\"> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">||</span></span><span class=\"wpb-table-syntax\">\n|}</span></span>\n\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n!</span><span class=\"wpb-td-inner\"> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span><span class=\"wpb-table-attrs\"> <span class=\"wpb-table-attr\"><span class=\"wpb-attr-key\">align</span>=\"<span class=\"wpb-attr-value\">center</span>\"</span> </span>|<span class=\"wpb-td-inner\"> </span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">!!</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "T97430: Don't emit empty nowiki pairs around marker meta tags",
		"wikitext": "<nowiki>*</nowiki>This is a long sentence here that will make the nowiki algo split up the nowikis into multiple pairs\n|** Make this another long long long sentence forcing the nowiki algo to split up the nowikis.",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>This is a long sentence here that will make the nowiki algo split up the nowikis into multiple pairs\n|** Make this another long long long sentence forcing the nowiki algo to split up the nowikis.</span>"
	},
	{
		"desc": "Unclosed xmlish element in table line shouldn't eat end delimiters",
		"wikitext": "{|\n| <foo\n| bar>\n|}",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{|</span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> &lt;foo</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n|</span><span class=\"wpb-td-inner\"> bar&gt;</span></span><span class=\"wpb-table-syntax\">\n|}</span></span></span>"
	},
	{
		"desc": "Links 1. WikiLinks: No escapes needed",
		"wikitext": "[[Foo|Foo''boo'']]\n[[Foo|[Foobar]]]\n[[Foo|x [Foobar] x]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">Foo<span class=\"wpb-quote\">''</span>boo<span class=\"wpb-quote\">''</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">[Foobar]</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">x [Foobar] x</span>]]</span></span>"
	},
	{
		"desc": "Links 2. WikiLinks: Escapes needed",
		"wikitext": "[[Foo|<nowiki>Foobar]</nowiki>]]\n[[Foo|x <nowiki>[http://google.com g]</nowiki> x]]\n[[Foo|<nowiki>[[Bar]]</nowiki>]]\n[[Foo|<nowiki>x [[Bar]] x</nowiki>]]\n[[Foo||Bar]]\n[[Foo|<nowiki>]]bar</nowiki>]]\n[[Foo|<nowiki>[[bar</nowiki>]]\n[[Foo|<nowiki>x [[ y</nowiki>]]\n[[Foo|<nowiki>x ]] y</nowiki>]]\n[[Foo|<nowiki>x ]] y [[ z</nowiki>]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">Foobar]</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">x <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[http://google.com g]</span>&lt;/nowiki&gt;</span> x</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[Bar]]</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">x [[Bar]] x</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">|Bar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">]]bar</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[bar</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">x [[ y</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">x ]] y</span>&lt;/nowiki&gt;</span></span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">x ]] y [[ z</span>&lt;/nowiki&gt;</span></span>]]</span></span>"
	},
	{
		"desc": "Links 3. WikiLinks: No escapes needed",
		"wikitext": "[[Foo|[Foobar]]\n[[Foo|foo|bar]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">[Foobar</span>]]</span>\n<span class=\"wpb-link\">[[<span class=\"wpb-link-target\">Foo</span>|<span class=\"wpb-link-text\">foo|bar</span>]]</span></span>"
	},
	{
		"desc": "Links 4. ExtLinks: Escapes needed",
		"wikitext": "[http://google.com <nowiki>[google]</nowiki>]\n[http://google.com <nowiki>google]</nowiki>]\n[http://google.com <nowiki>goog] le</nowiki>]\n\n<nowiki>[http://google.com]</nowiki>\n\n<nowiki>[http://google.com google]</nowiki>\n\n[http://google.com<nowiki>]</nowiki>\n\n[{{1x|http://google.com}}<nowiki>]</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://google.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[google]</span>&lt;/nowiki&gt;</span></span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://google.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">google]</span>&lt;/nowiki&gt;</span></span>]</span>\n<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://google.com</span> <span class=\"wpb-ext-link-text\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">goog] le</span>&lt;/nowiki&gt;</span></span>]</span>\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[http://google.com]</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[http://google.com google]</span>&lt;/nowiki&gt;</span>\n\n[<span class=\"wpb-free-ext-link\">http://google.com</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">]</span>&lt;/nowiki&gt;</span>\n\n[<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\"><span class=\"wpb-free-ext-link\">http://google.com</span></span></span>}}</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">]</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Links 5. ExtLinks: No escapes needed",
		"wikitext": "[http://google.com [google]\n\n[[http://google.com]]",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://google.com</span> <span class=\"wpb-ext-link-text\">[google</span>]</span>\n\n[<span class=\"wpb-ext-link\">[<span class=\"wpb-ext-link-url\">http://google.com</span>]</span>]</span>"
	},
	{
		"desc": "Links 6. Add <nowiki/>s between text-nodes and url-links when required (T66300)",
		"wikitext": "x<nowiki/>http://example.com<nowiki/>y\nhttp://example.com<nowiki/>?x\nhttp://example.com<nowiki/>&x\nhttp://example.com<nowiki/>'x\nhttp://example.com<nowiki/>,x\nhttp://example.com<nowiki/>.x\nhttp://example.com<nowiki/>;x\nhttp://example.com<nowiki/>:x\nhttp://example.com<nowiki/>;x\nhttp://example.com<nowiki/>!x\nhttp://example.com<nowiki/>=x\nhttp://example.com<nowiki/>(x)\nhttp://example.com(x<nowiki/>)",
		"print": "<span class=\"wpb-root\">x<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>?x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>&amp;x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>,x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>.x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>;x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>:x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>;x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>!x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>=x\n<span class=\"wpb-free-ext-link\">http://example.com</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>(x)\n<span class=\"wpb-free-ext-link\">http://example.com(x</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>)</span>"
	},
	{
		"desc": "Links 7a. Don't add spurious <nowiki/>s between text-nodes and url-links (T66300)",
		"wikitext": "x\nhttp://example.com\ny\n\"http://example.com\"\n(http://example.com)\n(http://example.com) foo\nhttp://example.com,\nhttp://example.com, foo",
		"print": "<span class=\"wpb-root\">x\n<span class=\"wpb-free-ext-link\">http://example.com</span>\ny\n\"<span class=\"wpb-free-ext-link\">http://example.com</span>\"\n(<span class=\"wpb-free-ext-link\">http://example.com</span>)\n(<span class=\"wpb-free-ext-link\">http://example.com</span>) foo\n<span class=\"wpb-free-ext-link\">http://example.com</span>,\n<span class=\"wpb-free-ext-link\">http://example.com</span>, foo</span>"
	},
	{
		"desc": "Links 7b. Don't add spurious <nowiki/>s between text-nodes and url-links (T66300)",
		"wikitext": "http://example.com.,;:!?\\\n-http://example.com:",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-free-ext-link\">http://example.com</span>.,;:!?\\\n-<span class=\"wpb-free-ext-link\">http://example.com</span>:</span>"
	},
	{
		"desc": "Links 8. Add <nowiki/>s between text-nodes and RFC-links when required (T66300)",
		"wikitext": "RFC 123<nowiki/>4\nRFC 123<nowiki/>y\nX<nowiki/>RFC 123<nowiki/>y",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">RFC 123</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>4\n<span class=\"wpb-magic-link\">RFC 123</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y\nX<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-magic-link\">RFC 123</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span>"
	},
	{
		"desc": "Links 9. Don't add spurious <nowiki/>s between text-nodes and RFC-links (T66300)",
		"wikitext": "RFC 123?foo\nRFC 123&foo\n-RFC 123-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">RFC 123</span>?foo\n<span class=\"wpb-magic-link\">RFC 123</span>&amp;foo\n-<span class=\"wpb-magic-link\">RFC 123</span>-</span>"
	},
	{
		"desc": "Links 10. Add <nowiki/>s between text-nodes and PMID-links when required (T66300)",
		"wikitext": "PMID 123<nowiki/>4\nPMID 123<nowiki/>y\nX<nowiki/>PMID 123<nowiki/>y",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">PMID 123</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>4\n<span class=\"wpb-magic-link\">PMID 123</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y\nX<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-magic-link\">PMID 123</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>y</span>"
	},
	{
		"desc": "Links 11. Don't add spurious <nowiki/>s between text-nodes and PMID-links (T66300)",
		"wikitext": "PMID 123?foo\nPMID 123&foo\n-PMID 123-",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">PMID 123</span>?foo\n<span class=\"wpb-magic-link\">PMID 123</span>&amp;foo\n-<span class=\"wpb-magic-link\">PMID 123</span>-</span>"
	},
	{
		"desc": "Links 12. Add <nowiki/>s between text-nodes and ISBN-links when required (T66300)",
		"wikitext": "ISBN 1234567890<nowiki/>1\nISBN 1234567890<nowiki/>x\na<nowiki/>ISBN 1234567890<nowiki/>b",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-magic-link\">ISBN 1234567890</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>1\n<span class=\"wpb-magic-link\">ISBN 1234567890</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>x\na<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-magic-link\">ISBN 1234567890</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>b</span>"
	},
	{
		"desc": "Links 13. Don't add spurious <nowiki/>s between text-nodes and ISBN-links (T66300)",
		"wikitext": "-ISBN 1234567890's",
		"print": "<span class=\"wpb-root\">-<span class=\"wpb-magic-link\">ISBN 1234567890</span>'s</span>"
	},
	{
		"desc": "Links 14. Protect link-like plain text. (Parsoid bug T78425)",
		"wikitext": "this is not a link: <nowiki>http://example.com</nowiki>",
		"print": "<span class=\"wpb-root\">this is not a link: <span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">http://example.com</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "1a. Quotes inside <b> and <i>",
		"wikitext": "''<nowiki/>'foo'''\n''<nowiki>''foo''</nowiki>''\n''<nowiki>'''foo'''</nowiki>''\n''foo''<nowiki/>'s\n'''<nowiki/>'foo''''\n'''<nowiki>''foo''</nowiki>'''\n'''<nowiki>'''foo'''</nowiki>'''\n'''foo'<nowiki/>''bar'<nowiki/>''baz'''\n'''foo'''<nowiki/>'s\n'''foo''\n''foo''<nowiki/>'\n''foo'''<nowiki/>'\n'''foo''<nowiki/>'\n''''foo'''\n'''foo'''<nowiki/>'\n''''foo'''<nowiki/>'\n''fools'<span> errand</span>''\n''<span>fool</span>'s errand''\n'<nowiki/>''foo'' bar '''baz''\na|!*#-:;+-~[]{}b'''x''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'foo'<span class=\"wpb-quote\">''</span>\n<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''foo''</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span>\n<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">'''foo'''</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span>\n<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'s\n<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'foo'<span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">''foo''</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">'''foo'''</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">'''</span>foo'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">''</span>bar'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">''</span>baz<span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'s\n'<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span>\n<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'\n<span class=\"wpb-quote\">''</span>foo'<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'\n'<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'\n'<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span>\n<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'\n'<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>'\n<span class=\"wpb-quote\">''</span>fools'<span class=\"wpb-html\">&lt;span&gt;</span> errand<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-quote\">''</span>\n<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;span&gt;</span>fool<span class=\"wpb-html\">&lt;/span&gt;</span>'s errand<span class=\"wpb-quote\">''</span>\n'<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span> bar '<span class=\"wpb-quote\">''</span>baz<span class=\"wpb-quote\">''</span>\na|!*#-:;+-~[]{}b'<span class=\"wpb-quote\">''</span>x<span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "2. Link fragments separated by <i> and <b> tags",
		"wikitext": "[[''foo''<nowiki>hello]]</nowiki>\n\n[['''foo'''<nowiki>hello]]</nowiki>",
		"print": "<span class=\"wpb-root\">[[<span class=\"wpb-quote\">''</span>foo<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">hello]]</span>&lt;/nowiki&gt;</span>\n\n[[<span class=\"wpb-quote\">'''</span>foo<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">hello]]</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "3. Link fragments inside <i> and <b>",
		"wikitext": "''[[foo''<nowiki>]]</nowiki>\n\n'''[[foo'''<nowiki>]]</nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-quote\">''</span>[[foo<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">]]</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-quote\">'''</span>[[foo<span class=\"wpb-quote\">'''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">]]</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "4. No escaping needed",
		"wikitext": "'<span>''bar''</span>'\n'<span>'''bar'''</span>'\n'a:b'foo",
		"print": "<span class=\"wpb-root\">'<span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-quote\">''</span>bar<span class=\"wpb-quote\">''</span><span class=\"wpb-html\">&lt;/span&gt;</span>'\n'<span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-quote\">'''</span>bar<span class=\"wpb-quote\">'''</span><span class=\"wpb-html\">&lt;/span&gt;</span>'\n'a:b'foo</span>"
	},
	{
		"desc": "1. No unnecessary escapes",
		"wikitext": "bar <span><nowiki>[[foo]]</nowiki></span>\n\n=bar <span><nowiki>[[foo]]</nowiki></span>\n\n[[bar <span><nowiki>[[foo]]</nowiki></span>\n\n]]bar <span><nowiki>[[foo]]</nowiki></span>\n\n=bar <span>foo]]</span><nowiki>=</nowiki>",
		"print": "<span class=\"wpb-root\">bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n=bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n[[bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n]]bar <span class=\"wpb-html\">&lt;span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">[[foo]]</span>&lt;/nowiki&gt;</span><span class=\"wpb-html\">&lt;/span&gt;</span>\n\n=bar <span class=\"wpb-html\">&lt;span&gt;</span>foo]]<span class=\"wpb-html\">&lt;/span&gt;</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">=</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "1. Leading whitespace in SOL context should be stripped",
		"wikitext": "a\n\na\n\n\ta(tab)\n\na\n<!--cmt-->\na\n\na\nb\n\na\n\tb\n\na\n\t b",
		"print": "<span class=\"wpb-root\">a\n\na\n\n\ta(tab)\n\na\n<span class=\"wpb-comment\">&lt;!--cmt--&gt;</span>\na\n\na\nb\n\na\n\tb\n\na\n\t b</span>"
	},
	{
		"desc": "3. Leading whitespace in indent-pre suppressing contexts should not be escaped",
		"wikitext": "<blockquote>\n a\n <span>b</span>\n c\n</blockquote>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;blockquote&gt;</span>\n a\n <span class=\"wpb-html\">&lt;span&gt;</span>b<span class=\"wpb-html\">&lt;/span&gt;</span>\n c\n<span class=\"wpb-html\">&lt;/blockquote&gt;</span></span>"
	},
	{
		"desc": "4. Leading whitespace in indent-pre suppressing contexts should not be escaped",
		"wikitext": " [[File:Foobar.jpg|thumb|caption]]",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-file\">[[<span class=\"wpb-link-target\">File:Foobar.jpg</span>|<span class=\"wpb-image-parameter\">thumb</span>|<span class=\"wpb-image-caption\">caption</span>]]</span></span>"
	},
	{
		"desc": "5. Nowiki escaping should account for indent-pres",
		"wikitext": " ==foo==",
		"print": "<span class=\"wpb-root\"> ==foo==</span>"
	},
	{
		"desc": "T95794: nowiki escaping should account for leading space at start-of-line in an indent-pre block",
		"wikitext": " * foo\n * bar",
		"print": "<span class=\"wpb-root\"> * foo\n * bar</span>"
	},
	{
		"desc": "Whitespace scrubbing in SOL position should account for SOL-sensitive wikitext markup",
		"wikitext": "foo\n\n%foo\n\n<nowiki/>*foo\n\n<nowiki/>#foo\n\n<nowiki/>=foo=\n\n[[Category:Foo]]\n<nowiki/>*foo\n\n [[Category:Foo]]\n<nowiki>*</nowiki>foo\n\n<nowiki/><!--boo-->*foo\n\n<!--boo--><nowiki/>*foo\n\n<!--a--><!--b--><!--c--><!--d--><!--e-->foo\n\n<!--a--><nowiki/><!--b--><!--c--><!--d--><!--e-->*foo",
		"print": "<span class=\"wpb-root\">foo\n\n%foo\n\n<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>*foo\n\n<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>#foo\n\n<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>=foo=\n\n<span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n<span class=\"wpb-ext\">&lt;nowiki/&gt;</span>*foo\n\n <span class=\"wpb-category\">[[<span class=\"wpb-link-target\">Category:Foo</span>]]</span>\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">*</span>&lt;/nowiki&gt;</span>foo\n\n<span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-comment\">&lt;!--boo--&gt;</span>*foo\n\n<span class=\"wpb-comment\">&lt;!--boo--&gt;</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span>*foo\n\n<span class=\"wpb-comment\">&lt;!--a--&gt;</span><span class=\"wpb-comment\">&lt;!--b--&gt;</span><span class=\"wpb-comment\">&lt;!--c--&gt;</span><span class=\"wpb-comment\">&lt;!--d--&gt;</span><span class=\"wpb-comment\">&lt;!--e--&gt;</span>foo\n\n<span class=\"wpb-comment\">&lt;!--a--&gt;</span><span class=\"wpb-ext\">&lt;nowiki/&gt;</span><span class=\"wpb-comment\">&lt;!--b--&gt;</span><span class=\"wpb-comment\">&lt;!--c--&gt;</span><span class=\"wpb-comment\">&lt;!--d--&gt;</span><span class=\"wpb-comment\">&lt;!--e--&gt;</span>*foo</span>"
	},
	{
		"desc": "1. Valid behavior switches should be escaped",
		"wikitext": "<nowiki>__TOC__</nowiki>\n''<nowiki>__TOC__</nowiki>''",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">__TOC__</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-quote\">''</span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">__TOC__</span>&lt;/nowiki&gt;</span><span class=\"wpb-quote\">''</span></span>"
	},
	{
		"desc": "2. Invalid behavior switches should not be escaped",
		"wikitext": "__TOO__\n__|__",
		"print": "<span class=\"wpb-root\">__TOO__\n__|__</span>"
	},
	{
		"desc": "Behavior switches should be SOL-transparent",
		"wikitext": " __TOC__\n\n <!-- this one's bogus -->\n __TOO__\n\n __TOC__ foo\n\n__TOC__\n bar",
		"print": "<span class=\"wpb-root\"> <span class=\"wpb-double-underscore\">__TOC__</span>\n\n <span class=\"wpb-comment\">&lt;!-- this one's bogus --&gt;</span>\n __TOO__\n\n <span class=\"wpb-double-underscore\">__TOC__</span> foo\n\n<span class=\"wpb-double-underscore\">__TOC__</span>\n bar</span>"
	},
	{
		"desc": "During serialization, normalize output when given a SOL-transparent prefix",
		"wikitext": "x\n\n__NOTOC__y\n\n__NOTOC__z\n\n__notoc__p",
		"print": "<span class=\"wpb-root\">x\n\n<span class=\"wpb-double-underscore\">__NOTOC__</span>y\n\n<span class=\"wpb-double-underscore\">__NOTOC__</span>z\n\n<span class=\"wpb-double-underscore\">__notoc__</span>p</span>"
	},
	{
		"desc": "1. a tags",
		"wikitext": "<a href=\"http://google.com\">google</a>",
		"print": "<span class=\"wpb-root\">&lt;a href=\"<span class=\"wpb-free-ext-link\">http://google.com</span>\"&gt;google&lt;/a&gt;</span>"
	},
	{
		"desc": "2. other tags",
		"wikitext": "* <nowiki><div>foo</div></nowiki>\n* <nowiki><div style=\"color:red\">foo</div></nowiki>\n* <nowiki><td></nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-list\">* </span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;div&gt;foo&lt;/div&gt;</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;div style=\"color:red\"&gt;foo&lt;/div&gt;</span>&lt;/nowiki&gt;</span>\n<span class=\"wpb-list\">* </span><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;td&gt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "3. multi-line html tag",
		"wikitext": "<nowiki><div\n>foo</div\n></nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;div\n&gt;foo&lt;/div\n&gt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "4. extension tags",
		"wikitext": "<nowiki><ref>foo</ref></nowiki>\n\n<nowiki><ref>bar</nowiki>\n\nbaz<nowiki></ref></nowiki>",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;ref&gt;foo&lt;/ref&gt;</span>&lt;/nowiki&gt;</span>\n\n<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;ref&gt;bar</span>&lt;/nowiki&gt;</span>\n\nbaz<span class=\"wpb-ext\">&lt;nowiki&gt;<span class=\"wpb-ext-inner\">&lt;/ref&gt;</span>&lt;/nowiki&gt;</span></span>"
	},
	{
		"desc": "Parsoid: newline inducing block nodes don't suppress <nowiki>",
		"wikitext": "a\n\n= foo =",
		"print": "<span class=\"wpb-root\">a\n\n<span class=\"wpb-heading\">=<span class=\"wpb-heading-title\"> foo </span>=</span></span>"
	},
	{
		"desc": "Escaping nowikis",
		"wikitext": "&lt;nowiki&gt;foo&lt;/nowiki&gt;",
		"print": "<span class=\"wpb-root\">&amp;lt;nowiki&amp;gt;foo&amp;lt;/nowiki&amp;gt;</span>"
	},
	{
		"desc": "(T54035) Nowiki-escaping should not get tripped by \" :\" in text",
		"wikitext": "foo's bar :",
		"print": "<span class=\"wpb-root\">foo's bar :</span>"
	},
	{
		"desc": "Ensure that when a leading-whitespace-containing string is emitted on a newline, it is correctly escaped",
		"wikitext": "<div>\nABC\n{{1x|\n{{{!}}\n{{!}} a\n{{!}}}}} b",
		"print": "<span class=\"wpb-root\"><span class=\"wpb-html\">&lt;div&gt;</span>\nABC\n<span class=\"wpb-template\">{{<span class=\"wpb-template-name\">1x</span>|<span class=\"wpb-parameter\"><span class=\"wpb-parameter-value\">\n<span class=\"wpb-table\"><span class=\"wpb-table-syntax\">{<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span><span class=\"wpb-td-inner\"> a</span></span><span class=\"wpb-td\"><span class=\"wpb-table-syntax\">\n<span class=\"wpb-magic-word\">{{<span class=\"wpb-magic-word-name\">!</span>}}</span></span></span></span></span></span>}}</span>} b</span>"
	}
]